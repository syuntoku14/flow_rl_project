{"episode_reward_mean": 209.87017446485993, "info": {"num_steps_sampled": 116178, "grad_time_ms": 23399.012, "sample_time_ms": 40761.528, "update_time_ms": 2640.135, "default": {"vf_loss": 1.0943914651870728, "vf_explained_var": 0.8651472330093384, "entropy": 1.4189138412475586, "total_loss": 1.0928176641464233, "cur_lr": 0.0005000000237487257, "kl": 0.004353284370154142, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.002444400219246745}, "load_time_ms": 46.223, "num_steps_trained": 116178}, "episode_len_mean": 700.0, "timesteps_since_restore": 116178, "custom_metrics": {"cost1_max": 229.1723400520664, "system_level_velocity_min": 6.757562411089474, "system_level_velocity_max": 8.774290863658758, "outflow_rate_mean": 611.6361430398488, "cost2_min": -117.53517892807805, "cost1_min": 177.75350658569334, "cost2_max": -54.88733709595848, "outflow_rate_min": 568.8297561022192, "outflow_rate_max": 764.2110486285126, "cost1_mean": 199.8445368698617, "system_level_velocity_mean": 7.728464604692344, "cost2_mean": -77.05020268062229}, "node_ip": "10.138.0.2", "time_since_restore": 67.04211735725403, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c438>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-38-20", "timesteps_total": 116178, "done": false, "time_total_s": 67.04211735725403, "pid": 23758, "timestamp": 1556275100, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 33, "episode_reward_max": 278.5308869971623, "time_this_iter_s": 67.04211735725403, "training_iteration": 1, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 147.92409790560043, "episodes_this_iter": 33, "timesteps_this_iter": 116178, "hostname": "flow-main"}
{"episode_reward_mean": 235.10868632813802, "info": {"num_steps_sampled": 235002, "grad_time_ms": 23371.722, "sample_time_ms": 27885.091, "update_time_ms": 1325.582, "default": {"vf_loss": 1.2610650062561035, "vf_explained_var": 0.8485997915267944, "entropy": 1.411231517791748, "total_loss": 1.2549651861190796, "cur_lr": 0.0005000000237487257, "kl": 0.013767918571829796, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0074765742756426334}, "load_time_ms": 28.327, "num_steps_trained": 235002}, "episode_len_mean": 700.0, "timesteps_since_restore": 235002, "custom_metrics": {"cost1_max": 253.71674793771638, "system_level_velocity_min": 5.5526944004218555, "system_level_velocity_max": 9.83229170942258, "outflow_rate_mean": 613.855697852093, "cost2_min": -129.66086507429242, "cost1_min": 144.71210996137228, "cost2_max": -46.073356689759585, "outflow_rate_min": 407.2011481145565, "outflow_rate_max": 783.2927898165625, "cost1_mean": 202.80411719389247, "system_level_velocity_mean": 7.835796970439638, "cost2_mean": -79.04585670343657}, "node_ip": "10.138.0.2", "time_since_restore": 105.6238968372345, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219166a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916d30>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-38-59", "timesteps_total": 235002, "done": false, "time_total_s": 105.6238968372345, "pid": 23758, "timestamp": 1556275139, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 95, "episode_reward_max": 370.55497556941884, "time_this_iter_s": 38.58177947998047, "training_iteration": 2, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 109.5321049371237, "episodes_this_iter": 62, "timesteps_this_iter": 118824, "hostname": "flow-main"}
{"episode_reward_mean": 326.38239944173574, "info": {"num_steps_sampled": 347235, "grad_time_ms": 22878.172, "sample_time_ms": 23266.212, "update_time_ms": 887.42, "default": {"vf_loss": 4.926082134246826, "vf_explained_var": 0.7637119889259338, "entropy": 1.3733470439910889, "total_loss": 4.920417785644531, "cur_lr": 0.0005000000237487257, "kl": 0.011517220176756382, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00681645143777132}, "load_time_ms": 22.617, "num_steps_trained": 347235}, "episode_len_mean": 700.0, "timesteps_since_restore": 347235, "custom_metrics": {"cost1_max": 299.99606971462026, "system_level_velocity_min": 5.5526944004218555, "system_level_velocity_max": 11.521358926566286, "outflow_rate_mean": 660.0567217728458, "cost2_min": -129.66086507429242, "cost1_min": 144.71210996137228, "cost2_max": -46.073356689759585, "outflow_rate_min": 429.71592360686674, "outflow_rate_max": 840.7829836788629, "cost1_mean": 224.67224464531046, "system_level_velocity_mean": 8.651447947437767, "cost2_mean": -76.45941030689994}, "node_ip": "10.138.0.2", "time_since_restore": 141.74221682548523, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219113c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911a90>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-39-35", "timesteps_total": 347235, "done": false, "time_total_s": 141.74221682548523, "pid": 23758, "timestamp": 1556275175, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 145, "episode_reward_max": 551.8092180260962, "time_this_iter_s": 36.11831998825073, "training_iteration": 3, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 109.5321049371237, "episodes_this_iter": 50, "timesteps_this_iter": 112233, "hostname": "flow-main"}
{"episode_reward_mean": 479.3798280462413, "info": {"num_steps_sampled": 464009, "grad_time_ms": 22725.007, "sample_time_ms": 21295.74, "update_time_ms": 668.298, "default": {"vf_loss": 7.463669300079346, "vf_explained_var": 0.6339300274848938, "entropy": 1.3510866165161133, "total_loss": 7.461223602294922, "cur_lr": 0.0005000000237487257, "kl": 0.007509456481784582, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0031959409825503826}, "load_time_ms": 19.27, "num_steps_trained": 464009}, "episode_len_mean": 700.0, "timesteps_since_restore": 464009, "custom_metrics": {"cost1_max": 315.3190617319339, "system_level_velocity_min": 6.543230773835946, "system_level_velocity_max": 11.905174956068588, "outflow_rate_mean": 746.965658052747, "cost2_min": -98.39827325279157, "cost1_min": 167.8584669235196, "cost2_max": -52.36964306187851, "outflow_rate_min": 450.11585958960876, "outflow_rate_max": 898.7805750416629, "cost1_mean": 254.98957795243183, "system_level_velocity_mean": 9.733735850988804, "cost2_mean": -75.19687247005383}, "node_ip": "10.138.0.2", "time_since_restore": 179.58986926078796, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219163c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219169e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f28>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-40-13", "timesteps_total": 464009, "done": false, "time_total_s": 179.58986926078796, "pid": 23758, "timestamp": 1556275213, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 202, "episode_reward_max": 623.0658792538734, "time_this_iter_s": 37.847652435302734, "training_iteration": 4, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 210.78017152398007, "episodes_this_iter": 57, "timesteps_this_iter": 116774, "hostname": "flow-main"}
{"episode_reward_mean": 568.0921076414287, "info": {"num_steps_sampled": 581302, "grad_time_ms": 22864.148, "sample_time_ms": 19986.72, "update_time_ms": 536.627, "default": {"vf_loss": 6.763351917266846, "vf_explained_var": 0.60565584897995, "entropy": 1.3372632265090942, "total_loss": 6.761960983276367, "cur_lr": 0.0005000000237487257, "kl": 0.00640657264739275, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0020318906754255295}, "load_time_ms": 17.473, "num_steps_trained": 581302}, "episode_len_mean": 700.0, "timesteps_since_restore": 581302, "custom_metrics": {"cost1_max": 329.7152837031253, "system_level_velocity_min": 7.420182926556289, "system_level_velocity_max": 12.463053997982703, "outflow_rate_mean": 801.0926261622103, "cost2_min": -93.49302496847042, "cost1_min": 195.4057883085008, "cost2_max": -60.825485055817865, "outflow_rate_min": 576.2275996330111, "outflow_rate_max": 909.4774854080167, "cost1_mean": 267.65531147687676, "system_level_velocity_mean": 10.13773477075927, "cost2_mean": -74.3826347859602}, "node_ip": "10.138.0.2", "time_since_restore": 217.97318577766418, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916710>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-40-51", "timesteps_total": 581302, "done": false, "time_total_s": 217.97318577766418, "pid": 23758, "timestamp": 1556275251, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 246, "episode_reward_max": 684.693294745932, "time_this_iter_s": 38.38331651687622, "training_iteration": 5, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 375.54203620590846, "episodes_this_iter": 44, "timesteps_this_iter": 117293, "hostname": "flow-main"}
{"episode_reward_mean": 618.2226858120823, "info": {"num_steps_sampled": 697427, "grad_time_ms": 22900.576, "sample_time_ms": 19111.11, "update_time_ms": 448.943, "default": {"vf_loss": 8.195530891418457, "vf_explained_var": 0.6128910183906555, "entropy": 1.3333357572555542, "total_loss": 8.19417953491211, "cur_lr": 0.0005000000237487257, "kl": 0.0065194470807909966, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0020029067527502775}, "load_time_ms": 16.204, "num_steps_trained": 697427}, "episode_len_mean": 700.0, "timesteps_since_restore": 697427, "custom_metrics": {"cost1_max": 334.5537687646836, "system_level_velocity_min": 8.46268197071731, "system_level_velocity_max": 12.602350185474037, "outflow_rate_mean": 829.9407696661646, "cost2_min": -81.28607951678669, "cost1_min": 231.43577172665061, "cost2_max": -48.73529839740861, "outflow_rate_min": 751.1248825426836, "outflow_rate_max": 936.191552744929, "cost1_mean": 273.16337284325874, "system_level_velocity_mean": 10.289917768955796, "cost2_mean": -65.90444011521015}, "node_ip": "10.138.0.2", "time_since_restore": 256.0276253223419, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219165c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219169e8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-41-30", "timesteps_total": 697427, "done": false, "time_total_s": 256.0276253223419, "pid": 23758, "timestamp": 1556275290, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 301, "episode_reward_max": 695.0673632864782, "time_this_iter_s": 38.054439544677734, "training_iteration": 6, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 522.3146772630408, "episodes_this_iter": 55, "timesteps_this_iter": 116125, "hostname": "flow-main"}
{"episode_reward_mean": 644.7346056451894, "info": {"num_steps_sampled": 812324, "grad_time_ms": 22800.992, "sample_time_ms": 18496.001, "update_time_ms": 386.607, "default": {"vf_loss": 9.7385835647583, "vf_explained_var": 0.6121283173561096, "entropy": 1.329038381576538, "total_loss": 9.737637519836426, "cur_lr": 0.0005000000237487257, "kl": 0.005974289495497942, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.001542308134958148}, "load_time_ms": 15.168, "num_steps_trained": 812324}, "episode_len_mean": 700.0, "timesteps_since_restore": 812324, "custom_metrics": {"cost1_max": 335.2184738786758, "system_level_velocity_min": 8.46268197071731, "system_level_velocity_max": 12.759738203551906, "outflow_rate_mean": 843.7372770923847, "cost2_min": -70.68826636901792, "cost1_min": 231.43577172665061, "cost2_max": -39.739064514958045, "outflow_rate_min": 789.5684915419652, "outflow_rate_max": 946.3884284968452, "cost1_mean": 278.3981775825646, "system_level_velocity_mean": 10.457098299848997, "cost2_mean": -58.764099557936746}, "node_ip": "10.138.0.2", "time_since_restore": 293.26206493377686, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219162b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-42-07", "timesteps_total": 812324, "done": false, "time_total_s": 293.26206493377686, "pid": 23758, "timestamp": 1556275327, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 358, "episode_reward_max": 715.0955884026431, "time_this_iter_s": 37.23443961143494, "training_iteration": 7, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 601.3560833217335, "episodes_this_iter": 57, "timesteps_this_iter": 114897, "hostname": "flow-main"}
{"episode_reward_mean": 659.3374524009807, "info": {"num_steps_sampled": 926483, "grad_time_ms": 22424.557, "sample_time_ms": 18023.122, "update_time_ms": 339.707, "default": {"vf_loss": 9.831732749938965, "vf_explained_var": 0.6502487063407898, "entropy": 1.3138737678527832, "total_loss": 9.830348014831543, "cur_lr": 0.0005000000237487257, "kl": 0.006812874227762222, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0020673845428973436}, "load_time_ms": 14.166, "num_steps_trained": 926483}, "episode_len_mean": 700.0, "timesteps_since_restore": 926483, "custom_metrics": {"cost1_max": 339.10901799538715, "system_level_velocity_min": 8.839158387176786, "system_level_velocity_max": 12.86445330486906, "outflow_rate_mean": 854.9861940129641, "cost2_min": -65.94032977972759, "cost1_min": 238.09590140417305, "cost2_max": -39.739064514958045, "outflow_rate_min": 807.3327376208133, "outflow_rate_max": 953.4782941470693, "cost1_mean": 284.5869442838891, "system_level_velocity_mean": 10.677334486569595, "cost2_mean": -54.2643394527925}, "node_ip": "10.138.0.2", "time_since_restore": 327.9591808319092, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219165c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916c18>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-42-42", "timesteps_total": 926483, "done": false, "time_total_s": 327.9591808319092, "pid": 23758, "timestamp": 1556275362, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 409, "episode_reward_max": 718.784520888688, "time_this_iter_s": 34.697115898132324, "training_iteration": 8, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 618.2824763757883, "episodes_this_iter": 51, "timesteps_this_iter": 114159, "hostname": "flow-main"}
{"episode_reward_mean": 659.527422839898, "info": {"num_steps_sampled": 1040119, "grad_time_ms": 22264.804, "sample_time_ms": 17631.864, "update_time_ms": 303.174, "default": {"vf_loss": 11.388772010803223, "vf_explained_var": 0.6087539196014404, "entropy": 1.3141992092132568, "total_loss": 11.387374877929688, "cur_lr": 0.0005000000237487257, "kl": 0.007568181958049536, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0021542576141655445}, "load_time_ms": 13.371, "num_steps_trained": 1040119}, "episode_len_mean": 700.0, "timesteps_since_restore": 1040119, "custom_metrics": {"cost1_max": 349.6350890560759, "system_level_velocity_min": 9.124393118317858, "system_level_velocity_max": 13.184670464502677, "outflow_rate_mean": 850.3109654561555, "cost2_min": -59.165961984779685, "cost1_min": 245.24246304171555, "cost2_max": -40.91685088362806, "outflow_rate_min": 797.7865906458121, "outflow_rate_max": 943.2497687778795, "cost1_mean": 283.84043074969844, "system_level_velocity_mean": 10.646146338187366, "cost2_mean": -50.28354646295673}, "node_ip": "10.138.0.2", "time_since_restore": 363.670161485672, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219162b0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-43-17", "timesteps_total": 1040119, "done": false, "time_total_s": 363.670161485672, "pid": 23758, "timestamp": 1556275397, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 469, "episode_reward_max": 718.784520888688, "time_this_iter_s": 35.71098065376282, "training_iteration": 9, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 625.9867281618671, "episodes_this_iter": 60, "timesteps_this_iter": 113636, "hostname": "flow-main"}
{"episode_reward_mean": 652.3930675492361, "info": {"num_steps_sampled": 1152335, "grad_time_ms": 22108.751, "sample_time_ms": 17301.466, "update_time_ms": 273.925, "default": {"vf_loss": 12.706417083740234, "vf_explained_var": 0.5384939312934875, "entropy": 1.3007718324661255, "total_loss": 12.705029487609863, "cur_lr": 0.0005000000237487257, "kl": 0.007696783170104027, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0021584031637758017}, "load_time_ms": 12.654, "num_steps_trained": 1152335}, "episode_len_mean": 700.0, "timesteps_since_restore": 1152335, "custom_metrics": {"cost1_max": 341.5167874315209, "system_level_velocity_min": 9.18861686077894, "system_level_velocity_max": 12.748447033256063, "outflow_rate_mean": 838.7684434840507, "cost2_min": -56.79252638596482, "cost1_min": 245.24246304171555, "cost2_max": -39.62684449420843, "outflow_rate_min": 800.4780897204462, "outflow_rate_max": 924.4640942159422, "cost1_mean": 281.6644414236975, "system_level_velocity_mean": 10.569453044769487, "cost2_mean": -46.49890286371529}, "node_ip": "10.138.0.2", "time_since_restore": 398.92347145080566, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916da0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-43-53", "timesteps_total": 1152335, "done": false, "time_total_s": 398.92347145080566, "pid": 23758, "timestamp": 1556275433, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 526, "episode_reward_max": 718.6715188210984, "time_this_iter_s": 35.25330996513367, "training_iteration": 10, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 614.2084188384472, "episodes_this_iter": 57, "timesteps_this_iter": 112216, "hostname": "flow-main"}
{"episode_reward_mean": 646.0911153255015, "info": {"num_steps_sampled": 1264014, "grad_time_ms": 21839.361, "sample_time_ms": 14794.125, "update_time_ms": 11.237, "default": {"vf_loss": 15.278717994689941, "vf_explained_var": 0.4466608166694641, "entropy": 1.2913033962249756, "total_loss": 15.278020858764648, "cur_lr": 0.0005000000237487257, "kl": 0.007068247068673372, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00140307133551687}, "load_time_ms": 8.819, "num_steps_trained": 1264014}, "episode_len_mean": 693.4, "timesteps_since_restore": 1264014, "custom_metrics": {"cost1_max": 355.8470775254309, "system_level_velocity_min": 9.396966757260174, "system_level_velocity_max": 16.70515017171258, "outflow_rate_mean": 831.262792765527, "cost2_min": -49.571616618264486, "cost1_min": 23.52728398622211, "cost2_max": -21.722870850733507, "outflow_rate_min": 500.03505774887407, "outflow_rate_max": 915.5679483152351, "cost1_mean": 282.2024711374782, "system_level_velocity_mean": 10.770732550618513, "cost2_mean": -42.24193802610967}, "node_ip": "10.138.0.2", "time_since_restore": 435.52348256111145, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219115f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6668>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-44-29", "timesteps_total": 1264014, "done": false, "time_total_s": 435.52348256111145, "pid": 23758, "timestamp": 1556275469, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 588, "episode_reward_max": 713.9266035647989, "time_this_iter_s": 36.600011110305786, "training_iteration": 11, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 33.479432232262205, "episodes_this_iter": 62, "timesteps_this_iter": 111679, "hostname": "flow-main"}
{"episode_reward_mean": 652.9768233334114, "info": {"num_steps_sampled": 1375648, "grad_time_ms": 21637.532, "sample_time_ms": 14731.508, "update_time_ms": 11.273, "default": {"vf_loss": 14.934435844421387, "vf_explained_var": 0.4943975806236267, "entropy": 1.2867342233657837, "total_loss": 14.933602333068848, "cur_lr": 0.0005000000237487257, "kl": 0.007262452971190214, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0015594575088471174}, "load_time_ms": 8.246, "num_steps_trained": 1375648}, "episode_len_mean": 693.4, "timesteps_since_restore": 1375648, "custom_metrics": {"cost1_max": 360.533860469856, "system_level_velocity_min": 9.448278166805851, "system_level_velocity_max": 16.70515017171258, "outflow_rate_mean": 830.5806894177487, "cost2_min": -47.59675936516288, "cost1_min": 23.52728398622211, "cost2_max": -21.722870850733507, "outflow_rate_min": 500.03505774887407, "outflow_rate_max": 914.7499528399799, "cost1_mean": 284.0405029661639, "system_level_velocity_mean": 10.852561522961992, "cost2_mean": -39.06272745115409}, "node_ip": "10.138.0.2", "time_since_restore": 471.4496567249298, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b70>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-45-05", "timesteps_total": 1375648, "done": false, "time_total_s": 471.4496567249298, "pid": 23758, "timestamp": 1556275505, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 643, "episode_reward_max": 715.2449512427373, "time_this_iter_s": 35.92617416381836, "training_iteration": 12, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 33.479432232262205, "episodes_this_iter": 55, "timesteps_this_iter": 111634, "hostname": "flow-main"}
{"episode_reward_mean": 669.4930057687983, "info": {"num_steps_sampled": 1488418, "grad_time_ms": 21587.88, "sample_time_ms": 14817.559, "update_time_ms": 11.415, "default": {"vf_loss": 16.617586135864258, "vf_explained_var": 0.530826210975647, "entropy": 1.2818012237548828, "total_loss": 16.617496490478516, "cur_lr": 0.0005000000237487257, "kl": 0.006219100207090378, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007138160290196538}, "load_time_ms": 7.835, "num_steps_trained": 1488418}, "episode_len_mean": 700.0, "timesteps_since_restore": 1488418, "custom_metrics": {"cost1_max": 361.57322098131885, "system_level_velocity_min": 9.448278166805851, "system_level_velocity_max": 13.623441518622453, "outflow_rate_mean": 839.2847508016861, "cost2_min": -43.52798915569394, "cost1_min": 251.88873092090935, "cost2_max": -30.11184152100275, "outflow_rate_min": 802.8783274771353, "outflow_rate_max": 952.1977590599346, "cost1_mean": 290.00097589389554, "system_level_velocity_mean": 10.934073336188078, "cost2_mean": -36.598936566279434}, "node_ip": "10.138.0.2", "time_since_restore": 507.961065530777, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219115f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a58>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-45-42", "timesteps_total": 1488418, "done": false, "time_total_s": 507.961065530777, "pid": 23758, "timestamp": 1556275542, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 704, "episode_reward_max": 737.9403339046675, "time_this_iter_s": 36.51140880584717, "training_iteration": 13, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 638.09815878831, "episodes_this_iter": 61, "timesteps_this_iter": 112770, "hostname": "flow-main"}
{"episode_reward_mean": 686.1343305344548, "info": {"num_steps_sampled": 1602482, "grad_time_ms": 21584.617, "sample_time_ms": 14720.627, "update_time_ms": 11.642, "default": {"vf_loss": 17.38839340209961, "vf_explained_var": 0.5211408138275146, "entropy": 1.2764892578125, "total_loss": 17.387752532958984, "cur_lr": 0.0005000000237487257, "kl": 0.0068901898339390755, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0013285143068060279}, "load_time_ms": 7.678, "num_steps_trained": 1602482}, "episode_len_mean": 700.0, "timesteps_since_restore": 1602482, "custom_metrics": {"cost1_max": 376.50164613114134, "system_level_velocity_min": 9.739477977526288, "system_level_velocity_max": 14.146665665592181, "outflow_rate_mean": 855.0814596688126, "cost2_min": -43.10191554957714, "cost1_min": 256.81893773916863, "cost2_max": -29.56645200195714, "outflow_rate_min": 809.1947942651946, "outflow_rate_max": 952.1977590599346, "cost1_mean": 298.00749162091853, "system_level_velocity_mean": 11.225189695365346, "cost2_mean": -35.66954985503973}, "node_ip": "10.138.0.2", "time_since_restore": 544.8412222862244, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926080>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-46-19", "timesteps_total": 1602482, "done": false, "time_total_s": 544.8412222862244, "pid": 23758, "timestamp": 1556275579, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 757, "episode_reward_max": 754.9946229554728, "time_this_iter_s": 36.88015675544739, "training_iteration": 14, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 642.0422509829319, "episodes_this_iter": 53, "timesteps_this_iter": 114064, "hostname": "flow-main"}
{"episode_reward_mean": 690.898454621655, "info": {"num_steps_sampled": 1717784, "grad_time_ms": 21413.373, "sample_time_ms": 14728.866, "update_time_ms": 11.808, "default": {"vf_loss": 18.6163272857666, "vf_explained_var": 0.5694620013237, "entropy": 1.2645537853240967, "total_loss": 18.615955352783203, "cur_lr": 0.0005000000237487257, "kl": 0.006811240687966347, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0010553993051871657}, "load_time_ms": 7.237, "num_steps_trained": 1717784}, "episode_len_mean": 700.0, "timesteps_since_restore": 1717784, "custom_metrics": {"cost1_max": 390.89331826798417, "system_level_velocity_min": 9.524505769254999, "system_level_velocity_max": 14.963861611658333, "outflow_rate_mean": 858.408918962051, "cost2_min": -43.10191554957714, "cost1_min": 252.24108435268462, "cost2_max": -29.45276363648916, "outflow_rate_min": 805.0616355620175, "outflow_rate_max": 973.4136282394019, "cost1_mean": 295.77685781749204, "system_level_velocity_mean": 11.155501844418959, "cost2_mean": -34.72852666564646}, "node_ip": "10.138.0.2", "time_since_restore": 581.6137228012085, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219269b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ac8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-46-55", "timesteps_total": 1717784, "done": false, "time_total_s": 581.6137228012085, "pid": 23758, "timestamp": 1556275615, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 813, "episode_reward_max": 772.1338933063524, "time_this_iter_s": 36.77250051498413, "training_iteration": 15, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 642.0422509829319, "episodes_this_iter": 56, "timesteps_this_iter": 115302, "hostname": "flow-main"}
{"episode_reward_mean": 704.0147780724634, "info": {"num_steps_sampled": 1833894, "grad_time_ms": 21363.547, "sample_time_ms": 14750.337, "update_time_ms": 11.887, "default": {"vf_loss": 19.556453704833984, "vf_explained_var": 0.5816630721092224, "entropy": 1.253840684890747, "total_loss": 19.556589126586914, "cur_lr": 0.0005000000237487257, "kl": 0.006460282485932112, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.000509840901941061}, "load_time_ms": 7.056, "num_steps_trained": 1833894}, "episode_len_mean": 700.0, "timesteps_since_restore": 1833894, "custom_metrics": {"cost1_max": 390.89331826798417, "system_level_velocity_min": 9.22692022156746, "system_level_velocity_max": 14.963861611658333, "outflow_rate_mean": 870.7878955430908, "cost2_min": -39.84863771975752, "cost1_min": 248.88140740722065, "cost2_max": -30.855601213029107, "outflow_rate_min": 808.400458874969, "outflow_rate_max": 996.804900336525, "cost1_mean": 299.66437424247505, "system_level_velocity_mean": 11.30852467120739, "cost2_mean": -34.45265169299773}, "node_ip": "10.138.0.2", "time_since_restore": 619.3826756477356, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b70>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-47-33", "timesteps_total": 1833894, "done": false, "time_total_s": 619.3826756477356, "pid": 23758, "timestamp": 1556275653, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 865, "episode_reward_max": 793.7880626109302, "time_this_iter_s": 37.7689528465271, "training_iteration": 16, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 646.2946409832787, "episodes_this_iter": 52, "timesteps_this_iter": 116110, "hostname": "flow-main"}
{"episode_reward_mean": 716.3142799446084, "info": {"num_steps_sampled": 1948907, "grad_time_ms": 21501.913, "sample_time_ms": 14717.61, "update_time_ms": 11.699, "default": {"vf_loss": 20.742517471313477, "vf_explained_var": 0.6045119166374207, "entropy": 1.244372010231018, "total_loss": 20.74220848083496, "cur_lr": 0.0005000000237487257, "kl": 0.006935935467481613, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0010012565180659294}, "load_time_ms": 7.253, "num_steps_trained": 1948907}, "episode_len_mean": 700.0, "timesteps_since_restore": 1948907, "custom_metrics": {"cost1_max": 405.26713781997626, "system_level_velocity_min": 9.21330080925285, "system_level_velocity_max": 15.653892189085637, "outflow_rate_mean": 878.6486917967454, "cost2_min": -38.84544360165465, "cost1_min": 244.79160305627147, "cost2_max": -26.530664914983163, "outflow_rate_min": 812.6143682055068, "outflow_rate_max": 1031.8255545978768, "cost1_mean": 299.48455160080823, "system_level_velocity_mean": 11.307514645335882, "cost2_mean": -34.360947090706425}, "node_ip": "10.138.0.2", "time_since_restore": 657.6899783611298, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a58>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-48-12", "timesteps_total": 1948907, "done": false, "time_total_s": 657.6899783611298, "pid": 23758, "timestamp": 1556275692, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 919, "episode_reward_max": 793.7880626109302, "time_this_iter_s": 38.307302713394165, "training_iteration": 17, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 659.05416152142, "episodes_this_iter": 54, "timesteps_this_iter": 115013, "hostname": "flow-main"}
{"episode_reward_mean": 721.9557495449983, "info": {"num_steps_sampled": 2063649, "grad_time_ms": 21783.883, "sample_time_ms": 14714.165, "update_time_ms": 11.877, "default": {"vf_loss": 22.135202407836914, "vf_explained_var": 0.6309494376182556, "entropy": 1.2299906015396118, "total_loss": 22.135238647460938, "cur_lr": 0.0005000000237487257, "kl": 0.005827424116432667, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0005458475206978619}, "load_time_ms": 7.453, "num_steps_trained": 2063649}, "episode_len_mean": 700.0, "timesteps_since_restore": 2063649, "custom_metrics": {"cost1_max": 415.69038287110845, "system_level_velocity_min": 9.21330080925285, "system_level_velocity_max": 16.113650705797056, "outflow_rate_mean": 886.914237080789, "cost2_min": -40.399532009248716, "cost1_min": 244.79160305627147, "cost2_max": -26.530664914983163, "outflow_rate_min": 815.985708201077, "outflow_rate_max": 1055.532191480535, "cost1_mean": 302.25255617006695, "system_level_velocity_mean": 11.444624955881354, "cost2_mean": -34.076322803466574}, "node_ip": "10.138.0.2", "time_since_restore": 695.2078332901001, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a90>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-48-49", "timesteps_total": 2063649, "done": false, "time_total_s": 695.2078332901001, "pid": 23758, "timestamp": 1556275729, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 972, "episode_reward_max": 798.0726632305409, "time_this_iter_s": 37.51785492897034, "training_iteration": 18, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 661.7792763730122, "episodes_this_iter": 53, "timesteps_this_iter": 114742, "hostname": "flow-main"}
{"episode_reward_mean": 729.5103917570093, "info": {"num_steps_sampled": 2180112, "grad_time_ms": 21737.669, "sample_time_ms": 14748.26, "update_time_ms": 11.867, "default": {"vf_loss": 21.90213966369629, "vf_explained_var": 0.6382648944854736, "entropy": 1.2158583402633667, "total_loss": 21.90230941772461, "cur_lr": 0.0005000000237487257, "kl": 0.00634852796792984, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0004642972198780626}, "load_time_ms": 7.875, "num_steps_trained": 2180112}, "episode_len_mean": 700.0, "timesteps_since_restore": 2180112, "custom_metrics": {"cost1_max": 416.0261570906706, "system_level_velocity_min": 9.033584767110758, "system_level_velocity_max": 16.176968672801117, "outflow_rate_mean": 899.1103582625328, "cost2_min": -42.173109850906904, "cost1_min": 241.49693536057, "cost2_max": -26.36200378365405, "outflow_rate_min": 816.3858005367364, "outflow_rate_max": 1055.532191480535, "cost1_mean": 307.3199149053891, "system_level_velocity_mean": 11.662093917320812, "cost2_mean": -34.857273172294974}, "node_ip": "10.138.0.2", "time_since_restore": 730.8220751285553, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219113c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219110b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911f28>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-49-25", "timesteps_total": 2180112, "done": false, "time_total_s": 730.8220751285553, "pid": 23758, "timestamp": 1556275765, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1025, "episode_reward_max": 825.2586254646594, "time_this_iter_s": 35.6142418384552, "training_iteration": 19, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 651.7892678020777, "episodes_this_iter": 53, "timesteps_this_iter": 116463, "hostname": "flow-main"}
{"episode_reward_mean": 733.7613507455324, "info": {"num_steps_sampled": 2297892, "grad_time_ms": 21663.104, "sample_time_ms": 14757.038, "update_time_ms": 12.063, "default": {"vf_loss": 22.646841049194336, "vf_explained_var": 0.6491265296936035, "entropy": 1.2209886312484741, "total_loss": 22.64679527282715, "cur_lr": 0.0005000000237487257, "kl": 0.006253791972994804, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0006704193074256182}, "load_time_ms": 7.976, "num_steps_trained": 2297892}, "episode_len_mean": 700.0, "timesteps_since_restore": 2297892, "custom_metrics": {"cost1_max": 416.0261570906706, "system_level_velocity_min": 8.97008919883814, "system_level_velocity_max": 16.176968672801117, "outflow_rate_mean": 900.3882853100866, "cost2_min": -42.173109850906904, "cost1_min": 237.1030618925297, "cost2_max": -26.36200378365405, "outflow_rate_min": 815.0054415192299, "outflow_rate_max": 1048.2523397143823, "cost1_mean": 302.28439003444987, "system_level_velocity_mean": 11.439644019085675, "cost2_mean": -34.915148352840475}, "node_ip": "10.138.0.2", "time_since_restore": 765.3954992294312, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219364e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926978>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-49-59", "timesteps_total": 2297892, "done": false, "time_total_s": 765.3954992294312, "pid": 23758, "timestamp": 1556275799, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1079, "episode_reward_max": 825.2586254646594, "time_this_iter_s": 34.573424100875854, "training_iteration": 20, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 651.7892678020777, "episodes_this_iter": 54, "timesteps_this_iter": 117780, "hostname": "flow-main"}
{"episode_reward_mean": 732.2430547525355, "info": {"num_steps_sampled": 2415723, "grad_time_ms": 21815.628, "sample_time_ms": 14675.025, "update_time_ms": 11.796, "default": {"vf_loss": 21.07355499267578, "vf_explained_var": 0.6875659227371216, "entropy": 1.2180767059326172, "total_loss": 21.07406234741211, "cur_lr": 0.0005000000237487257, "kl": 0.006156448274850845, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00010981281229760498}, "load_time_ms": 7.779, "num_steps_trained": 2415723}, "episode_len_mean": 700.0, "timesteps_since_restore": 2415723, "custom_metrics": {"cost1_max": 405.75319051429307, "system_level_velocity_min": 8.97008919883814, "system_level_velocity_max": 15.560819105156142, "outflow_rate_mean": 893.7598770273642, "cost2_min": -41.96266518182039, "cost1_min": 237.1030618925297, "cost2_max": -26.259438280360246, "outflow_rate_min": 815.0054415192299, "outflow_rate_max": 1057.2293357253052, "cost1_mean": 292.476101295285, "system_level_velocity_mean": 11.031452101220516, "cost2_mean": -34.34572009180864}, "node_ip": "10.138.0.2", "time_since_restore": 802.7181088924408, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219162b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b2e8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-50-37", "timesteps_total": 2415723, "done": false, "time_total_s": 802.7181088924408, "pid": 23758, "timestamp": 1556275837, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1129, "episode_reward_max": 805.8110965783115, "time_this_iter_s": 37.322609663009644, "training_iteration": 21, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 665.4573606417945, "episodes_this_iter": 50, "timesteps_this_iter": 117831, "hostname": "flow-main"}
{"episode_reward_mean": 738.9071931752794, "info": {"num_steps_sampled": 2533936, "grad_time_ms": 21956.008, "sample_time_ms": 14757.993, "update_time_ms": 11.575, "default": {"vf_loss": 22.134902954101562, "vf_explained_var": 0.6703112721443176, "entropy": 1.2229961156845093, "total_loss": 22.13443946838379, "cur_lr": 0.0005000000237487257, "kl": 0.007136141415685415, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011774878948926926}, "load_time_ms": 8.083, "num_steps_trained": 2533936}, "episode_len_mean": 700.0, "timesteps_since_restore": 2533936, "custom_metrics": {"cost1_max": 404.0962626121045, "system_level_velocity_min": 9.061770136542815, "system_level_velocity_max": 15.476963484169238, "outflow_rate_mean": 902.7915845452085, "cost2_min": -41.68024754445288, "cost1_min": 241.69609120868486, "cost2_max": -26.259438280360246, "outflow_rate_min": 822.2142627091778, "outflow_rate_max": 1065.505933247067, "cost1_mean": 293.5133125320944, "system_level_velocity_mean": 11.061205254167923, "cost2_mean": -34.66396841852779}, "node_ip": "10.138.0.2", "time_since_restore": 840.891850233078, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926e10>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-51-15", "timesteps_total": 2533936, "done": false, "time_total_s": 840.891850233078, "pid": 23758, "timestamp": 1556275875, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1179, "episode_reward_max": 817.2072127118192, "time_this_iter_s": 38.17374134063721, "training_iteration": 22, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 655.1744302497185, "episodes_this_iter": 50, "timesteps_this_iter": 118213, "hostname": "flow-main"}
{"episode_reward_mean": 747.9670187826488, "info": {"num_steps_sampled": 2652838, "grad_time_ms": 21967.116, "sample_time_ms": 14688.078, "update_time_ms": 11.366, "default": {"vf_loss": 22.33404541015625, "vf_explained_var": 0.6711317896842957, "entropy": 1.2165058851242065, "total_loss": 22.333715438842773, "cur_lr": 0.0005000000237487257, "kl": 0.00623150821775198, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0009544579079374671}, "load_time_ms": 8.252, "num_steps_trained": 2652838}, "episode_len_mean": 700.0, "timesteps_since_restore": 2652838, "custom_metrics": {"cost1_max": 410.85961880209413, "system_level_velocity_min": 8.917021480462115, "system_level_velocity_max": 15.66657357472944, "outflow_rate_mean": 916.733855486395, "cost2_min": -40.89747825971336, "cost1_min": 236.57416623315893, "cost2_max": -30.925226605713533, "outflow_rate_min": 825.3733985594987, "outflow_rate_max": 1079.2794091075632, "cost1_mean": 299.0008498329043, "system_level_velocity_mean": 11.268470627458626, "cost2_mean": -35.5753411469541}, "node_ip": "10.138.0.2", "time_since_restore": 876.8253591060638, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219364e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926cf8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-51-51", "timesteps_total": 2652838, "done": false, "time_total_s": 876.8253591060638, "pid": 23758, "timestamp": 1556275911, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1231, "episode_reward_max": 835.313253734728, "time_this_iter_s": 35.93350887298584, "training_iteration": 23, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 655.1744302497185, "episodes_this_iter": 52, "timesteps_this_iter": 118902, "hostname": "flow-main"}
{"episode_reward_mean": 747.7294764318013, "info": {"num_steps_sampled": 2771112, "grad_time_ms": 22009.803, "sample_time_ms": 14698.822, "update_time_ms": 11.339, "default": {"vf_loss": 23.00261878967285, "vf_explained_var": 0.6890684366226196, "entropy": 1.208523154258728, "total_loss": 23.002717971801758, "cur_lr": 0.0005000000237487257, "kl": 0.007037229835987091, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0006052430835552514}, "load_time_ms": 8.575, "num_steps_trained": 2771112}, "episode_len_mean": 700.0, "timesteps_since_restore": 2771112, "custom_metrics": {"cost1_max": 410.85961880209413, "system_level_velocity_min": 9.328912936143416, "system_level_velocity_max": 15.66657357472944, "outflow_rate_mean": 911.5934646488023, "cost2_min": -40.2606823796572, "cost1_min": 245.43233298867017, "cost2_max": -28.068380238601016, "outflow_rate_min": 832.8015952159218, "outflow_rate_max": 1079.2794091075632, "cost1_mean": 294.47379198514824, "system_level_velocity_mean": 11.106242621535051, "cost2_mean": -35.39095557455713}, "node_ip": "10.138.0.2", "time_since_restore": 914.24471616745, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926be0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-52-28", "timesteps_total": 2771112, "done": false, "time_total_s": 914.24471616745, "pid": 23758, "timestamp": 1556275948, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1285, "episode_reward_max": 835.313253734728, "time_this_iter_s": 37.41935706138611, "training_iteration": 24, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 670.4929738971161, "episodes_this_iter": 54, "timesteps_this_iter": 118274, "hostname": "flow-main"}
{"episode_reward_mean": 747.5278212478906, "info": {"num_steps_sampled": 2889799, "grad_time_ms": 21987.135, "sample_time_ms": 14639.191, "update_time_ms": 11.168, "default": {"vf_loss": 20.738420486450195, "vf_explained_var": 0.6842629909515381, "entropy": 1.2009021043777466, "total_loss": 20.738019943237305, "cur_lr": 0.0005000000237487257, "kl": 0.007166852708905935, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011169635690748692}, "load_time_ms": 8.642, "num_steps_trained": 2889799}, "episode_len_mean": 700.0, "timesteps_since_restore": 2889799, "custom_metrics": {"cost1_max": 422.9651759184958, "system_level_velocity_min": 8.951747481278936, "system_level_velocity_max": 16.271156234848874, "outflow_rate_mean": 909.2716066055904, "cost2_min": -40.2606823796572, "cost1_min": 238.28060853842578, "cost2_max": -27.69869419165458, "outflow_rate_min": 821.9878844404756, "outflow_rate_max": 1090.8204159657619, "cost1_mean": 293.28196674293054, "system_level_velocity_mean": 11.074828903120954, "cost2_mean": -34.91269752766927}, "node_ip": "10.138.0.2", "time_since_restore": 950.1611242294312, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219268d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926470>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-53-04", "timesteps_total": 2889799, "done": false, "time_total_s": 950.1611242294312, "pid": 23758, "timestamp": 1556275984, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1330, "episode_reward_max": 844.2805415222937, "time_this_iter_s": 35.9164080619812, "training_iteration": 25, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 675.8660503253783, "episodes_this_iter": 45, "timesteps_this_iter": 118687, "hostname": "flow-main"}
{"episode_reward_mean": 743.1485577295648, "info": {"num_steps_sampled": 3007259, "grad_time_ms": 21981.643, "sample_time_ms": 14525.615, "update_time_ms": 11.106, "default": {"vf_loss": 25.521188735961914, "vf_explained_var": 0.6416610479354858, "entropy": 1.1847829818725586, "total_loss": 25.521503448486328, "cur_lr": 0.0005000000237487257, "kl": 0.00710185756906867, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00039308308623731136}, "load_time_ms": 8.734, "num_steps_trained": 3007259}, "episode_len_mean": 700.0, "timesteps_since_restore": 3007259, "custom_metrics": {"cost1_max": 422.9651759184958, "system_level_velocity_min": 8.951747481278936, "system_level_velocity_max": 16.271156234848874, "outflow_rate_mean": 907.7855783269462, "cost2_min": -45.28426497043196, "cost1_min": 238.28060853842578, "cost2_max": -26.43604647907007, "outflow_rate_min": 821.9878844404756, "outflow_rate_max": 1090.8204159657619, "cost1_mean": 292.60674641476436, "system_level_velocity_mean": 11.070329465680231, "cost2_mean": -35.47987912707549}, "node_ip": "10.138.0.2", "time_since_restore": 986.7205379009247, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926438>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-53-41", "timesteps_total": 3007259, "done": false, "time_total_s": 986.7205379009247, "pid": 23758, "timestamp": 1556276021, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1383, "episode_reward_max": 844.2805415222937, "time_this_iter_s": 36.55941367149353, "training_iteration": 26, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 657.7948394955235, "episodes_this_iter": 53, "timesteps_this_iter": 117460, "hostname": "flow-main"}
{"episode_reward_mean": 733.2173776337138, "info": {"num_steps_sampled": 3124743, "grad_time_ms": 21846.992, "sample_time_ms": 14512.564, "update_time_ms": 11.1, "default": {"vf_loss": 27.18677520751953, "vf_explained_var": 0.6328592300415039, "entropy": 1.1743532419204712, "total_loss": 27.186935424804688, "cur_lr": 0.0005000000237487257, "kl": 0.0068884240463376045, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0005283475038595498}, "load_time_ms": 8.114, "num_steps_trained": 3124743}, "episode_len_mean": 700.0, "timesteps_since_restore": 3124743, "custom_metrics": {"cost1_max": 431.4485446050253, "system_level_velocity_min": 9.026903267585768, "system_level_velocity_max": 16.98681839854985, "outflow_rate_mean": 912.2483339913343, "cost2_min": -45.28426497043196, "cost1_min": 239.6300314559992, "cost2_max": -26.43604647907007, "outflow_rate_min": 830.069662373482, "outflow_rate_max": 1091.4395173596151, "cost1_mean": 295.06684124576424, "system_level_velocity_mean": 11.208513578128507, "cost2_mean": -37.51589555914965}, "node_ip": "10.138.0.2", "time_since_restore": 1023.5107128620148, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926d68>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-54-18", "timesteps_total": 3124743, "done": false, "time_total_s": 1023.5107128620148, "pid": 23758, "timestamp": 1556276058, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1439, "episode_reward_max": 820.9313477488727, "time_this_iter_s": 36.79017496109009, "training_iteration": 27, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 653.5183817847488, "episodes_this_iter": 56, "timesteps_this_iter": 117484, "hostname": "flow-main"}
{"episode_reward_mean": 723.4126354907535, "info": {"num_steps_sampled": 3244728, "grad_time_ms": 21800.626, "sample_time_ms": 14463.06, "update_time_ms": 10.906, "default": {"vf_loss": 24.633705139160156, "vf_explained_var": 0.63252192735672, "entropy": 1.176764726638794, "total_loss": 24.633838653564453, "cur_lr": 0.0005000000237487257, "kl": 0.00759274372830987, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0006239135400392115}, "load_time_ms": 7.851, "num_steps_trained": 3244728}, "episode_len_mean": 700.0, "timesteps_since_restore": 3244728, "custom_metrics": {"cost1_max": 431.4485446050253, "system_level_velocity_min": 8.992745696422595, "system_level_velocity_max": 16.98681839854985, "outflow_rate_mean": 913.7838079608842, "cost2_min": -49.28066695754475, "cost1_min": 238.16996428657822, "cost2_max": -31.10194077447439, "outflow_rate_min": 831.2746501506092, "outflow_rate_max": 1091.4395173596151, "cost1_mean": 294.0643014789831, "system_level_velocity_mean": 11.180262819056741, "cost2_mean": -39.686064712731884}, "node_ip": "10.138.0.2", "time_since_restore": 1060.0757682323456, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926f28>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-54-54", "timesteps_total": 3244728, "done": false, "time_total_s": 1060.0757682323456, "pid": 23758, "timestamp": 1556276094, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1488, "episode_reward_max": 820.9313477488727, "time_this_iter_s": 36.56505537033081, "training_iteration": 28, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 626.2429918956824, "episodes_this_iter": 49, "timesteps_this_iter": 119985, "hostname": "flow-main"}
{"episode_reward_mean": 722.8236776814691, "info": {"num_steps_sampled": 3362049, "grad_time_ms": 22193.531, "sample_time_ms": 14412.971, "update_time_ms": 11.089, "default": {"vf_loss": 26.087875366210938, "vf_explained_var": 0.6511383652687073, "entropy": 1.1681532859802246, "total_loss": 26.08805274963379, "cur_lr": 0.0005000000237487257, "kl": 0.007147604133933783, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0005360192735679448}, "load_time_ms": 7.628, "num_steps_trained": 3362049}, "episode_len_mean": 700.0, "timesteps_since_restore": 3362049, "custom_metrics": {"cost1_max": 433.0742814294806, "system_level_velocity_min": 8.992745696422595, "system_level_velocity_max": 16.690769414985734, "outflow_rate_mean": 912.9584233386778, "cost2_min": -49.28066695754475, "cost1_min": 238.16996428657822, "cost2_max": -31.10194077447439, "outflow_rate_min": 831.2746501506092, "outflow_rate_max": 1107.2293941218638, "cost1_mean": 290.92503525041485, "system_level_velocity_mean": 11.0460689653634, "cost2_mean": -40.03331340326384}, "node_ip": "10.138.0.2", "time_since_restore": 1099.109613418579, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219260f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219260b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926588>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-55-33", "timesteps_total": 3362049, "done": false, "time_total_s": 1099.109613418579, "pid": 23758, "timestamp": 1556276133, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1537, "episode_reward_max": 833.3738650578421, "time_this_iter_s": 39.03384518623352, "training_iteration": 29, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 626.2429918956824, "episodes_this_iter": 49, "timesteps_this_iter": 117321, "hostname": "flow-main"}
{"episode_reward_mean": 740.6550569256162, "info": {"num_steps_sampled": 3482130, "grad_time_ms": 22457.703, "sample_time_ms": 14410.12, "update_time_ms": 10.904, "default": {"vf_loss": 25.764259338378906, "vf_explained_var": 0.6401339173316956, "entropy": 1.1625372171401978, "total_loss": 25.76491355895996, "cur_lr": 0.0005000000237487257, "kl": 0.006740269251167774, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -2.2512127543450333e-05}, "load_time_ms": 7.71, "num_steps_trained": 3482130}, "episode_len_mean": 700.0, "timesteps_since_restore": 3482130, "custom_metrics": {"cost1_max": 433.0742814294806, "system_level_velocity_min": 9.195826262138125, "system_level_velocity_max": 16.690769414985734, "outflow_rate_mean": 921.1853549507764, "cost2_min": -47.93957097339081, "cost1_min": 244.1982924756005, "cost2_max": -31.09722412801767, "outflow_rate_min": 834.4005634190139, "outflow_rate_max": 1107.2293941218638, "cost1_mean": 293.28215166898315, "system_level_velocity_mean": 11.109918032491398, "cost2_mean": -38.39727012495816}, "node_ip": "10.138.0.2", "time_since_restore": 1136.302906036377, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926320>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-56-11", "timesteps_total": 3482130, "done": false, "time_total_s": 1136.302906036377, "pid": 23758, "timestamp": 1556276171, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1589, "episode_reward_max": 844.465050517113, "time_this_iter_s": 37.19329261779785, "training_iteration": 30, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 642.7806060033287, "episodes_this_iter": 52, "timesteps_this_iter": 120081, "hostname": "flow-main"}
{"episode_reward_mean": 757.3009669144507, "info": {"num_steps_sampled": 3601876, "grad_time_ms": 22334.227, "sample_time_ms": 14332.613, "update_time_ms": 11.154, "default": {"vf_loss": 26.260074615478516, "vf_explained_var": 0.6553182005882263, "entropy": 1.1483063697814941, "total_loss": 26.260780334472656, "cur_lr": 0.0005000000237487257, "kl": 0.0066413553431630135, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 4.194726352579892e-05}, "load_time_ms": 7.903, "num_steps_trained": 3601876}, "episode_len_mean": 700.0, "timesteps_since_restore": 3601876, "custom_metrics": {"cost1_max": 443.834163442819, "system_level_velocity_min": 9.529550650037203, "system_level_velocity_max": 16.917792461257893, "outflow_rate_mean": 928.3173069721067, "cost2_min": -47.626100860267385, "cost1_min": 251.03110861208486, "cost2_max": -31.09722412801767, "outflow_rate_min": 845.5691327329529, "outflow_rate_max": 1136.3113958608187, "cost1_mean": 294.8366071824445, "system_level_velocity_mean": 11.149825657287531, "cost2_mean": -37.12621417083536}, "node_ip": "10.138.0.2", "time_since_restore": 1171.6382021903992, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219265f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926cc0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-56-46", "timesteps_total": 3601876, "done": false, "time_total_s": 1171.6382021903992, "pid": 23758, "timestamp": 1556276206, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1639, "episode_reward_max": 883.8326863033656, "time_this_iter_s": 35.33529615402222, "training_iteration": 31, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 642.7806060033287, "episodes_this_iter": 50, "timesteps_this_iter": 119746, "hostname": "flow-main"}
{"episode_reward_mean": 765.5518590431276, "info": {"num_steps_sampled": 3721525, "grad_time_ms": 22295.053, "sample_time_ms": 14257.898, "update_time_ms": 11.302, "default": {"vf_loss": 26.495567321777344, "vf_explained_var": 0.6470980644226074, "entropy": 1.1574676036834717, "total_loss": 26.49583625793457, "cur_lr": 0.0005000000237487257, "kl": 0.00664375489577651, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00039378643850795925}, "load_time_ms": 8.022, "num_steps_trained": 3721525}, "episode_len_mean": 700.0, "timesteps_since_restore": 3721525, "custom_metrics": {"cost1_max": 443.834163442819, "system_level_velocity_min": 8.921125932143353, "system_level_velocity_max": 16.917792461257893, "outflow_rate_mean": 937.8797501485001, "cost2_min": -47.626100860267385, "cost1_min": 234.6686390098663, "cost2_max": -30.625349489762456, "outflow_rate_min": 826.369483120573, "outflow_rate_max": 1136.3113958608187, "cost1_mean": 298.5980491890299, "system_level_velocity_mean": 11.285075625391674, "cost2_mean": -36.672219276765034}, "node_ip": "10.138.0.2", "time_since_restore": 1208.695482969284, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b00>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-57-23", "timesteps_total": 3721525, "done": false, "time_total_s": 1208.695482969284, "pid": 23758, "timestamp": 1556276243, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1689, "episode_reward_max": 883.8326863033656, "time_this_iter_s": 37.05728077888489, "training_iteration": 32, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 656.6210034304811, "episodes_this_iter": 50, "timesteps_this_iter": 119649, "hostname": "flow-main"}
{"episode_reward_mean": 763.8948850502803, "info": {"num_steps_sampled": 3841445, "grad_time_ms": 22289.848, "sample_time_ms": 14245.243, "update_time_ms": 11.532, "default": {"vf_loss": 27.2100772857666, "vf_explained_var": 0.661856472492218, "entropy": 1.144380807876587, "total_loss": 27.21076202392578, "cur_lr": 0.0005000000237487257, "kl": 0.006777204107493162, "cur_kl_coeff": 0.10000002384185791, "policy_loss": 4.772956344822887e-06}, "load_time_ms": 8.024, "num_steps_trained": 3841445}, "episode_len_mean": 700.0, "timesteps_since_restore": 3841445, "custom_metrics": {"cost1_max": 432.0351545357964, "system_level_velocity_min": 8.921125932143353, "system_level_velocity_max": 16.435729673929114, "outflow_rate_mean": 938.2686767915667, "cost2_min": -41.65967605343029, "cost1_min": 234.6686390098663, "cost2_max": -30.625349489762456, "outflow_rate_min": 826.369483120573, "outflow_rate_max": 1133.0278052213653, "cost1_mean": 296.75254173928187, "system_level_velocity_mean": 11.213392862694516, "cost2_mean": -36.492610441832696}, "node_ip": "10.138.0.2", "time_since_restore": 1244.4385163784027, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219267f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-57-59", "timesteps_total": 3841445, "done": false, "time_total_s": 1244.4385163784027, "pid": 23758, "timestamp": 1556276279, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1741, "episode_reward_max": 881.2467410919505, "time_this_iter_s": 35.74303340911865, "training_iteration": 33, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 656.6210034304811, "episodes_this_iter": 52, "timesteps_this_iter": 119920, "hostname": "flow-main"}
{"episode_reward_mean": 770.4704949811373, "info": {"num_steps_sampled": 3961022, "grad_time_ms": 22196.323, "sample_time_ms": 14174.789, "update_time_ms": 11.374, "default": {"vf_loss": 28.400482177734375, "vf_explained_var": 0.6635442972183228, "entropy": 1.138354778289795, "total_loss": 28.40062713623047, "cur_lr": 0.0005000000237487257, "kl": 0.00705167930573225, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0005594916292466223}, "load_time_ms": 7.959, "num_steps_trained": 3961022}, "episode_len_mean": 700.0, "timesteps_since_restore": 3961022, "custom_metrics": {"cost1_max": 450.06046746519667, "system_level_velocity_min": 9.075312314304899, "system_level_velocity_max": 17.11631960987708, "outflow_rate_mean": 943.889245754934, "cost2_min": -41.988145750471375, "cost1_min": 241.21388786372313, "cost2_max": -27.805758555196327, "outflow_rate_min": 842.7723502807848, "outflow_rate_max": 1150.8095264169933, "cost1_mean": 297.6538120023532, "system_level_velocity_mean": 11.237267106308728, "cost2_mean": -35.99909387514616}, "node_ip": "10.138.0.2", "time_since_restore": 1280.1846249103546, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219278d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927ba8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-58-35", "timesteps_total": 3961022, "done": false, "time_total_s": 1280.1846249103546, "pid": 23758, "timestamp": 1556276315, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1790, "episode_reward_max": 898.823739327987, "time_this_iter_s": 35.746108531951904, "training_iteration": 34, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 694.8679493014637, "episodes_this_iter": 49, "timesteps_this_iter": 119577, "hostname": "flow-main"}
{"episode_reward_mean": 776.852994940381, "info": {"num_steps_sampled": 4082462, "grad_time_ms": 22378.097, "sample_time_ms": 14153.01, "update_time_ms": 11.45, "default": {"vf_loss": 27.642475128173828, "vf_explained_var": 0.6386504769325256, "entropy": 1.1259015798568726, "total_loss": 27.64322280883789, "cur_lr": 0.0005000000237487257, "kl": 0.0074307979084551334, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 6.569588549609762e-06}, "load_time_ms": 8.074, "num_steps_trained": 4082462}, "episode_len_mean": 700.0, "timesteps_since_restore": 4082462, "custom_metrics": {"cost1_max": 450.06046746519667, "system_level_velocity_min": 9.075312314304899, "system_level_velocity_max": 17.11631960987708, "outflow_rate_mean": 954.0768324571956, "cost2_min": -41.988145750471375, "cost1_min": 241.21388786372313, "cost2_max": -27.805758555196327, "outflow_rate_min": 842.7723502807848, "outflow_rate_max": 1150.8095264169933, "cost1_mean": 301.95044368494666, "system_level_velocity_mean": 11.39243207377887, "cost2_mean": -36.034059178199826}, "node_ip": "10.138.0.2", "time_since_restore": 1317.7425196170807, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219260f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-59-12", "timesteps_total": 4082462, "done": false, "time_total_s": 1317.7425196170807, "pid": 23758, "timestamp": 1556276352, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1840, "episode_reward_max": 898.823739327987, "time_this_iter_s": 37.557894706726074, "training_iteration": 35, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 689.9826712742749, "episodes_this_iter": 50, "timesteps_this_iter": 121440, "hostname": "flow-main"}
{"episode_reward_mean": 762.7583457666774, "info": {"num_steps_sampled": 4203697, "grad_time_ms": 22466.821, "sample_time_ms": 14180.924, "update_time_ms": 11.496, "default": {"vf_loss": 26.317018508911133, "vf_explained_var": 0.6704717874526978, "entropy": 1.102698564529419, "total_loss": 26.317798614501953, "cur_lr": 0.0005000000237487257, "kl": 0.006978842429816723, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 7.949736755108461e-05}, "load_time_ms": 8.369, "num_steps_trained": 4203697}, "episode_len_mean": 700.0, "timesteps_since_restore": 4203697, "custom_metrics": {"cost1_max": 427.4724351746802, "system_level_velocity_min": 9.400220664753869, "system_level_velocity_max": 16.057708368290182, "outflow_rate_mean": 941.4493476074838, "cost2_min": -41.49384091192614, "cost1_min": 249.05967149650286, "cost2_max": -30.036535472945623, "outflow_rate_min": 854.0316410469112, "outflow_rate_max": 1133.6712231069323, "cost1_mean": 293.2104902171941, "system_level_velocity_mean": 11.074024331115757, "cost2_mean": -36.460931073364684}, "node_ip": "10.138.0.2", "time_since_restore": 1355.5090548992157, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219278d0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_10-59-50", "timesteps_total": 4203697, "done": false, "time_total_s": 1355.5090548992157, "pid": 23758, "timestamp": 1556276390, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1889, "episode_reward_max": 888.4991381700318, "time_this_iter_s": 37.76653528213501, "training_iteration": 36, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 686.7600397296358, "episodes_this_iter": 49, "timesteps_this_iter": 121235, "hostname": "flow-main"}
{"episode_reward_mean": 759.52069594461, "info": {"num_steps_sampled": 4324489, "grad_time_ms": 22747.767, "sample_time_ms": 14169.72, "update_time_ms": 11.461, "default": {"vf_loss": 28.343406677246094, "vf_explained_var": 0.6583869457244873, "entropy": 1.089658498764038, "total_loss": 28.343963623046875, "cur_lr": 0.0005000000237487257, "kl": 0.008107487112283707, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0002543820010032505}, "load_time_ms": 9.129, "num_steps_trained": 4324489}, "episode_len_mean": 700.0, "timesteps_since_restore": 4324489, "custom_metrics": {"cost1_max": 397.24168723578543, "system_level_velocity_min": 9.226149428884487, "system_level_velocity_max": 15.12880084566149, "outflow_rate_mean": 943.3829535377175, "cost2_min": -44.02059657511312, "cost1_min": 244.5340741765017, "cost2_max": -30.036535472945623, "outflow_rate_min": 842.4373119024616, "outflow_rate_max": 1102.264229581318, "cost1_mean": 293.2478214856665, "system_level_velocity_mean": 11.079118318118567, "cost2_mean": -37.12115535107578}, "node_ip": "10.138.0.2", "time_since_restore": 1395.0509226322174, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926358>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-00-29", "timesteps_total": 4324489, "done": false, "time_total_s": 1395.0509226322174, "pid": 23758, "timestamp": 1556276429, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1939, "episode_reward_max": 840.2405339212368, "time_this_iter_s": 39.54186773300171, "training_iteration": 37, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 659.1223713428591, "episodes_this_iter": 50, "timesteps_this_iter": 120792, "hostname": "flow-main"}
{"episode_reward_mean": 766.7184142453159, "info": {"num_steps_sampled": 4446032, "grad_time_ms": 22797.612, "sample_time_ms": 14200.25, "update_time_ms": 11.427, "default": {"vf_loss": 27.096004486083984, "vf_explained_var": 0.6666105389595032, "entropy": 1.0841461420059204, "total_loss": 27.097183227539062, "cur_lr": 0.0005000000237487257, "kl": 0.007513992954045534, "cur_kl_coeff": 0.10000002384185791, "policy_loss": 0.0004311719676479697}, "load_time_ms": 9.303, "num_steps_trained": 4446032}, "episode_len_mean": 700.0, "timesteps_since_restore": 4446032, "custom_metrics": {"cost1_max": 401.1869056673686, "system_level_velocity_min": 8.724333174647308, "system_level_velocity_max": 15.350498072817798, "outflow_rate_mean": 947.9536186906867, "cost2_min": -44.02059657511312, "cost1_min": 230.17115776841348, "cost2_max": -31.46397413661976, "outflow_rate_min": 830.4480318727484, "outflow_rate_max": 1114.4908826413027, "cost1_mean": 295.6404718467956, "system_level_velocity_mean": 11.164735583924472, "cost2_mean": -36.92512620988357}, "node_ip": "10.138.0.2", "time_since_restore": 1432.4297564029694, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219279e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927f98>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-01-07", "timesteps_total": 4446032, "done": false, "time_total_s": 1432.4297564029694, "pid": 23758, "timestamp": 1556276467, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 1989, "episode_reward_max": 840.2405339212368, "time_this_iter_s": 37.37883377075195, "training_iteration": 38, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 659.1223713428591, "episodes_this_iter": 50, "timesteps_this_iter": 121543, "hostname": "flow-main"}
{"episode_reward_mean": 763.2300939132398, "info": {"num_steps_sampled": 4567111, "grad_time_ms": 22659.654, "sample_time_ms": 14153.454, "update_time_ms": 11.372, "default": {"vf_loss": 27.946428298950195, "vf_explained_var": 0.6645085215568542, "entropy": 1.0788600444793701, "total_loss": 27.94689178466797, "cur_lr": 0.0005000000237487257, "kl": 0.008519282564520836, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00038896489422768354}, "load_time_ms": 9.103, "num_steps_trained": 4567111}, "episode_len_mean": 700.0, "timesteps_since_restore": 4567111, "custom_metrics": {"cost1_max": 401.1869056673686, "system_level_velocity_min": 8.724333174647308, "system_level_velocity_max": 15.350498072817798, "outflow_rate_mean": 939.1135481060273, "cost2_min": -41.171398347105814, "cost1_min": 230.17115776841348, "cost2_max": -31.238177362686883, "outflow_rate_min": 830.4480318727484, "outflow_rate_max": 1114.4908826413027, "cost1_mean": 290.03361607346915, "system_level_velocity_mean": 10.942112738939993, "cost2_mean": -36.193358489732816}, "node_ip": "10.138.0.2", "time_since_restore": 1469.623375415802, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219269e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926198>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-01-44", "timesteps_total": 4567111, "done": false, "time_total_s": 1469.623375415802, "pid": 23758, "timestamp": 1556276504, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2038, "episode_reward_max": 836.3252596701243, "time_this_iter_s": 37.19361901283264, "training_iteration": 39, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 668.9497818722468, "episodes_this_iter": 49, "timesteps_this_iter": 121079, "hostname": "flow-main"}
{"episode_reward_mean": 761.0077156216436, "info": {"num_steps_sampled": 4687797, "grad_time_ms": 22621.452, "sample_time_ms": 14185.208, "update_time_ms": 11.345, "default": {"vf_loss": 28.14759635925293, "vf_explained_var": 0.6721716523170471, "entropy": 1.0692288875579834, "total_loss": 28.148967742919922, "cur_lr": 0.0005000000237487257, "kl": 0.00805289950221777, "cur_kl_coeff": 0.10000002384185791, "policy_loss": 0.0005662883631885052}, "load_time_ms": 9.142, "num_steps_trained": 4687797}, "episode_len_mean": 700.0, "timesteps_since_restore": 4687797, "custom_metrics": {"cost1_max": 418.02020521168447, "system_level_velocity_min": 9.397569641019865, "system_level_velocity_max": 15.848781824388151, "outflow_rate_mean": 945.4846968289321, "cost2_min": -42.733895972791444, "cost1_min": 248.7409842260597, "cost2_max": -31.238177362686883, "outflow_rate_min": 858.714761110256, "outflow_rate_max": 1132.3438233367606, "cost1_mean": 293.0774019454777, "system_level_velocity_mean": 11.064117042194013, "cost2_mean": -36.89966281546359}, "node_ip": "10.138.0.2", "time_since_restore": 1506.754401922226, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219277f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219279e8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-02-21", "timesteps_total": 4687797, "done": false, "time_total_s": 1506.754401922226, "pid": 23758, "timestamp": 1556276541, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2090, "episode_reward_max": 874.8312119322784, "time_this_iter_s": 37.13102650642395, "training_iteration": 40, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 683.8186926749215, "episodes_this_iter": 52, "timesteps_this_iter": 120686, "hostname": "flow-main"}
{"episode_reward_mean": 760.7512697288976, "info": {"num_steps_sampled": 4809799, "grad_time_ms": 22838.149, "sample_time_ms": 14201.055, "update_time_ms": 11.023, "default": {"vf_loss": 27.248533248901367, "vf_explained_var": 0.6630220413208008, "entropy": 1.0588407516479492, "total_loss": 27.24903678894043, "cur_lr": 0.0005000000237487257, "kl": 0.0075921532697975636, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.000255970488069579}, "load_time_ms": 9.243, "num_steps_trained": 4809799}, "episode_len_mean": 700.0, "timesteps_since_restore": 4809799, "custom_metrics": {"cost1_max": 418.02020521168447, "system_level_velocity_min": 9.397569641019865, "system_level_velocity_max": 15.848781824388151, "outflow_rate_mean": 948.0908213924864, "cost2_min": -42.733895972791444, "cost1_min": 248.7409842260597, "cost2_max": -31.603829111106375, "outflow_rate_min": 855.1778834052642, "outflow_rate_max": 1132.3438233367606, "cost1_mean": 293.54550355807294, "system_level_velocity_mean": 11.090559588949029, "cost2_mean": -37.46433462705531}, "node_ip": "10.138.0.2", "time_since_restore": 1544.430320739746, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219266a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926d68>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-02-59", "timesteps_total": 4809799, "done": false, "time_total_s": 1544.430320739746, "pid": 23758, "timestamp": 1556276579, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2137, "episode_reward_max": 874.8312119322784, "time_this_iter_s": 37.67591881752014, "training_iteration": 41, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 683.8186926749215, "episodes_this_iter": 47, "timesteps_this_iter": 122002, "hostname": "flow-main"}
{"episode_reward_mean": 758.8204994882329, "info": {"num_steps_sampled": 4929930, "grad_time_ms": 22886.81, "sample_time_ms": 14240.662, "update_time_ms": 11.307, "default": {"vf_loss": 28.977798461914062, "vf_explained_var": 0.676302433013916, "entropy": 1.0636389255523682, "total_loss": 28.978466033935547, "cur_lr": 0.0005000000237487257, "kl": 0.0078070810995996, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00011112231004517525}, "load_time_ms": 9.272, "num_steps_trained": 4929930}, "episode_len_mean": 700.0, "timesteps_since_restore": 4929930, "custom_metrics": {"cost1_max": 396.06431167578336, "system_level_velocity_min": 8.737656585522078, "system_level_velocity_max": 15.042822059281804, "outflow_rate_mean": 944.5772063711303, "cost2_min": -41.955421200662485, "cost1_min": 236.1449287163748, "cost2_max": -32.41732078977665, "outflow_rate_min": 838.5807034453603, "outflow_rate_max": 1118.0360562507808, "cost1_mean": 290.8300725742787, "system_level_velocity_mean": 10.985635607365486, "cost2_mean": -37.66090781982165}, "node_ip": "10.138.0.2", "time_since_restore": 1582.3670771121979, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219277f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-03-37", "timesteps_total": 4929930, "done": false, "time_total_s": 1582.3670771121979, "pid": 23758, "timestamp": 1556276617, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2185, "episode_reward_max": 822.465178447879, "time_this_iter_s": 37.93675637245178, "training_iteration": 42, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 685.1469293775726, "episodes_this_iter": 48, "timesteps_this_iter": 120131, "hostname": "flow-main"}
{"episode_reward_mean": 759.470752737158, "info": {"num_steps_sampled": 5050886, "grad_time_ms": 22941.366, "sample_time_ms": 14241.487, "update_time_ms": 11.062, "default": {"vf_loss": 28.98047637939453, "vf_explained_var": 0.6734914183616638, "entropy": 1.0546841621398926, "total_loss": 28.981346130371094, "cur_lr": 0.0005000000237487257, "kl": 0.007136176805943251, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 0.00015557772712782025}, "load_time_ms": 9.243, "num_steps_trained": 5050886}, "episode_len_mean": 700.0, "timesteps_since_restore": 5050886, "custom_metrics": {"cost1_max": 456.66883404246914, "system_level_velocity_min": 8.737656585522078, "system_level_velocity_max": 17.55722206262544, "outflow_rate_mean": 953.1908130299813, "cost2_min": -48.563502826915354, "cost1_min": 236.1449287163748, "cost2_max": -30.831290264644977, "outflow_rate_min": 838.5807034453603, "outflow_rate_max": 1184.8509478091396, "cost1_mean": 295.5508310621289, "system_level_velocity_mean": 11.176907163924485, "cost2_mean": -38.413844856120846}, "node_ip": "10.138.0.2", "time_since_restore": 1618.6978120803833, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926f98>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-04-13", "timesteps_total": 5050886, "done": false, "time_total_s": 1618.6978120803833, "pid": 23758, "timestamp": 1556276653, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2237, "episode_reward_max": 913.7233489325469, "time_this_iter_s": 36.330734968185425, "training_iteration": 43, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 672.5416143415575, "episodes_this_iter": 52, "timesteps_this_iter": 120956, "hostname": "flow-main"}
{"episode_reward_mean": 760.269137239359, "info": {"num_steps_sampled": 5172780, "grad_time_ms": 23018.649, "sample_time_ms": 14264.027, "update_time_ms": 11.189, "default": {"vf_loss": 27.771045684814453, "vf_explained_var": 0.6730074286460876, "entropy": 1.0669162273406982, "total_loss": 27.771652221679688, "cur_lr": 0.0005000000237487257, "kl": 0.007076898589730263, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00010131988528883085}, "load_time_ms": 9.109, "num_steps_trained": 5172780}, "episode_len_mean": 700.0, "timesteps_since_restore": 5172780, "custom_metrics": {"cost1_max": 456.66883404246914, "system_level_velocity_min": 8.504114344234837, "system_level_velocity_max": 17.561540139203746, "outflow_rate_mean": 956.0415641412966, "cost2_min": -48.563502826915354, "cost1_min": 223.77908628639545, "cost2_max": -30.831290264644977, "outflow_rate_min": 831.0071425099103, "outflow_rate_max": 1185.038890915187, "cost1_mean": 296.9162219365396, "system_level_velocity_mean": 11.238707231435194, "cost2_mean": -38.52585563158193}, "node_ip": "10.138.0.2", "time_since_restore": 1655.4775903224945, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927550>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-04-50", "timesteps_total": 5172780, "done": false, "time_total_s": 1655.4775903224945, "pid": 23758, "timestamp": 1556276690, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2288, "episode_reward_max": 916.3871133619879, "time_this_iter_s": 36.779778242111206, "training_iteration": 44, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 668.582326065699, "episodes_this_iter": 51, "timesteps_this_iter": 121894, "hostname": "flow-main"}
{"episode_reward_mean": 755.7081342115267, "info": {"num_steps_sampled": 5294195, "grad_time_ms": 23009.185, "sample_time_ms": 14275.653, "update_time_ms": 11.438, "default": {"vf_loss": 27.456676483154297, "vf_explained_var": 0.681850016117096, "entropy": 1.0593605041503906, "total_loss": 27.45745086669922, "cur_lr": 0.0005000000237487257, "kl": 0.007146993186324835, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 6.120667967479676e-05}, "load_time_ms": 9.487, "num_steps_trained": 5294195}, "episode_len_mean": 700.0, "timesteps_since_restore": 5294195, "custom_metrics": {"cost1_max": 456.16445187553245, "system_level_velocity_min": 8.504114344234837, "system_level_velocity_max": 17.561540139203746, "outflow_rate_mean": 937.6027561123253, "cost2_min": -48.13956609442007, "cost1_min": 223.77908628639545, "cost2_max": -29.46341305280778, "outflow_rate_min": 831.0071425099103, "outflow_rate_max": 1185.038890915187, "cost1_mean": 286.5847944505082, "system_level_velocity_mean": 10.84168336017958, "cost2_mean": -37.71229464096042}, "node_ip": "10.138.0.2", "time_since_restore": 1693.0660333633423, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219260b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c18>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-05-28", "timesteps_total": 5294195, "done": false, "time_total_s": 1693.0660333633423, "pid": 23758, "timestamp": 1556276728, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2337, "episode_reward_max": 916.3871133619879, "time_this_iter_s": 37.58844304084778, "training_iteration": 45, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 661.6600578947941, "episodes_this_iter": 49, "timesteps_this_iter": 121415, "hostname": "flow-main"}
{"episode_reward_mean": 758.166353692232, "info": {"num_steps_sampled": 5415505, "grad_time_ms": 22935.372, "sample_time_ms": 14327.911, "update_time_ms": 11.345, "default": {"vf_loss": 28.232709884643555, "vf_explained_var": 0.6864027380943298, "entropy": 1.035326600074768, "total_loss": 28.233789443969727, "cur_lr": 0.0005000000237487257, "kl": 0.007246771361678839, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 0.0003565169754438102}, "load_time_ms": 9.067, "num_steps_trained": 5415505}, "episode_len_mean": 700.0, "timesteps_since_restore": 5415505, "custom_metrics": {"cost1_max": 423.5706525770047, "system_level_velocity_min": 8.785464730255084, "system_level_velocity_max": 16.10017211062527, "outflow_rate_mean": 934.1808277516586, "cost2_min": -45.07431143852306, "cost1_min": 231.5023755225027, "cost2_max": -29.46341305280778, "outflow_rate_min": 837.0526834267517, "outflow_rate_max": 1156.925533243795, "cost1_mean": 284.9092691001555, "system_level_velocity_mean": 10.77119627686325, "cost2_mean": -36.970862710686895}, "node_ip": "10.138.0.2", "time_since_restore": 1730.5656535625458, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927ef0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-06-05", "timesteps_total": 5415505, "done": false, "time_total_s": 1730.5656535625458, "pid": 23758, "timestamp": 1556276765, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2385, "episode_reward_max": 851.4121758446116, "time_this_iter_s": 37.49962019920349, "training_iteration": 46, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 661.6600578947941, "episodes_this_iter": 48, "timesteps_this_iter": 121310, "hostname": "flow-main"}
{"episode_reward_mean": 762.7163629634841, "info": {"num_steps_sampled": 5537891, "grad_time_ms": 22590.909, "sample_time_ms": 14302.001, "update_time_ms": 11.507, "default": {"vf_loss": 30.351469039916992, "vf_explained_var": 0.6855338215827942, "entropy": 1.0462284088134766, "total_loss": 30.352069854736328, "cur_lr": 0.0005000000237487257, "kl": 0.00780869834125042, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0001821926998673007}, "load_time_ms": 8.642, "num_steps_trained": 5537891}, "episode_len_mean": 700.0, "timesteps_since_restore": 5537891, "custom_metrics": {"cost1_max": 454.85663284326836, "system_level_velocity_min": 9.108854121298751, "system_level_velocity_max": 17.53191468532956, "outflow_rate_mean": 949.7213436506446, "cost2_min": -45.34543281799931, "cost1_min": 240.28744943151406, "cost2_max": -32.16110889131356, "outflow_rate_min": 855.5847316510253, "outflow_rate_max": 1183.9129356255467, "cost1_mean": 294.33061658466454, "system_level_velocity_mean": 11.13620121205761, "cost2_mean": -37.062546078873666}, "node_ip": "10.138.0.2", "time_since_restore": 1766.3574419021606, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219267f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-06-41", "timesteps_total": 5537891, "done": false, "time_total_s": 1766.3574419021606, "pid": 23758, "timestamp": 1556276801, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2436, "episode_reward_max": 915.2386260225765, "time_this_iter_s": 35.79178833961487, "training_iteration": 47, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 678.0781052816674, "episodes_this_iter": 51, "timesteps_this_iter": 122386, "hostname": "flow-main"}
{"episode_reward_mean": 751.6476775160231, "info": {"num_steps_sampled": 5659384, "grad_time_ms": 22617.972, "sample_time_ms": 14266.114, "update_time_ms": 11.68, "default": {"vf_loss": 29.258846282958984, "vf_explained_var": 0.6803610324859619, "entropy": 1.0349200963974, "total_loss": 29.259017944335938, "cur_lr": 0.0005000000237487257, "kl": 0.007204417139291763, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0005451663164421916}, "load_time_ms": 8.425, "num_steps_trained": 5659384}, "episode_len_mean": 700.0, "timesteps_since_restore": 5659384, "custom_metrics": {"cost1_max": 454.85663284326836, "system_level_velocity_min": 8.798786906961922, "system_level_velocity_max": 17.53191468532956, "outflow_rate_mean": 949.3909219716483, "cost2_min": -45.34543281799931, "cost1_min": 231.4107311157137, "cost2_max": -31.928374133017503, "outflow_rate_min": 832.1880462894576, "outflow_rate_max": 1183.9129356255467, "cost1_mean": 293.4950446624633, "system_level_velocity_mean": 11.113372934986907, "cost2_mean": -38.16533151022705}, "node_ip": "10.138.0.2", "time_since_restore": 1803.6428151130676, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219277f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927748>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-07-18", "timesteps_total": 5659384, "done": false, "time_total_s": 1803.6428151130676, "pid": 23758, "timestamp": 1556276838, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2484, "episode_reward_max": 915.2386260225765, "time_this_iter_s": 37.28537321090698, "training_iteration": 48, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 634.0521991031875, "episodes_this_iter": 48, "timesteps_this_iter": 121493, "hostname": "flow-main"}
{"episode_reward_mean": 749.5375419535407, "info": {"num_steps_sampled": 5780153, "grad_time_ms": 22452.864, "sample_time_ms": 14290.887, "update_time_ms": 11.522, "default": {"vf_loss": 29.67236328125, "vf_explained_var": 0.6759688258171082, "entropy": 1.0322109460830688, "total_loss": 29.67286491394043, "cur_lr": 0.0005000000237487257, "kl": 0.007615608163177967, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0002567535557318479}, "load_time_ms": 8.515, "num_steps_trained": 5780153}, "episode_len_mean": 700.0, "timesteps_since_restore": 5780153, "custom_metrics": {"cost1_max": 430.0721618248298, "system_level_velocity_min": 8.798786906961922, "system_level_velocity_max": 16.297970752771356, "outflow_rate_mean": 946.005048716644, "cost2_min": -48.34123300778951, "cost1_min": 231.4107311157137, "cost2_max": -31.928374133017503, "outflow_rate_min": 832.1880462894576, "outflow_rate_max": 1159.9350086116733, "cost1_mean": 289.93889760289653, "system_level_velocity_mean": 10.976736111958605, "cost2_mean": -38.193384380003245}, "node_ip": "10.138.0.2", "time_since_restore": 1839.3960535526276, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927ac8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-07-54", "timesteps_total": 5780153, "done": false, "time_total_s": 1839.3960535526276, "pid": 23758, "timestamp": 1556276874, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2534, "episode_reward_max": 867.7828542313698, "time_this_iter_s": 35.75323843955994, "training_iteration": 49, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 634.0521991031875, "episodes_this_iter": 50, "timesteps_this_iter": 120769, "hostname": "flow-main"}
{"episode_reward_mean": 764.4073812578532, "info": {"num_steps_sampled": 5901430, "grad_time_ms": 22301.172, "sample_time_ms": 14218.687, "update_time_ms": 11.549, "default": {"vf_loss": 29.135303497314453, "vf_explained_var": 0.678743302822113, "entropy": 1.0359171628952026, "total_loss": 29.1358642578125, "cur_lr": 0.0005000000237487257, "kl": 0.007770255208015442, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00021515425760298967}, "load_time_ms": 8.379, "num_steps_trained": 5901430}, "episode_len_mean": 700.0, "timesteps_since_restore": 5901430, "custom_metrics": {"cost1_max": 428.3988821787401, "system_level_velocity_min": 9.054831263165722, "system_level_velocity_max": 16.31183009474826, "outflow_rate_mean": 942.8466481207411, "cost2_min": -48.34123300778951, "cost1_min": 241.12392137888654, "cost2_max": -29.0503563925118, "outflow_rate_min": 849.4353799768936, "outflow_rate_max": 1155.544560630656, "cost1_mean": 288.69344862939414, "system_level_velocity_mean": 10.91398354544571, "cost2_mean": -36.181024642210176}, "node_ip": "10.138.0.2", "time_since_restore": 1874.2851603031158, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927550>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:5.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "straggler_mitigation": false, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "input_evaluation": null, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_11-08-29", "timesteps_total": 5901430, "done": true, "time_total_s": 1874.2851603031158, "pid": 23758, "timestamp": 1556276909, "experiment_id": "2cd55a913886473889d51ecb7777b1bc", "episodes_total": 2585, "episode_reward_max": 883.6969906867294, "time_this_iter_s": 34.88910675048828, "training_iteration": 50, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 657.5338108044563, "episodes_this_iter": 51, "timesteps_this_iter": 121277, "hostname": "flow-main"}

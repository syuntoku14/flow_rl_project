{"episode_reward_mean": 145.85365232524597, "timesteps_total": 118840, "date": "2019-04-26_08-39-22", "timesteps_since_restore": 118840, "custom_metrics": {"cost1_max": 239.028542630941, "system_level_velocity_max": 9.429440367648267, "system_level_velocity_min": 6.420312504033069, "outflow_rate_min": 567.0141567445351, "cost2_min": -661.8378258825682, "cost1_min": 164.09307741431866, "cost2_max": -221.84202602071605, "outflow_rate_mean": 624.9136920556489, "outflow_rate_max": 755.8197200105307, "cost1_mean": 203.52003189134703, "system_level_velocity_mean": 7.849095322762939, "cost2_mean": -448.3597121663083}, "time_total_s": 70.140385389328, "time_since_restore": 70.140385389328, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b438>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556267962, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 24, "episode_reward_max": 196.96147875359372, "episodes_this_iter": 24, "time_this_iter_s": 70.140385389328, "training_iteration": 1, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 113.65574910853553, "info": {"sample_time_ms": 44771.546, "grad_time_ms": 22789.811, "num_steps_sampled": 118840, "update_time_ms": 2326.735, "default": {"vf_loss": 0.8492376208305359, "vf_explained_var": 0.7146770358085632, "entropy": 1.4221909046173096, "total_loss": 0.8464825749397278, "cur_lr": 0.0005000000237487257, "kl": 0.007559801451861858, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.004267023876309395}, "load_time_ms": 44.221, "num_steps_trained": 118840}, "timesteps_this_iter": 118840, "hostname": "flow-main"}
{"episode_reward_mean": 159.09421184746822, "timesteps_total": 231669, "date": "2019-04-26_08-39-57", "timesteps_since_restore": 231669, "custom_metrics": {"cost1_max": 239.028542630941, "system_level_velocity_max": 9.429440367648267, "system_level_velocity_min": 5.695757039836052, "outflow_rate_min": 386.26957362897195, "cost2_min": -829.1591024721909, "cost1_min": 146.38636654052345, "cost2_max": -221.84202602071605, "outflow_rate_mean": 618.1782218301693, "outflow_rate_max": 755.8197200105307, "cost1_mean": 202.52674973141586, "system_level_velocity_mean": 7.8172299694102, "cost2_mean": -412.9189996647713}, "time_total_s": 104.86755633354187, "time_since_restore": 104.86755633354187, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970fd0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556267997, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 87, "episode_reward_max": 244.01819412798125, "episodes_this_iter": 63, "time_this_iter_s": 34.72717094421387, "training_iteration": 2, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 91.32751580805919, "info": {"sample_time_ms": 29412.912, "grad_time_ms": 21633.671, "num_steps_sampled": 231669, "update_time_ms": 1168.603, "default": {"vf_loss": 1.2063407897949219, "vf_explained_var": 0.7542613744735718, "entropy": 1.4220528602600098, "total_loss": 1.1990948915481567, "cur_lr": 0.0005000000237487257, "kl": 0.010945568792521954, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.00943510141223669}, "load_time_ms": 26.636, "num_steps_trained": 231669}, "timesteps_this_iter": 112829, "hostname": "flow-main"}
{"episode_reward_mean": 236.40096256029796, "timesteps_total": 338647, "date": "2019-04-26_08-40-31", "timesteps_since_restore": 338647, "custom_metrics": {"cost1_max": 279.11350602188395, "system_level_velocity_max": 10.746811250195307, "system_level_velocity_min": 6.278761450731447, "outflow_rate_min": 462.0193485206609, "cost2_min": -829.1591024721909, "cost1_min": 162.48915320086482, "cost2_max": -224.6024941728576, "outflow_rate_mean": 630.1826895200485, "outflow_rate_max": 756.4020633528055, "cost1_mean": 217.46634462669476, "system_level_velocity_mean": 8.394473693518142, "cost2_mean": -345.11331384392497}, "time_total_s": 139.0325903892517, "time_since_restore": 139.0325903892517, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219676d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219674e0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268031, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 147, "episode_reward_max": 393.8852941571699, "episodes_this_iter": 60, "time_this_iter_s": 34.16503405570984, "training_iteration": 3, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 91.32751580805919, "info": {"sample_time_ms": 24092.717, "grad_time_ms": 21264.589, "num_steps_sampled": 338647, "update_time_ms": 783.042, "default": {"vf_loss": 3.687419891357422, "vf_explained_var": 0.6753546595573425, "entropy": 1.3908885717391968, "total_loss": 3.6812171936035156, "cur_lr": 0.0005000000237487257, "kl": 0.01033021416515112, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.008269015699625015}, "load_time_ms": 20.843, "num_steps_trained": 338647}, "timesteps_this_iter": 106978, "hostname": "flow-main"}
{"episode_reward_mean": 353.0156178254986, "timesteps_total": 446441, "date": "2019-04-26_08-41-05", "timesteps_since_restore": 446441, "custom_metrics": {"cost1_max": 298.9712874572421, "system_level_velocity_max": 11.524324757318702, "system_level_velocity_min": 6.620801234428356, "outflow_rate_min": 497.9191035486129, "cost2_min": -404.1780797497057, "cost1_min": 169.1702290804207, "cost2_max": -224.6024941728576, "outflow_rate_mean": 676.6344805571161, "outflow_rate_max": 783.2963176796425, "cost1_mean": 249.21348545685098, "system_level_velocity_mean": 9.591549513501917, "cost2_mean": -283.26135017381193}, "time_total_s": 172.8138518333435, "time_since_restore": 172.8138518333435, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e10>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268065, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 208, "episode_reward_max": 445.07542170153357, "episodes_this_iter": 61, "time_this_iter_s": 33.7812614440918, "training_iteration": 4, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 161.62536069087585, "info": {"sample_time_ms": 21773.566, "grad_time_ms": 20644.775, "num_steps_sampled": 446441, "update_time_ms": 589.759, "default": {"vf_loss": 4.947901725769043, "vf_explained_var": 0.5220676064491272, "entropy": 1.36772882938385, "total_loss": 4.944945335388184, "cur_lr": 0.0005000000237487257, "kl": 0.007414367515593767, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0044388663955032825}, "load_time_ms": 17.139, "num_steps_trained": 446441}, "timesteps_this_iter": 107794, "hostname": "flow-main"}
{"episode_reward_mean": 424.9133351256974, "timesteps_total": 553134, "date": "2019-04-26_08-41-38", "timesteps_since_restore": 553134, "custom_metrics": {"cost1_max": 304.94311304256735, "system_level_velocity_max": 11.773280381781694, "system_level_velocity_min": 8.039095037447915, "outflow_rate_min": 618.3192524726435, "cost2_min": -354.1534703567572, "cost1_min": 214.10614727280293, "cost2_max": -220.94339324221173, "outflow_rate_mean": 718.1856326749771, "outflow_rate_max": 803.2494970761597, "cost1_mean": 268.7498351826729, "system_level_velocity_mean": 10.314496190571534, "cost2_mean": -259.64307095812615}, "time_total_s": 205.5012526512146, "time_since_restore": 205.5012526512146, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219674e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219678d0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268098, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 268, "episode_reward_max": 490.3838927908835, "episodes_this_iter": 60, "time_this_iter_s": 32.687400817871094, "training_iteration": 5, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 312.3179241604934, "info": {"sample_time_ms": 20066.314, "grad_time_ms": 20367.857, "num_steps_sampled": 553134, "update_time_ms": 474.511, "default": {"vf_loss": 6.319108009338379, "vf_explained_var": 0.43410563468933105, "entropy": 1.3653422594070435, "total_loss": 6.3177666664123535, "cur_lr": 0.0005000000237487257, "kl": 0.005655126180499792, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.002472707536071539}, "load_time_ms": 15.455, "num_steps_trained": 553134}, "timesteps_this_iter": 106693, "hostname": "flow-main"}
{"episode_reward_mean": 461.83473471882667, "timesteps_total": 660895, "date": "2019-04-26_08-42-12", "timesteps_since_restore": 660895, "custom_metrics": {"cost1_max": 306.3779367628705, "system_level_velocity_max": 11.881616223361684, "system_level_velocity_min": 8.76331483777926, "outflow_rate_min": 649.2914647448093, "cost2_min": -284.10129256361364, "cost1_min": 232.52163360469058, "cost2_max": -186.60317546851994, "outflow_rate_mean": 736.4076656957201, "outflow_rate_max": 794.44396038525, "cost1_mean": 275.34732347404, "system_level_velocity_mean": 10.555468539895683, "cost2_mean": -233.37439707740032}, "time_total_s": 240.0317506790161, "time_since_restore": 240.0317506790161, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219708d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219707f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268132, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 337, "episode_reward_max": 510.8087397880514, "episodes_this_iter": 69, "time_this_iter_s": 34.530498027801514, "training_iteration": 6, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 413.0391418755661, "info": {"sample_time_ms": 19111.629, "grad_time_ms": 20302.275, "num_steps_sampled": 660895, "update_time_ms": 397.167, "default": {"vf_loss": 8.481500625610352, "vf_explained_var": 0.3413596451282501, "entropy": 1.3643945455551147, "total_loss": 8.480903625488281, "cur_lr": 0.0005000000237487257, "kl": 0.004235371481627226, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0014446044806391}, "load_time_ms": 14.275, "num_steps_trained": 660895}, "timesteps_this_iter": 107761, "hostname": "flow-main"}
{"episode_reward_mean": 471.8905394442061, "timesteps_total": 768839, "date": "2019-04-26_08-42-45", "timesteps_since_restore": 768839, "custom_metrics": {"cost1_max": 304.60488790369936, "system_level_velocity_max": 17.1261457742611, "system_level_velocity_min": 8.76331483777926, "outflow_rate_min": 491.0341917764782, "cost2_min": -256.2153215114756, "cost1_min": 21.1127095784639, "cost2_max": -104.32498103103816, "outflow_rate_mean": 731.2351363285641, "outflow_rate_max": 783.1912527541723, "cost1_mean": 269.62665891549057, "system_level_velocity_mean": 10.459487698925713, "cost2_mean": -216.38899805900593}, "time_total_s": 273.3063967227936, "time_since_restore": 273.3063967227936, "pid": 24069, "episode_len_mean": 693.35, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219672e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219674e0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268165, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 398, "episode_reward_max": 513.630986289628, "episodes_this_iter": 61, "time_this_iter_s": 33.274646043777466, "training_iteration": 7, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 7.511899128154786, "info": {"sample_time_ms": 18254.417, "grad_time_ms": 20249.638, "num_steps_sampled": 768839, "update_time_ms": 341.935, "default": {"vf_loss": 8.949721336364746, "vf_explained_var": 0.33160245418548584, "entropy": 1.3565747737884521, "total_loss": 8.94896125793457, "cur_lr": 0.0005000000237487257, "kl": 0.005437612067908049, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0013028879184275866}, "load_time_ms": 13.83, "num_steps_trained": 768839}, "timesteps_this_iter": 107944, "hostname": "flow-main"}
{"episode_reward_mean": 499.70144505710397, "timesteps_total": 876590, "date": "2019-04-26_08-43-19", "timesteps_since_restore": 876590, "custom_metrics": {"cost1_max": 304.0580041602317, "system_level_velocity_max": 11.725749043844825, "system_level_velocity_min": 9.041176912800735, "outflow_rate_min": 690.0625321665215, "cost2_min": -239.17717836004493, "cost1_min": 239.3779605150317, "cost2_max": -169.62873006677745, "outflow_rate_mean": 736.6888500394807, "outflow_rate_max": 782.8003092820886, "cost1_mean": 273.6409705827976, "system_level_velocity_mean": 10.430475956122068, "cost2_mean": -201.55931053093397}, "time_total_s": 306.98966217041016, "time_since_restore": 306.98966217041016, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936438>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268199, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 462, "episode_reward_max": 552.1899202249451, "episodes_this_iter": 64, "time_this_iter_s": 33.68326544761658, "training_iteration": 8, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 455.5095785628156, "info": {"sample_time_ms": 17735.726, "grad_time_ms": 20139.438, "num_steps_sampled": 876590, "update_time_ms": 300.519, "default": {"vf_loss": 10.657084465026855, "vf_explained_var": 0.2835455536842346, "entropy": 1.3350189924240112, "total_loss": 10.656259536743164, "cur_lr": 0.0005000000237487257, "kl": 0.006642896216362715, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0014899130910634995}, "load_time_ms": 13.123, "num_steps_trained": 876590}, "timesteps_this_iter": 107751, "hostname": "flow-main"}
{"episode_reward_mean": 516.8621283034142, "timesteps_total": 983885, "date": "2019-04-26_08-43-53", "timesteps_since_restore": 983885, "custom_metrics": {"cost1_max": 304.0580041602317, "system_level_velocity_max": 11.725749043844825, "system_level_velocity_min": 8.582466876727644, "outflow_rate_min": 679.3641097197042, "cost2_min": -227.36378660077335, "cost1_min": 232.66569106791945, "cost2_max": -149.0611295330067, "outflow_rate_mean": 740.591110351555, "outflow_rate_max": 782.8003092820886, "cost1_mean": 276.189202437091, "system_level_velocity_mean": 10.51649553990033, "cost2_mean": -185.80156789086527}, "time_total_s": 340.4266016483307, "time_since_restore": 340.4266016483307, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970240>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268233, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 523, "episode_reward_max": 553.282305061026, "episodes_this_iter": 61, "time_this_iter_s": 33.43693947792053, "training_iteration": 9, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 475.8674314303354, "info": {"sample_time_ms": 17291.874, "grad_time_ms": 20068.573, "num_steps_sampled": 983885, "update_time_ms": 268.377, "default": {"vf_loss": 11.340044021606445, "vf_explained_var": 0.2553052008152008, "entropy": 1.3302185535430908, "total_loss": 11.339726448059082, "cur_lr": 0.0005000000237487257, "kl": 0.006323204841464758, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0009515464771538973}, "load_time_ms": 12.503, "num_steps_trained": 983885}, "timesteps_this_iter": 107295, "hostname": "flow-main"}
{"episode_reward_mean": 530.8289242797916, "timesteps_total": 1092180, "date": "2019-04-26_08-44-27", "timesteps_since_restore": 1092180, "custom_metrics": {"cost1_max": 308.74736518133915, "system_level_velocity_max": 11.821389155053762, "system_level_velocity_min": 8.835556846914209, "outflow_rate_min": 696.6877324107468, "cost2_min": -201.53361513635946, "cost1_min": 236.16847590737245, "cost2_max": -149.0611295330067, "outflow_rate_mean": 740.1349396038249, "outflow_rate_max": 779.146702180719, "cost1_mean": 275.1013956638003, "system_level_velocity_mean": 10.465956439567936, "cost2_mean": -169.6485480139053}, "time_total_s": 374.5529088973999, "time_since_restore": 374.5529088973999, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268267, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 587, "episode_reward_max": 559.6798315516011, "episodes_this_iter": 64, "time_this_iter_s": 34.126307249069214, "training_iteration": 10, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 499.7160672780807, "info": {"sample_time_ms": 16990.922, "grad_time_ms": 20025.008, "num_steps_sampled": 1092180, "update_time_ms": 242.536, "default": {"vf_loss": 12.518866539001465, "vf_explained_var": 0.2516728639602661, "entropy": 1.3259131908416748, "total_loss": 12.51909065246582, "cur_lr": 0.0005000000237487257, "kl": 0.00564812496304512, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00034134904853999615}, "load_time_ms": 12.041, "num_steps_trained": 1092180}, "timesteps_this_iter": 108295, "hostname": "flow-main"}
{"episode_reward_mean": 548.2635710144456, "timesteps_total": 1198522, "date": "2019-04-26_08-45-00", "timesteps_since_restore": 1198522, "custom_metrics": {"cost1_max": 308.0438617462816, "system_level_velocity_max": 11.954191049803486, "system_level_velocity_min": 7.911966051985428, "outflow_rate_min": 608.6943622617282, "cost2_min": -184.86188866570137, "cost1_min": 213.42641325732959, "cost2_max": -138.889324226255, "outflow_rate_mean": 742.9140186312975, "outflow_rate_max": 784.8751419535407, "cost1_mean": 277.1051902061206, "system_level_velocity_mean": 10.535605339890399, "cost2_mean": -160.01080553538227}, "time_total_s": 407.4777202606201, "time_since_restore": 407.4777202606201, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b9e8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268300, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 648, "episode_reward_max": 606.6392465306621, "episodes_this_iter": 61, "time_this_iter_s": 32.924811363220215, "training_iteration": 11, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 511.0576635290271, "info": {"sample_time_ms": 13909.167, "grad_time_ms": 19621.527, "num_steps_sampled": 1198522, "update_time_ms": 10.818, "default": {"vf_loss": 12.102641105651855, "vf_explained_var": 0.249215766787529, "entropy": 1.3111944198608398, "total_loss": 12.102127075195312, "cur_lr": 0.0005000000237487257, "kl": 0.007161206100136042, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.001231229747645557}, "load_time_ms": 8.387, "num_steps_trained": 1198522}, "timesteps_this_iter": 106342, "hostname": "flow-main"}
{"episode_reward_mean": 569.3682501771106, "timesteps_total": 1305800, "date": "2019-04-26_08-45-32", "timesteps_since_restore": 1305800, "custom_metrics": {"cost1_max": 308.0438617462816, "system_level_velocity_max": 11.860832562609064, "system_level_velocity_min": 7.911966051985428, "outflow_rate_min": 608.6943622617282, "cost2_min": -177.69648037062996, "cost1_min": 213.42641325732959, "cost2_max": -133.21243473703316, "outflow_rate_mean": 753.1084836640022, "outflow_rate_max": 791.3356667534816, "cost1_mean": 284.04584799738893, "system_level_velocity_mean": 10.787784015289422, "cost2_mean": -153.41596040385264}, "time_total_s": 440.19848561286926, "time_since_restore": 440.19848561286926, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66a0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268332, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 708, "episode_reward_max": 606.6392465306621, "episodes_this_iter": 60, "time_this_iter_s": 32.720765352249146, "training_iteration": 12, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 514.9224342601087, "info": {"sample_time_ms": 13765.788, "grad_time_ms": 19561.406, "num_steps_sampled": 1305800, "update_time_ms": 10.823, "default": {"vf_loss": 11.837981224060059, "vf_explained_var": 0.23121000826358795, "entropy": 1.3017715215682983, "total_loss": 11.837636947631836, "cur_lr": 0.0005000000237487257, "kl": 0.006062895525246859, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0009529510862194002}, "load_time_ms": 8.4, "num_steps_trained": 1305800}, "timesteps_this_iter": 107278, "hostname": "flow-main"}
{"episode_reward_mean": 588.0526789793344, "timesteps_total": 1412296, "date": "2019-04-26_08-46-08", "timesteps_since_restore": 1412296, "custom_metrics": {"cost1_max": 307.0711389361658, "system_level_velocity_max": 11.898580774762761, "system_level_velocity_min": 9.06273484638594, "outflow_rate_min": 699.2781441715974, "cost2_min": -177.69648037062996, "cost1_min": 242.88901257798415, "cost2_max": -116.50472509378353, "outflow_rate_mean": 757.2960334815275, "outflow_rate_max": 791.3356667534816, "cost1_mean": 288.6854512893567, "system_level_velocity_mean": 10.956136914915165, "cost2_mean": -144.18435636894503}, "time_total_s": 475.4546492099762, "time_since_restore": 475.4546492099762, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f67f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f65c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a90>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268368, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 771, "episode_reward_max": 626.2395715376168, "episodes_this_iter": 63, "time_this_iter_s": 35.256163597106934, "training_iteration": 13, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 527.4622427908927, "info": {"sample_time_ms": 13788.994, "grad_time_ms": 19643.67, "num_steps_sampled": 1412296, "update_time_ms": 10.701, "default": {"vf_loss": 12.726552963256836, "vf_explained_var": 0.2472064346075058, "entropy": 1.3004469871520996, "total_loss": 12.726337432861328, "cur_lr": 0.0005000000237487257, "kl": 0.0057798270136117935, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007934349705465138}, "load_time_ms": 8.241, "num_steps_trained": 1412296}, "timesteps_this_iter": 106496, "hostname": "flow-main"}
{"episode_reward_mean": 599.9429987657592, "timesteps_total": 1518403, "date": "2019-04-26_08-46-41", "timesteps_since_restore": 1518403, "custom_metrics": {"cost1_max": 318.20593052415325, "system_level_velocity_max": 12.252364522406465, "system_level_velocity_min": 9.02248642549868, "outflow_rate_min": 676.4289467802008, "cost2_min": -158.9398815706544, "cost1_min": 244.56461911599155, "cost2_max": -112.46664944391381, "outflow_rate_mean": 753.6103347258503, "outflow_rate_max": 803.1905631218834, "cost1_mean": 288.6532225280647, "system_level_velocity_mean": 10.921089399177982, "cost2_mean": -135.186855431503}, "time_total_s": 508.5463743209839, "time_since_restore": 508.5463743209839, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66d8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268401, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 833, "episode_reward_max": 631.7918108888863, "episodes_this_iter": 62, "time_this_iter_s": 33.09172511100769, "training_iteration": 14, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 527.4622427908927, "info": {"sample_time_ms": 13682.182, "grad_time_ms": 19678.161, "num_steps_sampled": 1518403, "update_time_ms": 10.814, "default": {"vf_loss": 13.139641761779785, "vf_explained_var": 0.23447488248348236, "entropy": 1.30275297164917, "total_loss": 13.139348030090332, "cur_lr": 0.0005000000237487257, "kl": 0.006001763977110386, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0008932705968618393}, "load_time_ms": 8.488, "num_steps_trained": 1518403}, "timesteps_this_iter": 106107, "hostname": "flow-main"}
{"episode_reward_mean": 604.6979205113432, "timesteps_total": 1624150, "date": "2019-04-26_08-47-14", "timesteps_since_restore": 1624150, "custom_metrics": {"cost1_max": 322.2523373961118, "system_level_velocity_max": 12.494164665422197, "system_level_velocity_min": 9.066292116536395, "outflow_rate_min": 695.469626066115, "cost2_min": -151.4882381016734, "cost1_min": 245.86978517696815, "cost2_max": -117.23057960780557, "outflow_rate_mean": 753.4826508927952, "outflow_rate_max": 802.2724785077157, "cost1_mean": 289.89946687595545, "system_level_velocity_mean": 10.951923695269407, "cost2_mean": -129.35698037160543}, "time_total_s": 541.4315941333771, "time_since_restore": 541.4315941333771, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6d30>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268434, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 897, "episode_reward_max": 625.1622321350552, "episodes_this_iter": 64, "time_this_iter_s": 32.88521981239319, "training_iteration": 15, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 550.7203803832912, "info": {"sample_time_ms": 13713.302, "grad_time_ms": 19664.283, "num_steps_sampled": 1624150, "update_time_ms": 10.528, "default": {"vf_loss": 14.374917030334473, "vf_explained_var": 0.2537297010421753, "entropy": 1.3135770559310913, "total_loss": 14.374330520629883, "cur_lr": 0.0005000000237487257, "kl": 0.005983066279441118, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011836460325866938}, "load_time_ms": 8.296, "num_steps_trained": 1624150}, "timesteps_this_iter": 105747, "hostname": "flow-main"}
{"episode_reward_mean": 604.3931353012729, "timesteps_total": 1730131, "date": "2019-04-26_08-47-47", "timesteps_since_restore": 1730131, "custom_metrics": {"cost1_max": 322.2523373961118, "system_level_velocity_max": 12.494164665422197, "system_level_velocity_min": 9.181544066285127, "outflow_rate_min": 697.5969793863413, "cost2_min": -145.32901791282978, "cost1_min": 248.70382557953403, "cost2_max": -114.45019644375895, "outflow_rate_mean": 749.9836490546837, "outflow_rate_max": 802.2724785077157, "cost1_mean": 287.4364596727018, "system_level_velocity_mean": 10.827856000640141, "cost2_mean": -125.6689596265717}, "time_total_s": 574.9844737052917, "time_since_restore": 574.9844737052917, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6eb8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268467, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 962, "episode_reward_max": 631.3126174696932, "episodes_this_iter": 65, "time_this_iter_s": 33.55287957191467, "training_iteration": 16, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 557.3189841243623, "info": {"sample_time_ms": 13648.145, "grad_time_ms": 19631.654, "num_steps_sampled": 1730131, "update_time_ms": 10.626, "default": {"vf_loss": 15.452333450317383, "vf_explained_var": 0.21950045228004456, "entropy": 1.3021820783615112, "total_loss": 15.452014923095703, "cur_lr": 0.0005000000237487257, "kl": 0.00544784078374505, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.000862718268763274}, "load_time_ms": 8.161, "num_steps_trained": 1730131}, "timesteps_this_iter": 105981, "hostname": "flow-main"}
{"episode_reward_mean": 606.0255618367617, "timesteps_total": 1836102, "date": "2019-04-26_08-48-22", "timesteps_since_restore": 1836102, "custom_metrics": {"cost1_max": 307.47817897801997, "system_level_velocity_max": 11.727062726298351, "system_level_velocity_min": 7.91328096751391, "outflow_rate_min": 613.9331334633343, "cost2_min": -142.91242662611745, "cost1_min": 216.0000317623813, "cost2_max": -106.06391256472617, "outflow_rate_mean": 746.4388098158754, "outflow_rate_max": 780.1968307600438, "cost1_mean": 283.6172471875143, "system_level_velocity_mean": 10.63584863859537, "cost2_mean": -122.85523513508456}, "time_total_s": 609.6805634498596, "time_since_restore": 609.6805634498596, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f67f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f65c0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268502, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1026, "episode_reward_max": 628.375554314024, "episodes_this_iter": 64, "time_this_iter_s": 34.69608974456787, "training_iteration": 17, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 541.1073230630957, "info": {"sample_time_ms": 13735.666, "grad_time_ms": 19688.212, "num_steps_sampled": 1836102, "update_time_ms": 10.62, "default": {"vf_loss": 16.75397300720215, "vf_explained_var": 0.18550948798656464, "entropy": 1.304280161857605, "total_loss": 16.75346565246582, "cur_lr": 0.0005000000237487257, "kl": 0.007241610437631607, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0012314475607126951}, "load_time_ms": 7.685, "num_steps_trained": 1836102}, "timesteps_this_iter": 105971, "hostname": "flow-main"}
{"episode_reward_mean": 607.0180337315759, "timesteps_total": 1943275, "date": "2019-04-26_08-48-56", "timesteps_since_restore": 1943275, "custom_metrics": {"cost1_max": 303.22149545938646, "system_level_velocity_max": 11.532962416452463, "system_level_velocity_min": 7.91328096751391, "outflow_rate_min": 613.9331334633343, "cost2_min": -134.77371823460123, "cost1_min": 216.0000317623813, "cost2_max": -102.73240738340016, "outflow_rate_mean": 745.3699653463677, "outflow_rate_max": 765.126778133787, "cost1_mean": 279.70190376953224, "system_level_velocity_mean": 10.443280680748677, "cost2_mean": -119.12465067500023}, "time_total_s": 643.9786977767944, "time_since_restore": 643.9786977767944, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6ef0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268536, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1091, "episode_reward_max": 632.0409068749399, "episodes_this_iter": 65, "time_this_iter_s": 34.298134326934814, "training_iteration": 18, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 541.1073230630957, "info": {"sample_time_ms": 13724.847, "grad_time_ms": 19759.641, "num_steps_sampled": 1943275, "update_time_ms": 10.515, "default": {"vf_loss": 15.2347412109375, "vf_explained_var": 0.2416275441646576, "entropy": 1.2930346727371216, "total_loss": 15.234930038452148, "cur_lr": 0.0005000000237487257, "kl": 0.005372798070311546, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00034908283851109445}, "load_time_ms": 7.592, "num_steps_trained": 1943275}, "timesteps_this_iter": 107173, "hostname": "flow-main"}
{"episode_reward_mean": 608.5546654382009, "timesteps_total": 2050446, "date": "2019-04-26_08-49-31", "timesteps_since_restore": 2050446, "custom_metrics": {"cost1_max": 296.7453764671999, "system_level_velocity_max": 11.107075005033172, "system_level_velocity_min": 9.666687587224205, "outflow_rate_min": 723.5663598380424, "cost2_min": -134.1379993606306, "cost1_min": 262.94470762459196, "cost2_max": -101.1659430567078, "outflow_rate_mean": 746.31435754824, "outflow_rate_max": 770.5418373221094, "cost1_mean": 276.3969735948618, "system_level_velocity_mean": 10.274672953558683, "cost2_mean": -115.61095935832083}, "time_total_s": 678.5596985816956, "time_since_restore": 678.5596985816956, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6860>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268571, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1159, "episode_reward_max": 632.0409068749399, "episodes_this_iter": 68, "time_this_iter_s": 34.58100080490112, "training_iteration": 19, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 587.6214952067289, "info": {"sample_time_ms": 13743.992, "grad_time_ms": 19852.398, "num_steps_sampled": 2050446, "update_time_ms": 10.502, "default": {"vf_loss": 16.371105194091797, "vf_explained_var": 0.24905887246131897, "entropy": 1.281118392944336, "total_loss": 16.3714656829834, "cur_lr": 0.0005000000237487257, "kl": 0.005498794838786125, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00019134329340886325}, "load_time_ms": 7.37, "num_steps_trained": 2050446}, "timesteps_this_iter": 107171, "hostname": "flow-main"}
{"episode_reward_mean": 611.2994086531602, "timesteps_total": 2157743, "date": "2019-04-26_08-50-03", "timesteps_since_restore": 2157743, "custom_metrics": {"cost1_max": 294.2605534227856, "system_level_velocity_max": 11.107075005033172, "system_level_velocity_min": 9.496354247146096, "outflow_rate_min": 724.5308997227692, "cost2_min": -126.6565687669862, "cost1_min": 256.5488536521218, "cost2_max": -101.1659430567078, "outflow_rate_mean": 747.6526271020147, "outflow_rate_max": 770.5418373221094, "cost1_mean": 275.5053958419862, "system_level_velocity_mean": 10.227936862867317, "cost2_mean": -114.10364462028858}, "time_total_s": 710.7133390903473, "time_since_restore": 710.7133390903473, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219679b0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268603, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1221, "episode_reward_max": 634.069864424599, "episodes_this_iter": 62, "time_this_iter_s": 32.15364050865173, "training_iteration": 20, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 585.3641394877922, "info": {"sample_time_ms": 13721.118, "grad_time_ms": 19679.967, "num_steps_sampled": 2157743, "update_time_ms": 10.719, "default": {"vf_loss": 15.936666488647461, "vf_explained_var": 0.23504234850406647, "entropy": 1.2684595584869385, "total_loss": 15.936863899230957, "cur_lr": 0.0005000000237487257, "kl": 0.005925677716732025, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00039641413604840636}, "load_time_ms": 7.449, "num_steps_trained": 2157743}, "timesteps_this_iter": 107297, "hostname": "flow-main"}
{"episode_reward_mean": 611.657226328713, "timesteps_total": 2265420, "date": "2019-04-26_08-50-36", "timesteps_since_restore": 2265420, "custom_metrics": {"cost1_max": 286.8573742149625, "system_level_velocity_max": 10.844488933079072, "system_level_velocity_min": 9.482692249585421, "outflow_rate_min": 733.6333288600697, "cost2_min": -124.70020456831006, "cost1_min": 258.01261780598594, "cost2_max": -105.0424000490517, "outflow_rate_mean": 749.2775072159394, "outflow_rate_max": 764.8660869628233, "cost1_mean": 273.38497670827223, "system_level_velocity_mean": 10.128171778901196, "cost2_mean": -112.91813361787564}, "time_total_s": 743.7583711147308, "time_since_restore": 743.7583711147308, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6860>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268636, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1286, "episode_reward_max": 631.2269109840819, "episodes_this_iter": 65, "time_this_iter_s": 33.045032024383545, "training_iteration": 21, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 590.7248541766409, "info": {"sample_time_ms": 13714.168, "grad_time_ms": 19701.293, "num_steps_sampled": 2265420, "update_time_ms": 10.995, "default": {"vf_loss": 16.734346389770508, "vf_explained_var": 0.2474563866853714, "entropy": 1.263523817062378, "total_loss": 16.734527587890625, "cur_lr": 0.0005000000237487257, "kl": 0.0066345445811748505, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00048140157014131546}, "load_time_ms": 7.555, "num_steps_trained": 2265420}, "timesteps_this_iter": 107677, "hostname": "flow-main"}
{"episode_reward_mean": 612.6969444449991, "timesteps_total": 2372918, "date": "2019-04-26_08-51-12", "timesteps_since_restore": 2372918, "custom_metrics": {"cost1_max": 293.86374272792574, "system_level_velocity_max": 11.049833888549971, "system_level_velocity_min": 9.579028730920216, "outflow_rate_min": 733.6333288600697, "cost2_min": -124.70020456831006, "cost1_min": 259.8673665276574, "cost2_max": -103.30254537422404, "outflow_rate_mean": 749.9051427166248, "outflow_rate_max": 764.284564428452, "cost1_mean": 272.85503655768264, "system_level_velocity_mean": 10.094098613375103, "cost2_mean": -112.49281568093524}, "time_total_s": 779.6504826545715, "time_since_restore": 779.6504826545715, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219679b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967400>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268672, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1347, "episode_reward_max": 631.7932496309874, "episodes_this_iter": 61, "time_this_iter_s": 35.8921115398407, "training_iteration": 22, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 587.8802381718504, "info": {"sample_time_ms": 13844.368, "grad_time_ms": 19888.35, "num_steps_sampled": 2372918, "update_time_ms": 10.972, "default": {"vf_loss": 15.398972511291504, "vf_explained_var": 0.25979071855545044, "entropy": 1.2506158351898193, "total_loss": 15.399529457092285, "cur_lr": 0.0005000000237487257, "kl": 0.005126479081809521, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 4.547628486761823e-05}, "load_time_ms": 7.441, "num_steps_trained": 2372918}, "timesteps_this_iter": 107498, "hostname": "flow-main"}
{"episode_reward_mean": 613.3150376575202, "timesteps_total": 2479840, "date": "2019-04-26_08-51-44", "timesteps_since_restore": 2479840, "custom_metrics": {"cost1_max": 286.20169532978923, "system_level_velocity_max": 10.59774732008354, "system_level_velocity_min": 9.638946039878137, "outflow_rate_min": 727.9884515205487, "cost2_min": -124.00652776526893, "cost1_min": 261.45787547474663, "cost2_max": -94.7412138624138, "outflow_rate_mean": 747.9658548411697, "outflow_rate_max": 766.9385618292521, "cost1_mean": 273.39521948349613, "system_level_velocity_mean": 10.098646479511725, "cost2_mean": -111.32944872766731}, "time_total_s": 811.0993447303772, "time_since_restore": 811.0993447303772, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967898>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268704, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1409, "episode_reward_max": 631.7932496309874, "episodes_this_iter": 62, "time_this_iter_s": 31.448862075805664, "training_iteration": 23, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 587.8802381718504, "info": {"sample_time_ms": 13848.694, "grad_time_ms": 19503.62, "num_steps_sampled": 2479840, "update_time_ms": 10.934, "default": {"vf_loss": 16.42584228515625, "vf_explained_var": 0.2689613699913025, "entropy": 1.2450566291809082, "total_loss": 16.42613410949707, "cur_lr": 0.0005000000237487257, "kl": 0.006403160281479359, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0003474488912615925}, "load_time_ms": 7.523, "num_steps_trained": 2479840}, "timesteps_this_iter": 106922, "hostname": "flow-main"}
{"episode_reward_mean": 609.6496772632483, "timesteps_total": 2587362, "date": "2019-04-26_08-52-18", "timesteps_since_restore": 2587362, "custom_metrics": {"cost1_max": 289.0135531095266, "system_level_velocity_max": 10.78953326415833, "system_level_velocity_min": 9.622545041855348, "outflow_rate_min": 728.1811843944613, "cost2_min": -121.87268104913065, "cost1_min": 260.2529015953547, "cost2_max": -97.28479777490719, "outflow_rate_mean": 745.4004971039296, "outflow_rate_max": 766.9385618292521, "cost1_mean": 272.4739309329677, "system_level_velocity_mean": 10.072142592630547, "cost2_mean": -110.24835971384222}, "time_total_s": 845.541476726532, "time_since_restore": 845.541476726532, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f63c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66d8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268738, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1475, "episode_reward_max": 631.9111015048131, "episodes_this_iter": 66, "time_this_iter_s": 34.442131996154785, "training_iteration": 24, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 585.2785234175186, "info": {"sample_time_ms": 13870.956, "grad_time_ms": 19615.253, "num_steps_sampled": 2587362, "update_time_ms": 10.974, "default": {"vf_loss": 17.100393295288086, "vf_explained_var": 0.31597965955734253, "entropy": 1.2530282735824585, "total_loss": 17.1007022857666, "cur_lr": 0.0005000000237487257, "kl": 0.005421114154160023, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00023221671290230006}, "load_time_ms": 7.469, "num_steps_trained": 2587362}, "timesteps_this_iter": 107522, "hostname": "flow-main"}
{"episode_reward_mean": 608.6468156122957, "timesteps_total": 2694060, "date": "2019-04-26_08-52-53", "timesteps_since_restore": 2694060, "custom_metrics": {"cost1_max": 289.0135531095266, "system_level_velocity_max": 10.78953326415833, "system_level_velocity_min": 9.091596752588654, "outflow_rate_min": 704.8601619231757, "cost2_min": -121.30613774533889, "cost1_min": 246.30935957677124, "cost2_max": -98.97793042794532, "outflow_rate_mean": 741.9410563756365, "outflow_rate_max": 760.120411126377, "cost1_mean": 271.32108871088934, "system_level_velocity_mean": 10.031743527083654, "cost2_mean": -108.60662207451998}, "time_total_s": 880.1291930675507, "time_since_restore": 880.1291930675507, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967898>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268773, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1536, "episode_reward_max": 631.6933171735767, "episodes_this_iter": 61, "time_this_iter_s": 34.58771634101868, "training_iteration": 25, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 569.8446593238061, "info": {"sample_time_ms": 13894.499, "grad_time_ms": 19764.55, "num_steps_sampled": 2694060, "update_time_ms": 11.169, "default": {"vf_loss": 17.180341720581055, "vf_explained_var": 0.3262880742549896, "entropy": 1.2635493278503418, "total_loss": 17.180192947387695, "cur_lr": 0.0005000000237487257, "kl": 0.005728545133024454, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007226095185615122}, "load_time_ms": 7.602, "num_steps_trained": 2694060}, "timesteps_this_iter": 106698, "hostname": "flow-main"}
{"episode_reward_mean": 615.0062483927263, "timesteps_total": 2801464, "date": "2019-04-26_08-53-27", "timesteps_since_restore": 2801464, "custom_metrics": {"cost1_max": 288.2231571316518, "system_level_velocity_max": 10.799518365650886, "system_level_velocity_min": 9.526236560021799, "outflow_rate_min": 716.6045905083472, "cost2_min": -118.84374014730847, "cost1_min": 257.4606222340408, "cost2_max": -97.81900385667679, "outflow_rate_mean": 743.4928194619824, "outflow_rate_max": 759.7942496650554, "cost1_mean": 273.9687613779682, "system_level_velocity_mean": 10.134388820458495, "cost2_mean": -107.56628955859846}, "time_total_s": 914.3712193965912, "time_since_restore": 914.3712193965912, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f63c8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268807, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1598, "episode_reward_max": 637.0405753676201, "episodes_this_iter": 62, "time_this_iter_s": 34.24202632904053, "training_iteration": 26, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 581.4406933429882, "info": {"sample_time_ms": 13915.31, "grad_time_ms": 19814.81, "num_steps_sampled": 2801464, "update_time_ms": 11.377, "default": {"vf_loss": 17.47459602355957, "vf_explained_var": 0.2886146008968353, "entropy": 1.2353370189666748, "total_loss": 17.47388458251953, "cur_lr": 0.0005000000237487257, "kl": 0.008568206802010536, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0015684834215790033}, "load_time_ms": 7.905, "num_steps_trained": 2801464}, "timesteps_this_iter": 107404, "hostname": "flow-main"}
{"episode_reward_mean": 623.4361603012236, "timesteps_total": 2908911, "date": "2019-04-26_08-53-59", "timesteps_since_restore": 2908911, "custom_metrics": {"cost1_max": 289.50808104939193, "system_level_velocity_max": 10.799518365650886, "system_level_velocity_min": 9.526236560021799, "outflow_rate_min": 720.4010335961922, "cost2_min": -123.955998266852, "cost1_min": 257.4606222340408, "cost2_max": -97.81900385667679, "outflow_rate_mean": 749.5640847872595, "outflow_rate_max": 764.9595893596857, "cost1_mean": 276.66269647857405, "system_level_velocity_mean": 10.232346220468987, "cost2_mean": -108.75789571702633}, "time_total_s": 946.4881031513214, "time_since_restore": 946.4881031513214, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ac8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268839, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1661, "episode_reward_max": 640.727247124774, "episodes_this_iter": 63, "time_this_iter_s": 32.116883754730225, "training_iteration": 27, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 581.4406933429882, "info": {"sample_time_ms": 13898.977, "grad_time_ms": 19571.561, "num_steps_sampled": 2908911, "update_time_ms": 11.854, "default": {"vf_loss": 19.204814910888672, "vf_explained_var": 0.17725606262683868, "entropy": 1.215160608291626, "total_loss": 19.20520782470703, "cur_lr": 0.0005000000237487257, "kl": 0.007374918553978205, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00034249774762429297}, "load_time_ms": 7.824, "num_steps_trained": 2908911}, "timesteps_this_iter": 107447, "hostname": "flow-main"}
{"episode_reward_mean": 629.3580982448082, "timesteps_total": 3016237, "date": "2019-04-26_08-54-31", "timesteps_since_restore": 3016237, "custom_metrics": {"cost1_max": 289.50808104939193, "system_level_velocity_max": 10.780458202365372, "system_level_velocity_min": 9.627734183731882, "outflow_rate_min": 734.2859554536445, "cost2_min": -115.04088883135898, "cost1_min": 260.90091781721003, "cost2_max": -94.86785869249276, "outflow_rate_mean": 752.4737504215445, "outflow_rate_max": 764.1467941368411, "cost1_mean": 276.0799058992501, "system_level_velocity_mean": 10.198195010408442, "cost2_mean": -107.81283844797694}, "time_total_s": 978.2861196994781, "time_since_restore": 978.2861196994781, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219709b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e48>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268871, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1725, "episode_reward_max": 647.3387709039176, "episodes_this_iter": 64, "time_this_iter_s": 31.79801654815674, "training_iteration": 28, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 602.2018914344699, "info": {"sample_time_ms": 13884.455, "grad_time_ms": 19336.349, "num_steps_sampled": 3016237, "update_time_ms": 12.005, "default": {"vf_loss": 19.80974769592285, "vf_explained_var": 0.16242572665214539, "entropy": 1.224369764328003, "total_loss": 19.810001373291016, "cur_lr": 0.0005000000237487257, "kl": 0.0069594248197972775, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00044205025187693536}, "load_time_ms": 7.922, "num_steps_trained": 3016237}, "timesteps_this_iter": 107326, "hostname": "flow-main"}
{"episode_reward_mean": 631.8980566327808, "timesteps_total": 3124061, "date": "2019-04-26_08-55-02", "timesteps_since_restore": 3124061, "custom_metrics": {"cost1_max": 289.90628621546716, "system_level_velocity_max": 10.75535433516044, "system_level_velocity_min": 9.2184207412376, "outflow_rate_min": 725.2866035548719, "cost2_min": -116.86336231193644, "cost1_min": 249.88797571492097, "cost2_max": -94.86785869249276, "outflow_rate_mean": 751.9032510682171, "outflow_rate_max": 762.0707701422789, "cost1_mean": 275.90585369596704, "system_level_velocity_mean": 10.175134705460595, "cost2_mean": -108.0439899187336}, "time_total_s": 1009.1989505290985, "time_since_restore": 1009.1989505290985, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904978>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268902, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1785, "episode_reward_max": 650.904521765021, "episodes_this_iter": 60, "time_this_iter_s": 30.91283082962036, "training_iteration": 29, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 596.6232122434958, "info": {"sample_time_ms": 13754.903, "grad_time_ms": 19099.381, "num_steps_sampled": 3124061, "update_time_ms": 11.829, "default": {"vf_loss": 19.616825103759766, "vf_explained_var": 0.12600073218345642, "entropy": 1.2105563879013062, "total_loss": 19.616886138916016, "cur_lr": 0.0005000000237487257, "kl": 0.008727707900106907, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0008139766287058592}, "load_time_ms": 8.246, "num_steps_trained": 3124061}, "timesteps_this_iter": 107824, "hostname": "flow-main"}
{"episode_reward_mean": 631.0115372538984, "timesteps_total": 3231472, "date": "2019-04-26_08-55-34", "timesteps_since_restore": 3231472, "custom_metrics": {"cost1_max": 289.90628621546716, "system_level_velocity_max": 10.75535433516044, "system_level_velocity_min": 9.2184207412376, "outflow_rate_min": 725.2866035548719, "cost2_min": -122.7930184107303, "cost1_min": 249.88797571492097, "cost2_max": -96.18040845795792, "outflow_rate_mean": 754.3595989925225, "outflow_rate_max": 768.2136262694639, "cost1_mean": 277.44635771681266, "system_level_velocity_mean": 10.230180330470773, "cost2_mean": -111.19967333729433}, "time_total_s": 1041.646027803421, "time_since_restore": 1041.646027803421, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219672e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967400>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268934, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1847, "episode_reward_max": 650.904521765021, "episodes_this_iter": 62, "time_this_iter_s": 32.44707727432251, "training_iteration": 30, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 596.6232122434958, "info": {"sample_time_ms": 13730.42, "grad_time_ms": 19153.239, "num_steps_sampled": 3231472, "update_time_ms": 11.737, "default": {"vf_loss": 19.314594268798828, "vf_explained_var": 0.12110504508018494, "entropy": 1.218295931816101, "total_loss": 19.314647674560547, "cur_lr": 0.0005000000237487257, "kl": 0.00687492685392499, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0006342365522868931}, "load_time_ms": 8.057, "num_steps_trained": 3231472}, "timesteps_this_iter": 107411, "hostname": "flow-main"}
{"episode_reward_mean": 631.1487760900402, "timesteps_total": 3338766, "date": "2019-04-26_08-56-10", "timesteps_since_restore": 3338766, "custom_metrics": {"cost1_max": 290.4138438989325, "system_level_velocity_max": 10.80506279111914, "system_level_velocity_min": 9.81300358544466, "outflow_rate_min": 744.1070583782054, "cost2_min": -123.2759308422934, "cost1_min": 266.09348879345475, "cost2_max": -97.93412544585425, "outflow_rate_mean": 757.602708764828, "outflow_rate_max": 771.0439125637788, "cost1_mean": 279.71829507595567, "system_level_velocity_mean": 10.327744969513965, "cost2_mean": -112.21762373203022}, "time_total_s": 1077.32754611969, "time_since_restore": 1077.32754611969, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219046d8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556268970, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1913, "episode_reward_max": 643.2850293816815, "episodes_this_iter": 66, "time_this_iter_s": 35.68151831626892, "training_iteration": 31, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 607.7318689708733, "info": {"sample_time_ms": 13740.661, "grad_time_ms": 19405.019, "num_steps_sampled": 3338766, "update_time_ms": 11.568, "default": {"vf_loss": 18.603879928588867, "vf_explained_var": 0.1855449676513672, "entropy": 1.2232176065444946, "total_loss": 18.603784561157227, "cur_lr": 0.0005000000237487257, "kl": 0.00682182377204299, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0007794704870320857}, "load_time_ms": 8.004, "num_steps_trained": 3338766}, "timesteps_this_iter": 107294, "hostname": "flow-main"}
{"episode_reward_mean": 629.448216775413, "timesteps_total": 3445945, "date": "2019-04-26_08-56-46", "timesteps_since_restore": 3445945, "custom_metrics": {"cost1_max": 290.73799073025845, "system_level_velocity_max": 10.681196555081915, "system_level_velocity_min": 9.742233718675555, "outflow_rate_min": 738.4671429541928, "cost2_min": -123.2759308422934, "cost1_min": 264.31231799301924, "cost2_max": -95.50312198639116, "outflow_rate_mean": 755.4007349807708, "outflow_rate_max": 771.0439125637788, "cost1_mean": 278.8759188817162, "system_level_velocity_mean": 10.301414003117753, "cost2_mean": -110.91731503668015}, "time_total_s": 1113.2418608665466, "time_since_restore": 1113.2418608665466, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ba8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269006, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 1976, "episode_reward_max": 643.3484261584484, "episodes_this_iter": 63, "time_this_iter_s": 35.91431474685669, "training_iteration": 32, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 596.5825391990138, "info": {"sample_time_ms": 13775.447, "grad_time_ms": 19370.66, "num_steps_sampled": 3445945, "update_time_ms": 11.769, "default": {"vf_loss": 16.739606857299805, "vf_explained_var": 0.24009673297405243, "entropy": 1.2141751050949097, "total_loss": 16.739238739013672, "cur_lr": 0.0005000000237487257, "kl": 0.007115579210221767, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0010797150898724794}, "load_time_ms": 8.261, "num_steps_trained": 3445945}, "timesteps_this_iter": 107179, "hostname": "flow-main"}
{"episode_reward_mean": 622.7027011220783, "timesteps_total": 3554079, "date": "2019-04-26_08-57-20", "timesteps_since_restore": 3554079, "custom_metrics": {"cost1_max": 291.47791226324836, "system_level_velocity_max": 10.909923116529132, "system_level_velocity_min": 8.914288178601831, "outflow_rate_min": 705.8690423792173, "cost2_min": -119.12936274078677, "cost1_min": 242.28657273755752, "cost2_max": -91.3938881013886, "outflow_rate_mean": 747.4777993683693, "outflow_rate_max": 766.3072383170132, "cost1_mean": 274.3943375132067, "system_level_velocity_mean": 10.13488437647339, "cost2_mean": -107.3860454967853}, "time_total_s": 1147.0658292770386, "time_since_restore": 1147.0658292770386, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904320>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269040, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2041, "episode_reward_max": 642.2930608202264, "episodes_this_iter": 65, "time_this_iter_s": 33.82396841049194, "training_iteration": 33, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 572.0148311351344, "info": {"sample_time_ms": 13819.244, "grad_time_ms": 19563.732, "num_steps_sampled": 3554079, "update_time_ms": 11.824, "default": {"vf_loss": 18.26571273803711, "vf_explained_var": 0.28005561232566833, "entropy": 1.2214511632919312, "total_loss": 18.265470504760742, "cur_lr": 0.0005000000237487257, "kl": 0.007255851291120052, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0009693908505141735}, "load_time_ms": 8.062, "num_steps_trained": 3554079}, "timesteps_this_iter": 108134, "hostname": "flow-main"}
{"episode_reward_mean": 608.0245421384092, "timesteps_total": 3662753, "date": "2019-04-26_08-57-55", "timesteps_since_restore": 3662753, "custom_metrics": {"cost1_max": 291.3878565728201, "system_level_velocity_max": 10.74303181898267, "system_level_velocity_min": 8.863324629265461, "outflow_rate_min": 697.1949180150067, "cost2_min": -113.88786677966223, "cost1_min": 240.5706747278752, "cost2_max": -91.3938881013886, "outflow_rate_mean": 735.62153256929, "outflow_rate_max": 762.4331290170518, "cost1_mean": 264.67653481879364, "system_level_velocity_mean": 9.754192553808108, "cost2_mean": -103.75804107185823}, "time_total_s": 1182.6327679157257, "time_since_restore": 1182.6327679157257, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219674e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967978>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269075, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2106, "episode_reward_max": 642.2930608202264, "episodes_this_iter": 65, "time_this_iter_s": 35.566938638687134, "training_iteration": 34, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 572.1768550141175, "info": {"sample_time_ms": 13854.055, "grad_time_ms": 19641.771, "num_steps_sampled": 3662753, "update_time_ms": 12.236, "default": {"vf_loss": 18.41668128967285, "vf_explained_var": 0.30999934673309326, "entropy": 1.2070363759994507, "total_loss": 18.41632080078125, "cur_lr": 0.0005000000237487257, "kl": 0.006996770855039358, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0010583068942651153}, "load_time_ms": 8.203, "num_steps_trained": 3662753}, "timesteps_this_iter": 108674, "hostname": "flow-main"}
{"episode_reward_mean": 596.9733112449411, "timesteps_total": 3771534, "date": "2019-04-26_08-58-29", "timesteps_since_restore": 3771534, "custom_metrics": {"cost1_max": 286.82968259001734, "system_level_velocity_max": 10.61077600585877, "system_level_velocity_min": 8.80474841445502, "outflow_rate_min": 697.1949180150067, "cost2_min": -112.62824800993008, "cost1_min": 239.14160269250766, "cost2_max": -92.36754255700221, "outflow_rate_mean": 727.5129332944925, "outflow_rate_max": 756.410401994185, "cost1_mean": 258.13804014168016, "system_level_velocity_mean": 9.488987154261785, "cost2_mean": -102.9059337066616}, "time_total_s": 1216.236572265625, "time_since_restore": 1216.236572265625, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219049b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219045c0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269109, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2170, "episode_reward_max": 644.8090133102683, "episodes_this_iter": 64, "time_this_iter_s": 33.60380434989929, "training_iteration": 35, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 572.1768550141175, "info": {"sample_time_ms": 13886.334, "grad_time_ms": 19508.137, "num_steps_sampled": 3771534, "update_time_ms": 12.132, "default": {"vf_loss": 17.44908332824707, "vf_explained_var": 0.3672778308391571, "entropy": 1.1999642848968506, "total_loss": 17.44940757751465, "cur_lr": 0.0005000000237487257, "kl": 0.006091118790209293, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0002827728458214551}, "load_time_ms": 7.945, "num_steps_trained": 3771534}, "timesteps_this_iter": 108781, "hostname": "flow-main"}
{"episode_reward_mean": 597.5682447917468, "timesteps_total": 3879613, "date": "2019-04-26_08-59-03", "timesteps_since_restore": 3879613, "custom_metrics": {"cost1_max": 286.82968259001734, "system_level_velocity_max": 10.557855836675879, "system_level_velocity_min": 8.948895874417794, "outflow_rate_min": 700.0822010897025, "cost2_min": -113.63710982960883, "cost1_min": 243.34710711015248, "cost2_max": -94.30154926406283, "outflow_rate_mean": 727.4552687126182, "outflow_rate_max": 753.864879709722, "cost1_mean": 258.2348763167562, "system_level_velocity_mean": 9.484525924477689, "cost2_mean": -102.19464699621196}, "time_total_s": 1249.9771611690521, "time_since_restore": 1249.9771611690521, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970860>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269143, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2232, "episode_reward_max": 644.8090133102683, "episodes_this_iter": 62, "time_this_iter_s": 33.740588903427124, "training_iteration": 36, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 579.7273818731386, "info": {"sample_time_ms": 13894.774, "grad_time_ms": 19446.342, "num_steps_sampled": 3879613, "update_time_ms": 11.944, "default": {"vf_loss": 16.352266311645508, "vf_explained_var": 0.3933620750904083, "entropy": 1.1852973699569702, "total_loss": 16.352575302124023, "cur_lr": 0.0005000000237487257, "kl": 0.006568426266312599, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0003474971163086593}, "load_time_ms": 7.894, "num_steps_trained": 3879613}, "timesteps_this_iter": 108079, "hostname": "flow-main"}
{"episode_reward_mean": 599.5566420126165, "timesteps_total": 3988363, "date": "2019-04-26_08-59-37", "timesteps_since_restore": 3988363, "custom_metrics": {"cost1_max": 278.5752608379084, "system_level_velocity_max": 10.24441521498162, "system_level_velocity_min": 8.867163848677496, "outflow_rate_min": 700.0822010897025, "cost2_min": -113.63710982960883, "cost1_min": 240.92018122004282, "cost2_max": -92.0174824941707, "outflow_rate_mean": 729.4563499562375, "outflow_rate_max": 753.864879709722, "cost1_mean": 259.44878028346403, "system_level_velocity_mean": 9.536470769309393, "cost2_mean": -101.02542736593712}, "time_total_s": 1283.946061372757, "time_since_restore": 1283.946061372757, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219045c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904588>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269177, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2297, "episode_reward_max": 632.3973605924883, "episodes_this_iter": 65, "time_this_iter_s": 33.968900203704834, "training_iteration": 37, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 579.3394186406181, "info": {"sample_time_ms": 13928.543, "grad_time_ms": 19600.606, "num_steps_sampled": 3988363, "update_time_ms": 11.603, "default": {"vf_loss": 16.712627410888672, "vf_explained_var": 0.426799476146698, "entropy": 1.184159517288208, "total_loss": 16.713172912597656, "cur_lr": 0.0005000000237487257, "kl": 0.005463884212076664, "cur_kl_coeff": 0.10000000894069672, "policy_loss": 1.146037902799435e-06}, "load_time_ms": 8.183, "num_steps_trained": 3988363}, "timesteps_this_iter": 108750, "hostname": "flow-main"}
{"episode_reward_mean": 601.3224702911106, "timesteps_total": 4096651, "date": "2019-04-26_09-00-12", "timesteps_since_restore": 4096651, "custom_metrics": {"cost1_max": 276.326124649402, "system_level_velocity_max": 10.1913446238531, "system_level_velocity_min": 8.97247510786621, "outflow_rate_min": 714.9881328588137, "cost2_min": -108.2830924003035, "cost1_min": 243.70163425791, "cost2_max": -93.77981460729977, "outflow_rate_mean": 731.4277486275853, "outflow_rate_max": 748.8349312366282, "cost1_mean": 260.2622036056255, "system_level_velocity_mean": 9.565836867838193, "cost2_mean": -100.92317319017995}, "time_total_s": 1319.5174643993378, "time_since_restore": 1319.5174643993378, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904358>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269212, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2358, "episode_reward_max": 632.3973605924883, "episodes_this_iter": 61, "time_this_iter_s": 35.57140302658081, "training_iteration": 38, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 579.9296244893628, "info": {"sample_time_ms": 13951.63, "grad_time_ms": 19953.46, "num_steps_sampled": 4096651, "update_time_ms": 11.532, "default": {"vf_loss": 14.734333038330078, "vf_explained_var": 0.42127060890197754, "entropy": 1.1881096363067627, "total_loss": 14.734033584594727, "cur_lr": 0.0005000000237487257, "kl": 0.007058876566588879, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0010058814659714699}, "load_time_ms": 8.402, "num_steps_trained": 4096651}, "timesteps_this_iter": 108288, "hostname": "flow-main"}
{"episode_reward_mean": 608.7870329117254, "timesteps_total": 4204659, "date": "2019-04-26_09-00-47", "timesteps_since_restore": 4204659, "custom_metrics": {"cost1_max": 284.489996451204, "system_level_velocity_max": 10.370561171071584, "system_level_velocity_min": 9.125740915763624, "outflow_rate_min": 715.292880115672, "cost2_min": -107.1636559570773, "cost1_min": 248.51759077942603, "cost2_max": -92.71559015758204, "outflow_rate_mean": 732.943231035061, "outflow_rate_max": 748.8349312366282, "cost1_mean": 264.7899737639891, "system_level_velocity_mean": 9.734312662622454, "cost2_mean": -99.6890006150118}, "time_total_s": 1354.4796481132507, "time_since_restore": 1354.4796481132507, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ba8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269247, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2420, "episode_reward_max": 636.6324447366699, "episodes_this_iter": 62, "time_this_iter_s": 34.962183713912964, "training_iteration": 39, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 581.9430792217198, "info": {"sample_time_ms": 14078.965, "grad_time_ms": 20229.623, "num_steps_sampled": 4204659, "update_time_ms": 11.726, "default": {"vf_loss": 15.152466773986816, "vf_explained_var": 0.35589948296546936, "entropy": 1.1949228048324585, "total_loss": 15.152539253234863, "cur_lr": 0.0005000000237487257, "kl": 0.0072691659443080425, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0006544499774463475}, "load_time_ms": 8.477, "num_steps_trained": 4204659}, "timesteps_this_iter": 108008, "hostname": "flow-main"}
{"episode_reward_mean": 622.774249268807, "timesteps_total": 4311136, "date": "2019-04-26_09-01-22", "timesteps_since_restore": 4311136, "custom_metrics": {"cost1_max": 289.6582804597847, "system_level_velocity_max": 10.59336797465956, "system_level_velocity_min": 9.355609924047274, "outflow_rate_min": 720.6530598402256, "cost2_min": -107.12874111852722, "cost1_min": 254.89718240322208, "cost2_max": -90.94027997533163, "outflow_rate_mean": 738.2251021010783, "outflow_rate_max": 753.3555227504395, "cost1_mean": 272.37952822598777, "system_level_velocity_mean": 10.015681219194313, "cost2_mean": -98.63687964686608}, "time_total_s": 1389.1629116535187, "time_since_restore": 1389.1629116535187, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b70>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269282, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2482, "episode_reward_max": 647.8385075919248, "episodes_this_iter": 62, "time_this_iter_s": 34.683263540267944, "training_iteration": 40, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 594.180570636047, "info": {"sample_time_ms": 14079.506, "grad_time_ms": 20448.59, "num_steps_sampled": 4311136, "update_time_ms": 11.693, "default": {"vf_loss": 14.960075378417969, "vf_explained_var": 0.265971302986145, "entropy": 1.1808580160140991, "total_loss": 14.959834098815918, "cur_lr": 0.0005000000237487257, "kl": 0.007521199993789196, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0009916063863784075}, "load_time_ms": 8.65, "num_steps_trained": 4311136}, "timesteps_this_iter": 106477, "hostname": "flow-main"}
{"episode_reward_mean": 631.5194270297378, "timesteps_total": 4417837, "date": "2019-04-26_09-01-56", "timesteps_since_restore": 4417837, "custom_metrics": {"cost1_max": 290.27026032034246, "system_level_velocity_max": 10.615643835029854, "system_level_velocity_min": 9.543485162613038, "outflow_rate_min": 726.2870967227383, "cost2_min": -107.12874111852722, "cost1_min": 259.1038823692289, "cost2_max": -90.45466392820664, "outflow_rate_mean": 743.888327802423, "outflow_rate_max": 755.4904290065498, "cost1_mean": 276.99236516831024, "system_level_velocity_mean": 10.198074591425376, "cost2_mean": -98.64503915444108}, "time_total_s": 1422.9749200344086, "time_since_restore": 1422.9749200344086, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219045c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904550>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269316, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2544, "episode_reward_max": 652.6891893635757, "episodes_this_iter": 62, "time_this_iter_s": 33.81200838088989, "training_iteration": 41, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 610.4075446682547, "info": {"sample_time_ms": 14070.92, "grad_time_ms": 20266.584, "num_steps_sampled": 4417837, "update_time_ms": 11.819, "default": {"vf_loss": 16.23528480529785, "vf_explained_var": 0.23118296265602112, "entropy": 1.1838972568511963, "total_loss": 16.235754013061523, "cur_lr": 0.0005000000237487257, "kl": 0.005646870471537113, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -9.543912892695516e-05}, "load_time_ms": 8.858, "num_steps_trained": 4417837}, "timesteps_this_iter": 106701, "hostname": "flow-main"}
{"episode_reward_mean": 636.11017192079, "timesteps_total": 4524794, "date": "2019-04-26_09-02-25", "timesteps_since_restore": 4524794, "custom_metrics": {"cost1_max": 292.7123195554009, "system_level_velocity_max": 10.792227340384944, "system_level_velocity_min": 9.735009254381948, "outflow_rate_min": 720.7420579208485, "cost2_min": -109.13209885395648, "cost1_min": 264.1485480633319, "cost2_max": -90.45466392820664, "outflow_rate_mean": 746.9459189630464, "outflow_rate_max": 757.9510423763797, "cost1_mean": 279.47419242326896, "system_level_velocity_mean": 10.292265710616816, "cost2_mean": -99.8169335579389}, "time_total_s": 1452.4056901931763, "time_since_restore": 1452.4056901931763, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904cc0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269345, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2604, "episode_reward_max": 660.8971479289593, "episodes_this_iter": 60, "time_this_iter_s": 29.4307701587677, "training_iteration": 42, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 598.3859210824112, "info": {"sample_time_ms": 13900.267, "grad_time_ms": 19790.655, "num_steps_sampled": 4524794, "update_time_ms": 11.881, "default": {"vf_loss": 17.26666259765625, "vf_explained_var": 0.17958039045333862, "entropy": 1.1668962240219116, "total_loss": 17.266693115234375, "cur_lr": 0.0005000000237487257, "kl": 0.007178821600973606, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0006877558189444244}, "load_time_ms": 8.5, "num_steps_trained": 4524794}, "timesteps_this_iter": 106957, "hostname": "flow-main"}
{"episode_reward_mean": 641.7779482588228, "timesteps_total": 4631886, "date": "2019-04-26_09-03-01", "timesteps_since_restore": 4631886, "custom_metrics": {"cost1_max": 292.1415586877246, "system_level_velocity_max": 10.792227340384944, "system_level_velocity_min": 9.985784820429254, "outflow_rate_min": 730.2257426655312, "cost2_min": -113.46747494865299, "cost1_min": 270.06633094688493, "cost2_max": -91.0194520729065, "outflow_rate_mean": 751.4261361955811, "outflow_rate_max": 771.3846840934945, "cost1_mean": 279.99934116008694, "system_level_velocity_mean": 10.314529281454433, "cost2_mean": -100.63904899308305}, "time_total_s": 1487.511102437973, "time_since_restore": 1487.511102437973, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904518>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269381, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2665, "episode_reward_max": 657.2870197170904, "episodes_this_iter": 61, "time_this_iter_s": 35.10541224479675, "training_iteration": 43, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 611.87020120405, "info": {"sample_time_ms": 13860.272, "grad_time_ms": 19961.777, "num_steps_sampled": 4631886, "update_time_ms": 11.761, "default": {"vf_loss": 17.859575271606445, "vf_explained_var": 0.12646421790122986, "entropy": 1.1454054117202759, "total_loss": 17.85994529724121, "cur_lr": 0.0005000000237487257, "kl": 0.007132220081984997, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0003440341097302735}, "load_time_ms": 8.744, "num_steps_trained": 4631886}, "timesteps_this_iter": 107092, "hostname": "flow-main"}
{"episode_reward_mean": 644.2564073794986, "timesteps_total": 4738794, "date": "2019-04-26_09-03-34", "timesteps_since_restore": 4738794, "custom_metrics": {"cost1_max": 292.0110505655701, "system_level_velocity_max": 10.733188580540185, "system_level_velocity_min": 9.945427667365488, "outflow_rate_min": 736.213166501419, "cost2_min": -113.46747494865299, "cost1_min": 269.1076600002709, "cost2_max": -85.55895688967023, "outflow_rate_mean": 752.7311882002109, "outflow_rate_max": 771.3846840934945, "cost1_mean": 279.24467296396193, "system_level_velocity_mean": 10.298613795914457, "cost2_mean": -99.97559396828457}, "time_total_s": 1521.3728339672089, "time_since_restore": 1521.3728339672089, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904da0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269414, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2726, "episode_reward_max": 660.5687349879828, "episodes_this_iter": 61, "time_this_iter_s": 33.86173152923584, "training_iteration": 44, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 627.1409455457011, "info": {"sample_time_ms": 13796.45, "grad_time_ms": 19853.972, "num_steps_sampled": 4738794, "update_time_ms": 12.198, "default": {"vf_loss": 17.944276809692383, "vf_explained_var": 0.14452262222766876, "entropy": 1.1375516653060913, "total_loss": 17.944896697998047, "cur_lr": 0.0005000000237487257, "kl": 0.007403348572552204, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00012121014879085124}, "load_time_ms": 8.51, "num_steps_trained": 4738794}, "timesteps_this_iter": 106908, "hostname": "flow-main"}
{"episode_reward_mean": 647.1193273103835, "timesteps_total": 4845839, "date": "2019-04-26_09-04-08", "timesteps_since_restore": 4845839, "custom_metrics": {"cost1_max": 292.0110505655701, "system_level_velocity_max": 10.731090810212304, "system_level_velocity_min": 9.945427667365488, "outflow_rate_min": 736.213166501419, "cost2_min": -108.41859472813267, "cost1_min": 269.1076600002709, "cost2_max": -85.55895688967023, "outflow_rate_mean": 753.2005896542121, "outflow_rate_max": 767.6044721324128, "cost1_mean": 280.28450160126374, "system_level_velocity_mean": 10.347934275409202, "cost2_mean": -98.89222468132265}, "time_total_s": 1555.1216990947723, "time_since_restore": 1555.1216990947723, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219049e8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269448, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2786, "episode_reward_max": 661.54119810685, "episodes_this_iter": 60, "time_this_iter_s": 33.74886512756348, "training_iteration": 45, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 629.307396733847, "info": {"sample_time_ms": 13642.429, "grad_time_ms": 20020.229, "num_steps_sampled": 4845839, "update_time_ms": 12.128, "default": {"vf_loss": 16.528057098388672, "vf_explained_var": 0.2003527730703354, "entropy": 1.1362940073013306, "total_loss": 16.52874755859375, "cur_lr": 0.0005000000237487257, "kl": 0.007260351441800594, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -3.618697155616246e-05}, "load_time_ms": 9.069, "num_steps_trained": 4845839}, "timesteps_this_iter": 107045, "hostname": "flow-main"}
{"episode_reward_mean": 646.4716349052526, "timesteps_total": 4953005, "date": "2019-04-26_09-04-42", "timesteps_since_restore": 4953005, "custom_metrics": {"cost1_max": 289.8296873317872, "system_level_velocity_max": 10.806278943959166, "system_level_velocity_min": 10.019209010602395, "outflow_rate_min": 739.5818592791156, "cost2_min": -106.54543502666503, "cost1_min": 270.72461145471794, "cost2_max": -89.59943597658281, "outflow_rate_mean": 753.1551557039987, "outflow_rate_max": 763.0828943488898, "cost1_mean": 280.51433310635804, "system_level_velocity_mean": 10.369182636780701, "cost2_mean": -98.07291096043083}, "time_total_s": 1588.9204411506653, "time_since_restore": 1588.9204411506653, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904cf8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269482, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2850, "episode_reward_max": 659.8940169436687, "episodes_this_iter": 64, "time_this_iter_s": 33.798742055892944, "training_iteration": 46, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 629.2773283236975, "info": {"sample_time_ms": 13626.125, "grad_time_ms": 20042.564, "num_steps_sampled": 4953005, "update_time_ms": 12.028, "default": {"vf_loss": 16.740840911865234, "vf_explained_var": 0.2624463438987732, "entropy": 1.1393736600875854, "total_loss": 16.740842819213867, "cur_lr": 0.0005000000237487257, "kl": 0.008136842399835587, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0008129111956804991}, "load_time_ms": 8.849, "num_steps_trained": 4953005}, "timesteps_this_iter": 107166, "hostname": "flow-main"}
{"episode_reward_mean": 642.0309774516558, "timesteps_total": 5060503, "date": "2019-04-26_09-05-17", "timesteps_since_restore": 5060503, "custom_metrics": {"cost1_max": 289.7195734583683, "system_level_velocity_max": 10.703004181596432, "system_level_velocity_min": 9.676567122931418, "outflow_rate_min": 730.1669360961486, "cost2_min": -105.30606267847661, "cost1_min": 262.4878358543952, "cost2_max": -82.49725289137585, "outflow_rate_mean": 749.5655930018047, "outflow_rate_max": 761.1054729897596, "cost1_mean": 278.41625619559966, "system_level_velocity_mean": 10.273885264026699, "cost2_mean": -96.70558179263811}, "time_total_s": 1623.6548955440521, "time_since_restore": 1623.6548955440521, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904be0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269517, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2913, "episode_reward_max": 660.1856016169027, "episodes_this_iter": 63, "time_this_iter_s": 34.73445439338684, "training_iteration": 47, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 613.284028388668, "info": {"sample_time_ms": 13621.643, "grad_time_ms": 20122.553, "num_steps_sampled": 5060503, "update_time_ms": 11.966, "default": {"vf_loss": 17.09269142150879, "vf_explained_var": 0.20501385629177094, "entropy": 1.1350520849227905, "total_loss": 17.092439651489258, "cur_lr": 0.0005000000237487257, "kl": 0.00936493556946516, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011877367505803704}, "load_time_ms": 8.774, "num_steps_trained": 5060503}, "timesteps_this_iter": 107498, "hostname": "flow-main"}
{"episode_reward_mean": 627.8259097839268, "timesteps_total": 5168809, "date": "2019-04-26_09-05-51", "timesteps_since_restore": 5168809, "custom_metrics": {"cost1_max": 289.46536315841126, "system_level_velocity_max": 10.619947865867648, "system_level_velocity_min": 8.973802537163571, "outflow_rate_min": 710.8506183978575, "cost2_min": -103.36207948280132, "cost1_min": 243.4374148933697, "cost2_max": -84.29863338786463, "outflow_rate_mean": 740.3060278814099, "outflow_rate_max": 755.8535356815544, "cost1_mean": 270.8562010408486, "system_level_velocity_mean": 9.968272240627403, "cost2_mean": -94.71678897731461}, "time_total_s": 1657.7342760562897, "time_since_restore": 1657.7342760562897, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219709b0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269551, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 2981, "episode_reward_max": 660.1856016169027, "episodes_this_iter": 68, "time_this_iter_s": 34.07938051223755, "training_iteration": 48, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 586.5067376302445, "info": {"sample_time_ms": 13640.346, "grad_time_ms": 19953.946, "num_steps_sampled": 5168809, "update_time_ms": 12.169, "default": {"vf_loss": 16.615060806274414, "vf_explained_var": 0.3339737057685852, "entropy": 1.1171150207519531, "total_loss": 16.61560821533203, "cur_lr": 0.0005000000237487257, "kl": 0.00674522016197443, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0001275552058359608}, "load_time_ms": 8.754, "num_steps_trained": 5168809}, "timesteps_this_iter": 108306, "hostname": "flow-main"}
{"episode_reward_mean": 613.186402691112, "timesteps_total": 5278018, "date": "2019-04-26_09-06-26", "timesteps_since_restore": 5278018, "custom_metrics": {"cost1_max": 282.105855340973, "system_level_velocity_max": 10.392951956414477, "system_level_velocity_min": 8.97704377347313, "outflow_rate_min": 714.2261089404486, "cost2_min": -101.13456110486717, "cost1_min": 244.57098023292076, "cost2_max": -84.29863338786463, "outflow_rate_mean": 732.8022600587558, "outflow_rate_max": 754.7959161152016, "cost1_mean": 262.7190175887898, "system_level_velocity_mean": 9.649398007443978, "cost2_mean": -94.11661808075111}, "time_total_s": 1692.6088428497314, "time_since_restore": 1692.6088428497314, "pid": 24069, "episode_len_mean": 700.0, "done": false, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219043c8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269586, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 3043, "episode_reward_max": 649.8262515128081, "episodes_this_iter": 62, "time_this_iter_s": 34.87456679344177, "training_iteration": 49, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 576.1053096473718, "info": {"sample_time_ms": 13658.959, "grad_time_ms": 19930.176, "num_steps_sampled": 5278018, "update_time_ms": 12.285, "default": {"vf_loss": 17.52235984802246, "vf_explained_var": 0.49313104152679443, "entropy": 1.105854868888855, "total_loss": 17.522602081298828, "cur_lr": 0.0005000000237487257, "kl": 0.007256871089339256, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00048245186917483807}, "load_time_ms": 8.88, "num_steps_trained": 5278018}, "timesteps_this_iter": 109209, "hostname": "flow-main"}
{"episode_reward_mean": 602.000703774606, "timesteps_total": 5387596, "date": "2019-04-26_09-07-02", "timesteps_since_restore": 5387596, "custom_metrics": {"cost1_max": 274.56963684182267, "system_level_velocity_max": 10.080888598905386, "system_level_velocity_min": 8.97704377347313, "outflow_rate_min": 711.8704002838297, "cost2_min": -98.38946522732927, "cost1_min": 244.57098023292076, "cost2_max": -87.99308106348062, "outflow_rate_mean": 726.4416085090251, "outflow_rate_max": 748.4004551910632, "cost1_mean": 256.59414016915, "system_level_velocity_mean": 9.414081241428383, "cost2_mean": -94.05103117504021}, "time_total_s": 1728.8793594837189, "time_since_restore": 1728.8793594837189, "pid": 24069, "episode_len_mean": 700.0, "done": true, "node_ip": "10.138.0.2", "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219045f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904438>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "vf_loss_coeff": 1.0, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:20.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"free_log_std": false, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "lambda": 0.97, "lr_schedule": null, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "log_level": "INFO", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "simple_optimizer": false, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556269622, "experiment_id": "c4d66e2e729c48e798bb4dc6962da574", "episodes_total": 3107, "episode_reward_max": 633.317421522833, "episodes_this_iter": 64, "time_this_iter_s": 36.27051663398743, "training_iteration": 50, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 584.5269936252635, "info": {"sample_time_ms": 13768.291, "grad_time_ms": 19978.354, "num_steps_sampled": 5387596, "update_time_ms": 12.27, "default": {"vf_loss": 17.320335388183594, "vf_explained_var": 0.5092543363571167, "entropy": 1.1144239902496338, "total_loss": 17.320859909057617, "cur_lr": 0.0005000000237487257, "kl": 0.006532792001962662, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0001285440957872197}, "load_time_ms": 8.901, "num_steps_trained": 5387596}, "timesteps_this_iter": 109578, "hostname": "flow-main"}

{"episode_reward_mean": 225.30977922521038, "policy_reward_mean": {}, "episode_len_mean": 682.5526315789474, "timesteps_since_restore": 114920, "custom_metrics": {"cost2_min": -404.3728445122723, "system_level_velocity_min": 6.58068329992665, "system_level_velocity_max": 17.87527364496148, "outflow_rate_min": 482.811897518348, "cost1_max": 235.90593432892535, "cost1_min": 23.90893984484575, "cost2_max": -125.53319322902145, "outflow_rate_mean": 626.8437735616519, "outflow_rate_max": 774.7280987015073, "cost1_mean": 201.17761866471037, "system_level_velocity_mean": 8.192933230698376, "cost2_mean": -270.4985411207482}, "time_total_s": 70.74119329452515, "time_since_restore": 70.74119329452515, "pid": 45627, "date": "2019-04-26_09-08-30", "timesteps_total": 114920, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936358>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269710, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 38, "episode_reward_max": 320.4506868532239, "time_this_iter_s": 70.74119329452515, "training_iteration": 1, "info": {"num_steps_sampled": 114920, "grad_time_ms": 24688.406, "sample_time_ms": 43379.631, "update_time_ms": 2393.189, "default": {"vf_loss": 1.2949692010879517, "vf_explained_var": 0.840386152267456, "entropy": 1.414548635482788, "total_loss": 1.2936002016067505, "cur_lr": 0.0005000000237487257, "kl": 0.004134489223361015, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.002195923123508692}, "load_time_ms": 56.334, "num_steps_trained": 114920}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 10.691117501675269, "episodes_this_iter": 38, "timesteps_this_iter": 114920, "hostname": "flow-main"}
{"episode_reward_mean": 226.19390590514914, "policy_reward_mean": {}, "episode_len_mean": 693.1649484536083, "timesteps_since_restore": 233378, "custom_metrics": {"cost2_min": -411.9768874078988, "system_level_velocity_min": 5.565134564686003, "system_level_velocity_max": 17.87527364496148, "outflow_rate_min": 405.1442474063443, "cost1_max": 237.417342386348, "cost1_min": 23.90893984484575, "cost2_max": -125.53319322902145, "outflow_rate_mean": 608.1614150686815, "outflow_rate_max": 774.7280987015073, "cost1_mean": 199.20579455524478, "system_level_velocity_mean": 7.8622527224521415, "cost2_mean": -268.1612013021172}, "time_total_s": 108.30922150611877, "time_since_restore": 108.30922150611877, "pid": 45627, "date": "2019-04-26_09-09-08", "timesteps_total": 233378, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6208>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269748, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 97, "episode_reward_max": 364.47416250237677, "time_this_iter_s": 37.56802821159363, "training_iteration": 2, "info": {"num_steps_sampled": 233378, "grad_time_ms": 23860.713, "sample_time_ms": 28843.557, "update_time_ms": 1201.977, "default": {"vf_loss": 0.9252326488494873, "vf_explained_var": 0.847358226776123, "entropy": 1.4099599123001099, "total_loss": 0.918749988079071, "cur_lr": 0.0005000000237487257, "kl": 0.013623327016830444, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.007844925858080387}, "load_time_ms": 34.125, "num_steps_trained": 233378}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 10.691117501675269, "episodes_this_iter": 59, "timesteps_this_iter": 118458, "hostname": "flow-main"}
{"episode_reward_mean": 299.12744617191345, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 346199, "custom_metrics": {"cost2_min": -411.9768874078988, "system_level_velocity_min": 5.565134564686003, "system_level_velocity_max": 11.360716418685676, "outflow_rate_min": 405.1442474063443, "cost1_max": 296.9513769458365, "cost1_min": 145.84556691431945, "cost2_max": -157.1799801270766, "outflow_rate_mean": 653.8712746652486, "outflow_rate_max": 836.9786558614086, "cost1_mean": 218.43724452642545, "system_level_velocity_mean": 8.418687388270133, "cost2_mean": -254.75077201225255}, "time_total_s": 145.7841296195984, "time_since_restore": 145.7841296195984, "pid": 45627, "date": "2019-04-26_09-09-45", "timesteps_total": 346199, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219043c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904c50>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269785, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 145, "episode_reward_max": 512.5058447441791, "time_this_iter_s": 37.474908113479614, "training_iteration": 3, "info": {"num_steps_sampled": 346199, "grad_time_ms": 23405.601, "sample_time_ms": 24148.101, "update_time_ms": 804.879, "default": {"vf_loss": 4.095958709716797, "vf_explained_var": 0.8218844532966614, "entropy": 1.371564269065857, "total_loss": 4.090149879455566, "cur_lr": 0.0005000000237487257, "kl": 0.01253645308315754, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.007062586490064859}, "load_time_ms": 25.872, "num_steps_trained": 346199}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 147.3633008575414, "episodes_this_iter": 48, "timesteps_this_iter": 112821, "hostname": "flow-main"}
{"episode_reward_mean": 472.4546708861953, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 464219, "custom_metrics": {"cost2_min": -358.56905158588063, "system_level_velocity_min": 6.433404719705473, "system_level_velocity_max": 12.641695250801224, "outflow_rate_min": 481.35147112436147, "cost1_max": 333.56099061760494, "cost1_min": 167.0037132836682, "cost2_max": -157.1799801270766, "outflow_rate_mean": 765.0361761855467, "outflow_rate_max": 949.9255286547653, "cost1_mean": 257.3680838229369, "system_level_velocity_mean": 9.811644915257055, "cost2_mean": -249.40247716254123}, "time_total_s": 184.0278356075287, "time_since_restore": 184.0278356075287, "pid": 45627, "date": "2019-04-26_09-10-23", "timesteps_total": 464219, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269823, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 201, "episode_reward_max": 647.7268119400522, "time_this_iter_s": 38.2437059879303, "training_iteration": 4, "info": {"num_steps_sampled": 464219, "grad_time_ms": 23339.382, "sample_time_ms": 21830.075, "update_time_ms": 606.307, "default": {"vf_loss": 7.6093292236328125, "vf_explained_var": 0.655748188495636, "entropy": 1.3504239320755005, "total_loss": 7.606451034545898, "cur_lr": 0.0005000000237487257, "kl": 0.0077184285037219524, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0036500836722552776}, "load_time_ms": 22.35, "num_steps_trained": 464219}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 174.76997440931933, "episodes_this_iter": 56, "timesteps_this_iter": 118020, "hostname": "flow-main"}
{"episode_reward_mean": 575.9252738203313, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 583052, "custom_metrics": {"cost2_min": -296.85441673575957, "system_level_velocity_min": 7.231935957850086, "system_level_velocity_max": 12.666068782046095, "outflow_rate_min": 592.4892476396244, "cost1_max": 334.2614141573683, "cost1_min": 190.6641845683916, "cost2_max": -185.8152269007195, "outflow_rate_mean": 822.8092285246478, "outflow_rate_max": 954.6034183730198, "cost1_mean": 274.4478602309302, "system_level_velocity_mean": 10.370299232126433, "cost2_mean": -247.6139823542735}, "time_total_s": 221.65733647346497, "time_since_restore": 221.65733647346497, "pid": 45627, "date": "2019-04-26_09-11-01", "timesteps_total": 583052, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219047f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219362e8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269861, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 243, "episode_reward_max": 689.0681444673489, "time_this_iter_s": 37.62950086593628, "training_iteration": 5, "info": {"num_steps_sampled": 583052, "grad_time_ms": 23284.831, "sample_time_ms": 20332.1, "update_time_ms": 486.987, "default": {"vf_loss": 7.1921586990356445, "vf_explained_var": 0.6344741582870483, "entropy": 1.34286367893219, "total_loss": 7.190304279327393, "cur_lr": 0.0005000000237487257, "kl": 0.0067464690655469894, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.002528741490095854}, "load_time_ms": 19.71, "num_steps_trained": 583052}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 319.15732629004503, "episodes_this_iter": 42, "timesteps_this_iter": 118833, "hostname": "flow-main"}
{"episode_reward_mean": 627.9899631599005, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 699772, "custom_metrics": {"cost2_min": -276.02342790753005, "system_level_velocity_min": 7.231935957850086, "system_level_velocity_max": 13.717441567157428, "outflow_rate_min": 608.3330330458551, "cost1_max": 361.3681975720238, "cost1_min": 190.6641845683916, "cost2_max": -185.8152269007195, "outflow_rate_mean": 858.778317870448, "outflow_rate_max": 999.507899202981, "cost1_mean": 282.60029600653223, "system_level_velocity_mean": 10.639604760957987, "cost2_mean": -232.08614819864124}, "time_total_s": 256.1292715072632, "time_since_restore": 256.1292715072632, "pid": 45627, "date": "2019-04-26_09-11-35", "timesteps_total": 699772, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970c18>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269895, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 297, "episode_reward_max": 730.4241206552971, "time_this_iter_s": 34.47193503379822, "training_iteration": 6, "info": {"num_steps_sampled": 699772, "grad_time_ms": 22726.068, "sample_time_ms": 19333.999, "update_time_ms": 407.667, "default": {"vf_loss": 9.135415077209473, "vf_explained_var": 0.6469724178314209, "entropy": 1.3484337329864502, "total_loss": 9.134416580200195, "cur_lr": 0.0005000000237487257, "kl": 0.0055390032939612865, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0015531788812950253}, "load_time_ms": 18.21, "num_steps_trained": 699772}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 516.8799617834884, "episodes_this_iter": 54, "timesteps_this_iter": 116720, "hostname": "flow-main"}
{"episode_reward_mean": 653.1252787286595, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 815521, "custom_metrics": {"cost2_min": -250.07009105343718, "system_level_velocity_min": 8.944061827519384, "system_level_velocity_max": 13.717441567157428, "outflow_rate_min": 801.8612851073356, "cost1_max": 361.3681975720238, "cost1_min": 241.17639800968476, "cost2_max": -167.00943242628733, "outflow_rate_mean": 883.7443482681953, "outflow_rate_max": 999.507899202981, "cost1_mean": 290.56427929894, "system_level_velocity_mean": 10.922596535437801, "cost2_mean": -216.01361334981215}, "time_total_s": 294.3527410030365, "time_since_restore": 294.3527410030365, "pid": 45627, "date": "2019-04-26_09-12-14", "timesteps_total": 815521, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904860>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269934, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 352, "episode_reward_max": 730.4241206552971, "time_this_iter_s": 38.223469495773315, "training_iteration": 7, "info": {"num_steps_sampled": 815521, "grad_time_ms": 22697.51, "sample_time_ms": 18782.346, "update_time_ms": 350.903, "default": {"vf_loss": 10.008529663085938, "vf_explained_var": 0.6445872187614441, "entropy": 1.3259551525115967, "total_loss": 10.007452011108398, "cur_lr": 0.0005000000237487257, "kl": 0.0062115672044456005, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0016993770841509104}, "load_time_ms": 16.723, "num_steps_trained": 815521}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 586.1982237374403, "episodes_this_iter": 55, "timesteps_this_iter": 115749, "hostname": "flow-main"}
{"episode_reward_mean": 668.1984008342645, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 930890, "custom_metrics": {"cost2_min": -243.45477831107272, "system_level_velocity_min": 8.692346734313736, "system_level_velocity_max": 13.3234634716012, "outflow_rate_min": 807.0226498938841, "cost1_max": 350.52972844432753, "cost1_min": 233.38005584759208, "cost2_max": -167.00943242628733, "outflow_rate_mean": 891.1321759899746, "outflow_rate_max": 997.0311582472425, "cost1_mean": 290.17192451513347, "system_level_velocity_mean": 10.867875967561044, "cost2_mean": -202.8016549735416}, "time_total_s": 331.1508800983429, "time_since_restore": 331.1508800983429, "pid": 45627, "date": "2019-04-26_09-12-51", "timesteps_total": 930890, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8898>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556269971, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 405, "episode_reward_max": 742.0947077813958, "time_this_iter_s": 36.7981390953064, "training_iteration": 8, "info": {"num_steps_sampled": 930890, "grad_time_ms": 22622.334, "sample_time_ms": 18243.978, "update_time_ms": 308.794, "default": {"vf_loss": 10.395873069763184, "vf_explained_var": 0.6757565140724182, "entropy": 1.3176263570785522, "total_loss": 10.395048141479492, "cur_lr": 0.0005000000237487257, "kl": 0.006231647450476885, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.001448164228349924}, "load_time_ms": 15.743, "num_steps_trained": 930890}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 607.8246133656002, "episodes_this_iter": 53, "timesteps_this_iter": 115369, "hostname": "flow-main"}
{"episode_reward_mean": 684.2307462159288, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1046550, "custom_metrics": {"cost2_min": -214.81199166349472, "system_level_velocity_min": 8.692346734313736, "system_level_velocity_max": 13.524474042990613, "outflow_rate_min": 807.0226498938841, "cost1_max": 359.1510223864552, "cost1_min": 233.38005584759208, "cost2_max": -155.5707684633844, "outflow_rate_mean": 900.1856970374885, "outflow_rate_max": 1008.9644704686924, "cost1_mean": 293.23599914702635, "system_level_velocity_mean": 10.962588116895477, "cost2_mean": -190.48774463159342}, "time_total_s": 368.0777449607849, "time_since_restore": 368.0777449607849, "pid": 45627, "date": "2019-04-26_09-13-27", "timesteps_total": 1046550, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219043c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219041d0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270007, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 463, "episode_reward_max": 756.0360331748394, "time_this_iter_s": 36.92686486244202, "training_iteration": 9, "info": {"num_steps_sampled": 1046550, "grad_time_ms": 22607.008, "sample_time_ms": 17799.37, "update_time_ms": 275.656, "default": {"vf_loss": 12.413159370422363, "vf_explained_var": 0.6467445492744446, "entropy": 1.308192253112793, "total_loss": 12.412522315979004, "cur_lr": 0.0005000000237487257, "kl": 0.005830907262861729, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0012202005600556731}, "load_time_ms": 14.765, "num_steps_trained": 1046550}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 617.6474712386132, "episodes_this_iter": 58, "timesteps_this_iter": 115660, "hostname": "flow-main"}
{"episode_reward_mean": 695.3903843972533, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1160566, "custom_metrics": {"cost2_min": -206.60419085285517, "system_level_velocity_min": 8.999479947430723, "system_level_velocity_max": 14.126712230871199, "outflow_rate_min": 818.7256608088578, "cost1_max": 377.39317360534335, "cost1_min": 240.47794236504305, "cost2_max": -130.11973180778898, "outflow_rate_mean": 910.6343150201338, "outflow_rate_max": 1036.2241505714564, "cost1_mean": 300.5859558893603, "system_level_velocity_mean": 11.231502157630272, "cost2_mean": -177.21156422527383}, "time_total_s": 403.26948857307434, "time_since_restore": 403.26948857307434, "pid": 45627, "date": "2019-04-26_09-14-03", "timesteps_total": 1160566, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8828>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270043, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 514, "episode_reward_max": 787.2822973010568, "time_this_iter_s": 35.19174361228943, "training_iteration": 10, "info": {"num_steps_sampled": 1160566, "grad_time_ms": 22437.821, "sample_time_ms": 17424.443, "update_time_ms": 249.201, "default": {"vf_loss": 13.02967643737793, "vf_explained_var": 0.709470272064209, "entropy": 1.289447546005249, "total_loss": 13.029367446899414, "cur_lr": 0.0005000000237487257, "kl": 0.005293167661875486, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0008393926545977592}, "load_time_ms": 14.148, "num_steps_trained": 1160566}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 624.2075973774694, "episodes_this_iter": 51, "timesteps_this_iter": 114016, "hostname": "flow-main"}
{"episode_reward_mean": 699.7850846185185, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1274966, "custom_metrics": {"cost2_min": -196.36964362571737, "system_level_velocity_min": 8.999479947430723, "system_level_velocity_max": 14.126712230871199, "outflow_rate_min": 816.531805710181, "cost1_max": 377.39317360534335, "cost1_min": 241.02052630035547, "cost2_max": -128.78374093659275, "outflow_rate_mean": 908.7368621769049, "outflow_rate_max": 1036.2241505714564, "cost1_mean": 306.1874335200693, "system_level_velocity_mean": 11.454408524768358, "cost2_mean": -163.11720860141347}, "time_total_s": 440.34521412849426, "time_since_restore": 440.34521412849426, "pid": 45627, "date": "2019-04-26_09-14-40", "timesteps_total": 1274966, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f62b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6dd8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270080, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 576, "episode_reward_max": 787.2822973010568, "time_this_iter_s": 37.07572555541992, "training_iteration": 11, "info": {"num_steps_sampled": 1274966, "grad_time_ms": 22123.397, "sample_time_ms": 14617.923, "update_time_ms": 10.951, "default": {"vf_loss": 15.935824394226074, "vf_explained_var": 0.6576154828071594, "entropy": 1.2893880605697632, "total_loss": 15.935590744018555, "cur_lr": 0.0005000000237487257, "kl": 0.005616634618490934, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0007948792772367597}, "load_time_ms": 9.383, "num_steps_trained": 1274966}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 624.2075973774694, "episodes_this_iter": 62, "timesteps_this_iter": 114400, "hostname": "flow-main"}
{"episode_reward_mean": 700.9229339886832, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1386244, "custom_metrics": {"cost2_min": -182.8600726466683, "system_level_velocity_min": 9.219661163956532, "system_level_velocity_max": 14.765861724698942, "outflow_rate_min": 816.531805710181, "cost1_max": 392.21926238171187, "cost1_min": 247.3026606321488, "cost2_max": -117.53572933497696, "outflow_rate_mean": 901.860309353834, "outflow_rate_max": 998.091487890847, "cost1_mean": 311.55078902084483, "system_level_velocity_mean": 11.678123642596946, "cost2_mean": -153.0411569965205}, "time_total_s": 475.4263074398041, "time_since_restore": 475.4263074398041, "pid": 45627, "date": "2019-04-26_09-15-15", "timesteps_total": 1386244, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f82e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8be0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270115, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 631, "episode_reward_max": 777.2455047430306, "time_this_iter_s": 35.081093311309814, "training_iteration": 12, "info": {"num_steps_sampled": 1386244, "grad_time_ms": 21880.758, "sample_time_ms": 14612.621, "update_time_ms": 10.821, "default": {"vf_loss": 16.802888870239258, "vf_explained_var": 0.6521392464637756, "entropy": 1.2725036144256592, "total_loss": 16.802356719970703, "cur_lr": 0.0005000000237487257, "kl": 0.006188413593918085, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0011505380971357226}, "load_time_ms": 8.978, "num_steps_trained": 1386244}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 628.4259721472009, "episodes_this_iter": 55, "timesteps_this_iter": 111278, "hostname": "flow-main"}
{"episode_reward_mean": 701.419478049644, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1498120, "custom_metrics": {"cost2_min": -182.8600726466683, "system_level_velocity_min": 9.588322332976116, "system_level_velocity_max": 14.626444758371253, "outflow_rate_min": 818.3822842012655, "cost1_max": 386.184837483288, "cost1_min": 256.43767034957904, "cost2_max": -115.36948519544706, "outflow_rate_mean": 893.2433338763321, "outflow_rate_max": 973.3721855443952, "cost1_mean": 316.0063776655418, "system_level_velocity_mean": 11.864765911292041, "cost2_mean": -142.53186906191132}, "time_total_s": 509.0415368080139, "time_since_restore": 509.0415368080139, "pid": 45627, "date": "2019-04-26_09-15-49", "timesteps_total": 1498120, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6470>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270149, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 692, "episode_reward_max": 768.3559587235633, "time_this_iter_s": 33.61522936820984, "training_iteration": 13, "info": {"num_steps_sampled": 1498120, "grad_time_ms": 21513.693, "sample_time_ms": 14593.595, "update_time_ms": 10.913, "default": {"vf_loss": 20.481264114379883, "vf_explained_var": 0.5724697113037109, "entropy": 1.2660890817642212, "total_loss": 20.481212615966797, "cur_lr": 0.0005000000237487257, "kl": 0.005322057753801346, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0005841252277605236}, "load_time_ms": 8.856, "num_steps_trained": 1498120}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 628.4259721472009, "episodes_this_iter": 61, "timesteps_this_iter": 111876, "hostname": "flow-main"}
{"episode_reward_mean": 704.6754670666821, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1607590, "custom_metrics": {"cost2_min": -164.5848060453118, "system_level_velocity_min": 9.73536401900268, "system_level_velocity_max": 15.064109198611462, "outflow_rate_min": 817.1657895602541, "cost1_max": 400.3362251345711, "cost1_min": 258.7316121917925, "cost2_max": -105.59874455555698, "outflow_rate_mean": 891.9009823866835, "outflow_rate_max": 995.6816036574945, "cost1_mean": 321.8985566355428, "system_level_velocity_mean": 12.106567479769158, "cost2_mean": -133.15144643477325}, "time_total_s": 544.1539521217346, "time_since_restore": 544.1539521217346, "pid": 45627, "date": "2019-04-26_09-16-24", "timesteps_total": 1607590, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f82e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8828>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270184, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 751, "episode_reward_max": 780.008070092132, "time_this_iter_s": 35.1124153137207, "training_iteration": 14, "info": {"num_steps_sampled": 1607590, "grad_time_ms": 21253.659, "sample_time_ms": 14541.924, "update_time_ms": 10.876, "default": {"vf_loss": 20.506275177001953, "vf_explained_var": 0.546910285949707, "entropy": 1.2540704011917114, "total_loss": 20.506149291992188, "cur_lr": 0.0005000000237487257, "kl": 0.006704861763864756, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007970602018758655}, "load_time_ms": 8.49, "num_steps_trained": 1607590}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 630.6528017167261, "episodes_this_iter": 59, "timesteps_this_iter": 109470, "hostname": "flow-main"}
{"episode_reward_mean": 699.1126693376452, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1718393, "custom_metrics": {"cost2_min": -160.25056083654943, "system_level_velocity_min": 9.718699248828548, "system_level_velocity_max": 15.076245558032845, "outflow_rate_min": 814.9578268059572, "cost1_max": 400.3362251345711, "cost1_min": 255.9032241943306, "cost2_max": -105.59874455555698, "outflow_rate_mean": 886.3276419356566, "outflow_rate_max": 995.6816036574945, "cost1_mean": 323.5583722374855, "system_level_velocity_mean": 12.211164755686971, "cost2_mean": -129.52990795102335}, "time_total_s": 579.5771355628967, "time_since_restore": 579.5771355628967, "pid": 45627, "date": "2019-04-26_09-16-59", "timesteps_total": 1718393, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6470>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270219, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 811, "episode_reward_max": 780.1432240117182, "time_this_iter_s": 35.42318344116211, "training_iteration": 15, "info": {"num_steps_sampled": 1718393, "grad_time_ms": 21054.086, "sample_time_ms": 14524.069, "update_time_ms": 10.849, "default": {"vf_loss": 21.988182067871094, "vf_explained_var": 0.5448793172836304, "entropy": 1.24750554561615, "total_loss": 21.98773765563965, "cur_lr": 0.0005000000237487257, "kl": 0.006134606432169676, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00105826067738235}, "load_time_ms": 8.467, "num_steps_trained": 1718393}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 627.5346970923899, "episodes_this_iter": 60, "timesteps_this_iter": 110803, "hostname": "flow-main"}
{"episode_reward_mean": 694.7378568350983, "policy_reward_mean": {}, "episode_len_mean": 696.87, "timesteps_since_restore": 1826594, "custom_metrics": {"cost2_min": -160.25056083654943, "system_level_velocity_min": 9.718699248828548, "system_level_velocity_max": 15.20021567895133, "outflow_rate_min": 790.7325113581792, "cost1_max": 401.0260953762319, "cost1_min": 213.67598952037497, "cost2_max": -96.63157789744017, "outflow_rate_mean": 883.6194355661589, "outflow_rate_max": 991.588139369769, "cost1_mean": 326.7110096077247, "system_level_velocity_mean": 12.436771723858591, "cost2_mean": -124.43927553326452}, "time_total_s": 612.1297886371613, "time_since_restore": 612.1297886371613, "pid": 45627, "date": "2019-04-26_09-17-32", "timesteps_total": 1826594, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8be0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270252, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 871, "episode_reward_max": 780.1432240117182, "time_this_iter_s": 32.552653074264526, "training_iteration": 16, "info": {"num_steps_sampled": 1826594, "grad_time_ms": 20890.286, "sample_time_ms": 14493.944, "update_time_ms": 10.837, "default": {"vf_loss": 23.844696044921875, "vf_explained_var": 0.45487046241760254, "entropy": 1.2341282367706299, "total_loss": 23.844308853149414, "cur_lr": 0.0005000000237487257, "kl": 0.006820503622293472, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0010679925326257944}, "load_time_ms": 8.208, "num_steps_trained": 1826594}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 429.204297581081, "episodes_this_iter": 60, "timesteps_this_iter": 108201, "hostname": "flow-main"}
{"episode_reward_mean": 694.3607022493433, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 1933670, "custom_metrics": {"cost2_min": -140.87138854733178, "system_level_velocity_min": 9.987244148410952, "system_level_velocity_max": 15.20021567895133, "outflow_rate_min": 816.9422922600705, "cost1_max": 401.0260953762319, "cost1_min": 265.39322412747447, "cost2_max": -93.72979696834709, "outflow_rate_mean": 878.7228677793692, "outflow_rate_max": 977.1504694604357, "cost1_mean": 332.54750797362743, "system_level_velocity_mean": 12.624043893034607, "cost2_mean": -117.14848971801501}, "time_total_s": 645.3216562271118, "time_since_restore": 645.3216562271118, "pid": 45627, "date": "2019-04-26_09-18-05", "timesteps_total": 1933670, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66d8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270285, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 932, "episode_reward_max": 768.9494557961955, "time_this_iter_s": 33.19186758995056, "training_iteration": 17, "info": {"num_steps_sampled": 1933670, "grad_time_ms": 20565.217, "sample_time_ms": 14316.591, "update_time_ms": 10.929, "default": {"vf_loss": 24.087495803833008, "vf_explained_var": 0.39975690841674805, "entropy": 1.2250497341156006, "total_loss": 24.087425231933594, "cur_lr": 0.0005000000237487257, "kl": 0.007115407846868038, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007808163063600659}, "load_time_ms": 8.018, "num_steps_trained": 1933670}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 623.843071900397, "episodes_this_iter": 61, "timesteps_this_iter": 107076, "hostname": "flow-main"}
{"episode_reward_mean": 688.3915766404357, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2042003, "custom_metrics": {"cost2_min": -138.65790029902973, "system_level_velocity_min": 10.072580123357218, "system_level_velocity_max": 15.097713514651785, "outflow_rate_min": 809.762530291178, "cost1_max": 398.0277807548646, "cost1_min": 265.43251000622627, "cost2_max": -95.79406331371216, "outflow_rate_mean": 866.2883720810933, "outflow_rate_max": 961.6014722439168, "cost1_mean": 326.16334887063545, "system_level_velocity_mean": 12.374718731275859, "cost2_mean": -116.02833326748804}, "time_total_s": 680.853568315506, "time_since_restore": 680.853568315506, "pid": 45627, "date": "2019-04-26_09-18-41", "timesteps_total": 2042003, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8dd8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270321, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 992, "episode_reward_max": 758.528183655476, "time_this_iter_s": 35.531912088394165, "training_iteration": 18, "info": {"num_steps_sampled": 2042003, "grad_time_ms": 20506.352, "sample_time_ms": 14249.015, "update_time_ms": 10.621, "default": {"vf_loss": 25.130495071411133, "vf_explained_var": 0.3761642277240753, "entropy": 1.2153170108795166, "total_loss": 25.13038444519043, "cur_lr": 0.0005000000237487257, "kl": 0.006577754393219948, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007691727369092405}, "load_time_ms": 7.832, "num_steps_trained": 2042003}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 614.4905390796815, "episodes_this_iter": 60, "timesteps_this_iter": 108333, "hostname": "flow-main"}
{"episode_reward_mean": 680.5407150385686, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2149898, "custom_metrics": {"cost2_min": -135.32893320700015, "system_level_velocity_min": 10.241799051024508, "system_level_velocity_max": 14.457217195622881, "outflow_rate_min": 809.1425248970155, "cost1_max": 383.00840193737343, "cost1_min": 268.55179439387246, "cost2_max": -95.79406331371216, "outflow_rate_mean": 862.0881308417434, "outflow_rate_max": 947.1547841409883, "cost1_mean": 324.04695790739896, "system_level_velocity_mean": 12.267672647244137, "cost2_mean": -115.16075768016053}, "time_total_s": 715.6579146385193, "time_since_restore": 715.6579146385193, "pid": 45627, "date": "2019-04-26_09-19-15", "timesteps_total": 2149898, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e10>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270355, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1054, "episode_reward_max": 758.528183655476, "time_this_iter_s": 34.804346323013306, "training_iteration": 19, "info": {"num_steps_sampled": 2149898, "grad_time_ms": 20298.949, "sample_time_ms": 14241.978, "update_time_ms": 10.615, "default": {"vf_loss": 24.028627395629883, "vf_explained_var": 0.3441125750541687, "entropy": 1.20866858959198, "total_loss": 24.028900146484375, "cur_lr": 0.0005000000237487257, "kl": 0.007133697159588337, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0004378697485662997}, "load_time_ms": 8.146, "num_steps_trained": 2149898}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 619.0038745599899, "episodes_this_iter": 62, "timesteps_this_iter": 107895, "hostname": "flow-main"}
{"episode_reward_mean": 680.715662979008, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2260109, "custom_metrics": {"cost2_min": -137.34185354045127, "system_level_velocity_min": 9.975013595375948, "system_level_velocity_max": 14.588514094974068, "outflow_rate_min": 802.0563183413989, "cost1_max": 386.23487775130025, "cost1_min": 263.2010324321136, "cost2_max": -93.41985585694542, "outflow_rate_mean": 857.1461236766961, "outflow_rate_max": 962.1629632925975, "cost1_mean": 317.8204673455109, "system_level_velocity_mean": 12.049885690905523, "cost2_mean": -114.28191817271798}, "time_total_s": 751.1461162567139, "time_since_restore": 751.1461162567139, "pid": 45627, "date": "2019-04-26_09-19-51", "timesteps_total": 2260109, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8940>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270391, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1114, "episode_reward_max": 768.2121278123042, "time_this_iter_s": 35.48820161819458, "training_iteration": 20, "info": {"num_steps_sampled": 2260109, "grad_time_ms": 20295.493, "sample_time_ms": 14278.798, "update_time_ms": 10.517, "default": {"vf_loss": 25.136337280273438, "vf_explained_var": 0.4169536828994751, "entropy": 1.2005665302276611, "total_loss": 25.136646270751953, "cur_lr": 0.0005000000237487257, "kl": 0.006806375924497843, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00037219052319414914}, "load_time_ms": 8.209, "num_steps_trained": 2260109}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 610.2266905143673, "episodes_this_iter": 60, "timesteps_this_iter": 110211, "hostname": "flow-main"}
{"episode_reward_mean": 701.2920999901055, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2371707, "custom_metrics": {"cost2_min": -141.06171416098647, "system_level_velocity_min": 9.598195420379714, "system_level_velocity_max": 15.07562701989868, "outflow_rate_min": 802.0563183413989, "cost1_max": 399.27939172416626, "cost1_min": 253.11422755930022, "cost2_max": -91.65908146021485, "outflow_rate_mean": 871.1814098613137, "outflow_rate_max": 988.357947402694, "cost1_mean": 315.1890695681726, "system_level_velocity_mean": 11.940960024335999, "cost2_mean": -115.14115664929794}, "time_total_s": 789.0266098976135, "time_since_restore": 789.0266098976135, "pid": 45627, "date": "2019-04-26_09-20-29", "timesteps_total": 2371707, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6748>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270429, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1175, "episode_reward_max": 800.3827082661433, "time_this_iter_s": 37.88049364089966, "training_iteration": 21, "info": {"num_steps_sampled": 2371707, "grad_time_ms": 20425.463, "sample_time_ms": 14229.126, "update_time_ms": 10.504, "default": {"vf_loss": 27.250762939453125, "vf_explained_var": 0.4650394320487976, "entropy": 1.2035248279571533, "total_loss": 27.250751495361328, "cur_lr": 0.0005000000237487257, "kl": 0.006756519433110952, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0006872821832075715}, "load_time_ms": 8.183, "num_steps_trained": 2371707}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 610.2266905143673, "episodes_this_iter": 61, "timesteps_this_iter": 111598, "hostname": "flow-main"}
{"episode_reward_mean": 715.0907356070949, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2484998, "custom_metrics": {"cost2_min": -141.06171416098647, "system_level_velocity_min": 9.598195420379714, "system_level_velocity_max": 15.532221897263765, "outflow_rate_min": 818.638694166346, "cost1_max": 409.7169725682264, "cost1_min": 253.11422755930022, "cost2_max": -91.65908146021485, "outflow_rate_mean": 884.284149075861, "outflow_rate_max": 1023.6727320544195, "cost1_mean": 313.4859227104118, "system_level_velocity_mean": 11.851704704939426, "cost2_mean": -114.1531149171811}, "time_total_s": 824.6240320205688, "time_since_restore": 824.6240320205688, "pid": 45627, "date": "2019-04-26_09-21-04", "timesteps_total": 2484998, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f80b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8ba8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270464, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1232, "episode_reward_max": 811.6865983208249, "time_this_iter_s": 35.59742212295532, "training_iteration": 22, "info": {"num_steps_sampled": 2484998, "grad_time_ms": 20448.524, "sample_time_ms": 14256.906, "update_time_ms": 10.516, "default": {"vf_loss": 25.8288516998291, "vf_explained_var": 0.5297046303749084, "entropy": 1.2025293111801147, "total_loss": 25.828641891479492, "cur_lr": 0.0005000000237487257, "kl": 0.0070980871096253395, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00092030328232795}, "load_time_ms": 8.197, "num_steps_trained": 2484998}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 637.1643819107514, "episodes_this_iter": 57, "timesteps_this_iter": 113291, "hostname": "flow-main"}
{"episode_reward_mean": 712.9620774162463, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2598956, "custom_metrics": {"cost2_min": -135.6059475152347, "system_level_velocity_min": 9.219029704266868, "system_level_velocity_max": 15.532221897263765, "outflow_rate_min": 809.9276850761704, "cost1_max": 409.7169725682264, "cost1_min": 245.8665044681892, "cost2_max": -93.23440095846355, "outflow_rate_mean": 881.7955976352608, "outflow_rate_max": 1023.6727320544195, "cost1_mean": 303.5416803803237, "system_level_velocity_mean": 11.475304777330985, "cost2_mean": -113.15285599801375}, "time_total_s": 861.2711563110352, "time_since_restore": 861.2711563110352, "pid": 45627, "date": "2019-04-26_09-21-41", "timesteps_total": 2598956, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b6d8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270501, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1288, "episode_reward_max": 811.6865983208249, "time_this_iter_s": 36.64712429046631, "training_iteration": 23, "info": {"num_steps_sampled": 2598956, "grad_time_ms": 20738.823, "sample_time_ms": 14268.796, "update_time_ms": 10.441, "default": {"vf_loss": 25.023902893066406, "vf_explained_var": 0.564834475517273, "entropy": 1.1924256086349487, "total_loss": 25.0240478515625, "cur_lr": 0.0005000000237487257, "kl": 0.00614458043128252, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00046825624303892255}, "load_time_ms": 8.176, "num_steps_trained": 2598956}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 637.1643819107514, "episodes_this_iter": 56, "timesteps_this_iter": 113958, "hostname": "flow-main"}
{"episode_reward_mean": 711.497006104853, "policy_reward_mean": {}, "episode_len_mean": 695.97, "timesteps_since_restore": 2714822, "custom_metrics": {"cost2_min": -135.6059475152347, "system_level_velocity_min": 9.219029704266868, "system_level_velocity_max": 15.587033160562967, "outflow_rate_min": 804.071278013185, "cost1_max": 397.76618698481315, "cost1_min": 172.83581168799986, "cost2_max": -77.25991143965884, "outflow_rate_mean": 883.2188109755687, "outflow_rate_max": 1005.8338427167438, "cost1_mean": 300.3299277250037, "system_level_velocity_mean": 11.435163722680327, "cost2_mean": -113.6795723489233}, "time_total_s": 900.4528448581696, "time_since_restore": 900.4528448581696, "pid": 45627, "date": "2019-04-26_09-22-20", "timesteps_total": 2714822, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219045c0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270540, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1339, "episode_reward_max": 808.6426462436013, "time_this_iter_s": 39.1816885471344, "training_iteration": 24, "info": {"num_steps_sampled": 2714822, "grad_time_ms": 21095.978, "sample_time_ms": 14317.252, "update_time_ms": 10.525, "default": {"vf_loss": 23.183542251586914, "vf_explained_var": 0.5962662100791931, "entropy": 1.1890405416488647, "total_loss": 23.183439254760742, "cur_lr": 0.0005000000237487257, "kl": 0.0067344242706894875, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007792957476340234}, "load_time_ms": 8.27, "num_steps_trained": 2714822}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 338.62457602859246, "episodes_this_iter": 51, "timesteps_this_iter": 115866, "hostname": "flow-main"}
{"episode_reward_mean": 703.3114112811468, "policy_reward_mean": {}, "episode_len_mean": 695.97, "timesteps_since_restore": 2831494, "custom_metrics": {"cost2_min": -132.15088762926575, "system_level_velocity_min": 9.058731107222359, "system_level_velocity_max": 15.587033160562967, "outflow_rate_min": 804.071278013185, "cost1_max": 397.3663717962594, "cost1_min": 172.83581168799986, "cost2_max": -77.25991143965884, "outflow_rate_mean": 876.5176365618032, "outflow_rate_max": 1018.244003395974, "cost1_mean": 292.23510852882936, "system_level_velocity_mean": 11.12707907441021, "cost2_mean": -112.4759820358723}, "time_total_s": 937.776505947113, "time_since_restore": 937.776505947113, "pid": 45627, "date": "2019-04-26_09-22-58", "timesteps_total": 2831494, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904d30>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270578, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1390, "episode_reward_max": 828.2157834326498, "time_this_iter_s": 37.32366108894348, "training_iteration": 25, "info": {"num_steps_sampled": 2831494, "grad_time_ms": 21263.864, "sample_time_ms": 14335.367, "update_time_ms": 10.602, "default": {"vf_loss": 21.80328369140625, "vf_explained_var": 0.6344265937805176, "entropy": 1.1945141553878784, "total_loss": 21.80278778076172, "cur_lr": 0.0005000000237487257, "kl": 0.006711190100759268, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0011661634780466557}, "load_time_ms": 8.131, "num_steps_trained": 2831494}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 338.62457602859246, "episodes_this_iter": 51, "timesteps_this_iter": 116672, "hostname": "flow-main"}
{"episode_reward_mean": 702.1327976238053, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 2949320, "custom_metrics": {"cost2_min": -143.08775790580776, "system_level_velocity_min": 9.058731107222359, "system_level_velocity_max": 15.038795445750427, "outflow_rate_min": 812.7209352537974, "cost1_max": 397.3663717962594, "cost1_min": 242.37999405554362, "cost2_max": -80.67092831340621, "outflow_rate_mean": 871.1153824851685, "outflow_rate_max": 1018.244003395974, "cost1_mean": 284.21819481359347, "system_level_velocity_mean": 10.720568957835937, "cost2_mean": -111.67319138511712}, "time_total_s": 974.6416094303131, "time_since_restore": 974.6416094303131, "pid": 45627, "date": "2019-04-26_09-23-35", "timesteps_total": 2949320, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f67f0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270615, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1442, "episode_reward_max": 828.2157834326498, "time_this_iter_s": 36.86510348320007, "training_iteration": 26, "info": {"num_steps_sampled": 2949320, "grad_time_ms": 21636.454, "sample_time_ms": 14392.279, "update_time_ms": 10.499, "default": {"vf_loss": 23.484277725219727, "vf_explained_var": 0.6106564998626709, "entropy": 1.186851143836975, "total_loss": 23.48387336730957, "cur_lr": 0.0005000000237487257, "kl": 0.007435372564941645, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011450485326349735}, "load_time_ms": 8.369, "num_steps_trained": 2949320}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 634.4997081250006, "episodes_this_iter": 52, "timesteps_this_iter": 117826, "hostname": "flow-main"}
{"episode_reward_mean": 705.7385105311384, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 3066794, "custom_metrics": {"cost2_min": -143.08775790580776, "system_level_velocity_min": 9.180649095827318, "system_level_velocity_max": 14.152304483027814, "outflow_rate_min": 816.6949818754566, "cost1_max": 373.91418323321324, "cost1_min": 242.6022071352391, "cost2_max": -87.02616770438937, "outflow_rate_mean": 871.3756761752904, "outflow_rate_max": 999.9526031419474, "cost1_mean": 281.4731390436847, "system_level_velocity_mean": 10.61792713862412, "cost2_mean": -112.58014091722065}, "time_total_s": 1012.7869095802307, "time_since_restore": 1012.7869095802307, "pid": 45627, "date": "2019-04-26_09-24-13", "timesteps_total": 3066794, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f87b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8630>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270653, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1490, "episode_reward_max": 778.5747609523352, "time_this_iter_s": 38.1453001499176, "training_iteration": 27, "info": {"num_steps_sampled": 3066794, "grad_time_ms": 22010.358, "sample_time_ms": 14512.68, "update_time_ms": 10.458, "default": {"vf_loss": 21.520366668701172, "vf_explained_var": 0.6413968801498413, "entropy": 1.1871246099472046, "total_loss": 21.52043914794922, "cur_lr": 0.0005000000237487257, "kl": 0.006612904369831085, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0005892805056646466}, "load_time_ms": 8.753, "num_steps_trained": 3066794}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 649.5355652819958, "episodes_this_iter": 48, "timesteps_this_iter": 117474, "hostname": "flow-main"}
{"episode_reward_mean": 700.5981111948723, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 3182991, "custom_metrics": {"cost2_min": -127.40109946776725, "system_level_velocity_min": 9.048734477577346, "system_level_velocity_max": 15.020918097327536, "outflow_rate_min": 815.2595111978948, "cost1_max": 391.99367464467616, "cost1_min": 239.81906049382593, "cost2_max": -86.7740091887896, "outflow_rate_mean": 868.9247815498078, "outflow_rate_max": 1047.6545330021584, "cost1_mean": 278.592422546202, "system_level_velocity_mean": 10.537484554190161, "cost2_mean": -111.64736453472659}, "time_total_s": 1050.4019348621368, "time_since_restore": 1050.4019348621368, "pid": 45627, "date": "2019-04-26_09-24-50", "timesteps_total": 3182991, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904860>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270690, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1543, "episode_reward_max": 784.7559976518864, "time_this_iter_s": 37.61502528190613, "training_iteration": 28, "info": {"num_steps_sampled": 3182991, "grad_time_ms": 22132.102, "sample_time_ms": 14598.766, "update_time_ms": 10.382, "default": {"vf_loss": 23.81189727783203, "vf_explained_var": 0.6417925357818604, "entropy": 1.1778099536895752, "total_loss": 23.81208610534668, "cur_lr": 0.0005000000237487257, "kl": 0.0063312179408967495, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0004459284245967865}, "load_time_ms": 8.779, "num_steps_trained": 3182991}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 646.9747998581828, "episodes_this_iter": 53, "timesteps_this_iter": 116197, "hostname": "flow-main"}
{"episode_reward_mean": 700.6977365896882, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 3297527, "custom_metrics": {"cost2_min": -128.52552823040406, "system_level_velocity_min": 9.120947172306453, "system_level_velocity_max": 15.806831921046703, "outflow_rate_min": 815.8414961816837, "cost1_max": 406.96932015947095, "cost1_min": 242.0612368348299, "cost2_max": -86.7740091887896, "outflow_rate_mean": 872.0150038138569, "outflow_rate_max": 1047.6545330021584, "cost1_mean": 283.26167209873057, "system_level_velocity_mean": 10.740670074819732, "cost2_mean": -109.8661933621442}, "time_total_s": 1086.4319460391998, "time_since_restore": 1086.4319460391998, "pid": 45627, "date": "2019-04-26_09-25-26", "timesteps_total": 3297527, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f86d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f80f0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270726, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1600, "episode_reward_max": 789.5144622459468, "time_this_iter_s": 36.03001117706299, "training_iteration": 29, "info": {"num_steps_sampled": 3297527, "grad_time_ms": 22218.8, "sample_time_ms": 14636.184, "update_time_ms": 10.509, "default": {"vf_loss": 26.145715713500977, "vf_explained_var": 0.6420766115188599, "entropy": 1.1700873374938965, "total_loss": 26.145946502685547, "cur_lr": 0.0005000000237487257, "kl": 0.006348523311316967, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00040224575786851346}, "load_time_ms": 8.488, "num_steps_trained": 3297527}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 640.740990844463, "episodes_this_iter": 57, "timesteps_this_iter": 114536, "hostname": "flow-main"}
{"episode_reward_mean": 694.5349536654732, "policy_reward_mean": {}, "episode_len_mean": 695.97, "timesteps_since_restore": 3413119, "custom_metrics": {"cost2_min": -134.88553408550365, "system_level_velocity_min": 9.237557267144314, "system_level_velocity_max": 16.37090201331012, "outflow_rate_min": 816.5140966953763, "cost1_max": 406.96932015947095, "cost1_min": 177.43808703978314, "cost2_max": -89.89902285720116, "outflow_rate_mean": 870.7294284637879, "outflow_rate_max": 1042.8635339997522, "cost1_mean": 282.91457291319244, "system_level_velocity_mean": 10.835011902887665, "cost2_mean": -110.24234604291387}, "time_total_s": 1120.751748085022, "time_since_restore": 1120.751748085022, "pid": 45627, "date": "2019-04-26_09-26-01", "timesteps_total": 3413119, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8860>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270761, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1655, "episode_reward_max": 789.5144622459468, "time_this_iter_s": 34.319802045822144, "training_iteration": 30, "info": {"num_steps_sampled": 3413119, "grad_time_ms": 22126.468, "sample_time_ms": 14610.721, "update_time_ms": 10.684, "default": {"vf_loss": 25.645132064819336, "vf_explained_var": 0.6487331390380859, "entropy": 1.1693016290664673, "total_loss": 25.64545249938965, "cur_lr": 0.0005000000237487257, "kl": 0.006042940076440573, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00028411680250428617}, "load_time_ms": 8.375, "num_steps_trained": 3413119}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 329.588973542387, "episodes_this_iter": 55, "timesteps_this_iter": 115592, "hostname": "flow-main"}
{"episode_reward_mean": 700.9881942033535, "policy_reward_mean": {}, "episode_len_mean": 695.97, "timesteps_since_restore": 3530654, "custom_metrics": {"cost2_min": -137.40302332866332, "system_level_velocity_min": 9.245016503972783, "system_level_velocity_max": 16.37090201331012, "outflow_rate_min": 817.3810406483547, "cost1_max": 417.3814999769752, "cost1_min": 177.43808703978314, "cost2_max": -89.89902285720116, "outflow_rate_mean": 879.9143852372049, "outflow_rate_max": 1051.711491237971, "cost1_mean": 286.68320508589665, "system_level_velocity_mean": 10.970285019237984, "cost2_mean": -112.59119768315044}, "time_total_s": 1158.0497279167175, "time_since_restore": 1158.0497279167175, "pid": 45627, "date": "2019-04-26_09-26-38", "timesteps_total": 3530654, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8ef0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270798, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1705, "episode_reward_max": 781.8406978006411, "time_this_iter_s": 37.29797983169556, "training_iteration": 31, "info": {"num_steps_sampled": 3530654, "grad_time_ms": 22100.414, "sample_time_ms": 14577.603, "update_time_ms": 10.724, "default": {"vf_loss": 23.61972427368164, "vf_explained_var": 0.6834853887557983, "entropy": 1.1594514846801758, "total_loss": 23.619707107543945, "cur_lr": 0.0005000000237487257, "kl": 0.007308152969926596, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007483294466510415}, "load_time_ms": 8.537, "num_steps_trained": 3530654}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 329.588973542387, "episodes_this_iter": 50, "timesteps_this_iter": 117535, "hostname": "flow-main"}
{"episode_reward_mean": 709.308213999536, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 3649124, "custom_metrics": {"cost2_min": -137.40302332866332, "system_level_velocity_min": 9.178079741974765, "system_level_velocity_max": 16.90337694436083, "outflow_rate_min": 811.3109040298847, "cost1_max": 426.35975825240075, "cost1_min": 242.28287792212444, "cost2_max": -93.9555082086777, "outflow_rate_mean": 886.03905365427, "outflow_rate_max": 1085.3072903886077, "cost1_mean": 288.50169903281096, "system_level_velocity_mean": 10.947950778446073, "cost2_mean": -113.29433403190149}, "time_total_s": 1197.0031843185425, "time_since_restore": 1197.0031843185425, "pid": 45627, "date": "2019-04-26_09-27-17", "timesteps_total": 3649124, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f84e0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270837, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1755, "episode_reward_max": 805.7094001135057, "time_this_iter_s": 38.95345640182495, "training_iteration": 32, "info": {"num_steps_sampled": 3649124, "grad_time_ms": 22420.119, "sample_time_ms": 14589.158, "update_time_ms": 13.149, "default": {"vf_loss": 23.87969970703125, "vf_explained_var": 0.6890403032302856, "entropy": 1.1503692865371704, "total_loss": 23.880067825317383, "cur_lr": 0.0005000000237487257, "kl": 0.005708370823413134, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00020663526083808392}, "load_time_ms": 8.729, "num_steps_trained": 3649124}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 647.4509403565019, "episodes_this_iter": 50, "timesteps_this_iter": 118470, "hostname": "flow-main"}
{"episode_reward_mean": 704.025695964664, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 3769285, "custom_metrics": {"cost2_min": -136.16872868586788, "system_level_velocity_min": 8.881773593230578, "system_level_velocity_max": 16.90337694436083, "outflow_rate_min": 811.2961591009654, "cost1_max": 426.35975825240075, "cost1_min": 236.0204330130951, "cost2_max": -94.94555789419582, "outflow_rate_mean": 878.9823237033997, "outflow_rate_max": 1085.3072903886077, "cost1_mean": 280.81129805403145, "system_level_velocity_mean": 10.652850271958178, "cost2_mean": -111.7079105008445}, "time_total_s": 1233.589507341385, "time_since_restore": 1233.589507341385, "pid": 45627, "date": "2019-04-26_09-27-54", "timesteps_total": 3769285, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8208>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270874, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1805, "episode_reward_max": 805.7094001135057, "time_this_iter_s": 36.58632302284241, "training_iteration": 33, "info": {"num_steps_sampled": 3769285, "grad_time_ms": 22486.237, "sample_time_ms": 14519.944, "update_time_ms": 13.244, "default": {"vf_loss": 23.221973419189453, "vf_explained_var": 0.6723945736885071, "entropy": 1.1534419059753418, "total_loss": 23.222185134887695, "cur_lr": 0.0005000000237487257, "kl": 0.007153782993555069, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0005044058780185878}, "load_time_ms": 8.801, "num_steps_trained": 3769285}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 643.6499228069209, "episodes_this_iter": 50, "timesteps_this_iter": 120161, "hostname": "flow-main"}
{"episode_reward_mean": 708.3369499193867, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 3887720, "custom_metrics": {"cost2_min": -123.41714465073663, "system_level_velocity_min": 8.881773593230578, "system_level_velocity_max": 15.421432966157692, "outflow_rate_min": 811.2961591009654, "cost1_max": 403.33777571615377, "cost1_min": 236.0204330130951, "cost2_max": -91.26264617011165, "outflow_rate_mean": 877.473191635135, "outflow_rate_max": 1059.6906102421692, "cost1_mean": 277.01914017193104, "system_level_velocity_mean": 10.485239540599462, "cost2_mean": -110.03207390771712}, "time_total_s": 1269.117280960083, "time_since_restore": 1269.117280960083, "pid": 45627, "date": "2019-04-26_09-28-29", "timesteps_total": 3887720, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f84e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f89b0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270909, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1853, "episode_reward_max": 809.7201588188447, "time_this_iter_s": 35.52777361869812, "training_iteration": 34, "info": {"num_steps_sampled": 3887720, "grad_time_ms": 22166.948, "sample_time_ms": 14473.044, "update_time_ms": 13.111, "default": {"vf_loss": 23.22197151184082, "vf_explained_var": 0.681668758392334, "entropy": 1.1368129253387451, "total_loss": 23.222122192382812, "cur_lr": 0.0005000000237487257, "kl": 0.006723163649439812, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0005225063650868833}, "load_time_ms": 8.802, "num_steps_trained": 3887720}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 643.6499228069209, "episodes_this_iter": 48, "timesteps_this_iter": 118435, "hostname": "flow-main"}
{"episode_reward_mean": 710.8370816317386, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4005429, "custom_metrics": {"cost2_min": -125.61522113018036, "system_level_velocity_min": 9.017772293121528, "system_level_velocity_max": 16.18266637920215, "outflow_rate_min": 820.779624993433, "cost1_max": 416.10678470823274, "cost1_min": 238.9630084089584, "cost2_max": -90.03256601497067, "outflow_rate_mean": 879.0932842748016, "outflow_rate_max": 1072.763644042831, "cost1_mean": 277.16775675836385, "system_level_velocity_mean": 10.494375350225523, "cost2_mean": -110.01545774077503}, "time_total_s": 1301.9603464603424, "time_since_restore": 1301.9603464603424, "pid": 45627, "date": "2019-04-26_09-29-02", "timesteps_total": 4005429, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8a20>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270942, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1905, "episode_reward_max": 809.7201588188447, "time_this_iter_s": 32.8430655002594, "training_iteration": 35, "info": {"num_steps_sampled": 4005429, "grad_time_ms": 21818.04, "sample_time_ms": 14373.48, "update_time_ms": 13.14, "default": {"vf_loss": 24.36381721496582, "vf_explained_var": 0.6616453528404236, "entropy": 1.1370478868484497, "total_loss": 24.364229202270508, "cur_lr": 0.0005000000237487257, "kl": 0.007234041579067707, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00031131174182519317}, "load_time_ms": 8.83, "num_steps_trained": 4005429}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 633.3895855565673, "episodes_this_iter": 52, "timesteps_this_iter": 117709, "hostname": "flow-main"}
{"episode_reward_mean": 701.4450989756394, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4123252, "custom_metrics": {"cost2_min": -142.416555094138, "system_level_velocity_min": 9.011877048791586, "system_level_velocity_max": 13.662510568726411, "outflow_rate_min": 822.0445910054802, "cost1_max": 358.0938252405664, "cost1_min": 238.26551050092246, "cost2_max": -88.45177760755173, "outflow_rate_mean": 871.2168869994198, "outflow_rate_max": 1004.1047102772759, "cost1_mean": 272.49006625024384, "system_level_velocity_mean": 10.330452228039965, "cost2_mean": -109.67471325087989}, "time_total_s": 1336.9280683994293, "time_since_restore": 1336.9280683994293, "pid": 45627, "date": "2019-04-26_09-29-37", "timesteps_total": 4123252, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219044e0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556270977, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 1959, "episode_reward_max": 784.7452584550505, "time_this_iter_s": 34.967721939086914, "training_iteration": 36, "info": {"num_steps_sampled": 4123252, "grad_time_ms": 21695.738, "sample_time_ms": 14305.702, "update_time_ms": 13.169, "default": {"vf_loss": 26.368392944335938, "vf_explained_var": 0.6547689437866211, "entropy": 1.1334648132324219, "total_loss": 26.368375778198242, "cur_lr": 0.0005000000237487257, "kl": 0.006649806629866362, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0006826351745985448}, "load_time_ms": 8.65, "num_steps_trained": 4123252}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 633.3895855565673, "episodes_this_iter": 54, "timesteps_this_iter": 117823, "hostname": "flow-main"}
{"episode_reward_mean": 698.4887742057105, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4241703, "custom_metrics": {"cost2_min": -142.416555094138, "system_level_velocity_min": 9.011877048791586, "system_level_velocity_max": 15.496363112691943, "outflow_rate_min": 820.6244451514855, "cost1_max": 401.1549129504548, "cost1_min": 238.26551050092246, "cost2_max": -88.45177760755173, "outflow_rate_mean": 876.7696803033207, "outflow_rate_max": 1077.6230196000454, "cost1_mean": 276.08143278848553, "system_level_velocity_mean": 10.488909033657597, "cost2_mean": -112.3019237739764}, "time_total_s": 1373.9171669483185, "time_since_restore": 1373.9171669483185, "pid": 45627, "date": "2019-04-26_09-30-14", "timesteps_total": 4241703, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190d438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190d400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190d470>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271014, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2010, "episode_reward_max": 796.180345308705, "time_this_iter_s": 36.98909854888916, "training_iteration": 37, "info": {"num_steps_sampled": 4241703, "grad_time_ms": 21723.383, "sample_time_ms": 14160.102, "update_time_ms": 13.428, "default": {"vf_loss": 25.427635192871094, "vf_explained_var": 0.6698446869850159, "entropy": 1.1221083402633667, "total_loss": 25.427919387817383, "cur_lr": 0.0005000000237487257, "kl": 0.007246711291372776, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00044110382441431284}, "load_time_ms": 8.643, "num_steps_trained": 4241703}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 638.0808793555774, "episodes_this_iter": 51, "timesteps_this_iter": 118451, "hostname": "flow-main"}
{"episode_reward_mean": 699.7327066855183, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4360531, "custom_metrics": {"cost2_min": -141.4097190040958, "system_level_velocity_min": 9.154782780787121, "system_level_velocity_max": 16.237322782508556, "outflow_rate_min": 820.6244451514855, "cost1_max": 415.8966669292922, "cost1_min": 240.81534286618714, "cost2_max": -94.6108242499962, "outflow_rate_mean": 884.8544937628915, "outflow_rate_max": 1091.6175941542167, "cost1_mean": 279.5228664738646, "system_level_velocity_mean": 10.635174077138581, "cost2_mean": -114.68401295953278}, "time_total_s": 1411.2474648952484, "time_since_restore": 1411.2474648952484, "pid": 45627, "date": "2019-04-26_09-30-51", "timesteps_total": 4360531, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8588>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271051, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2059, "episode_reward_max": 796.180345308705, "time_this_iter_s": 37.33029794692993, "training_iteration": 38, "info": {"num_steps_sampled": 4360531, "grad_time_ms": 21795.748, "sample_time_ms": 14059.485, "update_time_ms": 13.808, "default": {"vf_loss": 23.932268142700195, "vf_explained_var": 0.6764392852783203, "entropy": 1.1218122243881226, "total_loss": 23.932111740112305, "cur_lr": 0.0005000000237487257, "kl": 0.007115217857062817, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0008683972992002964}, "load_time_ms": 8.627, "num_steps_trained": 4360531}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 638.0808793555774, "episodes_this_iter": 49, "timesteps_this_iter": 118828, "hostname": "flow-main"}
{"episode_reward_mean": 702.4398773858292, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4478978, "custom_metrics": {"cost2_min": -141.4097190040958, "system_level_velocity_min": 9.134704144016185, "system_level_velocity_max": 16.237322782508556, "outflow_rate_min": 820.5105964748499, "cost1_max": 415.8966669292922, "cost1_min": 240.22807379100212, "cost2_max": -85.10757370476895, "outflow_rate_mean": 880.8682153790405, "outflow_rate_max": 1091.7769989419905, "cost1_mean": 276.63554123490763, "system_level_velocity_mean": 10.520683838851507, "cost2_mean": -111.77341196619474}, "time_total_s": 1447.9513812065125, "time_since_restore": 1447.9513812065125, "pid": 45627, "date": "2019-04-26_09-31-28", "timesteps_total": 4478978, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f88d0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271088, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2109, "episode_reward_max": 807.1833350394616, "time_this_iter_s": 36.70391631126404, "training_iteration": 39, "info": {"num_steps_sampled": 4478978, "grad_time_ms": 21964.938, "sample_time_ms": 13958.188, "update_time_ms": 13.612, "default": {"vf_loss": 24.98895263671875, "vf_explained_var": 0.6890819072723389, "entropy": 1.1167399883270264, "total_loss": 24.989347457885742, "cur_lr": 0.0005000000237487257, "kl": 0.007449656259268522, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00034737109672278166}, "load_time_ms": 8.841, "num_steps_trained": 4478978}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 644.3568375025571, "episodes_this_iter": 50, "timesteps_this_iter": 118447, "hostname": "flow-main"}
{"episode_reward_mean": 715.3181941698006, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4599198, "custom_metrics": {"cost2_min": -138.5826655408118, "system_level_velocity_min": 9.134704144016185, "system_level_velocity_max": 17.141576389606566, "outflow_rate_min": 820.5105964748499, "cost1_max": 435.4006809312954, "cost1_min": 240.22807379100212, "cost2_max": -85.10757370476895, "outflow_rate_mean": 886.6743834130659, "outflow_rate_max": 1123.0378593324413, "cost1_mean": 280.699435549553, "system_level_velocity_mean": 10.664523245804178, "cost2_mean": -108.53605153707325}, "time_total_s": 1485.3188967704773, "time_since_restore": 1485.3188967704773, "pid": 45627, "date": "2019-04-26_09-32-06", "timesteps_total": 4599198, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f83c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8550>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271126, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2161, "episode_reward_max": 830.829144834935, "time_this_iter_s": 37.367515563964844, "training_iteration": 40, "info": {"num_steps_sampled": 4599198, "grad_time_ms": 22263.317, "sample_time_ms": 13961.611, "update_time_ms": 13.517, "default": {"vf_loss": 26.45058822631836, "vf_explained_var": 0.6652243137359619, "entropy": 1.1060131788253784, "total_loss": 26.451154708862305, "cur_lr": 0.0005000000237487257, "kl": 0.007253922522068024, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00015727951540611684}, "load_time_ms": 8.938, "num_steps_trained": 4599198}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 647.9037328235052, "episodes_this_iter": 52, "timesteps_this_iter": 120220, "hostname": "flow-main"}
{"episode_reward_mean": 715.45479516909, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4719494, "custom_metrics": {"cost2_min": -138.5826655408118, "system_level_velocity_min": 9.006897375530496, "system_level_velocity_max": 17.141576389606566, "outflow_rate_min": 819.4964844217424, "cost1_max": 435.4006809312954, "cost1_min": 238.02114545422663, "cost2_max": -86.34380200261307, "outflow_rate_mean": 882.5388382944318, "outflow_rate_max": 1123.0378593324413, "cost1_mean": 276.8369787707666, "system_level_velocity_mean": 10.501578490250058, "cost2_mean": -107.16450627411818}, "time_total_s": 1523.3817069530487, "time_since_restore": 1523.3817069530487, "pid": 45627, "date": "2019-04-26_09-32-44", "timesteps_total": 4719494, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f86d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8f98>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271164, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2209, "episode_reward_max": 830.829144834935, "time_this_iter_s": 38.06281018257141, "training_iteration": 41, "info": {"num_steps_sampled": 4719494, "grad_time_ms": 22413.865, "sample_time_ms": 13886.882, "update_time_ms": 13.542, "default": {"vf_loss": 22.56580352783203, "vf_explained_var": 0.689883291721344, "entropy": 1.101891279220581, "total_loss": 22.566102981567383, "cur_lr": 0.0005000000237487257, "kl": 0.007442548405379057, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0004428532556630671}, "load_time_ms": 8.484, "num_steps_trained": 4719494}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 656.4125496302146, "episodes_this_iter": 48, "timesteps_this_iter": 120296, "hostname": "flow-main"}
{"episode_reward_mean": 709.8509897192755, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4838697, "custom_metrics": {"cost2_min": -129.9653159496233, "system_level_velocity_min": 8.842536498965728, "system_level_velocity_max": 14.73685574621777, "outflow_rate_min": 819.4964844217424, "cost1_max": 380.46652027615926, "cost1_min": 234.41352404618016, "cost2_max": -92.88202294053139, "outflow_rate_mean": 874.3547314581502, "outflow_rate_max": 1031.8677409830343, "cost1_mean": 271.006798917607, "system_level_velocity_mean": 10.279360481946146, "cost2_mean": -106.45231026011555}, "time_total_s": 1559.8646667003632, "time_since_restore": 1559.8646667003632, "pid": 45627, "date": "2019-04-26_09-33-20", "timesteps_total": 4838697, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219044e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904908>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271200, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2259, "episode_reward_max": 787.4212313653272, "time_this_iter_s": 36.48295974731445, "training_iteration": 42, "info": {"num_steps_sampled": 4838697, "grad_time_ms": 22219.833, "sample_time_ms": 13840.286, "update_time_ms": 11.207, "default": {"vf_loss": 25.04619026184082, "vf_explained_var": 0.6726134419441223, "entropy": 1.0786906480789185, "total_loss": 25.04680633544922, "cur_lr": 0.0005000000237487257, "kl": 0.007177052553743124, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00010330182703910396}, "load_time_ms": 8.523, "num_steps_trained": 4838697}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 657.3996127842324, "episodes_this_iter": 50, "timesteps_this_iter": 119203, "hostname": "flow-main"}
{"episode_reward_mean": 707.584628224533, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 4956812, "custom_metrics": {"cost2_min": -129.9653159496233, "system_level_velocity_min": 8.842536498965728, "system_level_velocity_max": 14.73685574621777, "outflow_rate_min": 817.0321183948947, "cost1_max": 380.46652027615926, "cost1_min": 234.41352404618016, "cost2_max": -84.13817992667188, "outflow_rate_mean": 869.7401941698131, "outflow_rate_max": 1031.8677409830343, "cost1_mean": 270.13495977984667, "system_level_velocity_mean": 10.254886313879128, "cost2_mean": -105.60637218517058}, "time_total_s": 1594.485101222992, "time_since_restore": 1594.485101222992, "pid": 45627, "date": "2019-04-26_09-33-55", "timesteps_total": 4956812, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8550>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271235, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2312, "episode_reward_max": 787.4212313653272, "time_this_iter_s": 34.620434522628784, "training_iteration": 43, "info": {"num_steps_sampled": 4956812, "grad_time_ms": 22082.137, "sample_time_ms": 13777.754, "update_time_ms": 11.064, "default": {"vf_loss": 25.552845001220703, "vf_explained_var": 0.6691713333129883, "entropy": 1.0787283182144165, "total_loss": 25.553569793701172, "cur_lr": 0.0005000000237487257, "kl": 0.006640242878347635, "cur_kl_coeff": 0.10000001639127731, "policy_loss": 6.11497089266777e-05}, "load_time_ms": 8.433, "num_steps_trained": 4956812}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 657.3996127842324, "episodes_this_iter": 53, "timesteps_this_iter": 118115, "hostname": "flow-main"}
{"episode_reward_mean": 703.6342260592677, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 5075232, "custom_metrics": {"cost2_min": -122.67031907636256, "system_level_velocity_min": 9.142708324374718, "system_level_velocity_max": 16.368886652879226, "outflow_rate_min": 817.0321183948947, "cost1_max": 418.1809352635577, "cost1_min": 241.24658714209673, "cost2_max": -82.79691261996595, "outflow_rate_mean": 865.8838502637263, "outflow_rate_max": 1081.9713305155929, "cost1_mean": 271.78516726050924, "system_level_velocity_mean": 10.337486846889373, "cost2_mean": -103.8736699125358}, "time_total_s": 1629.1804611682892, "time_since_restore": 1629.1804611682892, "pid": 45627, "date": "2019-04-26_09-34-30", "timesteps_total": 5075232, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8780>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271270, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2365, "episode_reward_max": 816.3988889727407, "time_this_iter_s": 34.69535994529724, "training_iteration": 44, "info": {"num_steps_sampled": 5075232, "grad_time_ms": 22046.254, "sample_time_ms": 13734.523, "update_time_ms": 11.142, "default": {"vf_loss": 26.17160987854004, "vf_explained_var": 0.6749585866928101, "entropy": 1.070192575454712, "total_loss": 26.17153549194336, "cur_lr": 0.0005000000237487257, "kl": 0.00721105607226491, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0007964693359099329}, "load_time_ms": 7.953, "num_steps_trained": 5075232}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 655.0956734602617, "episodes_this_iter": 53, "timesteps_this_iter": 118420, "hostname": "flow-main"}
{"episode_reward_mean": 703.4741360628184, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 5194307, "custom_metrics": {"cost2_min": -114.75607275350748, "system_level_velocity_min": 9.019229834320397, "system_level_velocity_max": 16.368886652879226, "outflow_rate_min": 819.1625762698443, "cost1_max": 418.1809352635577, "cost1_min": 237.6974580928162, "cost2_max": -82.79691261996595, "outflow_rate_mean": 867.4966338558952, "outflow_rate_max": 1081.9713305155929, "cost1_mean": 273.7111883993918, "system_level_velocity_mean": 10.420629576369393, "cost2_mean": -101.76078624153838}, "time_total_s": 1665.9659807682037, "time_since_restore": 1665.9659807682037, "pid": 45627, "date": "2019-04-26_09-35-06", "timesteps_total": 5194307, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b70>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271306, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2415, "episode_reward_max": 816.3988889727407, "time_this_iter_s": 36.78551959991455, "training_iteration": 45, "info": {"num_steps_sampled": 5194307, "grad_time_ms": 22408.407, "sample_time_ms": 13769.78, "update_time_ms": 11.385, "default": {"vf_loss": 25.338340759277344, "vf_explained_var": 0.6735579967498779, "entropy": 1.0605480670928955, "total_loss": 25.33884048461914, "cur_lr": 0.0005000000237487257, "kl": 0.007034188602119684, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00020163654698990285}, "load_time_ms": 7.779, "num_steps_trained": 5194307}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 655.0956734602617, "episodes_this_iter": 50, "timesteps_this_iter": 119075, "hostname": "flow-main"}
{"episode_reward_mean": 704.5904192040321, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 5314627, "custom_metrics": {"cost2_min": -139.43394577220312, "system_level_velocity_min": 9.019229834320397, "system_level_velocity_max": 14.740312478672614, "outflow_rate_min": 820.1170082576721, "cost1_max": 379.580041663859, "cost1_min": 237.6974580928162, "cost2_max": -75.76902110706754, "outflow_rate_mean": 868.3366332156651, "outflow_rate_max": 1033.947167910782, "cost1_mean": 271.7739950912159, "system_level_velocity_mean": 10.337760827505674, "cost2_mean": -102.52697720852316}, "time_total_s": 1703.7562425136566, "time_since_restore": 1703.7562425136566, "pid": 45627, "date": "2019-04-26_09-35-44", "timesteps_total": 5314627, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8a20>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271344, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2462, "episode_reward_max": 791.3544859414686, "time_this_iter_s": 37.79026174545288, "training_iteration": 46, "info": {"num_steps_sampled": 5314627, "grad_time_ms": 22642.686, "sample_time_ms": 13816.775, "update_time_ms": 11.507, "default": {"vf_loss": 23.52378273010254, "vf_explained_var": 0.6903865933418274, "entropy": 1.056464433670044, "total_loss": 23.524168014526367, "cur_lr": 0.0005000000237487257, "kl": 0.007086270023137331, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0003202078223694116}, "load_time_ms": 7.884, "num_steps_trained": 5314627}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 658.7868231519077, "episodes_this_iter": 47, "timesteps_this_iter": 120320, "hostname": "flow-main"}
{"episode_reward_mean": 705.2925301337334, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 5434212, "custom_metrics": {"cost2_min": -139.43394577220312, "system_level_velocity_min": 8.9079050268176, "system_level_velocity_max": 17.324615859782835, "outflow_rate_min": 820.1383632111769, "cost1_max": 442.9666311156681, "cost1_min": 236.42857063938084, "cost2_max": -75.76902110706754, "outflow_rate_mean": 869.2053533396404, "outflow_rate_max": 1124.6320459634587, "cost1_mean": 271.08440442760525, "system_level_velocity_mean": 10.32086165469538, "cost2_mean": -103.57268639999836}, "time_total_s": 1739.9122443199158, "time_since_restore": 1739.9122443199158, "pid": 45627, "date": "2019-04-26_09-36-20", "timesteps_total": 5434212, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904860>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271380, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2515, "episode_reward_max": 834.8254114548507, "time_this_iter_s": 36.156001806259155, "training_iteration": 47, "info": {"num_steps_sampled": 5434212, "grad_time_ms": 22529.335, "sample_time_ms": 13851.801, "update_time_ms": 11.215, "default": {"vf_loss": 27.596912384033203, "vf_explained_var": 0.6551936268806458, "entropy": 1.050211787223816, "total_loss": 27.59722328186035, "cur_lr": 0.0005000000237487257, "kl": 0.007397209759801626, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00042782683158293366}, "load_time_ms": 7.812, "num_steps_trained": 5434212}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 658.7868231519077, "episodes_this_iter": 53, "timesteps_this_iter": 119585, "hostname": "flow-main"}
{"episode_reward_mean": 707.6178685265645, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 5554339, "custom_metrics": {"cost2_min": -116.00508971074473, "system_level_velocity_min": 8.9079050268176, "system_level_velocity_max": 17.324615859782835, "outflow_rate_min": 820.1383632111769, "cost1_max": 442.9666311156681, "cost1_min": 236.42857063938084, "cost2_max": -81.77254469139682, "outflow_rate_mean": 873.5309260470551, "outflow_rate_max": 1127.8172398278857, "cost1_mean": 273.49996894691003, "system_level_velocity_mean": 10.420326759051983, "cost2_mean": -103.50393837668894}, "time_total_s": 1776.8543684482574, "time_since_restore": 1776.8543684482574, "pid": 45627, "date": "2019-04-26_09-36-57", "timesteps_total": 5554339, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8748>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271417, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2566, "episode_reward_max": 836.3156670721561, "time_this_iter_s": 36.942124128341675, "training_iteration": 48, "info": {"num_steps_sampled": 5554339, "grad_time_ms": 22439.495, "sample_time_ms": 13904.965, "update_time_ms": 10.851, "default": {"vf_loss": 24.963207244873047, "vf_explained_var": 0.6849145889282227, "entropy": 1.044490098953247, "total_loss": 24.963531494140625, "cur_lr": 0.0005000000237487257, "kl": 0.007380760740488768, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00041313847759738564}, "load_time_ms": 8.039, "num_steps_trained": 5554339}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 656.1660187901392, "episodes_this_iter": 51, "timesteps_this_iter": 120127, "hostname": "flow-main"}
{"episode_reward_mean": 707.0848141690876, "policy_reward_mean": {}, "episode_len_mean": 700.0, "timesteps_since_restore": 5674561, "custom_metrics": {"cost2_min": -136.40848133039907, "system_level_velocity_min": 9.055897276589224, "system_level_velocity_max": 17.26947883104505, "outflow_rate_min": 820.3237559254952, "cost1_max": 442.09158052064447, "cost1_min": 238.3109371256549, "cost2_max": -84.20740350864668, "outflow_rate_mean": 874.8053919770516, "outflow_rate_max": 1127.8172398278857, "cost1_mean": 273.3775660032657, "system_level_velocity_mean": 10.405355692049454, "cost2_mean": -104.50113546997416}, "time_total_s": 1814.2836146354675, "time_since_restore": 1814.2836146354675, "pid": 45627, "date": "2019-04-26_09-37-35", "timesteps_total": 5674561, "done": false, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721904550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c128>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271455, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2617, "episode_reward_max": 836.3156670721561, "time_this_iter_s": 37.42924618721008, "training_iteration": 49, "info": {"num_steps_sampled": 5674561, "grad_time_ms": 22443.01, "sample_time_ms": 13970.547, "update_time_ms": 11.036, "default": {"vf_loss": 25.530803680419922, "vf_explained_var": 0.6724502444267273, "entropy": 1.0480656623840332, "total_loss": 25.531225204467773, "cur_lr": 0.0005000000237487257, "kl": 0.0072739003226161, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0003054276457987726}, "load_time_ms": 8.168, "num_steps_trained": 5674561}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 652.0226262552533, "episodes_this_iter": 51, "timesteps_this_iter": 120222, "hostname": "flow-main"}
{"episode_reward_mean": 696.4614465152758, "policy_reward_mean": {}, "episode_len_mean": 694.17, "timesteps_since_restore": 5794140, "custom_metrics": {"cost2_min": -136.40848133039907, "system_level_velocity_min": 9.055897276589224, "system_level_velocity_max": 16.71587834837895, "outflow_rate_min": 669.2196633911936, "cost1_max": 407.5608964565831, "cost1_min": 72.56864766273733, "cost2_max": -64.7119658512738, "outflow_rate_mean": 878.7338765336381, "outflow_rate_max": 1095.943149331804, "cost1_mean": 273.661547081081, "system_level_velocity_mean": 10.566999160327022, "cost2_mean": -107.71820451358487}, "time_total_s": 1851.1011872291565, "time_since_restore": 1851.1011872291565, "pid": 45627, "date": "2019-04-26_09-38-12", "timesteps_total": 5794140, "done": true, "node_ip": "10.138.0.2", "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:5.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "lr_schedule": null, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "log_level": "INFO", "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c9b0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "use_lstm": false, "custom_options": {}, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "timestamp": 1556271492, "experiment_id": "4601ec0b0a7b487f86efd196b106cdba", "episodes_total": 2668, "episode_reward_max": 805.6419133364062, "time_this_iter_s": 36.817572593688965, "training_iteration": 50, "info": {"num_steps_sampled": 5794140, "grad_time_ms": 22377.506, "sample_time_ms": 13979.612, "update_time_ms": 11.091, "default": {"vf_loss": 26.503862380981445, "vf_explained_var": 0.6743305325508118, "entropy": 1.0470681190490723, "total_loss": 26.503841400146484, "cur_lr": 0.0005000000237487257, "kl": 0.007419409230351448, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0007654426153749228}, "load_time_ms": 8.22, "num_steps_trained": 5794140}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 138.57343558685264, "episodes_this_iter": 51, "timesteps_this_iter": 119579, "hostname": "flow-main"}

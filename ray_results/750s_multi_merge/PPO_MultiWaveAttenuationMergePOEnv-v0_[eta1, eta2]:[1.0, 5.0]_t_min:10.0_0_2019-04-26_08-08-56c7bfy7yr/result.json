{"episode_reward_mean": 154.3812038280905, "info": {"num_steps_sampled": 120470, "grad_time_ms": 24719.258, "sample_time_ms": 30870.376, "update_time_ms": 1211.097, "default": {"vf_loss": 1.0494701862335205, "vf_explained_var": 0.7512187361717224, "entropy": 1.4174059629440308, "total_loss": 1.0466198921203613, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003862113459035754, "cur_kl_coeff": 0.20000004768371582, "kl": 0.005058763548731804}, "load_time_ms": 46.271, "num_steps_trained": 120470}, "episode_len_mean": 671.9583333333334, "timesteps_since_restore": 120470, "custom_metrics": {"cost1_max": 241.13705093395708, "system_level_velocity_min": 6.423076876242801, "system_level_velocity_max": 16.861663162592812, "outflow_rate_mean": 595.9532735737862, "cost2_min": -318.9551766274645, "cost1_min": 17.86226500082395, "cost2_max": -90.48251868370866, "outflow_rate_min": 455.3152703982479, "outflow_rate_max": 722.6185796081465, "cost1_mean": 191.85098378828715, "system_level_velocity_mean": 8.144479745342794, "cost2_mean": -229.96178307262895}, "time_total_s": 57.064958810806274, "time_since_restore": 57.064958810806274, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b9b0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-10-20", "timesteps_total": 120470, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266220, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 24, "episode_reward_max": 230.29676330490653, "time_this_iter_s": 57.064958810806274, "training_iteration": 1, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 5.460723041943706, "episodes_this_iter": 24, "timesteps_this_iter": 120470, "hostname": "flow-main"}
{"episode_reward_mean": 180.14060993963906, "info": {"num_steps_sampled": 238207, "grad_time_ms": 23234.86, "sample_time_ms": 22874.754, "update_time_ms": 611.278, "default": {"vf_loss": 1.1306959390640259, "vf_explained_var": 0.8202800750732422, "entropy": 1.4104859828948975, "total_loss": 1.126240611076355, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0062264567241072655, "cur_kl_coeff": 0.20000003278255463, "kl": 0.008855937980115414}, "load_time_ms": 26.303, "num_steps_trained": 238207}, "episode_len_mean": 692.264367816092, "timesteps_since_restore": 238207, "custom_metrics": {"cost1_max": 241.13705093395708, "system_level_velocity_min": 6.009151620250329, "system_level_velocity_max": 16.861663162592812, "outflow_rate_mean": 605.0189178139185, "cost2_min": -562.5514906304502, "cost1_min": 17.86226500082395, "cost2_max": -90.48251868370866, "outflow_rate_min": 429.8850117898302, "outflow_rate_max": 722.6185796081465, "cost1_mean": 196.72545346755402, "system_level_velocity_mean": 7.796604553178851, "cost2_mean": -263.39233040554444}, "time_total_s": 93.91861534118652, "time_since_restore": 93.91861534118652, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219673c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967390>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-10-57", "timesteps_total": 238207, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266257, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 87, "episode_reward_max": 266.19898924536983, "time_this_iter_s": 36.85365653038025, "training_iteration": 2, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 5.460723041943706, "episodes_this_iter": 63, "timesteps_this_iter": 117737, "hostname": "flow-main"}
{"episode_reward_mean": 250.12122011570816, "info": {"num_steps_sampled": 348520, "grad_time_ms": 21762.47, "sample_time_ms": 19900.714, "update_time_ms": 411.088, "default": {"vf_loss": 3.351628065109253, "vf_explained_var": 0.7635883688926697, "entropy": 1.387695074081421, "total_loss": 3.3459107875823975, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007694711443036795, "cur_kl_coeff": 0.20000003278255463, "kl": 0.009887146763503551}, "load_time_ms": 19.31, "num_steps_trained": 348520}, "episode_len_mean": 693.27, "timesteps_since_restore": 348520, "custom_metrics": {"cost1_max": 256.76454721038203, "system_level_velocity_min": 2.7306781834594145, "system_level_velocity_max": 16.93671531235361, "outflow_rate_mean": 609.9376132963715, "cost2_min": -562.5514906304502, "cost1_min": 17.314537574453713, "cost2_max": -84.67709637174967, "outflow_rate_min": 248.320954618906, "outflow_rate_max": 755.0362134549284, "cost1_mean": 204.19721746091287, "system_level_velocity_mean": 8.042959885139775, "cost2_mean": -230.63307050709594}, "time_total_s": 126.9149010181427, "time_since_restore": 126.9149010181427, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967e80>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-11-30", "timesteps_total": 348520, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266290, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 146, "episode_reward_max": 429.71792562361884, "time_this_iter_s": 32.99628567695618, "training_iteration": 3, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 4.545905043037935, "episodes_this_iter": 59, "timesteps_this_iter": 110313, "hostname": "flow-main"}
{"episode_reward_mean": 383.6328160220127, "info": {"num_steps_sampled": 458976, "grad_time_ms": 21584.669, "sample_time_ms": 18452.879, "update_time_ms": 310.922, "default": {"vf_loss": 5.94042444229126, "vf_explained_var": 0.5794771313667297, "entropy": 1.373907208442688, "total_loss": 5.937150001525879, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004772411193698645, "cur_kl_coeff": 0.20000003278255463, "kl": 0.007489112205803394}, "load_time_ms": 15.637, "num_steps_trained": 458976}, "episode_len_mean": 700.0, "timesteps_since_restore": 458976, "custom_metrics": {"cost1_max": 291.5564456440951, "system_level_velocity_min": 2.7306781834594145, "system_level_velocity_max": 11.154075408023928, "outflow_rate_mean": 680.4278850568505, "cost2_min": -320.2978720525596, "cost1_min": 71.0687875743904, "cost2_max": -157.7214077723998, "outflow_rate_min": 248.320954618906, "outflow_rate_max": 811.4098611954948, "cost1_mean": 237.27500312184887, "system_level_velocity_mean": 9.092178418831145, "cost2_mean": -202.5536531708115}, "time_total_s": 162.2938301563263, "time_since_restore": 162.2938301563263, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219672b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219672e8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-12-05", "timesteps_total": 458976, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266325, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 206, "episode_reward_max": 515.6276349404399, "time_this_iter_s": 35.378929138183594, "training_iteration": 4, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 169.2056479726541, "episodes_this_iter": 60, "timesteps_this_iter": 110456, "hostname": "flow-main"}
{"episode_reward_mean": 490.11749415993637, "info": {"num_steps_sampled": 568345, "grad_time_ms": 21252.705, "sample_time_ms": 17584.91, "update_time_ms": 250.795, "default": {"vf_loss": 7.4571099281311035, "vf_explained_var": 0.46895766258239746, "entropy": 1.3672107458114624, "total_loss": 7.455749988555908, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002438886323943734, "cur_kl_coeff": 0.20000001788139343, "kl": 0.005393526516854763}, "load_time_ms": 13.495, "num_steps_trained": 568345}, "episode_len_mean": 700.0, "timesteps_since_restore": 568345, "custom_metrics": {"cost1_max": 307.37249708364567, "system_level_velocity_min": 6.630837229386286, "system_level_velocity_max": 11.804415158401122, "outflow_rate_mean": 760.1184935310267, "cost2_min": -251.48636649011695, "cost1_min": 172.39839541248404, "cost2_max": -179.6138037040277, "outflow_rate_min": 525.0713112663269, "outflow_rate_max": 833.7691640028778, "cost1_mean": 265.7667252239396, "system_level_velocity_mean": 10.11380344303984, "cost2_mean": -203.66847021441706}, "time_total_s": 196.5144078731537, "time_since_restore": 196.5144078731537, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219679e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967080>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-12-40", "timesteps_total": 568345, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266360, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 266, "episode_reward_max": 558.7007229993644, "time_this_iter_s": 34.22057771682739, "training_iteration": 5, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 330.65207578317217, "episodes_this_iter": 60, "timesteps_this_iter": 109369, "hostname": "flow-main"}
{"episode_reward_mean": 542.232314169712, "info": {"num_steps_sampled": 678865, "grad_time_ms": 21275.615, "sample_time_ms": 17131.779, "update_time_ms": 210.491, "default": {"vf_loss": 8.330327987670898, "vf_explained_var": 0.3810662031173706, "entropy": 1.3564021587371826, "total_loss": 8.329415321350098, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001849987544119358, "cur_kl_coeff": 0.20000004768371582, "kl": 0.004683976527303457}, "load_time_ms": 11.881, "num_steps_trained": 678865}, "episode_len_mean": 700.0, "timesteps_since_restore": 678865, "custom_metrics": {"cost1_max": 307.37249708364567, "system_level_velocity_min": 7.431262470347999, "system_level_velocity_max": 11.804415158401122, "outflow_rate_mean": 797.0973674897333, "cost2_min": -226.11345138316813, "cost1_min": 195.6752333534601, "cost2_max": -168.04023993187278, "outflow_rate_min": 589.5466736906867, "outflow_rate_max": 833.7691640028778, "cost1_mean": 277.45368060655693, "system_level_velocity_mean": 10.522541279692968, "cost2_mean": -192.81336689575835}, "time_total_s": 232.9868462085724, "time_since_restore": 232.9868462085724, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967630>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-13-16", "timesteps_total": 678865, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266396, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 328, "episode_reward_max": 576.751835104945, "time_this_iter_s": 36.4724383354187, "training_iteration": 6, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 430.0364578645203, "episodes_this_iter": 62, "timesteps_this_iter": 110520, "hostname": "flow-main"}
{"episode_reward_mean": 553.5249257050808, "info": {"num_steps_sampled": 788542, "grad_time_ms": 21152.902, "sample_time_ms": 16724.045, "update_time_ms": 182.039, "default": {"vf_loss": 9.573851585388184, "vf_explained_var": 0.35415807366371155, "entropy": 1.3502205610275269, "total_loss": 9.572676658630371, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00180220662150532, "cur_kl_coeff": 0.10000000894069672, "kl": 0.006272188853472471}, "load_time_ms": 10.753, "num_steps_trained": 788542}, "episode_len_mean": 700.0, "timesteps_since_restore": 788542, "custom_metrics": {"cost1_max": 299.2781999463126, "system_level_velocity_min": 8.227259303983333, "system_level_velocity_max": 11.386313783637632, "outflow_rate_mean": 791.1723407962687, "cost2_min": -215.3055491900429, "cost1_min": 217.66951444574966, "cost2_max": -150.1170951085784, "outflow_rate_min": 683.0229077841458, "outflow_rate_max": 833.8390159381515, "cost1_mean": 273.4040169766957, "system_level_velocity_mean": 10.345862930321832, "cost2_mean": -178.1261938264375}, "time_total_s": 267.89881658554077, "time_since_restore": 267.89881658554077, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967d68>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-13-51", "timesteps_total": 788542, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266431, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 388, "episode_reward_max": 587.170379352123, "time_this_iter_s": 34.911970376968384, "training_iteration": 7, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 500.9269819587813, "episodes_this_iter": 60, "timesteps_this_iter": 109677, "hostname": "flow-main"}
{"episode_reward_mean": 565.1214533939724, "info": {"num_steps_sampled": 899008, "grad_time_ms": 21112.796, "sample_time_ms": 16414.492, "update_time_ms": 161.113, "default": {"vf_loss": 9.425004005432129, "vf_explained_var": 0.3649918735027313, "entropy": 1.3403557538986206, "total_loss": 9.424670219421387, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008095921366475523, "cur_kl_coeff": 0.10000002384185791, "kl": 0.004757525399327278}, "load_time_ms": 10.064, "num_steps_trained": 899008}, "episode_len_mean": 700.0, "timesteps_since_restore": 899008, "custom_metrics": {"cost1_max": 294.35387649789425, "system_level_velocity_min": 8.60627389455499, "system_level_velocity_max": 11.295084868053948, "outflow_rate_mean": 785.9040216738616, "cost2_min": -195.50439165376315, "cost1_min": 226.29356975560393, "cost2_max": -144.42399406094268, "outflow_rate_min": 674.4720285080562, "outflow_rate_max": 833.8390159381515, "cost1_mean": 270.1128371659713, "system_level_velocity_mean": 10.187262754207401, "cost2_mean": -168.03113727156793}, "time_total_s": 303.19723677635193, "time_since_restore": 303.19723677635193, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219674e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970160>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-14-27", "timesteps_total": 899008, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266467, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 447, "episode_reward_max": 599.2356948902718, "time_this_iter_s": 35.29842019081116, "training_iteration": 8, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 506.1040335729041, "episodes_this_iter": 59, "timesteps_this_iter": 110466, "hostname": "flow-main"}
{"episode_reward_mean": 580.4779824178443, "info": {"num_steps_sampled": 1009723, "grad_time_ms": 21153.671, "sample_time_ms": 16108.007, "update_time_ms": 144.218, "default": {"vf_loss": 9.577611923217773, "vf_explained_var": 0.32169339060783386, "entropy": 1.3539727926254272, "total_loss": 9.577080726623535, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008615578408353031, "cur_kl_coeff": 0.05000000447034836, "kl": 0.0065868753008544445}, "load_time_ms": 9.474, "num_steps_trained": 1009723}, "episode_len_mean": 700.0, "timesteps_since_restore": 1009723, "custom_metrics": {"cost1_max": 294.1794535285424, "system_level_velocity_min": 8.175420519979095, "system_level_velocity_max": 11.167733682282934, "outflow_rate_mean": 785.8489891458888, "cost2_min": -195.50439165376315, "cost1_min": 216.49178310863635, "cost2_max": -143.7851384750292, "outflow_rate_min": 674.4720285080562, "outflow_rate_max": 819.6039921753984, "cost1_mean": 267.46163769357946, "system_level_velocity_mean": 10.053433980163755, "cost2_mean": -159.67759462721665}, "time_total_s": 338.55424761772156, "time_since_restore": 338.55424761772156, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bd30>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-15-02", "timesteps_total": 1009723, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266502, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 503, "episode_reward_max": 605.9555866522169, "time_this_iter_s": 35.35701084136963, "training_iteration": 9, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 506.1040335729041, "episodes_this_iter": 56, "timesteps_this_iter": 110715, "hostname": "flow-main"}
{"episode_reward_mean": 589.8697017978579, "info": {"num_steps_sampled": 1119988, "grad_time_ms": 21174.294, "sample_time_ms": 15873.713, "update_time_ms": 130.881, "default": {"vf_loss": 11.13912582397461, "vf_explained_var": 0.29581254720687866, "entropy": 1.330628752708435, "total_loss": 11.138751983642578, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006683460087515414, "cur_kl_coeff": 0.05000000819563866, "kl": 0.0058984518982470036}, "load_time_ms": 9.043, "num_steps_trained": 1119988}, "episode_len_mean": 700.0, "timesteps_since_restore": 1119988, "custom_metrics": {"cost1_max": 290.52634120515387, "system_level_velocity_min": 8.156154047828156, "system_level_velocity_max": 11.020837069508314, "outflow_rate_mean": 789.0353647801984, "cost2_min": -172.807310996861, "cost1_min": 216.49178310863635, "cost2_max": -133.71481279046506, "outflow_rate_min": 677.6258191499044, "outflow_rate_max": 817.3497515623611, "cost1_mean": 267.3348695047836, "system_level_velocity_mean": 10.022893714339565, "cost2_mean": -151.67455297637218}, "time_total_s": 373.90712881088257, "time_since_restore": 373.90712881088257, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bc50>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-15-37", "timesteps_total": 1119988, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266537, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 561, "episode_reward_max": 611.0513393928262, "time_this_iter_s": 35.35288119316101, "training_iteration": 10, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 532.6205452667261, "episodes_this_iter": 58, "timesteps_this_iter": 110265, "hostname": "flow-main"}
{"episode_reward_mean": 588.1853534078784, "info": {"num_steps_sampled": 1229594, "grad_time_ms": 20749.772, "sample_time_ms": 14174.261, "update_time_ms": 10.803, "default": {"vf_loss": 12.491548538208008, "vf_explained_var": 0.2659497559070587, "entropy": 1.3312828540802002, "total_loss": 12.490710258483887, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001169820548966527, "cur_kl_coeff": 0.05000000447034836, "kl": 0.006633081939071417}, "load_time_ms": 4.887, "num_steps_trained": 1229594}, "episode_len_mean": 700.0, "timesteps_since_restore": 1229594, "custom_metrics": {"cost1_max": 290.33312198966314, "system_level_velocity_min": 8.132268566829875, "system_level_velocity_max": 11.020837069508314, "outflow_rate_mean": 784.3675609365555, "cost2_min": -166.47271931469717, "cost1_min": 217.78332421861313, "cost2_max": -128.3114382107193, "outflow_rate_min": 684.627572523929, "outflow_rate_max": 814.7361554919387, "cost1_mean": 266.69076089625105, "system_level_velocity_mean": 10.00564090069239, "cost2_mean": -142.131162193264}, "time_total_s": 408.45541405677795, "time_since_restore": 408.45541405677795, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936400>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-16-12", "timesteps_total": 1229594, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266572, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 621, "episode_reward_max": 610.3845544863303, "time_this_iter_s": 34.548285245895386, "training_iteration": 11, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 536.6155397931946, "episodes_this_iter": 60, "timesteps_this_iter": 109606, "hostname": "flow-main"}
{"episode_reward_mean": 590.8476503701484, "info": {"num_steps_sampled": 1339845, "grad_time_ms": 20637.913, "sample_time_ms": 14034.606, "update_time_ms": 10.781, "default": {"vf_loss": 12.545876502990723, "vf_explained_var": 0.2834981381893158, "entropy": 1.3381043672561646, "total_loss": 12.545880317687988, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00028289458714425564, "cur_kl_coeff": 0.05000000819563866, "kl": 0.005728257354348898}, "load_time_ms": 4.695, "num_steps_trained": 1339845}, "episode_len_mean": 700.0, "timesteps_since_restore": 1339845, "custom_metrics": {"cost1_max": 295.89326805104895, "system_level_velocity_min": 8.132268566829875, "system_level_velocity_max": 11.126276702558402, "outflow_rate_mean": 782.5236681753429, "cost2_min": -160.31133608640224, "cost1_min": 217.78332421861313, "cost2_max": -126.44485067207302, "outflow_rate_min": 688.7275104234724, "outflow_rate_max": 810.0869300821134, "cost1_mean": 267.7269039779874, "system_level_velocity_mean": 10.04404849314448, "cost2_mean": -136.6834636435229}, "time_total_s": 442.7906057834625, "time_since_restore": 442.7906057834625, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219679e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219705c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ba8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-16-46", "timesteps_total": 1339845, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266606, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 677, "episode_reward_max": 612.0637832955322, "time_this_iter_s": 34.33519172668457, "training_iteration": 12, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 537.6454503803424, "episodes_this_iter": 56, "timesteps_this_iter": 110251, "hostname": "flow-main"}
{"episode_reward_mean": 586.1444623890806, "info": {"num_steps_sampled": 1449449, "grad_time_ms": 20815.798, "sample_time_ms": 14005.813, "update_time_ms": 10.877, "default": {"vf_loss": 13.576781272888184, "vf_explained_var": 0.2583577036857605, "entropy": 1.325920581817627, "total_loss": 13.576594352722168, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00045517837861552835, "cur_kl_coeff": 0.05000000447034836, "kl": 0.005374296102672815}, "load_time_ms": 4.786, "num_steps_trained": 1449449}, "episode_len_mean": 700.0, "timesteps_since_restore": 1449449, "custom_metrics": {"cost1_max": 295.89326805104895, "system_level_velocity_min": 6.361128525564403, "system_level_velocity_max": 11.15985277723481, "outflow_rate_mean": 767.5058760711817, "cost2_min": -149.2175517480913, "cost1_min": 170.81662296542476, "cost2_max": -111.18821138102274, "outflow_rate_min": 605.2775249190314, "outflow_rate_max": 810.0869300821134, "cost1_mean": 263.91590309620017, "system_level_velocity_mean": 9.889956694699618, "cost2_mean": -131.74940769116188}, "time_total_s": 477.28366708755493, "time_since_restore": 477.28366708755493, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970d68>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-17-21", "timesteps_total": 1449449, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266641, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 737, "episode_reward_max": 612.0637832955322, "time_this_iter_s": 34.49306130409241, "training_iteration": 13, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 527.6091336264241, "episodes_this_iter": 60, "timesteps_this_iter": 109604, "hostname": "flow-main"}
{"episode_reward_mean": 584.0720866845049, "info": {"num_steps_sampled": 1559280, "grad_time_ms": 20730.211, "sample_time_ms": 13991.551, "update_time_ms": 10.836, "default": {"vf_loss": 13.666672706604004, "vf_explained_var": 0.3010738492012024, "entropy": 1.3256138563156128, "total_loss": 13.66673755645752, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00019816543499473482, "cur_kl_coeff": 0.05000000447034836, "kl": 0.005256399512290955}, "load_time_ms": 4.701, "num_steps_trained": 1559280}, "episode_len_mean": 700.0, "timesteps_since_restore": 1559280, "custom_metrics": {"cost1_max": 295.5513806518885, "system_level_velocity_min": 6.361128525564403, "system_level_velocity_max": 11.232192282878154, "outflow_rate_mean": 756.1959632366347, "cost2_min": -145.34113821484456, "cost1_min": 170.81662296542476, "cost2_max": -110.67195014619182, "outflow_rate_min": 605.2775249190314, "outflow_rate_max": 796.276591929632, "cost1_mean": 260.8076101461407, "system_level_velocity_mean": 9.752639460876996, "cost2_mean": -126.88000183427292}, "time_total_s": 511.6655285358429, "time_since_restore": 511.6655285358429, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219705c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970fd0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-17-55", "timesteps_total": 1559280, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266675, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 797, "episode_reward_max": 620.0240775187667, "time_this_iter_s": 34.381861448287964, "training_iteration": 14, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 497.0731202134855, "episodes_this_iter": 60, "timesteps_this_iter": 109831, "hostname": "flow-main"}
{"episode_reward_mean": 580.8289892887555, "info": {"num_steps_sampled": 1669326, "grad_time_ms": 20728.706, "sample_time_ms": 14015.865, "update_time_ms": 11.066, "default": {"vf_loss": 14.090216636657715, "vf_explained_var": 0.4440073072910309, "entropy": 1.3256782293319702, "total_loss": 14.089277267456055, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0012938855215907097, "cur_kl_coeff": 0.05000000447034836, "kl": 0.007119405083358288}, "load_time_ms": 4.736, "num_steps_trained": 1669326}, "episode_len_mean": 700.0, "timesteps_since_restore": 1669326, "custom_metrics": {"cost1_max": 329.7795701956639, "system_level_velocity_min": 5.780083329252176, "system_level_velocity_max": 12.68280518853389, "outflow_rate_mean": 748.8144859089426, "cost2_min": -137.64912274563767, "cost1_min": 150.5822678829612, "cost2_max": -106.82793906892512, "outflow_rate_min": 456.85083884277867, "outflow_rate_max": 790.0447432080127, "cost1_mean": 262.3843236965851, "system_level_velocity_mean": 9.823939380984648, "cost2_mean": -122.68407039972477}, "time_total_s": 546.1447246074677, "time_since_restore": 546.1447246074677, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219709e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970f28>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-18-30", "timesteps_total": 1669326, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266710, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 856, "episode_reward_max": 620.0240775187667, "time_this_iter_s": 34.479196071624756, "training_iteration": 15, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 383.8670486908717, "episodes_this_iter": 59, "timesteps_this_iter": 110046, "hostname": "flow-main"}
{"episode_reward_mean": 570.1282623376873, "info": {"num_steps_sampled": 1776769, "grad_time_ms": 20623.861, "sample_time_ms": 13874.552, "update_time_ms": 11.381, "default": {"vf_loss": 14.566109657287598, "vf_explained_var": 0.4509226381778717, "entropy": 1.3367338180541992, "total_loss": 14.565451622009277, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000980942859314382, "cur_kl_coeff": 0.05000000819563866, "kl": 0.0064839329570531845}, "load_time_ms": 5.102, "num_steps_trained": 1776769}, "episode_len_mean": 700.0, "timesteps_since_restore": 1776769, "custom_metrics": {"cost1_max": 329.26584364119174, "system_level_velocity_min": 5.780083329252176, "system_level_velocity_max": 12.656336950870589, "outflow_rate_mean": 735.7008799273561, "cost2_min": -134.99356707738175, "cost1_min": 150.5822678829612, "cost2_max": -94.95190085936557, "outflow_rate_min": 456.85083884277867, "outflow_rate_max": 817.0429238414897, "cost1_mean": 269.4836042037116, "system_level_velocity_mean": 10.137659867256993, "cost2_mean": -116.92895057654876}, "time_total_s": 580.1610822677612, "time_since_restore": 580.1610822677612, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219705c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970b38>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-19-04", "timesteps_total": 1776769, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266744, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 914, "episode_reward_max": 617.7011468529046, "time_this_iter_s": 34.01635766029358, "training_iteration": 16, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 383.8670486908717, "episodes_this_iter": 58, "timesteps_this_iter": 107443, "hostname": "flow-main"}
{"episode_reward_mean": 567.7386088851514, "info": {"num_steps_sampled": 1879642, "grad_time_ms": 20549.417, "sample_time_ms": 13871.316, "update_time_ms": 11.351, "default": {"vf_loss": 16.120397567749023, "vf_explained_var": 0.31478118896484375, "entropy": 1.3090019226074219, "total_loss": 16.119842529296875, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008996428223326802, "cur_kl_coeff": 0.050000011920928955, "kl": 0.006895681843161583}, "load_time_ms": 5.175, "num_steps_trained": 1879642}, "episode_len_mean": 700.0, "timesteps_since_restore": 1879642, "custom_metrics": {"cost1_max": 344.9090827958655, "system_level_velocity_min": 4.750511022882368, "system_level_velocity_max": 13.481110588809944, "outflow_rate_mean": 730.5927048706611, "cost2_min": -127.24567497003738, "cost1_min": 123.64195097735733, "cost2_max": -91.84914550393353, "outflow_rate_min": 434.1539009863647, "outflow_rate_max": 785.2298777126581, "cost1_mean": 288.3419496622037, "system_level_velocity_mean": 10.918357381031235, "cost2_mean": -109.29111085354991}, "time_total_s": 614.2896640300751, "time_since_restore": 614.2896640300751, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970a90>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-19-38", "timesteps_total": 1879642, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266778, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 980, "episode_reward_max": 625.5283157571048, "time_this_iter_s": 34.12858176231384, "training_iteration": 17, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 373.21502250043824, "episodes_this_iter": 66, "timesteps_this_iter": 102873, "hostname": "flow-main"}
{"episode_reward_mean": 582.3772226121545, "info": {"num_steps_sampled": 1980475, "grad_time_ms": 20562.722, "sample_time_ms": 13845.909, "update_time_ms": 10.979, "default": {"vf_loss": 17.7543888092041, "vf_explained_var": 0.2135896533727646, "entropy": 1.2728195190429688, "total_loss": 17.753917694091797, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008168268832378089, "cur_kl_coeff": 0.05000000819563866, "kl": 0.006918048486113548}, "load_time_ms": 5.228, "num_steps_trained": 1980475}, "episode_len_mean": 700.0, "timesteps_since_restore": 1980475, "custom_metrics": {"cost1_max": 365.9785789070552, "system_level_velocity_min": 5.966618252510098, "system_level_velocity_max": 14.197958616795876, "outflow_rate_mean": 739.3529999481175, "cost2_min": -122.4469546645935, "cost1_min": 158.94270024380404, "cost2_max": -88.660161607747, "outflow_rate_min": 515.8582561508715, "outflow_rate_max": 782.6432835978625, "cost1_mean": 319.4184090346836, "system_level_velocity_mean": 12.209747871899456, "cost2_mean": -102.20118623223057}, "time_total_s": 649.4614722728729, "time_since_restore": 649.4614722728729, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970fd0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-20-13", "timesteps_total": 1980475, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266813, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1050, "episode_reward_max": 607.4463561458135, "time_this_iter_s": 35.17180824279785, "training_iteration": 18, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 484.5279017015145, "episodes_this_iter": 70, "timesteps_this_iter": 100833, "hostname": "flow-main"}
{"episode_reward_mean": 587.6527834598919, "info": {"num_steps_sampled": 2080825, "grad_time_ms": 20242.103, "sample_time_ms": 13845.383, "update_time_ms": 11.249, "default": {"vf_loss": 20.81723976135254, "vf_explained_var": 0.16786587238311768, "entropy": 1.276036262512207, "total_loss": 20.81672477722168, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009497589780949056, "cur_kl_coeff": 0.050000011920928955, "kl": 0.008720384910702705}, "load_time_ms": 5.145, "num_steps_trained": 2080825}, "episode_len_mean": 700.0, "timesteps_since_restore": 2080825, "custom_metrics": {"cost1_max": 355.92007309971444, "system_level_velocity_min": 11.005570900620823, "system_level_velocity_max": 13.917249521705719, "outflow_rate_mean": 740.5020995390389, "cost2_min": -111.44326392855632, "cost1_min": 287.9951218925404, "cost2_max": -83.9172037874427, "outflow_rate_min": 688.8319017614659, "outflow_rate_max": 764.3363040422261, "cost1_mean": 330.1768643345625, "system_level_velocity_mean": 12.652783308943427, "cost2_mean": -96.95953229758047}, "time_total_s": 681.5962982177734, "time_since_restore": 681.5962982177734, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219700f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970048>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-20-45", "timesteps_total": 2080825, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266845, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1127, "episode_reward_max": 616.3373023879317, "time_this_iter_s": 32.13482594490051, "training_iteration": 19, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 545.2125714379172, "episodes_this_iter": 77, "timesteps_this_iter": 100350, "hostname": "flow-main"}
{"episode_reward_mean": 595.0633074224753, "info": {"num_steps_sampled": 2181298, "grad_time_ms": 19843.169, "sample_time_ms": 13861.337, "update_time_ms": 11.278, "default": {"vf_loss": 22.865015029907227, "vf_explained_var": 0.16257032752037048, "entropy": 1.2728372812271118, "total_loss": 22.864521026611328, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008830762817524374, "cur_kl_coeff": 0.05000000447034836, "kl": 0.007791298907250166}, "load_time_ms": 4.968, "num_steps_trained": 2181298}, "episode_len_mean": 700.0, "timesteps_since_restore": 2181298, "custom_metrics": {"cost1_max": 375.80557324779573, "system_level_velocity_min": 11.30757168676115, "system_level_velocity_max": 14.589378273865183, "outflow_rate_mean": 738.9397938590159, "cost2_min": -110.22909901691743, "cost1_min": 299.5676536188894, "cost2_max": -72.93084139739759, "outflow_rate_min": 696.3547660921074, "outflow_rate_max": 762.6136727884341, "cost1_mean": 334.22529999415144, "system_level_velocity_mean": 12.784993065181336, "cost2_mean": -92.07700439002761}, "time_total_s": 713.1002404689789, "time_since_restore": 713.1002404689789, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ac8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-21-17", "timesteps_total": 2181298, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266877, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1213, "episode_reward_max": 616.3373023879317, "time_this_iter_s": 31.503942251205444, "training_iteration": 20, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 556.1895981317849, "episodes_this_iter": 86, "timesteps_this_iter": 100473, "hostname": "flow-main"}
{"episode_reward_mean": 590.0283863599328, "info": {"num_steps_sampled": 2281368, "grad_time_ms": 19580.866, "sample_time_ms": 13851.994, "update_time_ms": 11.261, "default": {"vf_loss": 23.29213523864746, "vf_explained_var": 0.14309370517730713, "entropy": 1.2668917179107666, "total_loss": 23.291715621948242, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008257994777522981, "cur_kl_coeff": 0.05000000447034836, "kl": 0.008166971616446972}, "load_time_ms": 4.846, "num_steps_trained": 2281368}, "episode_len_mean": 700.0, "timesteps_since_restore": 2281368, "custom_metrics": {"cost1_max": 378.6393772498278, "system_level_velocity_min": 11.50821363502726, "system_level_velocity_max": 15.023663833404544, "outflow_rate_mean": 736.6138052586763, "cost2_min": -106.46702593417598, "cost1_min": 308.6703130447619, "cost2_max": -72.93084139739759, "outflow_rate_min": 701.4541108569099, "outflow_rate_max": 760.0788453714578, "cost1_mean": 336.51799227674314, "system_level_velocity_mean": 12.907500659635486, "cost2_mean": -89.80644030477228}, "time_total_s": 744.9157631397247, "time_since_restore": 744.9157631397247, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970dd8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-21-49", "timesteps_total": 2281368, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266909, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1289, "episode_reward_max": 621.7038887344773, "time_this_iter_s": 31.81552267074585, "training_iteration": 21, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 547.6960645446399, "episodes_this_iter": 76, "timesteps_this_iter": 100070, "hostname": "flow-main"}
{"episode_reward_mean": 590.5534716135121, "info": {"num_steps_sampled": 2381705, "grad_time_ms": 19415.722, "sample_time_ms": 13871.523, "update_time_ms": 11.151, "default": {"vf_loss": 24.649967193603516, "vf_explained_var": 0.1479702591896057, "entropy": 1.2630393505096436, "total_loss": 24.650218963623047, "cur_lr": 0.0005000000237487257, "policy_loss": -9.122281335294247e-05, "cur_kl_coeff": 0.050000011920928955, "kl": 0.006858941167593002}, "load_time_ms": 4.833, "num_steps_trained": 2381705}, "episode_len_mean": 700.0, "timesteps_since_restore": 2381705, "custom_metrics": {"cost1_max": 388.7122968081868, "system_level_velocity_min": 12.001931485106788, "system_level_velocity_max": 15.079466314588098, "outflow_rate_mean": 737.9825496090593, "cost2_min": -103.65686215926345, "cost1_min": 313.88722856854866, "cost2_max": -71.94856839002118, "outflow_rate_min": 705.3556624240358, "outflow_rate_max": 783.072050395038, "cost1_mean": 336.80068074091736, "system_level_velocity_mean": 12.939066182106439, "cost2_mean": -87.26033611844869}, "time_total_s": 777.7554275989532, "time_since_restore": 777.7554275989532, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970d30>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-22-21", "timesteps_total": 2381705, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266941, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1367, "episode_reward_max": 617.8421203333388, "time_this_iter_s": 32.839664459228516, "training_iteration": 22, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 551.4825426015069, "episodes_this_iter": 78, "timesteps_this_iter": 100337, "hostname": "flow-main"}
{"episode_reward_mean": 596.7969857677615, "info": {"num_steps_sampled": 2482475, "grad_time_ms": 19243.465, "sample_time_ms": 13891.208, "update_time_ms": 11.024, "default": {"vf_loss": 23.591781616210938, "vf_explained_var": 0.16231544315814972, "entropy": 1.2541556358337402, "total_loss": 23.591873168945312, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00021320524683687836, "cur_kl_coeff": 0.05000000819563866, "kl": 0.006094737444072962}, "load_time_ms": 4.676, "num_steps_trained": 2482475}, "episode_len_mean": 700.0, "timesteps_since_restore": 2482475, "custom_metrics": {"cost1_max": 375.32150750696337, "system_level_velocity_min": 11.438171735585966, "system_level_velocity_max": 14.592172761086664, "outflow_rate_mean": 742.1521248985197, "cost2_min": -100.63572068517081, "cost1_min": 301.5141482415242, "cost2_max": -71.94856839002118, "outflow_rate_min": 717.540879430774, "outflow_rate_max": 786.8575103042047, "cost1_mean": 333.6015171458568, "system_level_velocity_mean": 12.786966997952229, "cost2_mean": -84.50832105745883}, "time_total_s": 810.7040042877197, "time_since_restore": 810.7040042877197, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970f98>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-22-54", "timesteps_total": 2482475, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556266974, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1444, "episode_reward_max": 618.2267288240071, "time_this_iter_s": 32.94857668876648, "training_iteration": 23, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 565.6533482858267, "episodes_this_iter": 77, "timesteps_this_iter": 100770, "hostname": "flow-main"}
{"episode_reward_mean": 599.3407606310341, "info": {"num_steps_sampled": 2583256, "grad_time_ms": 19157.294, "sample_time_ms": 13891.261, "update_time_ms": 11.24, "default": {"vf_loss": 20.6544132232666, "vf_explained_var": 0.19363491237163544, "entropy": 1.249427318572998, "total_loss": 20.6543025970459, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00040899449959397316, "cur_kl_coeff": 0.05000000819563866, "kl": 0.005966563243418932}, "load_time_ms": 4.832, "num_steps_trained": 2583256}, "episode_len_mean": 700.0, "timesteps_since_restore": 2583256, "custom_metrics": {"cost1_max": 375.32150750696337, "system_level_velocity_min": 11.817179158187107, "system_level_velocity_max": 14.545914070825852, "outflow_rate_mean": 745.8377233718421, "cost2_min": -102.25701276476815, "cost1_min": 312.91487288295934, "cost2_max": -69.95921783911206, "outflow_rate_min": 712.3445330446199, "outflow_rate_max": 775.2933105704785, "cost1_mean": 331.29537574230045, "system_level_velocity_mean": 12.649194376272192, "cost2_mean": -84.85935895895383}, "time_total_s": 844.222758769989, "time_since_restore": 844.222758769989, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219705c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970908>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-23-28", "timesteps_total": 2583256, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267008, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1518, "episode_reward_max": 622.6716017729575, "time_this_iter_s": 33.51875448226929, "training_iteration": 24, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 562.0908244196168, "episodes_this_iter": 74, "timesteps_this_iter": 100781, "hostname": "flow-main"}
{"episode_reward_mean": 593.3092946054136, "info": {"num_steps_sampled": 2684338, "grad_time_ms": 19072.035, "sample_time_ms": 13847.033, "update_time_ms": 11.105, "default": {"vf_loss": 26.256633758544922, "vf_explained_var": 0.1150645762681961, "entropy": 1.2422645092010498, "total_loss": 26.25647735595703, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00047997513320297003, "cur_kl_coeff": 0.05000000447034836, "kl": 0.0064965225756168365}, "load_time_ms": 4.857, "num_steps_trained": 2684338}, "episode_len_mean": 700.0, "timesteps_since_restore": 2684338, "custom_metrics": {"cost1_max": 351.7730975100028, "system_level_velocity_min": 11.238490991510849, "system_level_velocity_max": 13.448473750157984, "outflow_rate_mean": 740.3264720380823, "cost2_min": -96.98789509910006, "cost1_min": 297.4843374501151, "cost2_max": -68.60013273579399, "outflow_rate_min": 702.1889991386012, "outflow_rate_max": 766.338406337917, "cost1_mean": 322.2934522767612, "system_level_velocity_mean": 12.248205716970661, "cost2_mean": -81.75996077244638}, "time_total_s": 877.4089314937592, "time_since_restore": 877.4089314937592, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970f98>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-24-01", "timesteps_total": 2684338, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267041, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1599, "episode_reward_max": 624.739247801819, "time_this_iter_s": 33.18617272377014, "training_iteration": 25, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 552.8834067394805, "episodes_this_iter": 81, "timesteps_this_iter": 101082, "hostname": "flow-main"}
{"episode_reward_mean": 592.0735993884058, "info": {"num_steps_sampled": 2785164, "grad_time_ms": 18962.156, "sample_time_ms": 13913.9, "update_time_ms": 10.923, "default": {"vf_loss": 24.47415542602539, "vf_explained_var": 0.12354366481304169, "entropy": 1.2463780641555786, "total_loss": 24.474140167236328, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003548837557900697, "cur_kl_coeff": 0.05000000819563866, "kl": 0.006785938050597906}, "load_time_ms": 4.587, "num_steps_trained": 2785164}, "episode_len_mean": 700.0, "timesteps_since_restore": 2785164, "custom_metrics": {"cost1_max": 340.2465227911611, "system_level_velocity_min": 11.238490991510849, "system_level_velocity_max": 13.067087120290816, "outflow_rate_mean": 736.8483644568603, "cost2_min": -97.84115513331679, "cost1_min": 297.4843374501151, "cost2_max": -64.5392824327539, "outflow_rate_min": 702.6466384399565, "outflow_rate_max": 757.1912771950109, "cost1_mean": 321.0629986090651, "system_level_velocity_mean": 12.190656587894523, "cost2_mean": -79.73662862398567}, "time_total_s": 910.9812858104706, "time_since_restore": 910.9812858104706, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219700f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ac8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-24-35", "timesteps_total": 2785164, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267075, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1671, "episode_reward_max": 620.9695721604859, "time_this_iter_s": 33.572354316711426, "training_iteration": 26, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 553.4811742435198, "episodes_this_iter": 72, "timesteps_this_iter": 100826, "hostname": "flow-main"}
{"episode_reward_mean": 602.5249188022639, "info": {"num_steps_sampled": 2886437, "grad_time_ms": 18975.698, "sample_time_ms": 13892.632, "update_time_ms": 10.837, "default": {"vf_loss": 22.371044158935547, "vf_explained_var": 0.14905110001564026, "entropy": 1.2501190900802612, "total_loss": 22.37073516845703, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006908222567290068, "cur_kl_coeff": 0.05000000819563866, "kl": 0.007611193228513002}, "load_time_ms": 4.606, "num_steps_trained": 2886437}, "episode_len_mean": 700.0, "timesteps_since_restore": 2886437, "custom_metrics": {"cost1_max": 352.5417835245159, "system_level_velocity_min": 11.439204519955751, "system_level_velocity_max": 13.480942599484337, "outflow_rate_mean": 740.9794671874129, "cost2_min": -98.59790356254167, "cost1_min": 303.77472592859965, "cost2_max": -71.98448481377571, "outflow_rate_min": 702.6466384399565, "outflow_rate_max": 767.2688950307921, "cost1_mean": 324.30337294480546, "system_level_velocity_mean": 12.280122423358689, "cost2_mean": -79.83598819918836}, "time_total_s": 945.0413529872894, "time_since_restore": 945.0413529872894, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970588>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-25-09", "timesteps_total": 2886437, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267109, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1747, "episode_reward_max": 627.6700704550562, "time_this_iter_s": 34.06006717681885, "training_iteration": 27, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 564.6204264573064, "episodes_this_iter": 76, "timesteps_this_iter": 101273, "hostname": "flow-main"}
{"episode_reward_mean": 603.2694916524256, "info": {"num_steps_sampled": 2987110, "grad_time_ms": 18736.466, "sample_time_ms": 13908.846, "update_time_ms": 11.008, "default": {"vf_loss": 24.2924861907959, "vf_explained_var": 0.1559671312570572, "entropy": 1.2561681270599365, "total_loss": 24.292247772216797, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000597169972024858, "cur_kl_coeff": 0.05000000819563866, "kl": 0.007203919813036919}, "load_time_ms": 4.493, "num_steps_trained": 2987110}, "episode_len_mean": 700.0, "timesteps_since_restore": 2987110, "custom_metrics": {"cost1_max": 352.10693545709614, "system_level_velocity_min": 11.437998099928482, "system_level_velocity_max": 13.480547526165982, "outflow_rate_mean": 742.7583606790788, "cost2_min": -97.9429506673857, "cost1_min": 303.69242750294546, "cost2_max": -66.63530680548305, "outflow_rate_min": 712.6812856293184, "outflow_rate_max": 764.1157570430938, "cost1_mean": 323.75611605562784, "system_level_velocity_mean": 12.245508581253809, "cost2_mean": -78.04680984461336}, "time_total_s": 977.9841859340668, "time_since_restore": 977.9841859340668, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219708d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970cf8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-25-42", "timesteps_total": 2987110, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267142, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1829, "episode_reward_max": 630.6625206117183, "time_this_iter_s": 32.942832946777344, "training_iteration": 28, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 572.3222203166414, "episodes_this_iter": 82, "timesteps_this_iter": 100673, "hostname": "flow-main"}
{"episode_reward_mean": 601.1469917564922, "info": {"num_steps_sampled": 3088115, "grad_time_ms": 18579.545, "sample_time_ms": 13918.675, "update_time_ms": 10.851, "default": {"vf_loss": 22.119762420654297, "vf_explained_var": 0.16559715569019318, "entropy": 1.2516165971755981, "total_loss": 22.119115829467773, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001081109163351357, "cur_kl_coeff": 0.05000000447034836, "kl": 0.008671454153954983}, "load_time_ms": 4.728, "num_steps_trained": 3088115}, "episode_len_mean": 700.0, "timesteps_since_restore": 3088115, "custom_metrics": {"cost1_max": 347.83866576788495, "system_level_velocity_min": 11.437998099928482, "system_level_velocity_max": 13.286024032825743, "outflow_rate_mean": 739.8596851316152, "cost2_min": -97.9429506673857, "cost1_min": 303.69242750294546, "cost2_max": -66.63530680548305, "outflow_rate_min": 708.8913938932689, "outflow_rate_max": 764.8097245408893, "cost1_mean": 321.32714459246006, "system_level_velocity_mean": 12.146261531427003, "cost2_mean": -76.98541721002032}, "time_total_s": 1008.6535315513611, "time_since_restore": 1008.6535315513611, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219704a8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-26-13", "timesteps_total": 3088115, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267173, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1899, "episode_reward_max": 637.0220622985448, "time_this_iter_s": 30.66934561729431, "training_iteration": 29, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 575.5412161582492, "episodes_this_iter": 70, "timesteps_this_iter": 101005, "hostname": "flow-main"}
{"episode_reward_mean": 601.9605951294154, "info": {"num_steps_sampled": 3189527, "grad_time_ms": 18652.997, "sample_time_ms": 13922.202, "update_time_ms": 10.887, "default": {"vf_loss": 23.691884994506836, "vf_explained_var": 0.13278917968273163, "entropy": 1.2437776327133179, "total_loss": 23.69133758544922, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000903161009773612, "cur_kl_coeff": 0.05000000819563866, "kl": 0.007108982186764479}, "load_time_ms": 5.077, "num_steps_trained": 3189527}, "episode_len_mean": 700.0, "timesteps_since_restore": 3189527, "custom_metrics": {"cost1_max": 343.0027474720494, "system_level_velocity_min": 11.083616949430214, "system_level_velocity_max": 12.968513808382076, "outflow_rate_mean": 738.671430751156, "cost2_min": -90.37768999271337, "cost1_min": 295.2792098911343, "cost2_max": -61.349046650930994, "outflow_rate_min": 712.4106960268499, "outflow_rate_max": 761.6306832917339, "cost1_mean": 317.5513110379716, "system_level_velocity_mean": 11.972329080755282, "cost2_mean": -75.38456751555765}, "time_total_s": 1040.941585302353, "time_since_restore": 1040.941585302353, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970668>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-26-45", "timesteps_total": 3189527, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267205, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 1980, "episode_reward_max": 624.8217418682656, "time_this_iter_s": 32.28805375099182, "training_iteration": 30, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 565.3639017929412, "episodes_this_iter": 81, "timesteps_this_iter": 101412, "hostname": "flow-main"}
{"episode_reward_mean": 603.0963043653039, "info": {"num_steps_sampled": 3290838, "grad_time_ms": 18729.904, "sample_time_ms": 13933.381, "update_time_ms": 10.925, "default": {"vf_loss": 22.380136489868164, "vf_explained_var": 0.14486362040042877, "entropy": 1.2385882139205933, "total_loss": 22.37964630126953, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000831119657959789, "cur_kl_coeff": 0.05000000819563866, "kl": 0.006858193781226873}, "load_time_ms": 5.088, "num_steps_trained": 3290838}, "episode_len_mean": 700.0, "timesteps_since_restore": 3290838, "custom_metrics": {"cost1_max": 336.2711045469676, "system_level_velocity_min": 11.083616949430214, "system_level_velocity_max": 12.687684373055815, "outflow_rate_mean": 739.46124225612, "cost2_min": -91.67411578021944, "cost1_min": 295.2792098911343, "cost2_max": -61.12999577642603, "outflow_rate_min": 712.4106960268499, "outflow_rate_max": 761.3076299076423, "cost1_mean": 315.97360140977725, "system_level_velocity_mean": 11.89518368627335, "cost2_mean": -74.79797803016463}, "time_total_s": 1073.6775770187378, "time_since_restore": 1073.6775770187378, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219700f0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-27-18", "timesteps_total": 3290838, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267238, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2054, "episode_reward_max": 626.473615762021, "time_this_iter_s": 32.73599171638489, "training_iteration": 31, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 565.3639017929412, "episodes_this_iter": 74, "timesteps_this_iter": 101311, "hostname": "flow-main"}
{"episode_reward_mean": 605.8155957467499, "info": {"num_steps_sampled": 3392487, "grad_time_ms": 18801.152, "sample_time_ms": 13954.525, "update_time_ms": 11.281, "default": {"vf_loss": 22.045494079589844, "vf_explained_var": 0.13718441128730774, "entropy": 1.2340761423110962, "total_loss": 22.04534912109375, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004680610145442188, "cur_kl_coeff": 0.05000000447034836, "kl": 0.006441008299589157}, "load_time_ms": 5.169, "num_steps_trained": 3392487}, "episode_len_mean": 700.0, "timesteps_since_restore": 3392487, "custom_metrics": {"cost1_max": 337.8752523163365, "system_level_velocity_min": 11.278364038656628, "system_level_velocity_max": 12.681065084001725, "outflow_rate_mean": 739.9615734493775, "cost2_min": -87.03358856107918, "cost1_min": 299.4103622887377, "cost2_max": -61.12999577642603, "outflow_rate_min": 713.1568358617055, "outflow_rate_max": 766.2018255254478, "cost1_mean": 315.5659461004974, "system_level_velocity_mean": 11.864302025668673, "cost2_mean": -74.64202769566471}, "time_total_s": 1107.4564652442932, "time_since_restore": 1107.4564652442932, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970e80>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-27-51", "timesteps_total": 3392487, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267271, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2127, "episode_reward_max": 626.473615762021, "time_this_iter_s": 33.77888822555542, "training_iteration": 32, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 575.296084961127, "episodes_this_iter": 73, "timesteps_this_iter": 101649, "hostname": "flow-main"}
{"episode_reward_mean": 609.5382451215429, "info": {"num_steps_sampled": 3493831, "grad_time_ms": 18789.2, "sample_time_ms": 13968.555, "update_time_ms": 11.243, "default": {"vf_loss": 21.03742027282715, "vf_explained_var": 0.17698831856250763, "entropy": 1.2210676670074463, "total_loss": 21.03700065612793, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000856005004607141, "cur_kl_coeff": 0.05000000819563866, "kl": 0.008705148473381996}, "load_time_ms": 5.274, "num_steps_trained": 3493831}, "episode_len_mean": 700.0, "timesteps_since_restore": 3493831, "custom_metrics": {"cost1_max": 336.5535599148505, "system_level_velocity_min": 11.107511261345612, "system_level_velocity_max": 12.682923747100418, "outflow_rate_mean": 742.3044924495798, "cost2_min": -83.76733922126972, "cost1_min": 296.149881904022, "cost2_max": -65.62485704946282, "outflow_rate_min": 714.0187243404079, "outflow_rate_max": 767.2719889359412, "cost1_mean": 315.87105038711536, "system_level_velocity_mean": 11.865120648411262, "cost2_mean": -74.89664834012984}, "time_total_s": 1140.429523229599, "time_since_restore": 1140.429523229599, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6c18>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-28-24", "timesteps_total": 3493831, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267304, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2204, "episode_reward_max": 631.4448575508001, "time_this_iter_s": 32.973057985305786, "training_iteration": 33, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 575.296084961127, "episodes_this_iter": 77, "timesteps_this_iter": 101344, "hostname": "flow-main"}
{"episode_reward_mean": 611.9366338510412, "info": {"num_steps_sampled": 3595053, "grad_time_ms": 18757.337, "sample_time_ms": 13967.676, "update_time_ms": 11.064, "default": {"vf_loss": 18.487455368041992, "vf_explained_var": 0.1975782960653305, "entropy": 1.2061432600021362, "total_loss": 18.487043380737305, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000915988115593791, "cur_kl_coeff": 0.05000000819563866, "kl": 0.010079866275191307}, "load_time_ms": 5.36, "num_steps_trained": 3595053}, "episode_len_mean": 700.0, "timesteps_since_restore": 3595053, "custom_metrics": {"cost1_max": 330.6563219339954, "system_level_velocity_min": 11.405166384444936, "system_level_velocity_max": 12.450603451756786, "outflow_rate_mean": 746.5094096581847, "cost2_min": -85.37125428101717, "cost1_min": 303.81164010876876, "cost2_max": -66.55233384981912, "outflow_rate_min": 718.2726762715082, "outflow_rate_max": 767.7779508049101, "cost1_mean": 315.4043199828826, "system_level_velocity_mean": 11.838543553440683, "cost2_mean": -74.57080744855081}, "time_total_s": 1173.618242740631, "time_since_restore": 1173.618242740631, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6ef0>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-28-58", "timesteps_total": 3595053, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267338, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2276, "episode_reward_max": 636.5415192357252, "time_this_iter_s": 33.188719511032104, "training_iteration": 34, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 593.7623908220017, "episodes_this_iter": 72, "timesteps_this_iter": 101222, "hostname": "flow-main"}
{"episode_reward_mean": 616.3930181775451, "info": {"num_steps_sampled": 3696519, "grad_time_ms": 18863.942, "sample_time_ms": 14003.783, "update_time_ms": 10.958, "default": {"vf_loss": 23.679258346557617, "vf_explained_var": 0.1620643436908722, "entropy": 1.2052021026611328, "total_loss": 23.678966522216797, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007475999882444739, "cur_kl_coeff": 0.05000000819563866, "kl": 0.009076735936105251}, "load_time_ms": 5.337, "num_steps_trained": 3696519}, "episode_len_mean": 700.0, "timesteps_since_restore": 3696519, "custom_metrics": {"cost1_max": 333.38597421256, "system_level_velocity_min": 11.305228143106534, "system_level_velocity_max": 12.510179195893262, "outflow_rate_mean": 754.1714756976686, "cost2_min": -85.42986191104434, "cost1_min": 300.74237401484805, "cost2_max": -68.3977297310784, "outflow_rate_min": 729.1172192057572, "outflow_rate_max": 776.3168560240475, "cost1_mean": 316.11493063615063, "system_level_velocity_mean": 11.854607921170468, "cost2_mean": -75.52321665081729}, "time_total_s": 1208.2354140281677, "time_since_restore": 1208.2354140281677, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f60>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-29-32", "timesteps_total": 3696519, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267372, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2356, "episode_reward_max": 657.6227583395723, "time_this_iter_s": 34.61717128753662, "training_iteration": 35, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 601.063452024587, "episodes_this_iter": 80, "timesteps_this_iter": 101466, "hostname": "flow-main"}
{"episode_reward_mean": 618.8741265259337, "info": {"num_steps_sampled": 3798395, "grad_time_ms": 18797.608, "sample_time_ms": 13991.528, "update_time_ms": 10.977, "default": {"vf_loss": 22.38934326171875, "vf_explained_var": 0.2493126392364502, "entropy": 1.185923457145691, "total_loss": 22.38918113708496, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005816716002300382, "cur_kl_coeff": 0.05000000819563866, "kl": 0.008400959894061089}, "load_time_ms": 5.329, "num_steps_trained": 3798395}, "episode_len_mean": 700.0, "timesteps_since_restore": 3798395, "custom_metrics": {"cost1_max": 330.0563054136049, "system_level_velocity_min": 11.338973421203262, "system_level_velocity_max": 12.403971577561913, "outflow_rate_mean": 756.9889303253335, "cost2_min": -85.8753911154042, "cost1_min": 302.434905173954, "cost2_max": -66.46652201941562, "outflow_rate_min": 729.1172192057572, "outflow_rate_max": 775.5126251498496, "cost1_mean": 314.9455175156297, "system_level_velocity_mean": 11.81847630843421, "cost2_mean": -75.17946303999193}, "time_total_s": 1241.0053403377533, "time_since_restore": 1241.0053403377533, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6978>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-30-05", "timesteps_total": 3798395, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267405, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2427, "episode_reward_max": 643.0522206760555, "time_this_iter_s": 32.76992630958557, "training_iteration": 36, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 605.8153709475737, "episodes_this_iter": 71, "timesteps_this_iter": 101876, "hostname": "flow-main"}
{"episode_reward_mean": 623.0656413446405, "info": {"num_steps_sampled": 3900966, "grad_time_ms": 18778.964, "sample_time_ms": 14050.652, "update_time_ms": 11.139, "default": {"vf_loss": 26.083152770996094, "vf_explained_var": 0.27336761355400085, "entropy": 1.1881262063980103, "total_loss": 26.0828800201416, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000698752177413553, "cur_kl_coeff": 0.05000000819563866, "kl": 0.008550877682864666}, "load_time_ms": 5.301, "num_steps_trained": 3900966}, "episode_len_mean": 700.0, "timesteps_since_restore": 3900966, "custom_metrics": {"cost1_max": 334.53496248296665, "system_level_velocity_min": 11.338973421203262, "system_level_velocity_max": 12.438413699288834, "outflow_rate_mean": 760.9928583623749, "cost2_min": -88.0202960742882, "cost1_min": 302.434905173954, "cost2_max": -64.28535546404567, "outflow_rate_min": 735.8377364302695, "outflow_rate_max": 779.8080836027153, "cost1_mean": 316.32441870413476, "system_level_velocity_mean": 11.862210459088438, "cost2_mean": -75.71522328653799}, "time_total_s": 1275.46630525589, "time_since_restore": 1275.46630525589, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6ba8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-30-40", "timesteps_total": 3900966, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267440, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2503, "episode_reward_max": 656.6250152839809, "time_this_iter_s": 34.4609649181366, "training_iteration": 37, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 608.6893377659467, "episodes_this_iter": 76, "timesteps_this_iter": 102571, "hostname": "flow-main"}
{"episode_reward_mean": 632.8446678546774, "info": {"num_steps_sampled": 4003542, "grad_time_ms": 18794.737, "sample_time_ms": 14044.037, "update_time_ms": 10.895, "default": {"vf_loss": 28.51183319091797, "vf_explained_var": 0.23946282267570496, "entropy": 1.1888582706451416, "total_loss": 28.511571884155273, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006843017763458192, "cur_kl_coeff": 0.05000000819563866, "kl": 0.008447510190308094}, "load_time_ms": 5.161, "num_steps_trained": 4003542}, "episode_len_mean": 700.0, "timesteps_since_restore": 4003542, "custom_metrics": {"cost1_max": 335.66795088649627, "system_level_velocity_min": 11.419300775306967, "system_level_velocity_max": 12.631246349748773, "outflow_rate_mean": 765.9731328057679, "cost2_min": -88.68542214564441, "cost1_min": 304.3228894485702, "cost2_max": -64.28535546404567, "outflow_rate_min": 744.4832349938513, "outflow_rate_max": 782.1469183116765, "cost1_mean": 319.45666167710095, "system_level_velocity_mean": 11.990199881655297, "cost2_mean": -75.7292363006371}, "time_total_s": 1308.5127217769623, "time_since_restore": 1308.5127217769623, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f60b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-31-13", "timesteps_total": 4003542, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267473, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2574, "episode_reward_max": 674.3984506950204, "time_this_iter_s": 33.04641652107239, "training_iteration": 38, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 609.7057607247757, "episodes_this_iter": 71, "timesteps_this_iter": 102576, "hostname": "flow-main"}
{"episode_reward_mean": 639.1487545746367, "info": {"num_steps_sampled": 4105403, "grad_time_ms": 19019.209, "sample_time_ms": 14061.757, "update_time_ms": 11.013, "default": {"vf_loss": 30.00916862487793, "vf_explained_var": 0.22665324807167053, "entropy": 1.1813968420028687, "total_loss": 30.008588790893555, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009524080087430775, "cur_kl_coeff": 0.05000000819563866, "kl": 0.0074594407342374325}, "load_time_ms": 4.97, "num_steps_trained": 4105403}, "episode_len_mean": 700.0, "timesteps_since_restore": 4105403, "custom_metrics": {"cost1_max": 354.06518930288934, "system_level_velocity_min": 11.439359002444286, "system_level_velocity_max": 13.280524484623234, "outflow_rate_mean": 769.8413965846265, "cost2_min": -91.70275249095364, "cost1_min": 302.8624814184734, "cost2_max": -67.2896244316335, "outflow_rate_min": 751.4988988804804, "outflow_rate_max": 788.2297018182027, "cost1_mean": 323.41155606399826, "system_level_velocity_mean": 12.155406347567716, "cost2_mean": -76.37543659865509}, "time_total_s": 1341.5810363292694, "time_since_restore": 1341.5810363292694, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219709b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970c88>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-31-46", "timesteps_total": 4105403, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267506, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2645, "episode_reward_max": 671.5775158360437, "time_this_iter_s": 33.06831455230713, "training_iteration": 39, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 610.9819615662848, "episodes_this_iter": 71, "timesteps_this_iter": 101861, "hostname": "flow-main"}
{"episode_reward_mean": 644.0728358643896, "info": {"num_steps_sampled": 4206870, "grad_time_ms": 19270.292, "sample_time_ms": 14085.706, "update_time_ms": 11.005, "default": {"vf_loss": 32.56089401245117, "vf_explained_var": 0.22064487636089325, "entropy": 1.164643406867981, "total_loss": 32.560794830322266, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00047200528206303716, "cur_kl_coeff": 0.05000000819563866, "kl": 0.007477736100554466}, "load_time_ms": 4.801, "num_steps_trained": 4206870}, "episode_len_mean": 700.0, "timesteps_since_restore": 4206870, "custom_metrics": {"cost1_max": 342.50458680239916, "system_level_velocity_min": 11.641957891814052, "system_level_velocity_max": 12.858526788071314, "outflow_rate_mean": 772.798542873973, "cost2_min": -92.79006670501698, "cost1_min": 308.8497376294757, "cost2_max": -66.87193306300564, "outflow_rate_min": 757.3933070941367, "outflow_rate_max": 788.2297018182027, "cost1_mean": 325.2311367064509, "system_level_velocity_mean": 12.228962634976565, "cost2_mean": -76.03407077457469}, "time_total_s": 1376.6113150119781, "time_since_restore": 1376.6113150119781, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a90>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-32-21", "timesteps_total": 4206870, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267541, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2721, "episode_reward_max": 671.5775158360437, "time_this_iter_s": 35.03027868270874, "training_iteration": 40, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 621.8478261875837, "episodes_this_iter": 76, "timesteps_this_iter": 101467, "hostname": "flow-main"}
{"episode_reward_mean": 646.8383373341945, "info": {"num_steps_sampled": 4308642, "grad_time_ms": 19319.934, "sample_time_ms": 14099.8, "update_time_ms": 10.923, "default": {"vf_loss": 34.44257736206055, "vf_explained_var": 0.23952342569828033, "entropy": 1.160750150680542, "total_loss": 34.443111419677734, "cur_lr": 0.0005000000237487257, "policy_loss": 0.00020398350898176432, "cur_kl_coeff": 0.05000000819563866, "kl": 0.00661940174177289}, "load_time_ms": 4.989, "num_steps_trained": 4308642}, "episode_len_mean": 700.0, "timesteps_since_restore": 4308642, "custom_metrics": {"cost1_max": 341.47087417721235, "system_level_velocity_min": 11.745444056323686, "system_level_velocity_max": 12.825626029992863, "outflow_rate_mean": 774.6817589710098, "cost2_min": -94.7052201458385, "cost1_min": 311.2949659335662, "cost2_max": -66.60807126949128, "outflow_rate_min": 760.0882249338068, "outflow_rate_max": 785.850423338803, "cost1_mean": 324.83010978666306, "system_level_velocity_mean": 12.227034935011556, "cost2_mean": -76.4893494897512}, "time_total_s": 1409.9785447120667, "time_since_restore": 1409.9785447120667, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970898>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-32-54", "timesteps_total": 4308642, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267574, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2802, "episode_reward_max": 663.7396383451093, "time_this_iter_s": 33.3672297000885, "training_iteration": 41, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 627.5827835291102, "episodes_this_iter": 81, "timesteps_this_iter": 101772, "hostname": "flow-main"}
{"episode_reward_mean": 648.7542069944975, "info": {"num_steps_sampled": 4410640, "grad_time_ms": 19325.512, "sample_time_ms": 14117.211, "update_time_ms": 10.665, "default": {"vf_loss": 33.08528518676758, "vf_explained_var": 0.2168368399143219, "entropy": 1.1553516387939453, "total_loss": 33.08533477783203, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003601135977078229, "cur_kl_coeff": 0.05000000819563866, "kl": 0.008158337324857712}, "load_time_ms": 4.96, "num_steps_trained": 4410640}, "episode_len_mean": 700.0, "timesteps_since_restore": 4410640, "custom_metrics": {"cost1_max": 343.1223905645285, "system_level_velocity_min": 11.745444056323686, "system_level_velocity_max": 12.962371740031912, "outflow_rate_mean": 775.7006326996863, "cost2_min": -92.20728931194354, "cost1_min": 311.2949659335662, "cost2_max": -67.22723401094525, "outflow_rate_min": 761.4272673418757, "outflow_rate_max": 787.8575403011951, "cost1_mean": 327.9229884245048, "system_level_velocity_mean": 12.368648336794282, "cost2_mean": -76.48071077608995}, "time_total_s": 1443.9867541790009, "time_since_restore": 1443.9867541790009, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6978>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-33-28", "timesteps_total": 4410640, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267608, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2875, "episode_reward_max": 667.7322416341051, "time_this_iter_s": 34.008209466934204, "training_iteration": 42, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 625.5525062190328, "episodes_this_iter": 73, "timesteps_this_iter": 101998, "hostname": "flow-main"}
{"episode_reward_mean": 651.319334006371, "info": {"num_steps_sampled": 4512077, "grad_time_ms": 19144.332, "sample_time_ms": 14105.586, "update_time_ms": 10.809, "default": {"vf_loss": 34.683528900146484, "vf_explained_var": 0.19258010387420654, "entropy": 1.1633244752883911, "total_loss": 34.68333435058594, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005984986783005297, "cur_kl_coeff": 0.05000000819563866, "kl": 0.008122173137962818}, "load_time_ms": 4.725, "num_steps_trained": 4512077}, "episode_len_mean": 700.0, "timesteps_since_restore": 4512077, "custom_metrics": {"cost1_max": 345.81609546205357, "system_level_velocity_min": 11.757881726708536, "system_level_velocity_max": 13.054263488186214, "outflow_rate_mean": 777.2324651845432, "cost2_min": -92.17027930499941, "cost1_min": 311.24843249534433, "cost2_max": -64.50533972872998, "outflow_rate_min": 764.5895074540903, "outflow_rate_max": 792.2648867866211, "cost1_mean": 330.4881155410935, "system_level_velocity_mean": 12.486656303283384, "cost2_mean": -75.04823100146703}, "time_total_s": 1475.0306310653687, "time_since_restore": 1475.0306310653687, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721970748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219674e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967048>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-33-59", "timesteps_total": 4512077, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267639, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 2950, "episode_reward_max": 670.7646054759358, "time_this_iter_s": 31.043876886367798, "training_iteration": 43, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 625.5525062190328, "episodes_this_iter": 75, "timesteps_this_iter": 101437, "hostname": "flow-main"}
{"episode_reward_mean": 655.2879001275824, "info": {"num_steps_sampled": 4613940, "grad_time_ms": 19109.969, "sample_time_ms": 14106.926, "update_time_ms": 10.84, "default": {"vf_loss": 32.69020080566406, "vf_explained_var": 0.1578250378370285, "entropy": 1.1707332134246826, "total_loss": 32.68983840942383, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007151429890654981, "cur_kl_coeff": 0.05000000819563866, "kl": 0.007099433336406946}, "load_time_ms": 4.646, "num_steps_trained": 4613940}, "episode_len_mean": 700.0, "timesteps_since_restore": 4613940, "custom_metrics": {"cost1_max": 374.9270401258267, "system_level_velocity_min": 11.9957802324222, "system_level_velocity_max": 14.117291537439694, "outflow_rate_mean": 776.8556602107035, "cost2_min": -90.28995005266503, "cost1_min": 317.5158152056491, "cost2_max": -63.67492044980403, "outflow_rate_min": 763.425510832971, "outflow_rate_max": 792.381877248718, "cost1_mean": 333.10399131704247, "system_level_velocity_mean": 12.595899584439785, "cost2_mean": -73.13053633542683}, "time_total_s": 1507.8916776180267, "time_since_restore": 1507.8916776180267, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6940>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-34-32", "timesteps_total": 4613940, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267672, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3020, "episode_reward_max": 676.6369921073289, "time_this_iter_s": 32.86104655265808, "training_iteration": 44, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 630.2201094733236, "episodes_this_iter": 70, "timesteps_this_iter": 101863, "hostname": "flow-main"}
{"episode_reward_mean": 661.5824637961605, "info": {"num_steps_sampled": 4715691, "grad_time_ms": 18933.32, "sample_time_ms": 14088.209, "update_time_ms": 10.759, "default": {"vf_loss": 32.47466278076172, "vf_explained_var": 0.15847991406917572, "entropy": 1.1624224185943604, "total_loss": 32.4741325378418, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009308760636486113, "cur_kl_coeff": 0.05000000447034836, "kl": 0.008093523792922497}, "load_time_ms": 4.531, "num_steps_trained": 4715691}, "episode_len_mean": 700.0, "timesteps_since_restore": 4715691, "custom_metrics": {"cost1_max": 350.92503191560434, "system_level_velocity_min": 11.886100385317347, "system_level_velocity_max": 13.308458009278466, "outflow_rate_mean": 776.7122978730747, "cost2_min": -89.74299408791371, "cost1_min": 312.6749932008372, "cost2_max": -62.02908870922873, "outflow_rate_min": 762.4349309223882, "outflow_rate_max": 788.2421941822828, "cost1_mean": 332.7220458976806, "system_level_velocity_mean": 12.572385866211425, "cost2_mean": -73.50051981754449}, "time_total_s": 1540.551394701004, "time_since_restore": 1540.551394701004, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f98>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-35-05", "timesteps_total": 4715691, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267705, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3094, "episode_reward_max": 683.6763997379217, "time_this_iter_s": 32.659717082977295, "training_iteration": 45, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 635.4378168821918, "episodes_this_iter": 74, "timesteps_this_iter": 101751, "hostname": "flow-main"}
{"episode_reward_mean": 669.8696262783176, "info": {"num_steps_sampled": 4818262, "grad_time_ms": 19074.138, "sample_time_ms": 14140.757, "update_time_ms": 10.806, "default": {"vf_loss": 20.08620834350586, "vf_explained_var": 0.24904648959636688, "entropy": 1.1617528200149536, "total_loss": 20.086023330688477, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006781508564017713, "cur_kl_coeff": 0.05000000819563866, "kl": 0.009897428564727306}, "load_time_ms": 4.527, "num_steps_trained": 4818262}, "episode_len_mean": 700.0, "timesteps_since_restore": 4818262, "custom_metrics": {"cost1_max": 360.2477200806604, "system_level_velocity_min": 11.508875669987935, "system_level_velocity_max": 13.619898591874364, "outflow_rate_mean": 781.3526378580893, "cost2_min": -83.54209117735563, "cost1_min": 303.65582740657084, "cost2_max": -66.9339596998493, "outflow_rate_min": 762.4349309223882, "outflow_rate_max": 803.415511918399, "cost1_mean": 330.25440566970906, "system_level_velocity_mean": 12.456758538172032, "cost2_mean": -73.35285253722532}, "time_total_s": 1575.2810316085815, "time_since_restore": 1575.2810316085815, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6cf8>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-35-40", "timesteps_total": 4818262, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267740, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3170, "episode_reward_max": 690.3297220013477, "time_this_iter_s": 34.729636907577515, "training_iteration": 46, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 635.4378168821918, "episodes_this_iter": 76, "timesteps_this_iter": 102571, "hostname": "flow-main"}
{"episode_reward_mean": 673.6539821684337, "info": {"num_steps_sampled": 4921640, "grad_time_ms": 19137.635, "sample_time_ms": 14127.499, "update_time_ms": 10.817, "default": {"vf_loss": 12.709174156188965, "vf_explained_var": 0.3545493185520172, "entropy": 1.124866247177124, "total_loss": 12.707538604736328, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002124779624864459, "cur_kl_coeff": 0.05000000819563866, "kl": 0.009758380241692066}, "load_time_ms": 4.636, "num_steps_trained": 4921640}, "episode_len_mean": 700.0, "timesteps_since_restore": 4921640, "custom_metrics": {"cost1_max": 360.2477200806604, "system_level_velocity_min": 11.458532395945884, "system_level_velocity_max": 13.619898591874364, "outflow_rate_mean": 784.8882431487775, "cost2_min": -85.23546558573118, "cost1_min": 305.057311197171, "cost2_max": -64.65499171206133, "outflow_rate_min": 764.8487971193205, "outflow_rate_max": 811.5138444267675, "cost1_mean": 325.7558544280059, "system_level_velocity_mean": 12.251752942243181, "cost2_mean": -73.30686867454239}, "time_total_s": 1610.2251760959625, "time_since_restore": 1610.2251760959625, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f65c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-36-15", "timesteps_total": 4921640, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267775, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3239, "episode_reward_max": 686.4551631763962, "time_this_iter_s": 34.94414448738098, "training_iteration": 47, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 643.6248670458956, "episodes_this_iter": 69, "timesteps_this_iter": 103378, "hostname": "flow-main"}
{"episode_reward_mean": 676.0301365269157, "info": {"num_steps_sampled": 5024856, "grad_time_ms": 19021.092, "sample_time_ms": 14183.485, "update_time_ms": 10.946, "default": {"vf_loss": 12.841545104980469, "vf_explained_var": 0.42499297857284546, "entropy": 1.1079829931259155, "total_loss": 12.840251922607422, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0018211131682619452, "cur_kl_coeff": 0.050000011920928955, "kl": 0.010559162124991417}, "load_time_ms": 4.814, "num_steps_trained": 5024856}, "episode_len_mean": 700.0, "timesteps_since_restore": 5024856, "custom_metrics": {"cost1_max": 359.4783079626982, "system_level_velocity_min": 11.532797465251289, "system_level_velocity_max": 13.521811949517346, "outflow_rate_mean": 785.6589284412838, "cost2_min": -85.3967824140837, "cost1_min": 307.0157752552452, "cost2_max": -64.32708963892419, "outflow_rate_min": 773.8976505893861, "outflow_rate_max": 811.5138444267675, "cost1_mean": 321.87095791667514, "system_level_velocity_mean": 12.091369048885674, "cost2_mean": -72.46917242805874}, "time_total_s": 1642.6339797973633, "time_since_restore": 1642.6339797973633, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f60b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6438>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-36-47", "timesteps_total": 5024856, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267807, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3308, "episode_reward_max": 702.3128917799407, "time_this_iter_s": 32.40880370140076, "training_iteration": 48, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 660.0619336474026, "episodes_this_iter": 69, "timesteps_this_iter": 103216, "hostname": "flow-main"}
{"episode_reward_mean": 676.111364613295, "info": {"num_steps_sampled": 5128036, "grad_time_ms": 18887.622, "sample_time_ms": 14220.11, "update_time_ms": 11.195, "default": {"vf_loss": 17.96724510192871, "vf_explained_var": 0.44425931572914124, "entropy": 1.133507490158081, "total_loss": 17.966543197631836, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0015624214429408312, "cur_kl_coeff": 0.050000011920928955, "kl": 0.017190558835864067}, "load_time_ms": 4.699, "num_steps_trained": 5128036}, "episode_len_mean": 700.0, "timesteps_since_restore": 5128036, "custom_metrics": {"cost1_max": 359.4783079626982, "system_level_velocity_min": 11.633189569767604, "system_level_velocity_max": 13.521811949517346, "outflow_rate_mean": 784.2017943179692, "cost2_min": -86.52493519991532, "cost1_min": 308.9326359191528, "cost2_max": -62.97836905708871, "outflow_rate_min": 773.7783317641268, "outflow_rate_max": 800.9946073468126, "cost1_mean": 322.9677661971166, "system_level_velocity_mean": 12.126580680262894, "cost2_mean": -72.4353320347678}, "time_total_s": 1674.7631902694702, "time_since_restore": 1674.7631902694702, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f62e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f98>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-37-19", "timesteps_total": 5128036, "done": false, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267839, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3378, "episode_reward_max": 702.3128917799407, "time_this_iter_s": 32.129210472106934, "training_iteration": 49, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 656.3566933484427, "episodes_this_iter": 70, "timesteps_this_iter": 103180, "hostname": "flow-main"}
{"episode_reward_mean": 672.1899613145433, "info": {"num_steps_sampled": 5231402, "grad_time_ms": 18698.549, "sample_time_ms": 14264.26, "update_time_ms": 11.084, "default": {"vf_loss": 18.066362380981445, "vf_explained_var": 0.3160266578197479, "entropy": 1.1087493896484375, "total_loss": 18.065166473388672, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001893352367915213, "cur_kl_coeff": 0.05000000819563866, "kl": 0.01395061518996954}, "load_time_ms": 4.621, "num_steps_trained": 5231402}, "episode_len_mean": 700.0, "timesteps_since_restore": 5231402, "custom_metrics": {"cost1_max": 350.3445249457723, "system_level_velocity_min": 11.388545525321543, "system_level_velocity_max": 13.199108911684645, "outflow_rate_mean": 785.4521763383921, "cost2_min": -87.17491685824295, "cost1_min": 301.8727517927331, "cost2_max": -61.53436330890081, "outflow_rate_min": 773.3186161071549, "outflow_rate_max": 797.6101318735485, "cost1_mean": 319.6004848500825, "system_level_velocity_mean": 12.012031418027822, "cost2_mean": -73.89003534874296}, "time_total_s": 1708.3178215026855, "time_since_restore": 1708.3178215026855, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 5.0]_t_min:10.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "synchronize_filters": true, "num_gpus_per_worker": 0, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6e48>"}, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "framestack": true, "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "use_lstm": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "date": "2019-04-26_08-37-53", "timesteps_total": 5231402, "done": true, "node_ip": "10.138.0.2", "pid": 24067, "timestamp": 1556267873, "experiment_id": "8f4eb5d6e55f4d55950e55caeff68229", "episodes_total": 3447, "episode_reward_max": 699.3732494962577, "time_this_iter_s": 33.55463123321533, "training_iteration": 50, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 647.1373051505384, "episodes_this_iter": 69, "timesteps_this_iter": 103366, "hostname": "flow-main"}

{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 47.976521492004395, "episodes_this_iter": 28, "timestamp": 1558331431, "episode_reward_max": 379.83575344638615, "info": {"load_time_ms": 63.429, "default": {"vf_loss": 0.9068155884742737, "total_loss": 0.9059895873069763, "entropy": 1.4141167402267456, "cur_kl_coeff": 0.20000001788139343, "policy_loss": -0.0013957761693745852, "vf_explained_var": 0.8976221680641174, "cur_lr": 0.0005000000237487257, "kl": 0.0028487893287092447}, "num_steps_trained": 64785, "grad_time_ms": 18162.331, "num_steps_sampled": 64785, "sample_time_ms": 28944.151, "update_time_ms": 616.39}, "time_since_restore": 47.976521492004395, "timesteps_total": 64785, "episode_len_mean": 676.1071428571429, "episodes_total": 28, "training_iteration": 1, "episode_reward_mean": 272.2840188158193, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.976521492004395, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b3c8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 1, "date": "2019-05-20_05-50-31", "timesteps_since_restore": 64785, "timesteps_this_iter": 64785, "custom_metrics": {"system_level_velocity_min": 6.641482740952397, "outflow_rate_max": 741.9122491191375, "system_level_velocity_max": 17.732263278335445, "cost1_mean": 188.9835273781027, "outflow_rate_mean": 584.341785088581, "cost1_min": 19.79029297327066, "cost2_min": -66.21185598750708, "cost1_max": 227.56625553236688, "outflow_rate_min": 472.2626520890777, "cost2_max": -20.09554831293954, "cost2_mean": -49.4500668978061, "system_level_velocity_mean": 7.933188794257988}, "episode_reward_min": 39.920974669344176, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 104.5954122543335, "episodes_this_iter": 27, "timestamp": 1558331487, "episode_reward_max": 440.21185666624734, "info": {"load_time_ms": 38.901, "default": {"vf_loss": 0.8310123682022095, "total_loss": 0.828443169593811, "entropy": 1.4138890504837036, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0034397717099636793, "vf_explained_var": 0.9494184851646423, "cur_lr": 0.0005000000237487257, "kl": 0.008705342188477516}, "num_steps_trained": 140548, "grad_time_ms": 18923.497, "num_steps_sampled": 140548, "sample_time_ms": 32854.768, "update_time_ms": 311.953}, "time_since_restore": 104.5954122543335, "timesteps_total": 140548, "episode_len_mean": 675.6545454545454, "episodes_total": 55, "training_iteration": 2, "episode_reward_mean": 290.69836737677304, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 56.6188907623291, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde320>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 2, "date": "2019-05-20_05-51-27", "timesteps_since_restore": 140548, "timesteps_this_iter": 75763, "custom_metrics": {"system_level_velocity_min": 3.004119190759299, "outflow_rate_max": 741.9122491191375, "system_level_velocity_max": 17.984250814378537, "cost1_mean": 183.28193564861053, "outflow_rate_mean": 571.1913331040263, "cost1_min": 19.79029297327066, "cost2_min": -91.25784381072171, "cost1_max": 227.56625553236688, "outflow_rate_min": 290.49782292137917, "cost2_max": -20.09554831293954, "cost2_mean": -57.423701904953624, "system_level_velocity_mean": 7.718569200342407}, "episode_reward_min": 39.920974669344176, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 165.9486484527588, "episodes_this_iter": 25, "timestamp": 1558331549, "episode_reward_max": 612.2738356163238, "info": {"load_time_ms": 30.701, "default": {"vf_loss": 1.5762569904327393, "total_loss": 1.574414849281311, "entropy": 1.3979592323303223, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.002629648195579648, "vf_explained_var": 0.9618272185325623, "cur_lr": 0.0005000000237487257, "kl": 0.007876652292907238}, "num_steps_trained": 220641, "grad_time_ms": 20436.473, "num_steps_sampled": 220641, "sample_time_ms": 34485.027, "update_time_ms": 210.578}, "time_since_restore": 165.9486484527588, "timesteps_total": 220641, "episode_len_mean": 683.2625, "episodes_total": 80, "training_iteration": 3, "episode_reward_mean": 332.99725978778883, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 61.35323619842529, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e278>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 3, "date": "2019-05-20_05-52-29", "timesteps_since_restore": 220641, "timesteps_this_iter": 80093, "custom_metrics": {"system_level_velocity_min": 3.004119190759299, "outflow_rate_max": 937.9416868151693, "system_level_velocity_max": 17.984250814378537, "cost1_mean": 190.75569956229492, "outflow_rate_mean": 594.8355748612152, "cost1_min": 19.79029297327066, "cost2_min": -116.7315837901439, "cost1_max": 286.3996308382093, "outflow_rate_min": 290.49782292137917, "cost2_max": -20.09554831293954, "cost2_mean": -68.78992930440157, "system_level_velocity_mean": 7.779032747148257}, "episode_reward_min": 39.920974669344176, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 225.2359435558319, "episodes_this_iter": 24, "timestamp": 1558331608, "episode_reward_max": 643.2427013134422, "info": {"load_time_ms": 26.349, "default": {"vf_loss": 2.8082046508789062, "total_loss": 2.806325674057007, "entropy": 1.3852301836013794, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0025262755807489157, "vf_explained_var": 0.9567814469337463, "cur_lr": 0.0005000000237487257, "kl": 0.00647232448682189}, "num_steps_trained": 301001, "grad_time_ms": 20695.386, "num_steps_sampled": 301001, "sample_time_ms": 35282.553, "update_time_ms": 160.035}, "time_since_restore": 225.2359435558319, "timesteps_total": 301001, "episode_len_mean": 686.61, "episodes_total": 104, "training_iteration": 4, "episode_reward_mean": 383.2305117592259, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 59.28729510307312, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e780>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 4, "date": "2019-05-20_05-53-28", "timesteps_since_restore": 301001, "timesteps_this_iter": 80360, "custom_metrics": {"system_level_velocity_min": 3.004119190759299, "outflow_rate_max": 982.4769653903062, "system_level_velocity_max": 17.984250814378537, "cost1_mean": 200.67919740093228, "outflow_rate_mean": 640.9594092238865, "cost1_min": 19.79029297327066, "cost2_min": -129.09983175952738, "cost1_max": 293.1514057242065, "outflow_rate_min": 290.49782292137917, "cost2_max": -20.09554831293954, "cost2_mean": -82.05657754689932, "system_level_velocity_mean": 8.039214128871393}, "episode_reward_min": 39.920974669344176, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 281.16466903686523, "episodes_this_iter": 25, "timestamp": 1558331664, "episode_reward_max": 943.128262370114, "info": {"load_time_ms": 23.363, "default": {"vf_loss": 4.5037689208984375, "total_loss": 4.501020908355713, "entropy": 1.3716706037521362, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.003657107474282384, "vf_explained_var": 0.935948371887207, "cur_lr": 0.0005000000237487257, "kl": 0.009092678315937519}, "num_steps_trained": 377283, "grad_time_ms": 20325.002, "num_steps_sampled": 377283, "sample_time_ms": 35615.571, "update_time_ms": 129.532}, "time_since_restore": 281.16466903686523, "timesteps_total": 377283, "episode_len_mean": 693.3, "episodes_total": 129, "training_iteration": 5, "episode_reward_mean": 477.64186900071894, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 55.928725481033325, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5903c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5906a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590978>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 5, "date": "2019-05-20_05-54-24", "timesteps_since_restore": 377283, "timesteps_this_iter": 76282, "custom_metrics": {"system_level_velocity_min": 3.004119190759299, "outflow_rate_max": 1166.1480753055143, "system_level_velocity_max": 17.984250814378537, "cost1_mean": 223.2001155671971, "outflow_rate_mean": 723.2328259564863, "cost1_min": 20.154698106368407, "cost2_min": -155.8644261029318, "cost1_max": 369.50419354280433, "outflow_rate_min": 290.49782292137917, "cost2_max": -21.070699110419543, "cost2_mean": -102.86307706294909, "system_level_velocity_mean": 8.704169574473932}, "episode_reward_min": 48.882000732550495, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 335.69280338287354, "episodes_this_iter": 25, "timestamp": 1558331719, "episode_reward_max": 953.854135253642, "info": {"load_time_ms": 21.45, "default": {"vf_loss": 5.838201999664307, "total_loss": 5.835634231567383, "entropy": 1.352210283279419, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.003313065506517887, "vf_explained_var": 0.9205015301704407, "cur_lr": 0.0005000000237487257, "kl": 0.007457983214408159}, "num_steps_trained": 448626, "grad_time_ms": 19919.936, "num_steps_sampled": 448626, "sample_time_ms": 35761.209, "update_time_ms": 109.49}, "time_since_restore": 335.69280338287354, "timesteps_total": 448626, "episode_len_mean": 693.3, "episodes_total": 154, "training_iteration": 6, "episode_reward_mean": 574.8926496133231, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 54.5281343460083, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5861d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586550>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 6, "date": "2019-05-20_05-55-19", "timesteps_since_restore": 448626, "timesteps_this_iter": 71343, "custom_metrics": {"system_level_velocity_min": 6.113754765363132, "outflow_rate_max": 1245.0652712600408, "system_level_velocity_max": 17.984250814378537, "cost1_mean": 249.30480996826395, "outflow_rate_mean": 820.5505616507329, "cost1_min": 20.154698106368407, "cost2_min": -160.22986260000508, "cost1_max": 424.02388772822576, "outflow_rate_min": 396.41028940236885, "cost2_max": -21.070699110419543, "cost2_mean": -122.62671121254573, "system_level_velocity_mean": 9.684291346098906}, "episode_reward_min": 48.882000732550495, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 391.2672667503357, "episodes_this_iter": 26, "timestamp": 1558331774, "episode_reward_max": 962.0112866898781, "info": {"load_time_ms": 19.882, "default": {"vf_loss": 6.135076522827148, "total_loss": 6.132452487945557, "entropy": 1.3407403230667114, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0032855761237442493, "vf_explained_var": 0.8959881067276001, "cur_lr": 0.0005000000237487257, "kl": 0.006611664779484272}, "num_steps_trained": 519283, "grad_time_ms": 19904.977, "num_steps_sampled": 519283, "sample_time_ms": 35737.342, "update_time_ms": 95.101}, "time_since_restore": 391.2672667503357, "timesteps_total": 519283, "episode_len_mean": 700.0, "episodes_total": 180, "training_iteration": 7, "episode_reward_mean": 667.302589024261, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 55.57446336746216, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e4e0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 7, "date": "2019-05-20_05-56-14", "timesteps_since_restore": 519283, "timesteps_this_iter": 70657, "custom_metrics": {"system_level_velocity_min": 6.930449172997409, "outflow_rate_max": 1245.0652712600408, "system_level_velocity_max": 15.750887096902872, "cost1_mean": 277.98779023439033, "outflow_rate_mean": 918.331945286756, "cost1_min": 177.50235794347674, "cost2_min": -176.75489104900672, "cost1_max": 424.02388772822576, "outflow_rate_min": 633.0700677132606, "cost2_max": -107.9371762685144, "cost2_mean": -138.52553320570263, "system_level_velocity_mean": 10.603774676513481}, "episode_reward_min": 444.885374550485, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 442.7441885471344, "episodes_this_iter": 26, "timestamp": 1558331826, "episode_reward_max": 962.0112866898781, "info": {"load_time_ms": 18.071, "default": {"vf_loss": 6.524860858917236, "total_loss": 6.521647930145264, "entropy": 1.3402490615844727, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.00401304243132472, "vf_explained_var": 0.8706220388412476, "cur_lr": 0.0005000000237487257, "kl": 0.007997788488864899}, "num_steps_trained": 590175, "grad_time_ms": 19615.989, "num_steps_sampled": 590175, "sample_time_ms": 35490.563, "update_time_ms": 84.467}, "time_since_restore": 442.7441885471344, "timesteps_total": 590175, "episode_len_mean": 700.0, "episodes_total": 206, "training_iteration": 8, "episode_reward_mean": 719.2001529267835, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 51.476921796798706, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6748>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 8, "date": "2019-05-20_05-57-06", "timesteps_since_restore": 590175, "timesteps_this_iter": 70892, "custom_metrics": {"system_level_velocity_min": 8.156124418725401, "outflow_rate_max": 1245.0652712600408, "system_level_velocity_max": 15.750887096902872, "cost1_mean": 296.1623630875693, "outflow_rate_mean": 971.9667030723892, "cost1_min": 210.65402881053922, "cost2_min": -181.16674562771902, "cost1_max": 424.02388772822576, "outflow_rate_min": 683.4563396397544, "cost2_max": -124.53910910325467, "cost2_mean": -147.90662102030922, "system_level_velocity_mean": 11.30182002940242}, "episode_reward_min": 462.35629254599644, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 492.71662855148315, "episodes_this_iter": 27, "timestamp": 1558331876, "episode_reward_max": 962.0112866898781, "info": {"load_time_ms": 17.02, "default": {"vf_loss": 6.9576735496521, "total_loss": 6.9539899826049805, "entropy": 1.3289116621017456, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.004576602019369602, "vf_explained_var": 0.87610924243927, "cur_lr": 0.0005000000237487257, "kl": 0.00892663560807705}, "num_steps_trained": 660428, "grad_time_ms": 19401.051, "num_steps_sampled": 660428, "sample_time_ms": 35121.719, "update_time_ms": 75.903}, "time_since_restore": 492.71662855148315, "timesteps_total": 660428, "episode_len_mean": 700.0, "episodes_total": 233, "training_iteration": 9, "episode_reward_mean": 747.0433774881461, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 49.972440004348755, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5cee80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce550>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 9, "date": "2019-05-20_05-57-56", "timesteps_since_restore": 660428, "timesteps_this_iter": 70253, "custom_metrics": {"system_level_velocity_min": 8.26183989023343, "outflow_rate_max": 1245.0652712600408, "system_level_velocity_max": 15.750887096902872, "cost1_mean": 305.3960812430751, "outflow_rate_mean": 1002.2260911325976, "cost1_min": 210.65402881053922, "cost2_min": -190.4428159997959, "cost1_max": 424.02388772822576, "outflow_rate_min": 746.7084853998703, "cost2_max": -135.40580800117777, "cost2_mean": -153.75384757178776, "system_level_velocity_mean": 11.636802303949318}, "episode_reward_min": 592.7099309695215, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 543.6342568397522, "episodes_this_iter": 29, "timestamp": 1558331927, "episode_reward_max": 995.5860120919023, "info": {"load_time_ms": 16.15, "default": {"vf_loss": 9.436232566833496, "total_loss": 9.432554244995117, "entropy": 1.3198997974395752, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.004531270824372768, "vf_explained_var": 0.8451666235923767, "cur_lr": 0.0005000000237487257, "kl": 0.008534718304872513}, "num_steps_trained": 728327, "grad_time_ms": 19258.057, "num_steps_sampled": 728327, "sample_time_ms": 34891.729, "update_time_ms": 69.02}, "time_since_restore": 543.6342568397522, "timesteps_total": 728327, "episode_len_mean": 700.0, "episodes_total": 262, "training_iteration": 10, "episode_reward_mean": 759.8063643785347, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 50.91762828826904, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558470>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 10, "date": "2019-05-20_05-58-47", "timesteps_since_restore": 728327, "timesteps_this_iter": 67899, "custom_metrics": {"system_level_velocity_min": 8.26183989023343, "outflow_rate_max": 1228.8421608792084, "system_level_velocity_max": 16.51255211667391, "cost1_mean": 308.6231525272098, "outflow_rate_mean": 1014.010952197313, "cost1_min": 210.7544106486002, "cost2_min": -190.4428159997959, "cost1_max": 437.2688405135605, "outflow_rate_min": 824.0390936662559, "cost2_max": -132.61833582092623, "cost2_mean": -157.69428836263134, "system_level_velocity_mean": 11.750768097920481}, "episode_reward_min": 592.7099309695215, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 593.8693542480469, "episodes_this_iter": 38, "timestamp": 1558331977, "episode_reward_max": 1056.696515482301, "info": {"load_time_ms": 10.358, "default": {"vf_loss": 11.617623329162598, "total_loss": 11.613508224487305, "entropy": 1.3192744255065918, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.005149846896529198, "vf_explained_var": 0.8305702209472656, "cur_lr": 0.0005000000237487257, "kl": 0.010343953967094421}, "num_steps_trained": 795767, "grad_time_ms": 19233.016, "num_steps_sampled": 795767, "sample_time_ms": 35218.107, "update_time_ms": 8.136}, "time_since_restore": 593.8693542480469, "timesteps_total": 795767, "episode_len_mean": 693.34, "episodes_total": 300, "training_iteration": 11, "episode_reward_mean": 762.3589282758849, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 50.23509740829468, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a67f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a66d8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 11, "date": "2019-05-20_05-59-37", "timesteps_since_restore": 795767, "timesteps_this_iter": 67440, "custom_metrics": {"system_level_velocity_min": 8.26183989023343, "outflow_rate_max": 1258.4152939320184, "system_level_velocity_max": 18.345830332712307, "cost1_mean": 309.26512694315056, "outflow_rate_mean": 1021.2035318189892, "cost1_min": 22.86652255409105, "cost2_min": -190.4428159997959, "cost1_max": 437.2688405135605, "outflow_rate_min": 500.064837515095, "cost2_max": -22.27286056211527, "cost2_mean": -159.77425393829216, "system_level_velocity_mean": 11.95621651334576}, "episode_reward_min": 48.69405743560442, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 639.419347524643, "episodes_this_iter": 29, "timestamp": 1558332023, "episode_reward_max": 1056.696515482301, "info": {"load_time_ms": 9.522, "default": {"vf_loss": 11.378313064575195, "total_loss": 11.374231338500977, "entropy": 1.308932900428772, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.005036187823861837, "vf_explained_var": 0.8549941778182983, "cur_lr": 0.0005000000237487257, "kl": 0.009545941837131977}, "num_steps_trained": 859647, "grad_time_ms": 18974.563, "num_steps_sampled": 859647, "sample_time_ms": 34375.333, "update_time_ms": 8.123}, "time_since_restore": 639.419347524643, "timesteps_total": 859647, "episode_len_mean": 693.34, "episodes_total": 329, "training_iteration": 12, "episode_reward_mean": 769.5646166526378, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.54999327659607, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce6a0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 12, "date": "2019-05-20_06-00-23", "timesteps_since_restore": 859647, "timesteps_this_iter": 63880, "custom_metrics": {"system_level_velocity_min": 9.54657459464795, "outflow_rate_max": 1258.4152939320184, "system_level_velocity_max": 18.345830332712307, "cost1_mean": 311.25720410822606, "outflow_rate_mean": 1026.3670463565002, "cost1_min": 22.86652255409105, "cost2_min": -190.34720559755445, "cost1_max": 437.2688405135605, "outflow_rate_min": 500.064837515095, "cost2_max": -22.27286056211527, "cost2_mean": -162.229473376258, "system_level_velocity_mean": 12.046252286349896}, "episode_reward_min": 48.69405743560442, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 685.8512134552002, "episodes_this_iter": 28, "timestamp": 1558332069, "episode_reward_max": 1056.696515482301, "info": {"load_time_ms": 9.066, "default": {"vf_loss": 11.060237884521484, "total_loss": 11.055413246154785, "entropy": 1.316701054573059, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.005882979836314917, "vf_explained_var": 0.8465824127197266, "cur_lr": 0.0005000000237487257, "kl": 0.010580855421721935}, "num_steps_trained": 923408, "grad_time_ms": 18314.606, "num_steps_sampled": 923408, "sample_time_ms": 33544.157, "update_time_ms": 8.207}, "time_since_restore": 685.8512134552002, "timesteps_total": 923408, "episode_len_mean": 693.34, "episodes_total": 357, "training_iteration": 13, "episode_reward_mean": 769.6878277504333, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.43186593055725, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58eb00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 13, "date": "2019-05-20_06-01-09", "timesteps_since_restore": 923408, "timesteps_this_iter": 63761, "custom_metrics": {"system_level_velocity_min": 8.870002272159333, "outflow_rate_max": 1258.4152939320184, "system_level_velocity_max": 18.345830332712307, "cost1_mean": 315.81894201506907, "outflow_rate_mean": 1038.017952910418, "cost1_min": 22.86652255409105, "cost2_min": -190.34720559755445, "cost1_max": 434.0123962622473, "outflow_rate_min": 500.064837515095, "cost2_max": -22.27286056211527, "cost2_mean": -163.46510615587928, "system_level_velocity_mean": 12.233283510006475}, "episode_reward_min": 48.69405743560442, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 732.7344002723694, "episodes_this_iter": 26, "timestamp": 1558332116, "episode_reward_max": 1043.914358122535, "info": {"load_time_ms": 8.623, "default": {"vf_loss": 10.44546127319336, "total_loss": 10.440959930419922, "entropy": 1.3101656436920166, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.005620638839900494, "vf_explained_var": 0.8553996682167053, "cur_lr": 0.0005000000237487257, "kl": 0.01120012253522873}, "num_steps_trained": 989018, "grad_time_ms": 17911.854, "num_steps_sampled": 989018, "sample_time_ms": 32707.896, "update_time_ms": 8.232}, "time_since_restore": 732.7344002723694, "timesteps_total": 989018, "episode_len_mean": 700.0, "episodes_total": 383, "training_iteration": 14, "episode_reward_mean": 775.5448634551861, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.88318681716919, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a60b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6f98>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 14, "date": "2019-05-20_06-01-56", "timesteps_since_restore": 989018, "timesteps_this_iter": 65610, "custom_metrics": {"system_level_velocity_min": 8.870002272159333, "outflow_rate_max": 1254.9927760999772, "system_level_velocity_max": 16.071908248467597, "cost1_mean": 318.53166829567385, "outflow_rate_mean": 1047.9816539201488, "cost1_min": 229.75898854655662, "cost2_min": -189.82151919522786, "cost1_max": 424.40791745435035, "outflow_rate_min": 880.3774145748955, "cost2_max": -142.56364613152584, "cost2_mean": -166.27814059856883, "system_level_velocity_mean": 12.180982878314124}, "episode_reward_min": 611.388475755313, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 780.1260566711426, "episodes_this_iter": 26, "timestamp": 1558332164, "episode_reward_max": 1043.914358122535, "info": {"load_time_ms": 8.079, "default": {"vf_loss": 12.12767505645752, "total_loss": 12.121902465820312, "entropy": 1.3006346225738525, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.007122679613530636, "vf_explained_var": 0.8317453265190125, "cur_lr": 0.0005000000237487257, "kl": 0.013493271544575691}, "num_steps_trained": 1053690, "grad_time_ms": 17869.447, "num_steps_sampled": 1053690, "sample_time_ms": 31898.424, "update_time_ms": 8.195}, "time_since_restore": 780.1260566711426, "timesteps_total": 1053690, "episode_len_mean": 700.0, "episodes_total": 409, "training_iteration": 15, "episode_reward_mean": 786.2630507468479, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.39165639877319, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5903c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590898>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 15, "date": "2019-05-20_06-02-44", "timesteps_since_restore": 1053690, "timesteps_this_iter": 64672, "custom_metrics": {"system_level_velocity_min": 8.870002272159333, "outflow_rate_max": 1252.948463875215, "system_level_velocity_max": 16.071908248467597, "cost1_mean": 325.9722429932574, "outflow_rate_mean": 1066.2009649338577, "cost1_min": 229.75898854655662, "cost2_min": -191.69357229209692, "cost1_max": 424.40791745435035, "outflow_rate_min": 880.3774145748955, "cost2_max": -142.56364613152584, "cost2_mean": -166.45286139279415, "system_level_velocity_mean": 12.46815297239906}, "episode_reward_min": 611.388475755313, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 825.837929725647, "episodes_this_iter": 26, "timestamp": 1558332209, "episode_reward_max": 1002.754263387311, "info": {"load_time_ms": 7.543, "default": {"vf_loss": 11.791443824768066, "total_loss": 11.785818099975586, "entropy": 1.299213171005249, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.006869180593639612, "vf_explained_var": 0.8355604410171509, "cur_lr": 0.0005000000237487257, "kl": 0.012428966350853443}, "num_steps_trained": 1118462, "grad_time_ms": 17761.468, "num_steps_sampled": 1118462, "sample_time_ms": 31126.735, "update_time_ms": 8.005}, "time_since_restore": 825.837929725647, "timesteps_total": 1118462, "episode_len_mean": 700.0, "episodes_total": 435, "training_iteration": 16, "episode_reward_mean": 792.6565437898469, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.711873054504395, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde400>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 16, "date": "2019-05-20_06-03-29", "timesteps_since_restore": 1118462, "timesteps_this_iter": 64772, "custom_metrics": {"system_level_velocity_min": 8.854439644717116, "outflow_rate_max": 1314.7129741074627, "system_level_velocity_max": 17.267568327484476, "cost1_mean": 331.0192346417284, "outflow_rate_mean": 1079.2635582257763, "cost1_min": 230.23966980071953, "cost2_min": -202.2460643590466, "cost1_max": 456.6996036437587, "outflow_rate_min": 856.9094507967337, "cost2_max": -142.56364613152584, "cost2_mean": -168.01063416147815, "system_level_velocity_mean": 12.652939376312707}, "episode_reward_min": 636.8874561322666, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 874.7101347446442, "episodes_this_iter": 27, "timestamp": 1558332258, "episode_reward_max": 1002.0752037883203, "info": {"load_time_ms": 7.501, "default": {"vf_loss": 11.209094047546387, "total_loss": 11.203336715698242, "entropy": 1.3165615797042847, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.007090636994689703, "vf_explained_var": 0.8211522102355957, "cur_lr": 0.0005000000237487257, "kl": 0.01333240419626236}, "num_steps_trained": 1187100, "grad_time_ms": 17576.625, "num_steps_sampled": 1187100, "sample_time_ms": 30644.712, "update_time_ms": 7.836}, "time_since_restore": 874.7101347446442, "timesteps_total": 1187100, "episode_len_mean": 693.35, "episodes_total": 462, "training_iteration": 17, "episode_reward_mean": 780.27913515096, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.87220501899719, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6dd8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 17, "date": "2019-05-20_06-04-18", "timesteps_since_restore": 1187100, "timesteps_this_iter": 68638, "custom_metrics": {"system_level_velocity_min": 8.854439644717116, "outflow_rate_max": 1314.7129741074627, "system_level_velocity_max": 18.54175509402709, "cost1_mean": 324.691306404803, "outflow_rate_mean": 1069.6425429391477, "cost1_min": 22.70638798915477, "cost2_min": -202.2460643590466, "cost1_max": 456.6996036437587, "outflow_rate_min": 505.49254520364195, "cost2_max": -20.915737750335715, "cost2_mean": -169.6965538145241, "system_level_velocity_mean": 12.582811773570175}, "episode_reward_min": 53.00971839323567, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 924.5312147140503, "episodes_this_iter": 26, "timestamp": 1558332308, "episode_reward_max": 986.5602650800623, "info": {"load_time_ms": 7.758, "default": {"vf_loss": 11.183504104614258, "total_loss": 11.177027702331543, "entropy": 1.3066133260726929, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.008068950846791267, "vf_explained_var": 0.8271955847740173, "cur_lr": 0.0005000000237487257, "kl": 0.015920870006084442}, "num_steps_trained": 1255714, "grad_time_ms": 17643.578, "num_steps_sampled": 1255714, "sample_time_ms": 30411.529, "update_time_ms": 7.644}, "time_since_restore": 924.5312147140503, "timesteps_total": 1255714, "episode_len_mean": 693.35, "episodes_total": 488, "training_iteration": 18, "episode_reward_mean": 782.6598731829862, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 49.82107996940613, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590048>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 18, "date": "2019-05-20_06-05-08", "timesteps_since_restore": 1255714, "timesteps_this_iter": 68614, "custom_metrics": {"system_level_velocity_min": 8.512248113690879, "outflow_rate_max": 1314.7129741074627, "system_level_velocity_max": 18.54175509402709, "cost1_mean": 321.20893999738024, "outflow_rate_mean": 1061.5934557155704, "cost1_min": 22.70638798915477, "cost2_min": -211.32937852490494, "cost1_max": 456.6996036437587, "outflow_rate_min": 505.49254520364195, "cost2_max": -20.915737750335715, "cost2_mean": -173.15070734738768, "system_level_velocity_mean": 12.434606383901071}, "episode_reward_min": 53.00971839323567, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 972.4705429077148, "episodes_this_iter": 26, "timestamp": 1558332356, "episode_reward_max": 986.5602650800623, "info": {"load_time_ms": 7.808, "default": {"vf_loss": 13.31856632232666, "total_loss": 13.311646461486816, "entropy": 1.2980884313583374, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.008460335433483124, "vf_explained_var": 0.8140987157821655, "cur_lr": 0.0005000000237487257, "kl": 0.015415829606354237}, "num_steps_trained": 1321553, "grad_time_ms": 17622.827, "num_steps_sampled": 1321553, "sample_time_ms": 30227.94, "update_time_ms": 7.623}, "time_since_restore": 972.4705429077148, "timesteps_total": 1321553, "episode_len_mean": 693.35, "episodes_total": 514, "training_iteration": 19, "episode_reward_mean": 777.2515501033325, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.93932819366455, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586f60>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 19, "date": "2019-05-20_06-05-56", "timesteps_since_restore": 1321553, "timesteps_this_iter": 65839, "custom_metrics": {"system_level_velocity_min": 8.512248113690879, "outflow_rate_max": 1314.7129741074627, "system_level_velocity_max": 18.54175509402709, "cost1_mean": 317.6521185199684, "outflow_rate_mean": 1053.8454144178381, "cost1_min": 22.70638798915477, "cost2_min": -211.32937852490494, "cost1_max": 456.6996036437587, "outflow_rate_min": 505.49254520364195, "cost2_max": -20.915737750335715, "cost2_mean": -176.10284105648327, "system_level_velocity_mean": 12.285918037017055}, "episode_reward_min": 53.00971839323567, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1021.1268935203552, "episodes_this_iter": 29, "timestamp": 1558332405, "episode_reward_max": 1018.3592713078398, "info": {"load_time_ms": 7.746, "default": {"vf_loss": 15.192593574523926, "total_loss": 15.186490058898926, "entropy": 1.2985520362854004, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0076738339848816395, "vf_explained_var": 0.7997509241104126, "cur_lr": 0.0005000000237487257, "kl": 0.015705015510320663}, "num_steps_trained": 1387427, "grad_time_ms": 17569.105, "num_steps_sampled": 1387427, "sample_time_ms": 30055.582, "update_time_ms": 7.712}, "time_since_restore": 1021.1268935203552, "timesteps_total": 1387427, "episode_len_mean": 686.63, "episodes_total": 543, "training_iteration": 20, "episode_reward_mean": 769.8535813640208, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.65635061264038, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a61d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6908>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 20, "date": "2019-05-20_06-06-45", "timesteps_since_restore": 1387427, "timesteps_this_iter": 65874, "custom_metrics": {"system_level_velocity_min": 8.512248113690879, "outflow_rate_max": 1236.9652917268543, "system_level_velocity_max": 18.54175509402709, "cost1_mean": 310.0879920618929, "outflow_rate_mean": 1037.5523634039057, "cost1_min": 18.097635958603323, "cost2_min": -211.32937852490494, "cost1_max": 446.21120716573523, "outflow_rate_min": 472.86459012613903, "cost2_max": -19.187524432278977, "cost2_mean": -176.0322535672748, "system_level_velocity_mean": 12.177101217166594}, "episode_reward_min": 44.570381653508505, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1070.4283578395844, "episodes_this_iter": 31, "timestamp": 1558332454, "episode_reward_max": 1018.3592713078398, "info": {"load_time_ms": 8.227, "default": {"vf_loss": 16.74971580505371, "total_loss": 16.743555068969727, "entropy": 1.286059856414795, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.007738153450191021, "vf_explained_var": 0.8123582005500793, "cur_lr": 0.0005000000237487257, "kl": 0.015780113637447357}, "num_steps_trained": 1452718, "grad_time_ms": 17465.213, "num_steps_sampled": 1452718, "sample_time_ms": 30064.934, "update_time_ms": 7.71}, "time_since_restore": 1070.4283578395844, "timesteps_total": 1452718, "episode_len_mean": 693.28, "episodes_total": 574, "training_iteration": 21, "episode_reward_mean": 783.1961573371696, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 49.301464319229126, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590358>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 21, "date": "2019-05-20_06-07-34", "timesteps_since_restore": 1452718, "timesteps_this_iter": 65291, "custom_metrics": {"system_level_velocity_min": 8.867330542870299, "outflow_rate_max": 1280.115782730113, "system_level_velocity_max": 18.443679697132133, "cost1_mean": 317.28785763692497, "outflow_rate_mean": 1050.7647983406296, "cost1_min": 18.097635958603323, "cost2_min": -211.2953812776386, "cost1_max": 446.21120716573523, "outflow_rate_min": 472.86459012613903, "cost2_max": -19.187524432278977, "cost2_mean": -177.82084144391462, "system_level_velocity_mean": 12.274201941074509}, "episode_reward_min": 44.570381653508505, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1120.8693823814392, "episodes_this_iter": 31, "timestamp": 1558332505, "episode_reward_max": 1018.3592713078398, "info": {"load_time_ms": 8.738, "default": {"vf_loss": 15.76524543762207, "total_loss": 15.758794784545898, "entropy": 1.2844996452331543, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.007977991364896297, "vf_explained_var": 0.8259551525115967, "cur_lr": 0.0005000000237487257, "kl": 0.015258901752531528}, "num_steps_trained": 1519387, "grad_time_ms": 17428.298, "num_steps_sampled": 1519387, "sample_time_ms": 30588.502, "update_time_ms": 7.758}, "time_since_restore": 1120.8693823814392, "timesteps_total": 1519387, "episode_len_mean": 693.28, "episodes_total": 605, "training_iteration": 22, "episode_reward_mean": 783.7703395897515, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 50.44102454185486, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583828>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 22, "date": "2019-05-20_06-08-25", "timesteps_since_restore": 1519387, "timesteps_this_iter": 66669, "custom_metrics": {"system_level_velocity_min": 8.56531885520552, "outflow_rate_max": 1280.115782730113, "system_level_velocity_max": 18.443679697132133, "cost1_mean": 317.4833040904069, "outflow_rate_mean": 1054.0526350162702, "cost1_min": 18.097635958603323, "cost2_min": -222.17123510896838, "cost1_max": 446.21120716573523, "outflow_rate_min": 472.86459012613903, "cost2_max": -19.187524432278977, "cost2_mean": -179.1998001485937, "system_level_velocity_mean": 12.300321747188661}, "episode_reward_min": 44.570381653508505, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1168.4127371311188, "episodes_this_iter": 32, "timestamp": 1558332552, "episode_reward_max": 1006.9002015951972, "info": {"load_time_ms": 8.431, "default": {"vf_loss": 16.724992752075195, "total_loss": 16.71892738342285, "entropy": 1.2924003601074219, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0077090077102184296, "vf_explained_var": 0.8042741417884827, "cur_lr": 0.0005000000237487257, "kl": 0.01646549254655838}, "num_steps_trained": 1585351, "grad_time_ms": 17449.085, "num_steps_sampled": 1585351, "sample_time_ms": 30679.434, "update_time_ms": 7.682}, "time_since_restore": 1168.4127371311188, "timesteps_total": 1585351, "episode_len_mean": 700.0, "episodes_total": 637, "training_iteration": 23, "episode_reward_mean": 787.7580343394437, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.543354749679565, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6780>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 23, "date": "2019-05-20_06-09-12", "timesteps_since_restore": 1585351, "timesteps_this_iter": 65964, "custom_metrics": {"system_level_velocity_min": 8.56531885520552, "outflow_rate_max": 1280.115782730113, "system_level_velocity_max": 16.00233926380809, "cost1_mean": 317.8544128105587, "outflow_rate_mean": 1059.1591635525574, "cost1_min": 223.80522534923136, "cost2_min": -222.17123510896838, "cost1_max": 421.3915513752828, "outflow_rate_min": 873.3564007038492, "cost2_max": -144.80932722544736, "cost2_mean": -184.67632092301986, "system_level_velocity_mean": 12.164143865683961}, "episode_reward_min": 620.3999856327043, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1215.2338109016418, "episodes_this_iter": 28, "timestamp": 1558332599, "episode_reward_max": 1117.3269433802388, "info": {"load_time_ms": 8.156, "default": {"vf_loss": 17.73968505859375, "total_loss": 17.733078002929688, "entropy": 1.2701562643051147, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.008262173272669315, "vf_explained_var": 0.8296939134597778, "cur_lr": 0.0005000000237487257, "kl": 0.016560036689043045}, "num_steps_trained": 1649159, "grad_time_ms": 17398.22, "num_steps_sampled": 1649159, "sample_time_ms": 30724.166, "update_time_ms": 7.661}, "time_since_restore": 1215.2338109016418, "timesteps_total": 1649159, "episode_len_mean": 700.0, "episodes_total": 665, "training_iteration": 24, "episode_reward_mean": 799.9059932722662, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.82107377052307, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590d30>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 24, "date": "2019-05-20_06-09-59", "timesteps_since_restore": 1649159, "timesteps_this_iter": 63808, "custom_metrics": {"system_level_velocity_min": 8.56531885520552, "outflow_rate_max": 1323.4423541233493, "system_level_velocity_max": 17.509913956962276, "cost1_mean": 322.5788113443408, "outflow_rate_mean": 1068.7287650267626, "cost1_min": 223.80522534923136, "cost2_min": -222.17123510896838, "cost1_max": 465.816992581122, "outflow_rate_min": 886.8652911054813, "cost2_max": -144.80932722544736, "cost2_mean": -183.22826707399557, "system_level_velocity_mean": 12.35092499622262}, "episode_reward_min": 620.3999856327043, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1262.8232169151306, "episodes_this_iter": 27, "timestamp": 1558332647, "episode_reward_max": 1130.8902255779844, "info": {"load_time_ms": 8.394, "default": {"vf_loss": 17.4263916015625, "total_loss": 17.419143676757812, "entropy": 1.2957571744918823, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.009079648181796074, "vf_explained_var": 0.8381128907203674, "cur_lr": 0.0005000000237487257, "kl": 0.018331848084926605}, "num_steps_trained": 1713825, "grad_time_ms": 17272.945, "num_steps_sampled": 1713825, "sample_time_ms": 30868.542, "update_time_ms": 7.741}, "time_since_restore": 1262.8232169151306, "timesteps_total": 1713825, "episode_len_mean": 693.24, "episodes_total": 692, "training_iteration": 25, "episode_reward_mean": 801.6018541791906, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.58940601348877, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce400>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 25, "date": "2019-05-20_06-10-47", "timesteps_since_restore": 1713825, "timesteps_this_iter": 64666, "custom_metrics": {"system_level_velocity_min": 9.385084003186028, "outflow_rate_max": 1334.1705452947879, "system_level_velocity_max": 17.571904262745445, "cost1_mean": 325.99500542883123, "outflow_rate_mean": 1078.540611197609, "cost1_min": 15.872477003928532, "cost2_min": -210.75999609518945, "cost1_max": 465.816992581122, "outflow_rate_min": 477.8054575421641, "cost2_max": -16.715531743889002, "cost2_mean": -179.97001395615678, "system_level_velocity_mean": 12.654020583558689}, "episode_reward_min": 36.152239782615844, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1310.7667832374573, "episodes_this_iter": 26, "timestamp": 1558332695, "episode_reward_max": 1130.8902255779844, "info": {"load_time_ms": 8.355, "default": {"vf_loss": 15.466192245483398, "total_loss": 15.45952320098877, "entropy": 1.2828458547592163, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.008470390923321247, "vf_explained_var": 0.8389942049980164, "cur_lr": 0.0005000000237487257, "kl": 0.01800696551799774}, "num_steps_trained": 1778393, "grad_time_ms": 17330.331, "num_steps_sampled": 1778393, "sample_time_ms": 31033.506, "update_time_ms": 7.699}, "time_since_restore": 1310.7667832374573, "timesteps_total": 1778393, "episode_len_mean": 693.24, "episodes_total": 718, "training_iteration": 26, "episode_reward_mean": 806.0109268618902, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.94356632232666, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a62e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6be0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 26, "date": "2019-05-20_06-11-35", "timesteps_since_restore": 1778393, "timesteps_this_iter": 64568, "custom_metrics": {"system_level_velocity_min": 9.801541874582739, "outflow_rate_max": 1334.1705452947879, "system_level_velocity_max": 17.571904262745445, "cost1_mean": 332.8084983716843, "outflow_rate_mean": 1092.3574149326148, "cost1_min": 15.872477003928532, "cost2_min": -210.5600030380104, "cost1_max": 465.816992581122, "outflow_rate_min": 477.8054575421641, "cost2_max": -16.715531743889002, "cost2_mean": -176.40964744853795, "system_level_velocity_mean": 12.909614015282322}, "episode_reward_min": 36.152239782615844, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1358.2448134422302, "episodes_this_iter": 26, "timestamp": 1558332742, "episode_reward_max": 1130.8902255779844, "info": {"load_time_ms": 7.932, "default": {"vf_loss": 16.03942108154297, "total_loss": 16.032682418823242, "entropy": 1.2900850772857666, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00853655394166708, "vf_explained_var": 0.8372284173965454, "cur_lr": 0.0005000000237487257, "kl": 0.017982544377446175}, "num_steps_trained": 1841613, "grad_time_ms": 17223.118, "num_steps_sampled": 1841613, "sample_time_ms": 31002.162, "update_time_ms": 7.731}, "time_since_restore": 1358.2448134422302, "timesteps_total": 1841613, "episode_len_mean": 693.24, "episodes_total": 744, "training_iteration": 27, "episode_reward_mean": 799.5929898937862, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.47803020477295, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5902b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5905c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590400>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 27, "date": "2019-05-20_06-12-22", "timesteps_since_restore": 1841613, "timesteps_this_iter": 63220, "custom_metrics": {"system_level_velocity_min": 9.801541874582739, "outflow_rate_max": 1334.1705452947879, "system_level_velocity_max": 17.571904262745445, "cost1_mean": 335.858201055475, "outflow_rate_mean": 1096.0116265846102, "cost1_min": 15.872477003928532, "cost2_min": -202.96192161728263, "cost1_max": 465.816992581122, "outflow_rate_min": 477.8054575421641, "cost2_max": -16.715531743889002, "cost2_mean": -174.31301008613943, "system_level_velocity_mean": 13.015327448735809}, "episode_reward_min": 36.152239782615844, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1406.9773960113525, "episodes_this_iter": 27, "timestamp": 1558332791, "episode_reward_max": 1048.808469404674, "info": {"load_time_ms": 7.968, "default": {"vf_loss": 17.169607162475586, "total_loss": 17.16152000427246, "entropy": 1.2769070863723755, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.009937300346791744, "vf_explained_var": 0.8355467319488525, "cur_lr": 0.0005000000237487257, "kl": 0.01849954202771187}, "num_steps_trained": 1904383, "grad_time_ms": 17230.849, "num_steps_sampled": 1904383, "sample_time_ms": 30885.773, "update_time_ms": 7.621}, "time_since_restore": 1406.9773960113525, "timesteps_total": 1904383, "episode_len_mean": 686.67, "episodes_total": 771, "training_iteration": 28, "episode_reward_mean": 783.7553719427567, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.732582569122314, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58edd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e9b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 28, "date": "2019-05-20_06-13-11", "timesteps_since_restore": 1904383, "timesteps_this_iter": 62770, "custom_metrics": {"system_level_velocity_min": 9.964803210465487, "outflow_rate_max": 1326.9161243044314, "system_level_velocity_max": 18.7128160948732, "cost1_mean": 333.38766572635546, "outflow_rate_mean": 1089.6970327740976, "cost1_min": 15.872477003928532, "cost2_min": -206.63854329471673, "cost1_max": 454.6708881866699, "outflow_rate_min": 477.8054575421641, "cost2_max": -16.715531743889002, "cost2_mean": -172.12549694830923, "system_level_velocity_mean": 13.106025757902914}, "episode_reward_min": 36.152239782615844, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1454.4883592128754, "episodes_this_iter": 26, "timestamp": 1558332839, "episode_reward_max": 1004.5341278271, "info": {"load_time_ms": 7.944, "default": {"vf_loss": 16.025062561035156, "total_loss": 16.018224716186523, "entropy": 1.2899422645568848, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.008703311905264854, "vf_explained_var": 0.8377980589866638, "cur_lr": 0.0005000000237487257, "kl": 0.01866954006254673}, "num_steps_trained": 1969465, "grad_time_ms": 17252.467, "num_steps_sampled": 1969465, "sample_time_ms": 30821.755, "update_time_ms": 7.657}, "time_since_restore": 1454.4883592128754, "timesteps_total": 1969465, "episode_len_mean": 693.43, "episodes_total": 797, "training_iteration": 29, "episode_reward_mean": 788.8430150945119, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.51096320152283, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a60b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a62e8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 29, "date": "2019-05-20_06-13-59", "timesteps_since_restore": 1969465, "timesteps_this_iter": 65082, "custom_metrics": {"system_level_velocity_min": 9.45983379343348, "outflow_rate_max": 1326.9161243044314, "system_level_velocity_max": 18.7128160948732, "cost1_mean": 338.4181146048088, "outflow_rate_mean": 1094.3459577780645, "cost1_min": 28.447245299272875, "cost2_min": -206.63854329471673, "cost1_max": 472.5794040826066, "outflow_rate_min": 531.2520169192682, "cost2_max": -25.51437450411707, "cost2_mean": -171.91577255029682, "system_level_velocity_mean": 13.13061018201177}, "episode_reward_min": 56.10619632242665, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1503.0213248729706, "episodes_this_iter": 28, "timestamp": 1558332887, "episode_reward_max": 1019.4679718964537, "info": {"load_time_ms": 8.185, "default": {"vf_loss": 17.41269302368164, "total_loss": 17.40512466430664, "entropy": 1.2914639711380005, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.009607828222215176, "vf_explained_var": 0.825981616973877, "cur_lr": 0.0005000000237487257, "kl": 0.02038922719657421}, "num_steps_trained": 2032944, "grad_time_ms": 17228.915, "num_steps_sampled": 2032944, "sample_time_ms": 30832.416, "update_time_ms": 7.556}, "time_since_restore": 1503.0213248729706, "timesteps_total": 2032944, "episode_len_mean": 693.43, "episodes_total": 825, "training_iteration": 30, "episode_reward_mean": 779.3082915521859, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.532965660095215, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ecc0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 30, "date": "2019-05-20_06-14-47", "timesteps_since_restore": 2032944, "timesteps_this_iter": 63479, "custom_metrics": {"system_level_velocity_min": 9.45983379343348, "outflow_rate_max": 1326.9161243044314, "system_level_velocity_max": 18.7128160948732, "cost1_mean": 330.143641110277, "outflow_rate_mean": 1073.8053169291475, "cost1_min": 28.447245299272875, "cost2_min": -206.63854329471673, "cost1_max": 478.0735590041153, "outflow_rate_min": 531.2520169192682, "cost2_max": -25.51437450411707, "cost2_mean": -173.1893444039115, "system_level_velocity_mean": 12.821765208144685}, "episode_reward_min": 56.10619632242665, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1550.8415327072144, "episodes_this_iter": 30, "timestamp": 1558332935, "episode_reward_max": 1045.8393929925105, "info": {"load_time_ms": 8.084, "default": {"vf_loss": 17.507308959960938, "total_loss": 17.49892234802246, "entropy": 1.2954477071762085, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.011344658210873604, "vf_explained_var": 0.8549140095710754, "cur_lr": 0.0005000000237487257, "kl": 0.019713079556822777}, "num_steps_trained": 2096477, "grad_time_ms": 17270.893, "num_steps_sampled": 2096477, "sample_time_ms": 30642.421, "update_time_ms": 7.52}, "time_since_restore": 1550.8415327072144, "timesteps_total": 2096477, "episode_len_mean": 700.0, "episodes_total": 855, "training_iteration": 31, "episode_reward_mean": 785.0507772716625, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.820207834243774, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ecf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e0b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 31, "date": "2019-05-20_06-15-35", "timesteps_since_restore": 2096477, "timesteps_this_iter": 63533, "custom_metrics": {"system_level_velocity_min": 9.45983379343348, "outflow_rate_max": 1326.9161243044314, "system_level_velocity_max": 18.025739221387703, "cost1_mean": 333.0430977293449, "outflow_rate_mean": 1079.1335320340384, "cost1_min": 243.09385414291722, "cost2_min": -201.7822324822596, "cost1_max": 478.0735590041153, "outflow_rate_min": 874.5553909779526, "cost2_max": -140.2341658969758, "cost2_mean": -173.44395726736704, "system_level_velocity_mean": 12.752942002368382}, "episode_reward_min": 623.9746271690693, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1598.695051908493, "episodes_this_iter": 30, "timestamp": 1558332983, "episode_reward_max": 1066.7997643753786, "info": {"load_time_ms": 7.539, "default": {"vf_loss": 18.721614837646484, "total_loss": 18.714828491210938, "entropy": 1.3053088188171387, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00958287250250578, "vf_explained_var": 0.8460910320281982, "cur_lr": 0.0005000000237487257, "kl": 0.018631409853696823}, "num_steps_trained": 2161557, "grad_time_ms": 17364.889, "num_steps_sampled": 2161557, "sample_time_ms": 30290.879, "update_time_ms": 7.503}, "time_since_restore": 1598.695051908493, "timesteps_total": 2161557, "episode_len_mean": 693.43, "episodes_total": 885, "training_iteration": 32, "episode_reward_mean": 770.8213573346096, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.85351920127869, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6e80>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 32, "date": "2019-05-20_06-16-23", "timesteps_since_restore": 2161557, "timesteps_this_iter": 65080, "custom_metrics": {"system_level_velocity_min": 9.45983379343348, "outflow_rate_max": 1336.5512803470667, "system_level_velocity_max": 18.129966051210175, "cost1_mean": 327.08954935271066, "outflow_rate_mean": 1067.3622225121967, "cost1_min": 28.70335626038985, "cost2_min": -201.7822324822596, "cost1_max": 478.0735590041153, "outflow_rate_min": 525.616391838645, "cost2_max": -25.13046736668585, "cost2_mean": -171.41572054676197, "system_level_velocity_mean": 12.699550204592224}, "episode_reward_min": 66.92051640756631, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1647.263347864151, "episodes_this_iter": 32, "timestamp": 1558333032, "episode_reward_max": 1072.4928888505347, "info": {"load_time_ms": 7.76, "default": {"vf_loss": 19.830846786499023, "total_loss": 19.823497772216797, "entropy": 1.301573395729065, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010259631089866161, "vf_explained_var": 0.833793580532074, "cur_lr": 0.0005000000237487257, "kl": 0.01941019669175148}, "num_steps_trained": 2224742, "grad_time_ms": 17352.942, "num_steps_sampled": 2224742, "sample_time_ms": 30405.966, "update_time_ms": 7.489}, "time_since_restore": 1647.263347864151, "timesteps_total": 2224742, "episode_len_mean": 693.43, "episodes_total": 917, "training_iteration": 33, "episode_reward_mean": 777.3669487165796, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.56829595565796, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e908>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 33, "date": "2019-05-20_06-17-12", "timesteps_since_restore": 2224742, "timesteps_this_iter": 63185, "custom_metrics": {"system_level_velocity_min": 9.868626447779418, "outflow_rate_max": 1336.5512803470667, "system_level_velocity_max": 18.129966051210175, "cost1_mean": 329.4454967583593, "outflow_rate_mean": 1074.9988804189443, "cost1_min": 28.70335626038985, "cost2_min": -199.8895435314912, "cost1_max": 464.28788738133267, "outflow_rate_min": 525.616391838645, "cost2_max": -25.13046736668585, "cost2_mean": -171.16386929241816, "system_level_velocity_mean": 12.7939556212807}, "episode_reward_min": 66.92051640756631, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1694.5680873394012, "episodes_this_iter": 28, "timestamp": 1558333079, "episode_reward_max": 1158.3663870646853, "info": {"load_time_ms": 7.976, "default": {"vf_loss": 18.534757614135742, "total_loss": 18.528148651123047, "entropy": 1.293269157409668, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.009473027661442757, "vf_explained_var": 0.8603922724723816, "cur_lr": 0.0005000000237487257, "kl": 0.019100483506917953}, "num_steps_trained": 2287478, "grad_time_ms": 17386.694, "num_steps_sampled": 2287478, "sample_time_ms": 30420.667, "update_time_ms": 7.384}, "time_since_restore": 1694.5680873394012, "timesteps_total": 2287478, "episode_len_mean": 693.43, "episodes_total": 945, "training_iteration": 34, "episode_reward_mean": 778.5249656626623, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.304739475250244, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ec50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e358>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 34, "date": "2019-05-20_06-17-59", "timesteps_since_restore": 2287478, "timesteps_this_iter": 62736, "custom_metrics": {"system_level_velocity_min": 8.716192296949883, "outflow_rate_max": 1344.3692127258726, "system_level_velocity_max": 18.129966051210175, "cost1_mean": 327.63535035271997, "outflow_rate_mean": 1072.07198289194, "cost1_min": 28.70335626038985, "cost2_min": -199.8895435314912, "cost1_max": 464.28788738133267, "outflow_rate_min": 525.616391838645, "cost2_max": -25.13046736668585, "cost2_mean": -171.4958505109538, "system_level_velocity_mean": 12.729977533218264}, "episode_reward_min": 66.92051640756631, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1743.980994939804, "episodes_this_iter": 28, "timestamp": 1558333128, "episode_reward_max": 1158.3663870646853, "info": {"load_time_ms": 8.081, "default": {"vf_loss": 19.070331573486328, "total_loss": 19.064863204956055, "entropy": 1.3000068664550781, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.007979165762662888, "vf_explained_var": 0.8435258269309998, "cur_lr": 0.0005000000237487257, "kl": 0.016725748777389526}, "num_steps_trained": 2350593, "grad_time_ms": 17408.579, "num_steps_sampled": 2350593, "sample_time_ms": 30581.358, "update_time_ms": 7.298}, "time_since_restore": 1743.980994939804, "timesteps_total": 2350593, "episode_len_mean": 693.43, "episodes_total": 973, "training_iteration": 35, "episode_reward_mean": 790.8306321197421, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 49.41290760040283, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590e80>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 35, "date": "2019-05-20_06-18-48", "timesteps_since_restore": 2350593, "timesteps_this_iter": 63115, "custom_metrics": {"system_level_velocity_min": 8.716192296949883, "outflow_rate_max": 1344.3692127258726, "system_level_velocity_max": 18.129966051210175, "cost1_mean": 331.21198271106493, "outflow_rate_mean": 1081.3632626091287, "cost1_min": 28.70335626038985, "cost2_min": -199.58695354952636, "cost1_max": 466.0522804158014, "outflow_rate_min": 525.616391838645, "cost2_max": -25.13046736668585, "cost2_mean": -172.01411052720377, "system_level_velocity_mean": 12.852120778591125}, "episode_reward_min": 66.92051640756631, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1790.260422706604, "episodes_this_iter": 28, "timestamp": 1558333175, "episode_reward_max": 1158.3663870646853, "info": {"load_time_ms": 8.399, "default": {"vf_loss": 17.48720359802246, "total_loss": 17.479379653930664, "entropy": 1.2888784408569336, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.010612137615680695, "vf_explained_var": 0.8584247827529907, "cur_lr": 0.0005000000237487257, "kl": 0.018588874489068985}, "num_steps_trained": 2414600, "grad_time_ms": 17335.539, "num_steps_sampled": 2414600, "sample_time_ms": 30488.38, "update_time_ms": 7.33}, "time_since_restore": 1790.260422706604, "timesteps_total": 2414600, "episode_len_mean": 700.0, "episodes_total": 1001, "training_iteration": 36, "episode_reward_mean": 797.3366334078205, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.27942776679993, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5902b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5904e0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 36, "date": "2019-05-20_06-19-35", "timesteps_since_restore": 2414600, "timesteps_this_iter": 64007, "custom_metrics": {"system_level_velocity_min": 8.716192296949883, "outflow_rate_max": 1344.3692127258726, "system_level_velocity_max": 17.62772624529749, "cost1_mean": 334.5052184674647, "outflow_rate_mean": 1087.51178527654, "cost1_min": 227.75129402864087, "cost2_min": -199.58695354952636, "cost1_max": 466.0522804158014, "outflow_rate_min": 878.5303260569008, "cost2_max": -149.9513887369631, "cost2_mean": -174.18710200421228, "system_level_velocity_mean": 12.812707079538745}, "episode_reward_min": 602.7050423409338, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1837.999546289444, "episodes_this_iter": 27, "timestamp": 1558333222, "episode_reward_max": 1158.3663870646853, "info": {"load_time_ms": 8.707, "default": {"vf_loss": 19.27217674255371, "total_loss": 19.266010284423828, "entropy": 1.2920458316802979, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008924778550863266, "vf_explained_var": 0.8321843147277832, "cur_lr": 0.0005000000237487257, "kl": 0.018371079117059708}, "num_steps_trained": 2479638, "grad_time_ms": 17377.5, "num_steps_sampled": 2479638, "sample_time_ms": 30473.21, "update_time_ms": 7.302}, "time_since_restore": 1837.999546289444, "timesteps_total": 2479638, "episode_len_mean": 693.3, "episodes_total": 1028, "training_iteration": 37, "episode_reward_mean": 789.4743393394767, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.739123582839966, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ea20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ea58>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 37, "date": "2019-05-20_06-20-22", "timesteps_since_restore": 2479638, "timesteps_this_iter": 65038, "custom_metrics": {"system_level_velocity_min": 9.074994356556859, "outflow_rate_max": 1344.3692127258726, "system_level_velocity_max": 17.89287555403812, "cost1_mean": 329.92135305616205, "outflow_rate_mean": 1079.7868376766312, "cost1_min": 19.98901239457915, "cost2_min": -202.87079675161704, "cost1_max": 466.0522804158014, "outflow_rate_min": 487.7424732023566, "cost2_max": -19.077911376391125, "cost2_mean": -174.50231201687922, "system_level_velocity_mean": 12.804199538419304}, "episode_reward_min": 48.701643054604006, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1884.3090126514435, "episodes_this_iter": 27, "timestamp": 1558333269, "episode_reward_max": 1117.823893200239, "info": {"load_time_ms": 8.763, "default": {"vf_loss": 19.037437438964844, "total_loss": 19.030683517456055, "entropy": 1.3029648065567017, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.009690284729003906, "vf_explained_var": 0.8341965079307556, "cur_lr": 0.0005000000237487257, "kl": 0.019559210166335106}, "num_steps_trained": 2544372, "grad_time_ms": 17272.515, "num_steps_sampled": 2544372, "sample_time_ms": 30335.943, "update_time_ms": 7.305}, "time_since_restore": 1884.3090126514435, "timesteps_total": 2544372, "episode_len_mean": 686.73, "episodes_total": 1055, "training_iteration": 38, "episode_reward_mean": 780.5602027919247, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.30946636199951, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58efd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e320>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 38, "date": "2019-05-20_06-21-09", "timesteps_since_restore": 2544372, "timesteps_this_iter": 64734, "custom_metrics": {"system_level_velocity_min": 9.074994356556859, "outflow_rate_max": 1327.1057156106774, "system_level_velocity_max": 18.289644512801452, "cost1_mean": 324.3818336930388, "outflow_rate_mean": 1067.4853304037147, "cost1_min": 19.98901239457915, "cost2_min": -202.87079675161704, "cost1_max": 466.0522804158014, "outflow_rate_min": 487.7424732023566, "cost2_max": -19.077911376391125, "cost2_mean": -174.19387063762116, "system_level_velocity_mean": 12.771936501346913}, "episode_reward_min": 48.701643054604006, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1930.1755039691925, "episodes_this_iter": 26, "timestamp": 1558333315, "episode_reward_max": 1116.760033892992, "info": {"load_time_ms": 8.441, "default": {"vf_loss": 19.072114944458008, "total_loss": 19.065147399902344, "entropy": 1.2712846994400024, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.009911737404763699, "vf_explained_var": 0.8621817827224731, "cur_lr": 0.0005000000237487257, "kl": 0.019619498401880264}, "num_steps_trained": 2608396, "grad_time_ms": 17211.306, "num_steps_sampled": 2608396, "sample_time_ms": 30233.193, "update_time_ms": 7.303}, "time_since_restore": 1930.1755039691925, "timesteps_total": 2608396, "episode_len_mean": 686.73, "episodes_total": 1081, "training_iteration": 39, "episode_reward_mean": 787.6837957776363, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.86649131774902, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ef0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 39, "date": "2019-05-20_06-21-55", "timesteps_since_restore": 2608396, "timesteps_this_iter": 64024, "custom_metrics": {"system_level_velocity_min": 9.723125204050328, "outflow_rate_max": 1317.9654974426478, "system_level_velocity_max": 18.289644512801452, "cost1_mean": 327.8693111535181, "outflow_rate_mean": 1076.2294162115122, "cost1_min": 19.98901239457915, "cost2_min": -202.88219549560858, "cost1_max": 450.31669292835954, "outflow_rate_min": 487.7424732023566, "cost2_max": -19.077911376391125, "cost2_mean": -175.13514454530235, "system_level_velocity_mean": 12.888162895783985}, "episode_reward_min": 48.701643054604006, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 1977.0655047893524, "episodes_this_iter": 28, "timestamp": 1558333362, "episode_reward_max": 1116.760033892992, "info": {"load_time_ms": 8.04, "default": {"vf_loss": 20.956592559814453, "total_loss": 20.94786262512207, "entropy": 1.2870081663131714, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.011827697046101093, "vf_explained_var": 0.8435701727867126, "cur_lr": 0.0005000000237487257, "kl": 0.02066883072257042}, "num_steps_trained": 2672474, "grad_time_ms": 17225.386, "num_steps_sampled": 2672474, "sample_time_ms": 30056.328, "update_time_ms": 7.518}, "time_since_restore": 1977.0655047893524, "timesteps_total": 2672474, "episode_len_mean": 686.73, "episodes_total": 1109, "training_iteration": 40, "episode_reward_mean": 805.7560890943195, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.89000082015991, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5f8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 40, "date": "2019-05-20_06-22-42", "timesteps_since_restore": 2672474, "timesteps_this_iter": 64078, "custom_metrics": {"system_level_velocity_min": 9.723125204050328, "outflow_rate_max": 1317.9654974426478, "system_level_velocity_max": 18.289644512801452, "cost1_mean": 331.8885966213096, "outflow_rate_mean": 1084.686645636457, "cost1_min": 19.98901239457915, "cost2_min": -202.88219549560858, "cost1_max": 450.31669292835954, "outflow_rate_min": 487.7424732023566, "cost2_max": -19.077911376391125, "cost2_mean": -174.49648312422934, "system_level_velocity_mean": 13.032227785350903}, "episode_reward_min": 48.701643054604006, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2025.6316184997559, "episodes_this_iter": 27, "timestamp": 1558333410, "episode_reward_max": 1116.760033892992, "info": {"load_time_ms": 8.008, "default": {"vf_loss": 20.477848052978516, "total_loss": 20.471698760986328, "entropy": 1.2992268800735474, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.00968972034752369, "vf_explained_var": 0.8472622036933899, "cur_lr": 0.0005000000237487257, "kl": 0.01573827862739563}, "num_steps_trained": 2736736, "grad_time_ms": 17423.18, "num_steps_sampled": 2736736, "sample_time_ms": 29933.57, "update_time_ms": 7.504}, "time_since_restore": 2025.6316184997559, "timesteps_total": 2736736, "episode_len_mean": 693.43, "episodes_total": 1136, "training_iteration": 41, "episode_reward_mean": 809.8661163624258, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.56611371040344, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ea58>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 41, "date": "2019-05-20_06-23-30", "timesteps_since_restore": 2736736, "timesteps_this_iter": 64262, "custom_metrics": {"system_level_velocity_min": 8.998036024357324, "outflow_rate_max": 1317.9654974426478, "system_level_velocity_max": 18.289644512801452, "cost1_mean": 334.70313251952246, "outflow_rate_mean": 1089.7886041740705, "cost1_min": 28.84365952955634, "cost2_min": -208.51541313094, "cost1_max": 450.31669292835954, "outflow_rate_min": 529.4459709326148, "cost2_max": -25.829500722944356, "cost2_mean": -176.61533003610282, "system_level_velocity_mean": 12.96019030659054}, "episode_reward_min": 58.29169045138361, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2072.5606775283813, "episodes_this_iter": 29, "timestamp": 1558333457, "episode_reward_max": 1086.3711434843788, "info": {"load_time_ms": 8.31, "default": {"vf_loss": 20.703828811645508, "total_loss": 20.69729995727539, "entropy": 1.3028733730316162, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010300792753696442, "vf_explained_var": 0.8507437109947205, "cur_lr": 0.0005000000237487257, "kl": 0.01676514744758606}, "num_steps_trained": 2800622, "grad_time_ms": 17375.711, "num_steps_sampled": 2800622, "sample_time_ms": 29889.649, "update_time_ms": 7.488}, "time_since_restore": 2072.5606775283813, "timesteps_total": 2800622, "episode_len_mean": 700.0, "episodes_total": 1165, "training_iteration": 42, "episode_reward_mean": 820.2801937859738, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.92905902862549, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5832e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583908>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 42, "date": "2019-05-20_06-24-17", "timesteps_since_restore": 2800622, "timesteps_this_iter": 63886, "custom_metrics": {"system_level_velocity_min": 8.998036024357324, "outflow_rate_max": 1318.0508377601234, "system_level_velocity_max": 17.00507691148788, "cost1_mean": 342.38618817941335, "outflow_rate_mean": 1106.5199227758653, "cost1_min": 235.80075645147673, "cost2_min": -208.51541313094, "cost1_max": 446.1487762043353, "outflow_rate_min": 907.5508199650976, "cost2_max": -148.98252414458415, "cost2_mean": -178.0432426347853, "system_level_velocity_mean": 13.078515636567039}, "episode_reward_min": 630.2508562071399, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2118.4051430225372, "episodes_this_iter": 28, "timestamp": 1558333503, "episode_reward_max": 1086.3711434843788, "info": {"load_time_ms": 8.252, "default": {"vf_loss": 20.347476959228516, "total_loss": 20.34121322631836, "entropy": 1.3187034130096436, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009540052153170109, "vf_explained_var": 0.8379912376403809, "cur_lr": 0.0005000000237487257, "kl": 0.014546209946274757}, "num_steps_trained": 2864427, "grad_time_ms": 17400.887, "num_steps_sampled": 2864427, "sample_time_ms": 29592.61, "update_time_ms": 7.438}, "time_since_restore": 2118.4051430225372, "timesteps_total": 2864427, "episode_len_mean": 700.0, "episodes_total": 1193, "training_iteration": 43, "episode_reward_mean": 812.0212242329134, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.844465494155884, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ed68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ee10>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 43, "date": "2019-05-20_06-25-03", "timesteps_since_restore": 2864427, "timesteps_this_iter": 63805, "custom_metrics": {"system_level_velocity_min": 8.998036024357324, "outflow_rate_max": 1318.0508377601234, "system_level_velocity_max": 17.00507691148788, "cost1_mean": 337.7665911873187, "outflow_rate_mean": 1096.668833269382, "cost1_min": 235.80075645147673, "cost2_min": -208.51541313094, "cost1_max": 446.1487762043353, "outflow_rate_min": 907.5508199650976, "cost2_max": -148.98252414458415, "cost2_mean": -178.9282806982172, "system_level_velocity_mean": 12.925084010812181}, "episode_reward_min": 630.2508562071399, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2164.35702419281, "episodes_this_iter": 31, "timestamp": 1558333549, "episode_reward_max": 1135.3220789391876, "info": {"load_time_ms": 7.977, "default": {"vf_loss": 21.826047897338867, "total_loss": 21.819311141967773, "entropy": 1.3071656227111816, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010415353812277317, "vf_explained_var": 0.8379533886909485, "cur_lr": 0.0005000000237487257, "kl": 0.016352081671357155}, "num_steps_trained": 2927859, "grad_time_ms": 17380.106, "num_steps_sampled": 2927859, "sample_time_ms": 29477.938, "update_time_ms": 7.389}, "time_since_restore": 2164.35702419281, "timesteps_total": 2927859, "episode_len_mean": 700.0, "episodes_total": 1224, "training_iteration": 44, "episode_reward_mean": 803.3312156460045, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.95188117027283, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e1d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 44, "date": "2019-05-20_06-25-49", "timesteps_since_restore": 2927859, "timesteps_this_iter": 63432, "custom_metrics": {"system_level_velocity_min": 9.661272250683716, "outflow_rate_max": 1336.9742380444122, "system_level_velocity_max": 17.747770766179805, "cost1_mean": 336.81842519743026, "outflow_rate_mean": 1092.8922909516482, "cost1_min": 252.3010976937041, "cost2_min": -198.91766210472477, "cost1_max": 468.40575520649213, "outflow_rate_min": 892.681504409598, "cost2_max": -155.35875157483662, "cost2_mean": -178.45479165048232, "system_level_velocity_mean": 12.881000909161667}, "episode_reward_min": 630.2508562071399, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2213.0531284809113, "episodes_this_iter": 31, "timestamp": 1558333598, "episode_reward_max": 1140.310874620421, "info": {"load_time_ms": 7.767, "default": {"vf_loss": 22.044527053833008, "total_loss": 22.03803062438965, "entropy": 1.3169196844100952, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010106378234922886, "vf_explained_var": 0.8420650959014893, "cur_lr": 0.0005000000237487257, "kl": 0.016037069261074066}, "num_steps_trained": 2993562, "grad_time_ms": 17412.838, "num_steps_sampled": 2993562, "sample_time_ms": 29373.328, "update_time_ms": 7.474}, "time_since_restore": 2213.0531284809113, "timesteps_total": 2993562, "episode_len_mean": 693.2, "episodes_total": 1255, "training_iteration": 45, "episode_reward_mean": 797.6906599845429, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.696104288101196, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583e80>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 45, "date": "2019-05-20_06-26-38", "timesteps_since_restore": 2993562, "timesteps_this_iter": 65703, "custom_metrics": {"system_level_velocity_min": 9.3138199650065, "outflow_rate_max": 1347.8173120616116, "system_level_velocity_max": 18.42534826533554, "cost1_mean": 331.82737489341446, "outflow_rate_mean": 1081.8625386865665, "cost1_min": 13.046835561574323, "cost2_min": -197.61171573611557, "cost1_max": 486.6694914122003, "outflow_rate_min": 470.5008371641972, "cost2_max": -14.867929237338346, "cost2_mean": -176.50807946522022, "system_level_velocity_mean": 12.864553179285572}, "episode_reward_min": 33.8078648074575, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2258.6530656814575, "episodes_this_iter": 29, "timestamp": 1558333644, "episode_reward_max": 1140.310874620421, "info": {"load_time_ms": 7.622, "default": {"vf_loss": 19.894386291503906, "total_loss": 19.8864688873291, "entropy": 1.3099342584609985, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011514796875417233, "vf_explained_var": 0.871198832988739, "cur_lr": 0.0005000000237487257, "kl": 0.015995416790246964}, "num_steps_trained": 3057583, "grad_time_ms": 17467.744, "num_steps_sampled": 3057583, "sample_time_ms": 29251.032, "update_time_ms": 7.487}, "time_since_restore": 2258.6530656814575, "timesteps_total": 3057583, "episode_len_mean": 693.2, "episodes_total": 1284, "training_iteration": 46, "episode_reward_mean": 804.565224543678, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.599937200546265, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde8d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 46, "date": "2019-05-20_06-27-24", "timesteps_since_restore": 3057583, "timesteps_this_iter": 64021, "custom_metrics": {"system_level_velocity_min": 9.3138199650065, "outflow_rate_max": 1347.8173120616116, "system_level_velocity_max": 18.897950729047327, "cost1_mean": 336.0765534017784, "outflow_rate_mean": 1086.8008402224234, "cost1_min": 13.046835561574323, "cost2_min": -197.61171573611557, "cost1_max": 498.9762434163306, "outflow_rate_min": 470.5008371641972, "cost2_max": -14.867929237338346, "cost2_mean": -174.42685576387342, "system_level_velocity_mean": 13.015437038600496}, "episode_reward_min": 33.8078648074575, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2306.213710784912, "episodes_this_iter": 29, "timestamp": 1558333691, "episode_reward_max": 1140.310874620421, "info": {"load_time_ms": 7.642, "default": {"vf_loss": 20.956825256347656, "total_loss": 20.952598571777344, "entropy": 1.3147506713867188, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.007634943351149559, "vf_explained_var": 0.8469374775886536, "cur_lr": 0.0005000000237487257, "kl": 0.015150604769587517}, "num_steps_trained": 3123672, "grad_time_ms": 17506.718, "num_steps_sampled": 3123672, "sample_time_ms": 29193.166, "update_time_ms": 7.488}, "time_since_restore": 2306.213710784912, "timesteps_total": 3123672, "episode_len_mean": 693.2, "episodes_total": 1313, "training_iteration": 47, "episode_reward_mean": 805.4267321683543, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.56064510345459, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ec50>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 47, "date": "2019-05-20_06-28-11", "timesteps_since_restore": 3123672, "timesteps_this_iter": 66089, "custom_metrics": {"system_level_velocity_min": 9.137003987863368, "outflow_rate_max": 1350.6533095593936, "system_level_velocity_max": 18.897950729047327, "cost1_mean": 339.40395785238036, "outflow_rate_mean": 1093.6843827541647, "cost1_min": 13.046835561574323, "cost2_min": -197.61171573611557, "cost1_max": 498.9762434163306, "outflow_rate_min": 470.5008371641972, "cost2_max": -14.867929237338346, "cost2_mean": -175.10898195277804, "system_level_velocity_mean": 13.150086860673085}, "episode_reward_min": 33.8078648074575, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2353.228747844696, "episodes_this_iter": 26, "timestamp": 1558333738, "episode_reward_max": 1033.2068542796428, "info": {"load_time_ms": 7.642, "default": {"vf_loss": 18.6757755279541, "total_loss": 18.66986846923828, "entropy": 1.3381829261779785, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009374096058309078, "vf_explained_var": 0.8616487383842468, "cur_lr": 0.0005000000237487257, "kl": 0.015400134027004242}, "num_steps_trained": 3188506, "grad_time_ms": 17519.506, "num_steps_sampled": 3188506, "sample_time_ms": 29251.417, "update_time_ms": 7.594}, "time_since_restore": 2353.228747844696, "timesteps_total": 3188506, "episode_len_mean": 700.0, "episodes_total": 1339, "training_iteration": 48, "episode_reward_mean": 814.9595731170517, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.015037059783936, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e5c0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 48, "date": "2019-05-20_06-28-58", "timesteps_since_restore": 3188506, "timesteps_this_iter": 64834, "custom_metrics": {"system_level_velocity_min": 9.137003987863368, "outflow_rate_max": 1350.6533095593936, "system_level_velocity_max": 18.897950729047327, "cost1_mean": 343.1006330338524, "outflow_rate_mean": 1102.0104294264547, "cost1_min": 237.54413911693194, "cost2_min": -201.38718990117945, "cost1_max": 498.9762434163306, "outflow_rate_min": 889.412122837501, "cost2_max": -144.43385022694673, "cost2_mean": -177.15914661018553, "system_level_velocity_mean": 13.116343269674791}, "episode_reward_min": 648.1185478266633, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2400.299716234207, "episodes_this_iter": 26, "timestamp": 1558333785, "episode_reward_max": 1098.293417318352, "info": {"load_time_ms": 7.958, "default": {"vf_loss": 18.93511199951172, "total_loss": 18.929187774658203, "entropy": 1.3427860736846924, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.009267997927963734, "vf_explained_var": 0.8430469036102295, "cur_lr": 0.0005000000237487257, "kl": 0.014861665666103363}, "num_steps_trained": 3254085, "grad_time_ms": 17593.701, "num_steps_sampled": 3254085, "sample_time_ms": 29296.872, "update_time_ms": 7.543}, "time_since_restore": 2400.299716234207, "timesteps_total": 3254085, "episode_len_mean": 700.0, "episodes_total": 1365, "training_iteration": 49, "episode_reward_mean": 814.3659206488743, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.07096838951111, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5f8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 49, "date": "2019-05-20_06-29-45", "timesteps_since_restore": 3254085, "timesteps_this_iter": 65579, "custom_metrics": {"system_level_velocity_min": 9.137003987863368, "outflow_rate_max": 1350.6533095593936, "system_level_velocity_max": 18.897950729047327, "cost1_mean": 341.9234720829806, "outflow_rate_mean": 1099.8328473363451, "cost1_min": 237.54413911693194, "cost2_min": -201.38718990117945, "cost1_max": 498.9762434163306, "outflow_rate_min": 904.9237471892667, "cost2_max": -144.43385022694673, "cost2_mean": -178.36668184352402, "system_level_velocity_mean": 13.068847109240519}, "episode_reward_min": 667.2924659872215, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2447.516881942749, "episodes_this_iter": 28, "timestamp": 1558333833, "episode_reward_max": 1133.0139642353474, "info": {"load_time_ms": 8.132, "default": {"vf_loss": 19.819421768188477, "total_loss": 19.81325340270996, "entropy": 1.3454176187515259, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.00942029245197773, "vf_explained_var": 0.855086624622345, "cur_lr": 0.0005000000237487257, "kl": 0.01445692777633667}, "num_steps_trained": 3319538, "grad_time_ms": 17612.769, "num_steps_sampled": 3319538, "sample_time_ms": 29309.635, "update_time_ms": 7.412}, "time_since_restore": 2447.516881942749, "timesteps_total": 3319538, "episode_len_mean": 700.0, "episodes_total": 1393, "training_iteration": 50, "episode_reward_mean": 806.1073737742075, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.21716570854187, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ec50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58eb00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e198>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 50, "date": "2019-05-20_06-30-33", "timesteps_since_restore": 3319538, "timesteps_this_iter": 65453, "custom_metrics": {"system_level_velocity_min": 9.137003987863368, "outflow_rate_max": 1350.6533095593936, "system_level_velocity_max": 18.440334044383018, "cost1_mean": 336.14206825261914, "outflow_rate_mean": 1090.8955934491403, "cost1_min": 237.54413911693194, "cost2_min": -204.488352182646, "cost1_max": 484.32892460188197, "outflow_rate_min": 892.535288985175, "cost2_max": -154.9386655239386, "cost2_mean": -179.73342141328564, "system_level_velocity_mean": 12.861035976772403}, "episode_reward_min": 639.5722064110342, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2493.7754316329956, "episodes_this_iter": 27, "timestamp": 1558333879, "episode_reward_max": 1133.0139642353474, "info": {"load_time_ms": 8.069, "default": {"vf_loss": 18.261268615722656, "total_loss": 18.255779266357422, "entropy": 1.3488106727600098, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.00887306872755289, "vf_explained_var": 0.8475279211997986, "cur_lr": 0.0005000000237487257, "kl": 0.015040543861687183}, "num_steps_trained": 3384263, "grad_time_ms": 17418.673, "num_steps_sampled": 3384263, "sample_time_ms": 29273.572, "update_time_ms": 7.431}, "time_since_restore": 2493.7754316329956, "timesteps_total": 3384263, "episode_len_mean": 700.0, "episodes_total": 1420, "training_iteration": 51, "episode_reward_mean": 797.546495601389, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.25854969024658, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d0c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590a90>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 51, "date": "2019-05-20_06-31-19", "timesteps_since_restore": 3384263, "timesteps_this_iter": 64725, "custom_metrics": {"system_level_velocity_min": 9.170677506359432, "outflow_rate_max": 1344.7449339646125, "system_level_velocity_max": 18.440334044383018, "cost1_mean": 331.3491490763357, "outflow_rate_mean": 1080.7838366469516, "cost1_min": 238.60869353539363, "cost2_min": -204.488352182646, "cost1_max": 484.32892460188197, "outflow_rate_min": 891.9636779738506, "cost2_max": -154.9386655239386, "cost2_mean": -181.01201273419687, "system_level_velocity_mean": 12.681084077031798}, "episode_reward_min": 639.5722064110342, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2541.7741317749023, "episodes_this_iter": 30, "timestamp": 1558333927, "episode_reward_max": 1133.0139642353474, "info": {"load_time_ms": 8.147, "default": {"vf_loss": 21.18309783935547, "total_loss": 21.1767635345459, "entropy": 1.345569133758545, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.010107645764946938, "vf_explained_var": 0.8328275680541992, "cur_lr": 0.0005000000237487257, "kl": 0.016784315928816795}, "num_steps_trained": 3450260, "grad_time_ms": 17431.159, "num_steps_sampled": 3450260, "sample_time_ms": 29366.606, "update_time_ms": 7.367}, "time_since_restore": 2541.7741317749023, "timesteps_total": 3450260, "episode_len_mean": 693.34, "episodes_total": 1450, "training_iteration": 52, "episode_reward_mean": 777.7686530262047, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.99870014190674, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5cee80>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 52, "date": "2019-05-20_06-32-07", "timesteps_since_restore": 3450260, "timesteps_this_iter": 65997, "custom_metrics": {"system_level_velocity_min": 9.170677506359432, "outflow_rate_max": 1344.7449339646125, "system_level_velocity_max": 18.126462580563242, "cost1_mean": 321.97763399121203, "outflow_rate_mean": 1064.6066370396913, "cost1_min": 22.803934342199614, "cost2_min": -207.68110630475198, "cost1_max": 467.4561021868585, "outflow_rate_min": 503.35134443172086, "cost2_max": -22.16854032199981, "cost2_mean": -181.56694483629525, "system_level_velocity_mean": 12.508275691679264}, "episode_reward_min": 51.81596365415027, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2587.131069421768, "episodes_this_iter": 30, "timestamp": 1558333972, "episode_reward_max": 1151.2739125091957, "info": {"load_time_ms": 8.184, "default": {"vf_loss": 23.26249122619629, "total_loss": 23.25509262084961, "entropy": 1.3356215953826904, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011005637235939503, "vf_explained_var": 0.8284805417060852, "cur_lr": 0.0005000000237487257, "kl": 0.016020309180021286}, "num_steps_trained": 3513004, "grad_time_ms": 17380.872, "num_steps_sampled": 3513004, "sample_time_ms": 29367.772, "update_time_ms": 7.397}, "time_since_restore": 2587.131069421768, "timesteps_total": 3513004, "episode_len_mean": 693.34, "episodes_total": 1480, "training_iteration": 53, "episode_reward_mean": 772.0528867241259, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.356937646865845, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0edd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0ecc0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 53, "date": "2019-05-20_06-32-52", "timesteps_since_restore": 3513004, "timesteps_this_iter": 62744, "custom_metrics": {"system_level_velocity_min": 9.169991313469268, "outflow_rate_max": 1344.7449339646125, "system_level_velocity_max": 18.126462580563242, "cost1_mean": 320.84194915551996, "outflow_rate_mean": 1062.4018230870877, "cost1_min": 22.803934342199614, "cost2_min": -207.68110630475198, "cost1_max": 465.68345958062963, "outflow_rate_min": 503.35134443172086, "cost2_max": -22.16854032199981, "cost2_mean": -182.40866208161614, "system_level_velocity_mean": 12.466648914412549}, "episode_reward_min": 51.81596365415027, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2636.192941904068, "episodes_this_iter": 28, "timestamp": 1558334021, "episode_reward_max": 1151.2739125091957, "info": {"load_time_ms": 8.391, "default": {"vf_loss": 22.516536712646484, "total_loss": 22.511371612548828, "entropy": 1.337276816368103, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.00843086652457714, "vf_explained_var": 0.8386288285255432, "cur_lr": 0.0005000000237487257, "kl": 0.014517286792397499}, "num_steps_trained": 3577301, "grad_time_ms": 17512.534, "num_steps_sampled": 3577301, "sample_time_ms": 29547.682, "update_time_ms": 7.483}, "time_since_restore": 2636.192941904068, "timesteps_total": 3577301, "episode_len_mean": 693.34, "episodes_total": 1508, "training_iteration": 54, "episode_reward_mean": 781.4730402327945, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 49.061872482299805, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0ea20>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 54, "date": "2019-05-20_06-33-41", "timesteps_since_restore": 3577301, "timesteps_this_iter": 64297, "custom_metrics": {"system_level_velocity_min": 9.169991313469268, "outflow_rate_max": 1331.9219396481803, "system_level_velocity_max": 18.126462580563242, "cost1_mean": 323.5356488655084, "outflow_rate_mean": 1067.8403061797478, "cost1_min": 22.803934342199614, "cost2_min": -207.68110630475198, "cost1_max": 463.0186494835523, "outflow_rate_min": 503.35134443172086, "cost2_max": -22.16854032199981, "cost2_mean": -182.0564981158191, "system_level_velocity_mean": 12.565113276578499}, "episode_reward_min": 51.81596365415027, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2682.586309671402, "episodes_this_iter": 29, "timestamp": 1558334068, "episode_reward_max": 1151.2739125091957, "info": {"load_time_ms": 8.601, "default": {"vf_loss": 24.274030685424805, "total_loss": 24.2676944732666, "entropy": 1.3242231607437134, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.009740974754095078, "vf_explained_var": 0.8303970098495483, "cur_lr": 0.0005000000237487257, "kl": 0.015138644725084305}, "num_steps_trained": 3641418, "grad_time_ms": 17438.321, "num_steps_sampled": 3641418, "sample_time_ms": 29391.113, "update_time_ms": 7.626}, "time_since_restore": 2682.586309671402, "timesteps_total": 3641418, "episode_len_mean": 700.0, "episodes_total": 1537, "training_iteration": 55, "episode_reward_mean": 797.2189757903943, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.393367767333984, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ad30>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 55, "date": "2019-05-20_06-34-28", "timesteps_since_restore": 3641418, "timesteps_this_iter": 64117, "custom_metrics": {"system_level_velocity_min": 9.169991313469268, "outflow_rate_max": 1331.9219396481803, "system_level_velocity_max": 17.458607332159918, "cost1_mean": 330.4899053907034, "outflow_rate_mean": 1081.151008105299, "cost1_min": 238.7011178669802, "cost2_min": -206.76554892551528, "cost1_max": 463.0186494835523, "outflow_rate_min": 899.670759398279, "cost2_max": -161.5722411983192, "cost2_mean": -182.7340705562792, "system_level_velocity_mean": 12.662492107545894}, "episode_reward_min": 625.5362207873065, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2729.453928232193, "episodes_this_iter": 27, "timestamp": 1558334115, "episode_reward_max": 1151.2739125091957, "info": {"load_time_ms": 8.71, "default": {"vf_loss": 22.408849716186523, "total_loss": 22.403024673461914, "entropy": 1.3217357397079468, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.00913290772587061, "vf_explained_var": 0.8328465223312378, "cur_lr": 0.0005000000237487257, "kl": 0.014716734178364277}, "num_steps_trained": 3707173, "grad_time_ms": 17454.237, "num_steps_sampled": 3707173, "sample_time_ms": 29502.289, "update_time_ms": 7.625}, "time_since_restore": 2729.453928232193, "timesteps_total": 3707173, "episode_len_mean": 700.0, "episodes_total": 1564, "training_iteration": 56, "episode_reward_mean": 801.9556453404336, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.867618560791016, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590710>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 56, "date": "2019-05-20_06-35-15", "timesteps_since_restore": 3707173, "timesteps_this_iter": 65755, "custom_metrics": {"system_level_velocity_min": 10.162370312062874, "outflow_rate_max": 1331.9219396481803, "system_level_velocity_max": 18.158964593396558, "cost1_mean": 335.2376899239296, "outflow_rate_mean": 1089.09009337536, "cost1_min": 262.23454205360383, "cost2_min": -217.58064949251386, "cost1_max": 472.8843309470312, "outflow_rate_min": 947.2202944337059, "cost2_max": -161.03466323247866, "cost2_mean": -183.93529369702432, "system_level_velocity_mean": 12.838238621001727}, "episode_reward_min": 625.5362207873065, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2776.448920726776, "episodes_this_iter": 29, "timestamp": 1558334162, "episode_reward_max": 973.0159559481723, "info": {"load_time_ms": 8.373, "default": {"vf_loss": 21.627368927001953, "total_loss": 21.620128631591797, "entropy": 1.327111840248108, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010978355072438717, "vf_explained_var": 0.8447252511978149, "cur_lr": 0.0005000000237487257, "kl": 0.01661296933889389}, "num_steps_trained": 3772085, "grad_time_ms": 17394.785, "num_steps_sampled": 3772085, "sample_time_ms": 29506.087, "update_time_ms": 7.634}, "time_since_restore": 2776.448920726776, "timesteps_total": 3772085, "episode_len_mean": 700.0, "episodes_total": 1593, "training_iteration": 57, "episode_reward_mean": 801.713343415748, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.99499249458313, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5902b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a748>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 57, "date": "2019-05-20_06-36-02", "timesteps_since_restore": 3772085, "timesteps_this_iter": 64912, "custom_metrics": {"system_level_velocity_min": 9.984591294264087, "outflow_rate_max": 1280.806232104009, "system_level_velocity_max": 18.158964593396558, "cost1_mean": 334.21933849899926, "outflow_rate_mean": 1087.4986266065632, "cost1_min": 261.4815651363091, "cost2_min": -217.58064949251386, "cost1_max": 472.8843309470312, "outflow_rate_min": 947.2202944337059, "cost2_max": -161.03466323247866, "cost2_mean": -185.73378125498866, "system_level_velocity_mean": 12.815077207291063}, "episode_reward_min": 625.5362207873065, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2822.4183626174927, "episodes_this_iter": 28, "timestamp": 1558334208, "episode_reward_max": 1063.0865856572825, "info": {"load_time_ms": 8.33, "default": {"vf_loss": 23.034263610839844, "total_loss": 23.02804183959961, "entropy": 1.3297806978225708, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009949324652552605, "vf_explained_var": 0.8575631380081177, "cur_lr": 0.0005000000237487257, "kl": 0.016560884192585945}, "num_steps_trained": 3836259, "grad_time_ms": 17376.282, "num_steps_sampled": 3836259, "sample_time_ms": 29419.216, "update_time_ms": 7.611}, "time_since_restore": 2822.4183626174927, "timesteps_total": 3836259, "episode_len_mean": 700.0, "episodes_total": 1621, "training_iteration": 58, "episode_reward_mean": 801.637790483632, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.96944189071655, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ed68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ed30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e470>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 58, "date": "2019-05-20_06-36-48", "timesteps_since_restore": 3836259, "timesteps_this_iter": 64174, "custom_metrics": {"system_level_velocity_min": 9.407012888094634, "outflow_rate_max": 1339.1070765452466, "system_level_velocity_max": 18.158964593396558, "cost1_mean": 336.81450545853426, "outflow_rate_mean": 1093.055902139261, "cost1_min": 242.35085524703948, "cost2_min": -217.58064949251386, "cost1_max": 472.8843309470312, "outflow_rate_min": 913.9923040538046, "cost2_max": -161.03466323247866, "cost2_mean": -187.82695211977796, "system_level_velocity_mean": 12.917689909862277}, "episode_reward_min": 618.0194607482297, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2869.490766763687, "episodes_this_iter": 26, "timestamp": 1558334255, "episode_reward_max": 1070.2779568424937, "info": {"load_time_ms": 8.448, "default": {"vf_loss": 20.99081802368164, "total_loss": 20.98461151123047, "entropy": 1.33489990234375, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009846911765635014, "vf_explained_var": 0.8634660243988037, "cur_lr": 0.0005000000237487257, "kl": 0.016180502250790596}, "num_steps_trained": 3902104, "grad_time_ms": 17305.608, "num_steps_sampled": 3902104, "sample_time_ms": 29489.678, "update_time_ms": 7.68}, "time_since_restore": 2869.490766763687, "timesteps_total": 3902104, "episode_len_mean": 700.0, "episodes_total": 1647, "training_iteration": 59, "episode_reward_mean": 799.1396786218272, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.07240414619446, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58efd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e128>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 59, "date": "2019-05-20_06-37-35", "timesteps_since_restore": 3902104, "timesteps_this_iter": 65845, "custom_metrics": {"system_level_velocity_min": 9.407012888094634, "outflow_rate_max": 1342.2201945428992, "system_level_velocity_max": 17.68322357396473, "cost1_mean": 331.8760010848978, "outflow_rate_mean": 1085.741602568782, "cost1_min": 242.35085524703948, "cost2_min": -217.27176487394823, "cost1_max": 467.4231364479408, "outflow_rate_min": 913.9923040538046, "cost2_max": -167.9496698371984, "cost2_mean": -190.5979912799941, "system_level_velocity_mean": 12.72984847897855}, "episode_reward_min": 618.0194607482297, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2917.8085770606995, "episodes_this_iter": 28, "timestamp": 1558334303, "episode_reward_max": 1070.2779568424937, "info": {"load_time_ms": 8.635, "default": {"vf_loss": 22.45895004272461, "total_loss": 22.453102111816406, "entropy": 1.3339736461639404, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.009266678243875504, "vf_explained_var": 0.844391405582428, "cur_lr": 0.0005000000237487257, "kl": 0.015200316905975342}, "num_steps_trained": 3969421, "grad_time_ms": 17320.293, "num_steps_sampled": 3969421, "sample_time_ms": 29585.202, "update_time_ms": 7.606}, "time_since_restore": 2917.8085770606995, "timesteps_total": 3969421, "episode_len_mean": 700.0, "episodes_total": 1675, "training_iteration": 60, "episode_reward_mean": 799.7276314798563, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.31781029701233, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51fbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f6d8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 60, "date": "2019-05-20_06-38-23", "timesteps_since_restore": 3969421, "timesteps_this_iter": 67317, "custom_metrics": {"system_level_velocity_min": 9.407012888094634, "outflow_rate_max": 1342.2201945428992, "system_level_velocity_max": 17.68322357396473, "cost1_mean": 332.5672915622519, "outflow_rate_mean": 1088.234090126503, "cost1_min": 242.35085524703948, "cost2_min": -217.27176487394823, "cost1_max": 467.4231364479408, "outflow_rate_min": 909.4351371836958, "cost2_max": -167.9496698371984, "cost2_mean": -191.86560905863465, "system_level_velocity_mean": 12.753596558225794}, "episode_reward_min": 599.0405911496524, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 2966.346743822098, "episodes_this_iter": 28, "timestamp": 1558334352, "episode_reward_max": 1070.2779568424937, "info": {"load_time_ms": 8.735, "default": {"vf_loss": 23.253435134887695, "total_loss": 23.247234344482422, "entropy": 1.3299336433410645, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009712093509733677, "vf_explained_var": 0.8557026982307434, "cur_lr": 0.0005000000237487257, "kl": 0.015608430840075016}, "num_steps_trained": 4035288, "grad_time_ms": 17274.16, "num_steps_sampled": 4035288, "sample_time_ms": 29858.938, "update_time_ms": 7.604}, "time_since_restore": 2966.346743822098, "timesteps_total": 4035288, "episode_len_mean": 700.0, "episodes_total": 1703, "training_iteration": 61, "episode_reward_mean": 800.6317871980469, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.538166761398315, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a67b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6320>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 61, "date": "2019-05-20_06-39-12", "timesteps_since_restore": 4035288, "timesteps_this_iter": 65867, "custom_metrics": {"system_level_velocity_min": 9.523806553706196, "outflow_rate_max": 1342.2201945428992, "system_level_velocity_max": 17.993796014985637, "cost1_mean": 331.6549471377403, "outflow_rate_mean": 1085.9102411614995, "cost1_min": 248.60236182235226, "cost2_min": -230.00650528903225, "cost1_max": 473.46515658806015, "outflow_rate_min": 909.4351371836958, "cost2_max": -161.9761069913491, "cost2_mean": -193.7600748127083, "system_level_velocity_mean": 12.718555149263427}, "episode_reward_min": 599.0405911496524, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3013.5554308891296, "episodes_this_iter": 26, "timestamp": 1558334399, "episode_reward_max": 1070.2779568424937, "info": {"load_time_ms": 8.435, "default": {"vf_loss": 23.218564987182617, "total_loss": 23.212421417236328, "entropy": 1.3283531665802002, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.00971738900989294, "vf_explained_var": 0.8613950610160828, "cur_lr": 0.0005000000237487257, "kl": 0.01587691716849804}, "num_steps_trained": 4103064, "grad_time_ms": 17249.596, "num_steps_sampled": 4103064, "sample_time_ms": 29804.51, "update_time_ms": 7.595}, "time_since_restore": 3013.5554308891296, "timesteps_total": 4103064, "episode_len_mean": 700.0, "episodes_total": 1729, "training_iteration": 62, "episode_reward_mean": 798.0780023906269, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.20868706703186, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58eb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e860>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 62, "date": "2019-05-20_06-39-59", "timesteps_since_restore": 4103064, "timesteps_this_iter": 67776, "custom_metrics": {"system_level_velocity_min": 9.523806553706196, "outflow_rate_max": 1342.4226449451935, "system_level_velocity_max": 17.993796014985637, "cost1_mean": 328.3790281505652, "outflow_rate_mean": 1081.358387328181, "cost1_min": 248.60236182235226, "cost2_min": -230.00650528903225, "cost1_max": 473.46515658806015, "outflow_rate_min": 909.4351371836958, "cost2_max": -161.9761069913491, "cost2_mean": -195.2901167508795, "system_level_velocity_mean": 12.603988298811885}, "episode_reward_min": 599.0405911496524, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3061.697522163391, "episodes_this_iter": 29, "timestamp": 1558334447, "episode_reward_max": 1017.4342649100378, "info": {"load_time_ms": 8.432, "default": {"vf_loss": 23.812307357788086, "total_loss": 23.807687759399414, "entropy": 1.3420557975769043, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.008194494061172009, "vf_explained_var": 0.85093754529953, "cur_lr": 0.0005000000237487257, "kl": 0.0158856101334095}, "num_steps_trained": 4170554, "grad_time_ms": 17262.652, "num_steps_sampled": 4170554, "sample_time_ms": 30069.418, "update_time_ms": 7.539}, "time_since_restore": 3061.697522163391, "timesteps_total": 4170554, "episode_len_mean": 686.7, "episodes_total": 1758, "training_iteration": 63, "episode_reward_mean": 779.4295464305391, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.142091274261475, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f828>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 63, "date": "2019-05-20_06-40-47", "timesteps_since_restore": 4170554, "timesteps_this_iter": 67490, "custom_metrics": {"system_level_velocity_min": 9.523806553706196, "outflow_rate_max": 1342.4226449451935, "system_level_velocity_max": 18.179057007577704, "cost1_mean": 320.71558290254217, "outflow_rate_mean": 1070.4474314259946, "cost1_min": 12.395691141478489, "cost2_min": -230.00650528903225, "cost1_max": 473.46515658806015, "outflow_rate_min": 467.7500288525429, "cost2_max": -13.633647026139823, "cost2_mean": -193.6948263444579, "system_level_velocity_mean": 12.648133274571894}, "episode_reward_min": 23.468264450147412, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3109.138320207596, "episodes_this_iter": 30, "timestamp": 1558334495, "episode_reward_max": 1017.4342649100378, "info": {"load_time_ms": 8.516, "default": {"vf_loss": 23.981271743774414, "total_loss": 23.97472381591797, "entropy": 1.3449761867523193, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.010060811415314674, "vf_explained_var": 0.8554327487945557, "cur_lr": 0.0005000000237487257, "kl": 0.015613350085914135}, "num_steps_trained": 4237159, "grad_time_ms": 17098.744, "num_steps_sampled": 4237159, "sample_time_ms": 30070.396, "update_time_ms": 7.448}, "time_since_restore": 3109.138320207596, "timesteps_total": 4237159, "episode_len_mean": 686.7, "episodes_total": 1788, "training_iteration": 64, "episode_reward_mean": 776.5064706923799, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.44079804420471, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6b00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 64, "date": "2019-05-20_06-41-35", "timesteps_since_restore": 4237159, "timesteps_this_iter": 66605, "custom_metrics": {"system_level_velocity_min": 9.523806553706196, "outflow_rate_max": 1342.4226449451935, "system_level_velocity_max": 18.179057007577704, "cost1_mean": 320.40611459060483, "outflow_rate_mean": 1070.2631235263289, "cost1_min": 12.395691141478489, "cost2_min": -222.54838194120236, "cost1_max": 473.46515658806015, "outflow_rate_min": 467.7500288525429, "cost2_max": -13.633647026139823, "cost2_mean": -194.74359089551663, "system_level_velocity_mean": 12.647302747195148}, "episode_reward_min": 23.468264450147412, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3156.895031452179, "episodes_this_iter": 28, "timestamp": 1558334543, "episode_reward_max": 1025.6383563701124, "info": {"load_time_ms": 8.425, "default": {"vf_loss": 25.976388931274414, "total_loss": 25.970264434814453, "entropy": 1.3450148105621338, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009696959517896175, "vf_explained_var": 0.8534433245658875, "cur_lr": 0.0005000000237487257, "kl": 0.015882544219493866}, "num_steps_trained": 4303401, "grad_time_ms": 17077.027, "num_steps_sampled": 4303401, "sample_time_ms": 30229.524, "update_time_ms": 7.319}, "time_since_restore": 3156.895031452179, "timesteps_total": 4303401, "episode_len_mean": 684.69, "episodes_total": 1816, "training_iteration": 65, "episode_reward_mean": 777.7353528215702, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.75671124458313, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58eef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ef60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e6d8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 65, "date": "2019-05-20_06-42-23", "timesteps_since_restore": 4303401, "timesteps_this_iter": 66242, "custom_metrics": {"system_level_velocity_min": 9.618469928789304, "outflow_rate_max": 1342.4226449451935, "system_level_velocity_max": 18.188515691090938, "cost1_mean": 322.914141294797, "outflow_rate_mean": 1076.0464699993947, "cost1_min": 12.395691141478489, "cost2_min": -222.54838194120236, "cost1_max": 454.1416068774985, "outflow_rate_min": 467.7500288525429, "cost2_max": -13.633647026139823, "cost2_mean": -193.54958308335813, "system_level_velocity_mean": 12.80112551007953}, "episode_reward_min": 23.468264450147412, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3205.225963115692, "episodes_this_iter": 32, "timestamp": 1558334591, "episode_reward_max": 1025.6383563701124, "info": {"load_time_ms": 8.445, "default": {"vf_loss": 28.184724807739258, "total_loss": 28.178861618041992, "entropy": 1.354154109954834, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.00968089234083891, "vf_explained_var": 0.846236526966095, "cur_lr": 0.0005000000237487257, "kl": 0.016970587894320488}, "num_steps_trained": 4369740, "grad_time_ms": 17044.652, "num_steps_sampled": 4369740, "sample_time_ms": 30408.172, "update_time_ms": 7.34}, "time_since_restore": 3205.225963115692, "timesteps_total": 4369740, "episode_len_mean": 671.42, "episodes_total": 1848, "training_iteration": 66, "episode_reward_mean": 764.3772777705759, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.330931663513184, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f5c0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 66, "date": "2019-05-20_06-43-11", "timesteps_since_restore": 4369740, "timesteps_this_iter": 66339, "custom_metrics": {"system_level_velocity_min": 9.18610074967025, "outflow_rate_max": 1333.727491456556, "system_level_velocity_max": 18.983698751883253, "cost1_mean": 318.8207713517575, "outflow_rate_mean": 1064.100934132894, "cost1_min": 12.395691141478489, "cost2_min": -222.28486558600193, "cost1_max": 496.55043696681486, "outflow_rate_min": 467.7500288525429, "cost2_max": -13.633647026139823, "cost2_mean": -188.89712988587257, "system_level_velocity_mean": 12.993968105237188}, "episode_reward_min": 23.468264450147412, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3253.14666891098, "episodes_this_iter": 27, "timestamp": 1558334639, "episode_reward_max": 1116.226680578843, "info": {"load_time_ms": 8.541, "default": {"vf_loss": 20.76991844177246, "total_loss": 20.763507843017578, "entropy": 1.3433045148849487, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.009925858117640018, "vf_explained_var": 0.8906572461128235, "cur_lr": 0.0005000000237487257, "kl": 0.015608797781169415}, "num_steps_trained": 4433704, "grad_time_ms": 17023.472, "num_steps_sampled": 4433704, "sample_time_ms": 30521.053, "update_time_ms": 7.338}, "time_since_restore": 3253.14666891098, "timesteps_total": 4433704, "episode_len_mean": 684.72, "episodes_total": 1875, "training_iteration": 67, "episode_reward_mean": 786.4485613581325, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.920705795288086, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58efd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e0b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 67, "date": "2019-05-20_06-43-59", "timesteps_since_restore": 4433704, "timesteps_this_iter": 63964, "custom_metrics": {"system_level_velocity_min": 9.18610074967025, "outflow_rate_max": 1359.4141354571302, "system_level_velocity_max": 18.983698751883253, "cost1_mean": 332.0225538489615, "outflow_rate_mean": 1088.9280062583905, "cost1_min": 18.6387708634883, "cost2_min": -218.62326632381075, "cost1_max": 496.55043696681486, "outflow_rate_min": 471.5618022451357, "cost2_max": -19.810853026176602, "cost2_mean": -189.60994856430602, "system_level_velocity_mean": 13.167964783271245}, "episode_reward_min": 47.265845763387134, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3301.688891887665, "episodes_this_iter": 30, "timestamp": 1558334688, "episode_reward_max": 1116.226680578843, "info": {"load_time_ms": 8.712, "default": {"vf_loss": 22.018033981323242, "total_loss": 22.01246452331543, "entropy": 1.3440877199172974, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009251189418137074, "vf_explained_var": 0.8738961815834045, "cur_lr": 0.0005000000237487257, "kl": 0.016358893364667892}, "num_steps_trained": 4501206, "grad_time_ms": 16991.701, "num_steps_sampled": 4501206, "sample_time_ms": 30809.512, "update_time_ms": 7.389}, "time_since_restore": 3301.688891887665, "timesteps_total": 4501206, "episode_len_mean": 684.72, "episodes_total": 1905, "training_iteration": 68, "episode_reward_mean": 778.9815909041844, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.54222297668457, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58eb70>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 68, "date": "2019-05-20_06-44-48", "timesteps_since_restore": 4501206, "timesteps_this_iter": 67502, "custom_metrics": {"system_level_velocity_min": 9.18610074967025, "outflow_rate_max": 1362.0987914441052, "system_level_velocity_max": 18.983698751883253, "cost1_mean": 331.79417414244165, "outflow_rate_mean": 1087.015990478376, "cost1_min": 18.6387708634883, "cost2_min": -224.25417912382179, "cost1_max": 496.55043696681486, "outflow_rate_min": 471.5618022451357, "cost2_max": -19.810853026176602, "cost2_mean": -189.79002952894405, "system_level_velocity_mean": 13.158078356184978}, "episode_reward_min": 47.265845763387134, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3348.9124777317047, "episodes_this_iter": 30, "timestamp": 1558334735, "episode_reward_max": 1116.226680578843, "info": {"load_time_ms": 8.59, "default": {"vf_loss": 25.584775924682617, "total_loss": 25.57863426208496, "entropy": 1.3396435976028442, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009699816815555096, "vf_explained_var": 0.8514158129692078, "cur_lr": 0.0005000000237487257, "kl": 0.0158134363591671}, "num_steps_trained": 4567525, "grad_time_ms": 16927.185, "num_steps_sampled": 4567525, "sample_time_ms": 30890.571, "update_time_ms": 7.484}, "time_since_restore": 3348.9124777317047, "timesteps_total": 4567525, "episode_len_mean": 675.3, "episodes_total": 1935, "training_iteration": 69, "episode_reward_mean": 768.0712006556261, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.22358584403992, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5909e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51fba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5bba20>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 69, "date": "2019-05-20_06-45-35", "timesteps_since_restore": 4567525, "timesteps_this_iter": 66319, "custom_metrics": {"system_level_velocity_min": 9.333487731406466, "outflow_rate_max": 1362.0987914441052, "system_level_velocity_max": 18.53418575572219, "cost1_mean": 326.7398263162675, "outflow_rate_mean": 1080.4418628053731, "cost1_min": 18.6387708634883, "cost2_min": -224.25417912382179, "cost1_max": 482.57968840286935, "outflow_rate_min": 458.1459519615458, "cost2_max": -19.810853026176602, "cost2_mean": -188.14805501545877, "system_level_velocity_mean": 13.220131414492593}, "episode_reward_min": 47.265845763387134, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3395.6273589134216, "episodes_this_iter": 28, "timestamp": 1558334782, "episode_reward_max": 1116.226680578843, "info": {"load_time_ms": 8.477, "default": {"vf_loss": 22.762775421142578, "total_loss": 22.75735092163086, "entropy": 1.337767243385315, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.008815474808216095, "vf_explained_var": 0.8594400882720947, "cur_lr": 0.0005000000237487257, "kl": 0.015071270056068897}, "num_steps_trained": 4633042, "grad_time_ms": 16771.982, "num_steps_sampled": 4633042, "sample_time_ms": 30885.246, "update_time_ms": 7.472}, "time_since_restore": 3395.6273589134216, "timesteps_total": 4633042, "episode_len_mean": 682.02, "episodes_total": 1963, "training_iteration": 70, "episode_reward_mean": 780.763854795409, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.71488118171692, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ebe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58efd0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 70, "date": "2019-05-20_06-46-22", "timesteps_since_restore": 4633042, "timesteps_this_iter": 65517, "custom_metrics": {"system_level_velocity_min": 9.118910025098378, "outflow_rate_max": 1362.0987914441052, "system_level_velocity_max": 18.59352135183065, "cost1_mean": 332.249465352854, "outflow_rate_mean": 1092.4145068544476, "cost1_min": 24.453242774056374, "cost2_min": -230.77372235576397, "cost1_max": 482.57968840286935, "outflow_rate_min": 458.1459519615458, "cost2_max": -27.05519536231369, "cost2_mean": -190.37959977694408, "system_level_velocity_mean": 13.25960268947082}, "episode_reward_min": 59.47322173123939, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3444.3200945854187, "episodes_this_iter": 27, "timestamp": 1558334830, "episode_reward_max": 1020.1765398245473, "info": {"load_time_ms": 8.479, "default": {"vf_loss": 21.022403717041016, "total_loss": 21.01570701599121, "entropy": 1.338883876800537, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.01014122273772955, "vf_explained_var": 0.8573864102363586, "cur_lr": 0.0005000000237487257, "kl": 0.015313389711081982}, "num_steps_trained": 4700295, "grad_time_ms": 16787.641, "num_steps_sampled": 4700295, "sample_time_ms": 30883.639, "update_time_ms": 7.501}, "time_since_restore": 3444.3200945854187, "timesteps_total": 4700295, "episode_len_mean": 682.02, "episodes_total": 1990, "training_iteration": 71, "episode_reward_mean": 771.5645927580937, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.69273567199707, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ecf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e9b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 71, "date": "2019-05-20_06-47-10", "timesteps_since_restore": 4700295, "timesteps_this_iter": 67253, "custom_metrics": {"system_level_velocity_min": 9.118910025098378, "outflow_rate_max": 1331.3787671278478, "system_level_velocity_max": 18.59352135183065, "cost1_mean": 322.81753463991686, "outflow_rate_mean": 1076.821958193056, "cost1_min": 24.453242774056374, "cost2_min": -230.77372235576397, "cost1_max": 470.6518350225234, "outflow_rate_min": 458.1459519615458, "cost2_max": -27.05519536231369, "cost2_mean": -192.78587684269922, "system_level_velocity_mean": 12.906713688014252}, "episode_reward_min": 59.47322173123939, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3491.0968210697174, "episodes_this_iter": 28, "timestamp": 1558334877, "episode_reward_max": 1056.4048153267584, "info": {"load_time_ms": 8.512, "default": {"vf_loss": 20.768983840942383, "total_loss": 20.763017654418945, "entropy": 1.3399474620819092, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.00964866392314434, "vf_explained_var": 0.8794241547584534, "cur_lr": 0.0005000000237487257, "kl": 0.016368770971894264}, "num_steps_trained": 4766591, "grad_time_ms": 16610.564, "num_steps_sampled": 4766591, "sample_time_ms": 31017.75, "update_time_ms": 7.6}, "time_since_restore": 3491.0968210697174, "timesteps_total": 4766591, "episode_len_mean": 682.02, "episodes_total": 2018, "training_iteration": 72, "episode_reward_mean": 776.1713153990478, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.776726484298706, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51ff60>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 72, "date": "2019-05-20_06-47-57", "timesteps_since_restore": 4766591, "timesteps_this_iter": 66296, "custom_metrics": {"system_level_velocity_min": 8.749518759304346, "outflow_rate_max": 1353.5576553575413, "system_level_velocity_max": 18.59352135183065, "cost1_mean": 323.1694744384514, "outflow_rate_mean": 1078.6095773379373, "cost1_min": 24.453242774056374, "cost2_min": -230.77372235576397, "cost1_max": 470.6518350225234, "outflow_rate_min": 458.1459519615458, "cost2_max": -27.05519536231369, "cost2_mean": -193.0108480811451, "system_level_velocity_mean": 12.909411890445377}, "episode_reward_min": 59.47322173123939, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3538.9046382904053, "episodes_this_iter": 29, "timestamp": 1558334925, "episode_reward_max": 1056.4048153267584, "info": {"load_time_ms": 8.473, "default": {"vf_loss": 21.056716918945312, "total_loss": 21.049837112426758, "entropy": 1.349204182624817, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010693314485251904, "vf_explained_var": 0.8659534454345703, "cur_lr": 0.0005000000237487257, "kl": 0.016945919021964073}, "num_steps_trained": 4834629, "grad_time_ms": 16534.078, "num_steps_sampled": 4834629, "sample_time_ms": 31061.708, "update_time_ms": 7.576}, "time_since_restore": 3538.9046382904053, "timesteps_total": 4834629, "episode_len_mean": 688.87, "episodes_total": 2047, "training_iteration": 73, "episode_reward_mean": 784.6900510828355, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.807817220687866, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f438>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 73, "date": "2019-05-20_06-48-45", "timesteps_since_restore": 4834629, "timesteps_this_iter": 68038, "custom_metrics": {"system_level_velocity_min": 8.749518759304346, "outflow_rate_max": 1353.5576553575413, "system_level_velocity_max": 18.85179825693142, "cost1_mean": 329.53374330216764, "outflow_rate_mean": 1092.8161490028137, "cost1_min": 29.622321199978565, "cost2_min": -230.77372235576397, "cost1_max": 470.6518350225234, "outflow_rate_min": 537.6134459400562, "cost2_max": -27.75403934802818, "cost2_mean": -194.25378388502313, "system_level_velocity_mean": 12.9843064884658}, "episode_reward_min": 59.47322173123939, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3587.294021844864, "episodes_this_iter": 31, "timestamp": 1558334973, "episode_reward_max": 1056.4048153267584, "info": {"load_time_ms": 8.209, "default": {"vf_loss": 24.105228424072266, "total_loss": 24.0987491607666, "entropy": 1.349042534828186, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010099228471517563, "vf_explained_var": 0.8575087189674377, "cur_lr": 0.0005000000237487257, "kl": 0.016090745106339455}, "num_steps_trained": 4899765, "grad_time_ms": 16458.006, "num_steps_sampled": 4899765, "sample_time_ms": 31231.913, "update_time_ms": 7.607}, "time_since_restore": 3587.294021844864, "timesteps_total": 4899765, "episode_len_mean": 682.1, "episodes_total": 2078, "training_iteration": 74, "episode_reward_mean": 767.9433017196055, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 48.38938355445862, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ba8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 74, "date": "2019-05-20_06-49-33", "timesteps_since_restore": 4899765, "timesteps_this_iter": 65136, "custom_metrics": {"system_level_velocity_min": 8.654575518800755, "outflow_rate_max": 1353.5576553575413, "system_level_velocity_max": 18.85179825693142, "cost1_mean": 322.66569659285796, "outflow_rate_mean": 1079.420293619238, "cost1_min": 19.29058112019375, "cost2_min": -222.4397564932803, "cost1_max": 480.0592712379813, "outflow_rate_min": 495.85824524386044, "cost2_max": -20.021940279820615, "cost2_mean": -193.10189428499598, "system_level_velocity_mean": 12.90584987940989}, "episode_reward_min": 46.31876625102684, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3634.823698282242, "episodes_this_iter": 28, "timestamp": 1558335021, "episode_reward_max": 958.1422589161631, "info": {"load_time_ms": 8.141, "default": {"vf_loss": 24.026519775390625, "total_loss": 24.01966667175293, "entropy": 1.3520947694778442, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010542426258325577, "vf_explained_var": 0.8481907248497009, "cur_lr": 0.0005000000237487257, "kl": 0.01639867201447487}, "num_steps_trained": 4964660, "grad_time_ms": 16375.21, "num_steps_sampled": 4964660, "sample_time_ms": 31292.579, "update_time_ms": 7.529}, "time_since_restore": 3634.823698282242, "timesteps_total": 4964660, "episode_len_mean": 682.1, "episodes_total": 2106, "training_iteration": 75, "episode_reward_mean": 769.7715125931586, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.52967643737793, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51f710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51fb70>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 75, "date": "2019-05-20_06-50-21", "timesteps_since_restore": 4964660, "timesteps_this_iter": 64895, "custom_metrics": {"system_level_velocity_min": 8.654575518800755, "outflow_rate_max": 1353.5576553575413, "system_level_velocity_max": 18.85179825693142, "cost1_mean": 323.6155354546049, "outflow_rate_mean": 1079.3596183381112, "cost1_min": 19.29058112019375, "cost2_min": -223.12658416254007, "cost1_max": 480.0592712379813, "outflow_rate_min": 495.85824524386044, "cost2_max": -20.021940279820615, "cost2_mean": -191.9067486258162, "system_level_velocity_mean": 12.95998407598699}, "episode_reward_min": 46.31876625102684, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3681.6237845420837, "episodes_this_iter": 29, "timestamp": 1558335068, "episode_reward_max": 958.1422589161631, "info": {"load_time_ms": 7.75, "default": {"vf_loss": 24.8491153717041, "total_loss": 24.84175682067871, "entropy": 1.362344741821289, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011054336093366146, "vf_explained_var": 0.8405748605728149, "cur_lr": 0.0005000000237487257, "kl": 0.01642075553536415}, "num_steps_trained": 5028960, "grad_time_ms": 16206.958, "num_steps_sampled": 5028960, "sample_time_ms": 31308.579, "update_time_ms": 7.469}, "time_since_restore": 3681.6237845420837, "timesteps_total": 5028960, "episode_len_mean": 679.91, "episodes_total": 2135, "training_iteration": 76, "episode_reward_mean": 768.0551099087295, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.80008625984192, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a69b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a61d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a64e0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 76, "date": "2019-05-20_06-51-08", "timesteps_since_restore": 5028960, "timesteps_this_iter": 64300, "custom_metrics": {"system_level_velocity_min": 8.654575518800755, "outflow_rate_max": 1328.0421503945875, "system_level_velocity_max": 18.462307985410753, "cost1_mean": 321.2485865900106, "outflow_rate_mean": 1072.6883658886907, "cost1_min": 15.310632437087126, "cost2_min": -223.12658416254007, "cost1_max": 480.0592712379813, "outflow_rate_min": 481.0028128682593, "cost2_max": -16.548194990902978, "cost2_mean": -190.8939687288908, "system_level_velocity_mean": 12.925620617997419}, "episode_reward_min": 36.390507614419256, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3729.176029920578, "episodes_this_iter": 31, "timestamp": 1558335115, "episode_reward_max": 950.3914009538231, "info": {"load_time_ms": 7.893, "default": {"vf_loss": 26.08041000366211, "total_loss": 26.073774337768555, "entropy": 1.3682090044021606, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.01043614186346531, "vf_explained_var": 0.823747456073761, "cur_lr": 0.0005000000237487257, "kl": 0.016886604949831963}, "num_steps_trained": 5093654, "grad_time_ms": 16105.115, "num_steps_sampled": 5093654, "sample_time_ms": 31374.083, "update_time_ms": 7.46}, "time_since_restore": 3729.176029920578, "timesteps_total": 5093654, "episode_len_mean": 673.19, "episodes_total": 2166, "training_iteration": 77, "episode_reward_mean": 758.0608428167398, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.55224537849426, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51fb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e51fb00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 77, "date": "2019-05-20_06-51-55", "timesteps_since_restore": 5093654, "timesteps_this_iter": 64694, "custom_metrics": {"system_level_velocity_min": 9.459302600324033, "outflow_rate_max": 1328.0421503945875, "system_level_velocity_max": 18.517052259519094, "cost1_mean": 317.2940960687345, "outflow_rate_mean": 1060.7809722238494, "cost1_min": 15.310632437087126, "cost2_min": -223.12658416254007, "cost1_max": 480.0592712379813, "outflow_rate_min": 466.71889971218434, "cost2_max": -16.548194990902978, "cost2_mean": -188.34712082838453, "system_level_velocity_mean": 12.958470843546172}, "episode_reward_min": 35.99454382316741, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3776.0267372131348, "episodes_this_iter": 26, "timestamp": 1558335162, "episode_reward_max": 988.4894632407131, "info": {"load_time_ms": 7.702, "default": {"vf_loss": 21.574174880981445, "total_loss": 21.567426681518555, "entropy": 1.3819515705108643, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01054122019559145, "vf_explained_var": 0.8612412810325623, "cur_lr": 0.0005000000237487257, "kl": 0.016852697357535362}, "num_steps_trained": 5159084, "grad_time_ms": 15980.14, "num_steps_sampled": 5159084, "sample_time_ms": 31331.984, "update_time_ms": 7.415}, "time_since_restore": 3776.0267372131348, "timesteps_total": 5159084, "episode_len_mean": 679.8, "episodes_total": 2192, "training_iteration": 78, "episode_reward_mean": 770.0960739702737, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.85070729255676, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e518>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 78, "date": "2019-05-20_06-52-42", "timesteps_since_restore": 5159084, "timesteps_this_iter": 65430, "custom_metrics": {"system_level_velocity_min": 9.459302600324033, "outflow_rate_max": 1328.0421503945875, "system_level_velocity_max": 18.517052259519094, "cost1_mean": 321.26373289360646, "outflow_rate_mean": 1070.749536841264, "cost1_min": 15.310632437087126, "cost2_min": -221.65293673858758, "cost1_max": 470.83915731177296, "outflow_rate_min": 466.71889971218434, "cost2_max": -16.548194990902978, "cost2_mean": -190.15568204921385, "system_level_velocity_mean": 12.934176393062007}, "episode_reward_min": 35.99454382316741, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3822.0747170448303, "episodes_this_iter": 28, "timestamp": 1558335208, "episode_reward_max": 1035.626688623076, "info": {"load_time_ms": 7.533, "default": {"vf_loss": 22.182180404663086, "total_loss": 22.17453384399414, "entropy": 1.380257487297058, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011984222568571568, "vf_explained_var": 0.8637627959251404, "cur_lr": 0.0005000000237487257, "kl": 0.0192649494856596}, "num_steps_trained": 5224050, "grad_time_ms": 15878.202, "num_steps_sampled": 5224050, "sample_time_ms": 31315.873, "update_time_ms": 7.225}, "time_since_restore": 3822.0747170448303, "timesteps_total": 5224050, "episode_len_mean": 686.57, "episodes_total": 2220, "training_iteration": 79, "episode_reward_mean": 773.4086618131346, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.04797983169556, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a69b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6b00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 79, "date": "2019-05-20_06-53-28", "timesteps_since_restore": 5224050, "timesteps_this_iter": 64966, "custom_metrics": {"system_level_velocity_min": 9.459302600324033, "outflow_rate_max": 1360.9916577883093, "system_level_velocity_max": 18.517052259519094, "cost1_mean": 322.12559252550295, "outflow_rate_mean": 1071.5790751234483, "cost1_min": 16.102382927879496, "cost2_min": -226.31252029455766, "cost1_max": 472.25553913194926, "outflow_rate_min": 466.71889971218434, "cost2_max": -17.849173333191768, "cost2_mean": -191.5619067749724, "system_level_velocity_mean": 12.799811455721542}, "episode_reward_min": 35.99454382316741, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3868.490248441696, "episodes_this_iter": 29, "timestamp": 1558335255, "episode_reward_max": 1035.626688623076, "info": {"load_time_ms": 7.145, "default": {"vf_loss": 24.70143699645996, "total_loss": 24.692577362060547, "entropy": 1.3818140029907227, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.012903828173875809, "vf_explained_var": 0.8605414032936096, "cur_lr": 0.0005000000237487257, "kl": 0.01798059046268463}, "num_steps_trained": 5288322, "grad_time_ms": 15824.998, "num_steps_sampled": 5288322, "sample_time_ms": 31339.077, "update_time_ms": 7.208}, "time_since_restore": 3868.490248441696, "timesteps_total": 5288322, "episode_len_mean": 686.75, "episodes_total": 2249, "training_iteration": 80, "episode_reward_mean": 778.5608471644529, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.415531396865845, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e4a8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 80, "date": "2019-05-20_06-54-15", "timesteps_since_restore": 5288322, "timesteps_this_iter": 64272, "custom_metrics": {"system_level_velocity_min": 9.459302600324033, "outflow_rate_max": 1360.9916577883093, "system_level_velocity_max": 18.517052259519094, "cost1_mean": 326.54800785954575, "outflow_rate_mean": 1083.3269026753953, "cost1_min": 22.199340851433924, "cost2_min": -226.31252029455766, "cost1_max": 472.25553913194926, "outflow_rate_min": 502.87693863577323, "cost2_max": -21.792800572056947, "cost2_mean": -189.84677864137552, "system_level_velocity_mean": 12.971452425406198}, "episode_reward_min": 49.39376813176086, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3915.5210440158844, "episodes_this_iter": 27, "timestamp": 1558335302, "episode_reward_max": 1035.626688623076, "info": {"load_time_ms": 6.729, "default": {"vf_loss": 22.672229766845703, "total_loss": 22.665237426757812, "entropy": 1.3988093137741089, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010791261680424213, "vf_explained_var": 0.8514574766159058, "cur_lr": 0.0005000000237487257, "kl": 0.016887621954083443}, "num_steps_trained": 5352620, "grad_time_ms": 15648.659, "num_steps_sampled": 5352620, "sample_time_ms": 31351.648, "update_time_ms": 7.229}, "time_since_restore": 3915.5210440158844, "timesteps_total": 5352620, "episode_len_mean": 686.82, "episodes_total": 2276, "training_iteration": 81, "episode_reward_mean": 782.6131251602901, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.03079557418823, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e828>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 81, "date": "2019-05-20_06-55-02", "timesteps_since_restore": 5352620, "timesteps_this_iter": 64298, "custom_metrics": {"system_level_velocity_min": 9.73183223761245, "outflow_rate_max": 1360.9916577883093, "system_level_velocity_max": 18.910037938591383, "cost1_mean": 329.2222446907864, "outflow_rate_mean": 1085.5938533543572, "cost1_min": 26.79347909907458, "cost2_min": -226.31252029455766, "cost1_max": 472.25553913194926, "outflow_rate_min": 502.87693863577323, "cost2_max": -24.62435436429629, "cost2_mean": -188.6106646666146, "system_level_velocity_mean": 13.074797926165346}, "episode_reward_min": 60.1337913573332, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 3962.6483726501465, "episodes_this_iter": 30, "timestamp": 1558335349, "episode_reward_max": 1035.626688623076, "info": {"load_time_ms": 6.873, "default": {"vf_loss": 25.662870407104492, "total_loss": 25.655241012573242, "entropy": 1.3982621431350708, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011508913710713387, "vf_explained_var": 0.8476687669754028, "cur_lr": 0.0005000000237487257, "kl": 0.017245115712285042}, "num_steps_trained": 5416122, "grad_time_ms": 15623.791, "num_steps_sampled": 5416122, "sample_time_ms": 31412.779, "update_time_ms": 7.112}, "time_since_restore": 3962.6483726501465, "timesteps_total": 5416122, "episode_len_mean": 680.2, "episodes_total": 2306, "training_iteration": 82, "episode_reward_mean": 771.4365924328272, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.127328634262085, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6a58>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 82, "date": "2019-05-20_06-55-49", "timesteps_since_restore": 5416122, "timesteps_this_iter": 63502, "custom_metrics": {"system_level_velocity_min": 9.73183223761245, "outflow_rate_max": 1360.9916577883093, "system_level_velocity_max": 18.910037938591383, "cost1_mean": 325.7393177753762, "outflow_rate_mean": 1076.2275156435371, "cost1_min": 25.465424747525873, "cost2_min": -212.98689012159923, "cost1_max": 482.95809677671775, "outflow_rate_min": 502.87693863577323, "cost2_max": -24.62435436429629, "cost2_mean": -185.87207777923825, "system_level_velocity_mean": 13.112803610165022}, "episode_reward_min": 55.39513700434278, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4008.7040100097656, "episodes_this_iter": 29, "timestamp": 1558335395, "episode_reward_max": 959.4205537315897, "info": {"load_time_ms": 6.893, "default": {"vf_loss": 25.399721145629883, "total_loss": 25.392173767089844, "entropy": 1.3895212411880493, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011380995623767376, "vf_explained_var": 0.8533236384391785, "cur_lr": 0.0005000000237487257, "kl": 0.01703254133462906}, "num_steps_trained": 5481155, "grad_time_ms": 15585.994, "num_steps_sampled": 5481155, "sample_time_ms": 31275.591, "update_time_ms": 7.149}, "time_since_restore": 4008.7040100097656, "timesteps_total": 5481155, "episode_len_mean": 673.56, "episodes_total": 2335, "training_iteration": 83, "episode_reward_mean": 757.6744567303608, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.05563735961914, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ecc0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 83, "date": "2019-05-20_06-56-35", "timesteps_since_restore": 5481155, "timesteps_this_iter": 65033, "custom_metrics": {"system_level_velocity_min": 9.73183223761245, "outflow_rate_max": 1298.2325292782816, "system_level_velocity_max": 18.960922864832785, "cost1_mean": 318.46593197609786, "outflow_rate_mean": 1060.9052668489776, "cost1_min": 23.799354123400825, "cost2_min": -212.98689012159923, "cost1_max": 482.95809677671775, "outflow_rate_min": 497.0351305186435, "cost2_max": -24.34366633525767, "cost2_mean": -184.49805910881335, "system_level_velocity_mean": 13.013872172129515}, "episode_reward_min": 55.39513700434278, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4056.0827209949493, "episodes_this_iter": 31, "timestamp": 1558335443, "episode_reward_max": 1184.4633884313125, "info": {"load_time_ms": 7.055, "default": {"vf_loss": 26.3248233795166, "total_loss": 26.317222595214844, "entropy": 1.3850529193878174, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011423761956393719, "vf_explained_var": 0.851378858089447, "cur_lr": 0.0005000000237487257, "kl": 0.01698274165391922}, "num_steps_trained": 5544080, "grad_time_ms": 15566.062, "num_steps_sampled": 5544080, "sample_time_ms": 31197.172, "update_time_ms": 7.13}, "time_since_restore": 4056.0827209949493, "timesteps_total": 5544080, "episode_len_mean": 686.74, "episodes_total": 2366, "training_iteration": 84, "episode_reward_mean": 775.7889117856325, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 47.378710985183716, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ea58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ec88>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 84, "date": "2019-05-20_06-57-23", "timesteps_since_restore": 5544080, "timesteps_this_iter": 62925, "custom_metrics": {"system_level_velocity_min": 10.11783514358243, "outflow_rate_max": 1355.828489252535, "system_level_velocity_max": 18.960922864832785, "cost1_mean": 331.46809791930013, "outflow_rate_mean": 1085.8737321440783, "cost1_min": 23.799354123400825, "cost2_min": -212.53949107241522, "cost1_max": 482.95809677671775, "outflow_rate_min": 497.0351305186435, "cost2_max": -24.34366633525767, "cost2_mean": -184.13760521129225, "system_level_velocity_mean": 13.153792047615923}, "episode_reward_min": 55.39513700434278, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4102.6453721523285, "episodes_this_iter": 27, "timestamp": 1558335489, "episode_reward_max": 1184.4633884313125, "info": {"load_time_ms": 7.044, "default": {"vf_loss": 22.153282165527344, "total_loss": 22.145069122314453, "entropy": 1.399422526359558, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012174488976597786, "vf_explained_var": 0.8582568764686584, "cur_lr": 0.0005000000237487257, "kl": 0.017597336322069168}, "num_steps_trained": 5607711, "grad_time_ms": 15508.345, "num_steps_sampled": 5607711, "sample_time_ms": 31157.979, "update_time_ms": 7.168}, "time_since_restore": 4102.6453721523285, "timesteps_total": 5607711, "episode_len_mean": 689.42, "episodes_total": 2393, "training_iteration": 85, "episode_reward_mean": 778.0710028883975, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 46.56265115737915, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560940>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 85, "date": "2019-05-20_06-58-09", "timesteps_since_restore": 5607711, "timesteps_this_iter": 63631, "custom_metrics": {"system_level_velocity_min": 10.10329115558349, "outflow_rate_max": 1355.828489252535, "system_level_velocity_max": 18.960922864832785, "cost1_mean": 333.812558340906, "outflow_rate_mean": 1089.9541196265195, "cost1_min": 23.799354123400825, "cost2_min": -212.53949107241522, "cost1_max": 482.95809677671775, "outflow_rate_min": 497.0351305186435, "cost2_max": -24.34366633525767, "cost2_mean": -183.4626887944026, "system_level_velocity_mean": 13.171241417819283}, "episode_reward_min": 56.98167377719138, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4147.905619382858, "episodes_this_iter": 28, "timestamp": 1558335535, "episode_reward_max": 1184.4633884313125, "info": {"load_time_ms": 7.346, "default": {"vf_loss": 24.184476852416992, "total_loss": 24.177270889282227, "entropy": 1.4002666473388672, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.0112169673666358, "vf_explained_var": 0.8367393016815186, "cur_lr": 0.0005000000237487257, "kl": 0.017827041447162628}, "num_steps_trained": 5668882, "grad_time_ms": 15472.967, "num_steps_sampled": 5668882, "sample_time_ms": 31039.156, "update_time_ms": 7.297}, "time_since_restore": 4147.905619382858, "timesteps_total": 5668882, "episode_len_mean": 690.07, "episodes_total": 2421, "training_iteration": 86, "episode_reward_mean": 778.1415359670642, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 45.260247230529785, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ecf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e278>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 86, "date": "2019-05-20_06-58-55", "timesteps_since_restore": 5668882, "timesteps_this_iter": 61171, "custom_metrics": {"system_level_velocity_min": 10.10329115558349, "outflow_rate_max": 1355.828489252535, "system_level_velocity_max": 18.91785781903778, "cost1_mean": 331.45754515673383, "outflow_rate_mean": 1085.7187173567115, "cost1_min": 69.46176629609181, "cost2_min": -208.51039873832278, "cost1_max": 481.7554848451214, "outflow_rate_min": 702.0346581041522, "cost2_max": -47.47685783456126, "cost2_mean": -180.88800210140175, "system_level_velocity_mean": 13.067313709299345}, "episode_reward_min": 137.9216913033283, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4190.7807404994965, "episodes_this_iter": 31, "timestamp": 1558335577, "episode_reward_max": 1017.5074597569189, "info": {"load_time_ms": 7.19, "default": {"vf_loss": 27.234960556030273, "total_loss": 27.22697639465332, "entropy": 1.3971922397613525, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012192504480481148, "vf_explained_var": 0.844895601272583, "cur_lr": 0.0005000000237487257, "kl": 0.018692148849368095}, "num_steps_trained": 5730062, "grad_time_ms": 15468.622, "num_steps_sampled": 5730062, "sample_time_ms": 30576.221, "update_time_ms": 7.319}, "time_since_restore": 4190.7807404994965, "timesteps_total": 5730062, "episode_len_mean": 690.07, "episodes_total": 2452, "training_iteration": 87, "episode_reward_mean": 776.7449845310791, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.875121116638184, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8eddea90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8edde1d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 87, "date": "2019-05-20_06-59-37", "timesteps_since_restore": 5730062, "timesteps_this_iter": 61180, "custom_metrics": {"system_level_velocity_min": 10.10329115558349, "outflow_rate_max": 1347.2599614713283, "system_level_velocity_max": 18.91785781903778, "cost1_mean": 328.917275627061, "outflow_rate_mean": 1079.128149572164, "cost1_min": 69.46176629609181, "cost2_min": -208.3000598221002, "cost1_max": 460.94497968544067, "outflow_rate_min": 702.0346581041522, "cost2_max": -47.47685783456126, "cost2_mean": -179.74226436595472, "system_level_velocity_mean": 12.964731382681258}, "episode_reward_min": 137.9216913033283, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4233.383965969086, "episodes_this_iter": 30, "timestamp": 1558335620, "episode_reward_max": 1037.2234189009055, "info": {"load_time_ms": 7.171, "default": {"vf_loss": 26.907272338867188, "total_loss": 26.89898681640625, "entropy": 1.4131797552108765, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012722674757242203, "vf_explained_var": 0.8296458125114441, "cur_lr": 0.0005000000237487257, "kl": 0.019718851894140244}, "num_steps_trained": 5792040, "grad_time_ms": 15385.809, "num_steps_sampled": 5792040, "sample_time_ms": 30234.348, "update_time_ms": 7.325}, "time_since_restore": 4233.383965969086, "timesteps_total": 5792040, "episode_len_mean": 683.3, "episodes_total": 2482, "training_iteration": 88, "episode_reward_mean": 772.2097783373404, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.60322546958923, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0eb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0ec18>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 88, "date": "2019-05-20_07-00-20", "timesteps_since_restore": 5792040, "timesteps_this_iter": 61978, "custom_metrics": {"system_level_velocity_min": 10.10329115558349, "outflow_rate_max": 1327.6031520131155, "system_level_velocity_max": 19.65765257790175, "cost1_mean": 327.5293019970203, "outflow_rate_mean": 1075.7253632165955, "cost1_min": 15.401925544614468, "cost2_min": -208.3000598221002, "cost1_max": 470.9037563947792, "outflow_rate_min": 481.0028128682593, "cost2_max": -16.04866431558787, "cost2_mean": -176.89528860897718, "system_level_velocity_mean": 13.110161083430482}, "episode_reward_min": 30.75810327850136, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4276.1103394031525, "episodes_this_iter": 28, "timestamp": 1558335663, "episode_reward_max": 1037.2234189009055, "info": {"load_time_ms": 6.986, "default": {"vf_loss": 25.798355102539062, "total_loss": 25.790584564208984, "entropy": 1.3888353109359741, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012008965946733952, "vf_explained_var": 0.8544335961341858, "cur_lr": 0.0005000000237487257, "kl": 0.018840868026018143}, "num_steps_trained": 5855576, "grad_time_ms": 15374.952, "num_steps_sampled": 5855576, "sample_time_ms": 29913.714, "update_time_ms": 7.4}, "time_since_restore": 4276.1103394031525, "timesteps_total": 5855576, "episode_len_mean": 686.6, "episodes_total": 2510, "training_iteration": 89, "episode_reward_mean": 773.6764976192845, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.72637343406677, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590630>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 89, "date": "2019-05-20_07-01-03", "timesteps_since_restore": 5855576, "timesteps_this_iter": 63536, "custom_metrics": {"system_level_velocity_min": 9.90679692260478, "outflow_rate_max": 1314.0530295926235, "system_level_velocity_max": 19.65765257790175, "cost1_mean": 332.96131034695355, "outflow_rate_mean": 1083.43102070096, "cost1_min": 15.401925544614468, "cost2_min": -208.3000598221002, "cost1_max": 497.25394765985624, "outflow_rate_min": 481.0028128682593, "cost2_max": -16.04866431558787, "cost2_mean": -176.94769931105424, "system_level_velocity_mean": 13.23567424093028}, "episode_reward_min": 30.75810327850136, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4318.66943359375, "episodes_this_iter": 29, "timestamp": 1558335705, "episode_reward_max": 1037.2234189009055, "info": {"load_time_ms": 7.312, "default": {"vf_loss": 24.86305046081543, "total_loss": 24.85456085205078, "entropy": 1.4212918281555176, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012537057511508465, "vf_explained_var": 0.8459133505821228, "cur_lr": 0.0005000000237487257, "kl": 0.01797959953546524}, "num_steps_trained": 5918982, "grad_time_ms": 15351.074, "num_steps_sampled": 5918982, "sample_time_ms": 29553.581, "update_time_ms": 7.42}, "time_since_restore": 4318.66943359375, "timesteps_total": 5918982, "episode_len_mean": 674.3, "episodes_total": 2539, "training_iteration": 90, "episode_reward_mean": 760.2744152844618, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.559094190597534, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590908>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 90, "date": "2019-05-20_07-01-45", "timesteps_since_restore": 5918982, "timesteps_this_iter": 63406, "custom_metrics": {"system_level_velocity_min": 9.90679692260478, "outflow_rate_max": 1314.0530295926235, "system_level_velocity_max": 19.65765257790175, "cost1_mean": 330.79546769968425, "outflow_rate_mean": 1080.9711215491013, "cost1_min": 15.401925544614468, "cost2_min": -201.08020182970887, "cost1_max": 497.25394765985624, "outflow_rate_min": 481.0028128682593, "cost2_max": -16.04866431558787, "cost2_mean": -172.78778621973595, "system_level_velocity_mean": 13.498935801641545}, "episode_reward_min": 30.75810327850136, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4360.974068403244, "episodes_this_iter": 29, "timestamp": 1558335748, "episode_reward_max": 1037.2234189009055, "info": {"load_time_ms": 7.683, "default": {"vf_loss": 23.05296516418457, "total_loss": 23.044965744018555, "entropy": 1.424408197402954, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012156660668551922, "vf_explained_var": 0.8596097826957703, "cur_lr": 0.0005000000237487257, "kl": 0.018472395837306976}, "num_steps_trained": 5981715, "grad_time_ms": 15351.669, "num_steps_sampled": 5981715, "sample_time_ms": 29080.219, "update_time_ms": 7.35}, "time_since_restore": 4360.974068403244, "timesteps_total": 5981715, "episode_len_mean": 667.48, "episodes_total": 2568, "training_iteration": 91, "episode_reward_mean": 753.745757914772, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.30463480949402, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ae80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a240>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 91, "date": "2019-05-20_07-02-28", "timesteps_since_restore": 5981715, "timesteps_this_iter": 62733, "custom_metrics": {"system_level_velocity_min": 9.856847177844031, "outflow_rate_max": 1314.0530295926235, "system_level_velocity_max": 19.65765257790175, "cost1_mean": 328.6553598800989, "outflow_rate_mean": 1075.1909493845599, "cost1_min": 11.690202101632261, "cost2_min": -201.08020182970887, "cost1_max": 497.25394765985624, "outflow_rate_min": 464.32649368107076, "cost2_max": -13.422797029860023, "cost2_mean": -169.74606015980385, "system_level_velocity_mean": 13.605492502883045}, "episode_reward_min": 22.078758964934487, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4401.907468795776, "episodes_this_iter": 31, "timestamp": 1558335789, "episode_reward_max": 1133.4793679799307, "info": {"load_time_ms": 7.69, "default": {"vf_loss": 29.97621726989746, "total_loss": 29.96886444091797, "entropy": 1.3986924886703491, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011275035329163074, "vf_explained_var": 0.8308085203170776, "cur_lr": 0.0005000000237487257, "kl": 0.01743636466562748}, "num_steps_trained": 6042588, "grad_time_ms": 15267.787, "num_steps_sampled": 6042588, "sample_time_ms": 28544.777, "update_time_ms": 7.392}, "time_since_restore": 4401.907468795776, "timesteps_total": 6042588, "episode_len_mean": 670.33, "episodes_total": 2599, "training_iteration": 92, "episode_reward_mean": 766.4887682865403, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 40.93340039253235, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce4a8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 92, "date": "2019-05-20_07-03-09", "timesteps_since_restore": 6042588, "timesteps_this_iter": 60873, "custom_metrics": {"system_level_velocity_min": 9.856847177844031, "outflow_rate_max": 1326.3060211363793, "system_level_velocity_max": 19.527791363058846, "cost1_mean": 331.06065378256943, "outflow_rate_mean": 1073.1292636224887, "cost1_min": 11.690202101632261, "cost2_min": -206.12765315282763, "cost1_max": 497.25394765985624, "outflow_rate_min": 464.32649368107076, "cost2_max": -13.422797029860023, "cost2_mean": -168.43532359624425, "system_level_velocity_mean": 13.6246228337114}, "episode_reward_min": 22.078758964934487, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4443.533050537109, "episodes_this_iter": 30, "timestamp": 1558335830, "episode_reward_max": 1133.4793679799307, "info": {"load_time_ms": 7.812, "default": {"vf_loss": 25.774112701416016, "total_loss": 25.766651153564453, "entropy": 1.4285670518875122, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011628786101937294, "vf_explained_var": 0.8359814286231995, "cur_lr": 0.0005000000237487257, "kl": 0.01853376068174839}, "num_steps_trained": 6104881, "grad_time_ms": 15175.577, "num_steps_sampled": 6104881, "sample_time_ms": 28194.494, "update_time_ms": 7.289}, "time_since_restore": 4443.533050537109, "timesteps_total": 6104881, "episode_len_mean": 682.56, "episodes_total": 2629, "training_iteration": 93, "episode_reward_mean": 776.9441204261325, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 41.62558174133301, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590da0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 93, "date": "2019-05-20_07-03-50", "timesteps_since_restore": 6104881, "timesteps_this_iter": 62293, "custom_metrics": {"system_level_velocity_min": 9.205432113421006, "outflow_rate_max": 1332.8914137485576, "system_level_velocity_max": 19.527791363058846, "cost1_mean": 335.65482213966226, "outflow_rate_mean": 1078.8806249434629, "cost1_min": 11.690202101632261, "cost2_min": -216.88782617122726, "cost1_max": 486.3538718323715, "outflow_rate_min": 464.32649368107076, "cost2_max": -13.422797029860023, "cost2_mean": -170.50441979820917, "system_level_velocity_mean": 13.47286570275435}, "episode_reward_min": 22.078758964934487, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4485.58811044693, "episodes_this_iter": 28, "timestamp": 1558335873, "episode_reward_max": 1133.4793679799307, "info": {"load_time_ms": 7.876, "default": {"vf_loss": 22.65627670288086, "total_loss": 22.64862632751465, "entropy": 1.4247486591339111, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011527666822075844, "vf_explained_var": 0.8588085174560547, "cur_lr": 0.0005000000237487257, "kl": 0.017228322103619576}, "num_steps_trained": 6166999, "grad_time_ms": 15103.034, "num_steps_sampled": 6166999, "sample_time_ms": 27733.355, "update_time_ms": 7.29}, "time_since_restore": 4485.58811044693, "timesteps_total": 6166999, "episode_len_mean": 689.38, "episodes_total": 2657, "training_iteration": 94, "episode_reward_mean": 791.0359922030469, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.05505990982056, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583080>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 94, "date": "2019-05-20_07-04-33", "timesteps_since_restore": 6166999, "timesteps_this_iter": 62118, "custom_metrics": {"system_level_velocity_min": 9.205432113421006, "outflow_rate_max": 1332.8914137485576, "system_level_velocity_max": 19.342959087290428, "cost1_mean": 345.74183152609805, "outflow_rate_mean": 1097.6400444791257, "cost1_min": 20.13724300225105, "cost2_min": -216.88782617122726, "cost1_max": 492.4843518949254, "outflow_rate_min": 476.4293392398949, "cost2_max": -20.816069178538108, "cost2_mean": -172.43051883056057, "system_level_velocity_mean": 13.65886726969643}, "episode_reward_min": 42.34802515010931, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4526.802188396454, "episodes_this_iter": 32, "timestamp": 1558335914, "episode_reward_max": 1133.4793679799307, "info": {"load_time_ms": 7.893, "default": {"vf_loss": 27.745525360107422, "total_loss": 27.737411499023438, "entropy": 1.4186702966690063, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01223952230066061, "vf_explained_var": 0.8235350251197815, "cur_lr": 0.0005000000237487257, "kl": 0.01834644190967083}, "num_steps_trained": 6228272, "grad_time_ms": 15012.753, "num_steps_sampled": 6228272, "sample_time_ms": 27289.762, "update_time_ms": 7.211}, "time_since_restore": 4526.802188396454, "timesteps_total": 6228272, "episode_len_mean": 679.73, "episodes_total": 2689, "training_iteration": 95, "episode_reward_mean": 776.4347651618524, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 41.214077949523926, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a320>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 95, "date": "2019-05-20_07-05-14", "timesteps_since_restore": 6228272, "timesteps_this_iter": 61273, "custom_metrics": {"system_level_velocity_min": 8.952958865181733, "outflow_rate_max": 1332.8914137485576, "system_level_velocity_max": 19.023435434888043, "cost1_mean": 338.45846360295445, "outflow_rate_mean": 1082.8573324401475, "cost1_min": 11.744120623686817, "cost2_min": -216.88782617122726, "cost1_max": 492.4843518949254, "outflow_rate_min": 464.32649368107076, "cost2_max": -13.877671608944206, "cost2_mean": -169.10912711877626, "system_level_velocity_mean": 13.60442648049878}, "episode_reward_min": 24.145844737158153, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4568.216089725494, "episodes_this_iter": 29, "timestamp": 1558335955, "episode_reward_max": 1035.6451682274155, "info": {"load_time_ms": 7.95, "default": {"vf_loss": 22.333242416381836, "total_loss": 22.324953079223633, "entropy": 1.4176656007766724, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.01235270593315363, "vf_explained_var": 0.8574115037918091, "cur_lr": 0.0005000000237487257, "kl": 0.01804315857589245}, "num_steps_trained": 6290082, "grad_time_ms": 15018.252, "num_steps_sampled": 6290082, "sample_time_ms": 26899.47, "update_time_ms": 7.063}, "time_since_restore": 4568.216089725494, "timesteps_total": 6290082, "episode_len_mean": 686.43, "episodes_total": 2718, "training_iteration": 96, "episode_reward_mean": 780.2327604444778, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 41.41390132904053, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0eb70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e860>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 96, "date": "2019-05-20_07-05-55", "timesteps_since_restore": 6290082, "timesteps_this_iter": 61810, "custom_metrics": {"system_level_velocity_min": 8.952958865181733, "outflow_rate_max": 1331.0800675957528, "system_level_velocity_max": 19.023435434888043, "cost1_mean": 342.24542161616154, "outflow_rate_mean": 1092.5594516105903, "cost1_min": 11.744120623686817, "cost2_min": -205.84997818815452, "cost1_max": 492.4843518949254, "outflow_rate_min": 464.32649368107076, "cost2_max": -13.877671608944206, "cost2_mean": -170.42144402607016, "system_level_velocity_mean": 13.580718824919577}, "episode_reward_min": 24.145844737158153, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4609.157037258148, "episodes_this_iter": 32, "timestamp": 1558335996, "episode_reward_max": 1122.4867208172182, "info": {"load_time_ms": 8.195, "default": {"vf_loss": 29.063005447387695, "total_loss": 29.0549373626709, "entropy": 1.3998403549194336, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012584050185978413, "vf_explained_var": 0.8445552587509155, "cur_lr": 0.0005000000237487257, "kl": 0.020073728635907173}, "num_steps_trained": 6352020, "grad_time_ms": 14887.927, "num_steps_sampled": 6352020, "sample_time_ms": 26836.131, "update_time_ms": 7.024}, "time_since_restore": 4609.157037258148, "timesteps_total": 6352020, "episode_len_mean": 673.25, "episodes_total": 2750, "training_iteration": 97, "episode_reward_mean": 772.0819434562328, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 40.94094753265381, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583cc0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 97, "date": "2019-05-20_07-06-36", "timesteps_since_restore": 6352020, "timesteps_this_iter": 61938, "custom_metrics": {"system_level_velocity_min": 8.952958865181733, "outflow_rate_max": 1341.9224441710398, "system_level_velocity_max": 19.507397038146138, "cost1_mean": 337.52516119060607, "outflow_rate_mean": 1085.6549667996264, "cost1_min": 11.744120623686817, "cost2_min": -220.48923431216735, "cost1_max": 506.543647250802, "outflow_rate_min": 464.32649368107076, "cost2_max": -13.877671608944206, "cost2_mean": -167.01245284199274, "system_level_velocity_mean": 13.760499420915913}, "episode_reward_min": 24.145844737158153, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4652.013650894165, "episodes_this_iter": 34, "timestamp": 1558336039, "episode_reward_max": 1122.4867208172182, "info": {"load_time_ms": 8.341, "default": {"vf_loss": 30.09308624267578, "total_loss": 30.086524963378906, "entropy": 1.4132945537567139, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.011610554531216621, "vf_explained_var": 0.8175583481788635, "cur_lr": 0.0005000000237487257, "kl": 0.014962437562644482}, "num_steps_trained": 6413832, "grad_time_ms": 14900.93, "num_steps_sampled": 6413832, "sample_time_ms": 26848.523, "update_time_ms": 6.914}, "time_since_restore": 4652.013650894165, "timesteps_total": 6413832, "episode_len_mean": 654.09, "episodes_total": 2784, "training_iteration": 98, "episode_reward_mean": 756.8920802776048, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.856613636016846, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583550>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 98, "date": "2019-05-20_07-07-19", "timesteps_since_restore": 6413832, "timesteps_this_iter": 61812, "custom_metrics": {"system_level_velocity_min": 9.749234086016365, "outflow_rate_max": 1363.00349286015, "system_level_velocity_max": 19.507397038146138, "cost1_mean": 334.7837882368684, "outflow_rate_mean": 1084.273759406273, "cost1_min": 16.13541798271645, "cost2_min": -220.48923431216735, "cost1_max": 506.543647250802, "outflow_rate_min": 470.0972780905627, "cost2_max": -17.027934116890595, "cost2_mean": -162.5011231946806, "system_level_velocity_mean": 14.189374945242383}, "episode_reward_min": 36.08692629295829, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4694.691616535187, "episodes_this_iter": 28, "timestamp": 1558336082, "episode_reward_max": 1122.4867208172182, "info": {"load_time_ms": 8.727, "default": {"vf_loss": 20.951168060302734, "total_loss": 20.944334030151367, "entropy": 1.4224151372909546, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.011753437109291553, "vf_explained_var": 0.8537442088127136, "cur_lr": 0.0005000000237487257, "kl": 0.014581226743757725}, "num_steps_trained": 6477177, "grad_time_ms": 14877.143, "num_steps_sampled": 6477177, "sample_time_ms": 26867.82, "update_time_ms": 6.897}, "time_since_restore": 4694.691616535187, "timesteps_total": 6477177, "episode_len_mean": 660.84, "episodes_total": 2812, "training_iteration": 99, "episode_reward_mean": 768.9462884870189, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": false, "time_this_iter_s": 42.67796564102173, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ab00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 99, "date": "2019-05-20_07-08-02", "timesteps_since_restore": 6477177, "timesteps_this_iter": 63345, "custom_metrics": {"system_level_velocity_min": 9.749234086016365, "outflow_rate_max": 1363.00349286015, "system_level_velocity_max": 19.507397038146138, "cost1_mean": 339.4831977030343, "outflow_rate_mean": 1097.0193160516835, "cost1_min": 16.13541798271645, "cost2_min": -220.48923431216735, "cost1_max": 506.543647250802, "outflow_rate_min": 470.0972780905627, "cost2_max": -17.724843379166927, "cost2_mean": -164.76024144490734, "system_level_velocity_mean": 14.214289156367464}, "episode_reward_min": 36.08692629295829, "pid": 34488}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "time_total_s": 4736.083651304245, "episodes_this_iter": 29, "timestamp": 1558336123, "episode_reward_max": 1122.4867208172182, "info": {"load_time_ms": 8.824, "default": {"vf_loss": 25.248533248901367, "total_loss": 25.24152183532715, "entropy": 1.4215583801269531, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.011979097500443459, "vf_explained_var": 0.8389136791229248, "cur_lr": 0.0005000000237487257, "kl": 0.014718123711645603}, "num_steps_trained": 6538449, "grad_time_ms": 14835.101, "num_steps_sampled": 6538449, "sample_time_ms": 26792.886, "update_time_ms": 6.884}, "time_since_restore": 4736.083651304245, "timesteps_total": 6538449, "episode_len_mean": 667.27, "episodes_total": 2841, "training_iteration": 100, "episode_reward_mean": 770.8236741346111, "hostname": "flow-main", "experiment_id": "b2aed6eb35d240a487bc57c8bb267fee", "done": true, "time_this_iter_s": 41.39203476905823, "config": {"num_sgd_iter": 10, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a58>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "conv_filters": null, "lstm_cell_size": 256, "framestack": true, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "custom_options": {}, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "zero_mean": true, "grayscale": false, "channel_major": false, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "vf_share_layers": false, "clip_param": 0.3, "clip_rewards": null}, "iterations_since_restore": 100, "date": "2019-05-20_07-08-43", "timesteps_since_restore": 6538449, "timesteps_this_iter": 61272, "custom_metrics": {"system_level_velocity_min": 10.925435160856887, "outflow_rate_max": 1363.00349286015, "system_level_velocity_max": 18.96570179086988, "cost1_mean": 338.9893501379197, "outflow_rate_mean": 1094.7499724604115, "cost1_min": 15.512548004258608, "cost2_min": -209.06781590300218, "cost1_max": 479.36416917738075, "outflow_rate_min": 470.0972780905627, "cost2_max": -15.22233693590211, "cost2_mean": -166.08771494745412, "system_level_velocity_mean": 14.019968667125216}, "episode_reward_min": 36.08692629295829, "pid": 34488}

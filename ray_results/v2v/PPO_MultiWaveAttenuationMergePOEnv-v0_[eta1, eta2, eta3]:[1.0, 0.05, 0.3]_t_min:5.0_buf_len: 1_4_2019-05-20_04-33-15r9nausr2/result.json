{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 1, "episodes_this_iter": 27, "timestamp": 1558326855, "episode_reward_max": 682.5589641704897, "info": {"load_time_ms": 54.894, "default": {"vf_loss": 1.59544038772583, "entropy": 1.4111639261245728, "total_loss": 1.594150424003601, "cur_kl_coeff": 0.20000001788139343, "policy_loss": -0.0019398636650294065, "vf_explained_var": 0.854246199131012, "cur_lr": 0.0005000000237487257, "kl": 0.0032498480286449194}, "num_steps_trained": 62898, "grad_time_ms": 15294.069, "num_steps_sampled": 62898, "sample_time_ms": 33804.737, "update_time_ms": 547.506}, "time_since_restore": 49.84675455093384, "timesteps_total": 62898, "episode_len_mean": 700.0, "episodes_total": 27, "time_total_s": 49.84675455093384, "episode_reward_mean": 480.00299670183824, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 49.84675455093384, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5c4080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5c42e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5c43c8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 1, "date": "2019-05-20_04-34-15", "timesteps_since_restore": 62898, "timesteps_this_iter": 62898, "custom_metrics": {"system_level_velocity_min": 5.926360214242747, "outflow_rate_max": 771.0171601059157, "outflow_rate_min": 523.7865153846751, "outflow_rate_mean": 594.7814849636483, "cost1_min": 151.28902208818386, "cost2_min": -49.246863312443104, "cost1_max": 233.66869764649243, "cost1_mean": 193.67504612958052, "cost2_max": -16.08689752814596, "system_level_velocity_mean": 7.492528011345945, "cost2_mean": -27.0218738858414, "system_level_velocity_max": 9.354164459874859}, "episode_reward_min": 349.1275244334055, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 2, "episodes_this_iter": 28, "timestamp": 1558326902, "episode_reward_max": 719.0383775425954, "info": {"load_time_ms": 30.6, "default": {"vf_loss": 1.822311520576477, "entropy": 1.4023346900939941, "total_loss": 1.82050359249115, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.002481482457369566, "vf_explained_var": 0.8987536430358887, "cur_lr": 0.0005000000237487257, "kl": 0.0067369588650763035}, "num_steps_trained": 128335, "grad_time_ms": 15042.379, "num_steps_sampled": 128335, "sample_time_ms": 32957.006, "update_time_ms": 277.587}, "time_since_restore": 96.87352347373962, "timesteps_total": 128335, "episode_len_mean": 688.2, "episodes_total": 55, "time_total_s": 96.87352347373962, "episode_reward_mean": 495.11311055510686, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.026768922805786, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ceb70>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 2, "date": "2019-05-20_04-35-02", "timesteps_since_restore": 128335, "timesteps_this_iter": 65437, "custom_metrics": {"system_level_velocity_min": 5.926360214242747, "outflow_rate_max": 771.0171601059157, "outflow_rate_min": 523.7865153846751, "outflow_rate_mean": 598.1132083540036, "cost1_min": 31.592879837249345, "cost2_min": -49.246863312443104, "cost1_max": 233.6756018294196, "cost1_mean": 190.8959830417999, "cost2_max": -10.860179097425508, "system_level_velocity_mean": 7.672941402188155, "cost2_mean": -26.710711644044505, "system_level_velocity_max": 17.408714967711756}, "episode_reward_min": 80.77215516292071, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 3, "episodes_this_iter": 28, "timestamp": 1558326945, "episode_reward_max": 719.0383775425954, "info": {"load_time_ms": 23.086, "default": {"vf_loss": 2.985306739807129, "entropy": 1.3948850631713867, "total_loss": 2.977851152420044, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.009056629613041878, "vf_explained_var": 0.8807948231697083, "cur_lr": 0.0005000000237487257, "kl": 0.01601109653711319}, "num_steps_trained": 186931, "grad_time_ms": 14844.174, "num_steps_sampled": 186931, "sample_time_ms": 31535.326, "update_time_ms": 187.764}, "time_since_restore": 140.12438249588013, "timesteps_total": 186931, "episode_len_mean": 692.1807228915662, "episodes_total": 83, "time_total_s": 140.12438249588013, "episode_reward_mean": 512.3542606996872, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.2508590221405, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558358>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 3, "date": "2019-05-20_04-35-45", "timesteps_since_restore": 186931, "timesteps_this_iter": 58596, "custom_metrics": {"system_level_velocity_min": 4.083742840636857, "outflow_rate_max": 771.0171601059157, "outflow_rate_min": 453.56946709117386, "outflow_rate_mean": 606.6425830477023, "cost1_min": 31.592879837249345, "cost2_min": -49.246863312443104, "cost1_max": 241.23400109830186, "cost1_mean": 195.65638794479588, "cost2_max": -10.860179097425508, "system_level_velocity_mean": 7.758230999676713, "cost2_mean": -25.897532583019974, "system_level_velocity_max": 17.408714967711756}, "episode_reward_min": 80.77215516292071, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 4, "episodes_this_iter": 28, "timestamp": 1558326988, "episode_reward_max": 878.05372874368, "info": {"load_time_ms": 19.054, "default": {"vf_loss": 7.76160192489624, "entropy": 1.3907322883605957, "total_loss": 7.755699634552002, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00825059600174427, "vf_explained_var": 0.7532712817192078, "cur_lr": 0.0005000000237487257, "kl": 0.0234869122505188}, "num_steps_trained": 241792, "grad_time_ms": 14575.593, "num_steps_sampled": 241792, "sample_time_ms": 30865.12, "update_time_ms": 142.498}, "time_since_restore": 182.85792446136475, "timesteps_total": 241792, "episode_len_mean": 693.51, "episodes_total": 111, "time_total_s": 182.85792446136475, "episode_reward_mean": 575.5933731673534, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.73354196548462, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce320>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 4, "date": "2019-05-20_04-36-28", "timesteps_since_restore": 241792, "timesteps_this_iter": 54861, "custom_metrics": {"system_level_velocity_min": 4.083742840636857, "outflow_rate_max": 884.109882881176, "outflow_rate_min": 453.56946709117386, "outflow_rate_mean": 643.2798430945282, "cost1_min": 31.592879837249345, "cost2_min": -49.246863312443104, "cost1_max": 279.9285597075001, "cost1_mean": 212.38514517978933, "cost2_max": -10.860179097425508, "system_level_velocity_mean": 8.35748546634053, "cost2_mean": -26.61724569188028, "system_level_velocity_max": 17.408714967711756}, "episode_reward_min": 80.77215516292071, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 5, "episodes_this_iter": 27, "timestamp": 1558327036, "episode_reward_max": 1100.4329371205838, "info": {"load_time_ms": 16.958, "default": {"vf_loss": 10.22952938079834, "entropy": 1.399856686592102, "total_loss": 10.226760864257812, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00416478980332613, "vf_explained_var": 0.7643750905990601, "cur_lr": 0.0005000000237487257, "kl": 0.009303410537540913}, "num_steps_trained": 302120, "grad_time_ms": 14784.527, "num_steps_sampled": 302120, "sample_time_ms": 31029.479, "update_time_ms": 116.099}, "time_since_restore": 230.3114984035492, "timesteps_total": 302120, "episode_len_mean": 700.0, "episodes_total": 138, "time_total_s": 230.3114984035492, "episode_reward_mean": 703.8875662290914, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.45357394218445, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5cef60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ce6a0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 5, "date": "2019-05-20_04-37-16", "timesteps_since_restore": 302120, "timesteps_this_iter": 60328, "custom_metrics": {"system_level_velocity_min": 4.083742840636857, "outflow_rate_max": 952.7223328224437, "outflow_rate_min": 453.56946709117386, "outflow_rate_mean": 704.6100829338933, "cost1_min": 106.0181100542064, "cost2_min": -55.8894850631941, "cost1_max": 312.8215921001912, "cost1_mean": 236.81525396472773, "cost2_max": -14.919477490363999, "system_level_velocity_mean": 9.08071256070043, "cost2_mean": -29.849580093912085, "system_level_velocity_max": 11.633795124253997}, "episode_reward_min": 356.60223703965005, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 6, "episodes_this_iter": 26, "timestamp": 1558327087, "episode_reward_max": 1176.800800018716, "info": {"load_time_ms": 15.716, "default": {"vf_loss": 9.330743789672852, "entropy": 1.3851584196090698, "total_loss": 9.328947067260742, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.0027327537536621094, "vf_explained_var": 0.8403525948524475, "cur_lr": 0.0005000000237487257, "kl": 0.006236820947378874}, "num_steps_trained": 368734, "grad_time_ms": 15171.675, "num_steps_sampled": 368734, "sample_time_ms": 31548.454, "update_time_ms": 98.018}, "time_since_restore": 281.70555686950684, "timesteps_total": 368734, "episode_len_mean": 700.0, "episodes_total": 164, "time_total_s": 281.70555686950684, "episode_reward_mean": 839.2746426630989, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 51.39405846595764, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560dd8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 6, "date": "2019-05-20_04-38-07", "timesteps_since_restore": 368734, "timesteps_this_iter": 66614, "custom_metrics": {"system_level_velocity_min": 4.083742840636857, "outflow_rate_max": 952.7223328224437, "outflow_rate_min": 453.56946709117386, "outflow_rate_mean": 776.7174435461621, "cost1_min": 106.0181100542064, "cost2_min": -55.8894850631941, "cost1_max": 321.6715578243758, "cost1_mean": 257.75809668002296, "cost2_max": -17.95117586816208, "system_level_velocity_mean": 9.816540330703683, "cost2_mean": -34.97118949058287, "system_level_velocity_max": 12.167184370924538}, "episode_reward_min": 435.41162189768886, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 7, "episodes_this_iter": 26, "timestamp": 1558327141, "episode_reward_max": 1253.6260266040163, "info": {"load_time_ms": 14.782, "default": {"vf_loss": 11.1538724899292, "entropy": 1.3925012350082397, "total_loss": 11.151341438293457, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.00351841002702713, "vf_explained_var": 0.8578606843948364, "cur_lr": 0.0005000000237487257, "kl": 0.00658000074326992}, "num_steps_trained": 439230, "grad_time_ms": 15815.346, "num_steps_sampled": 439230, "sample_time_ms": 31891.721, "update_time_ms": 85.143}, "time_since_restore": 335.4709138870239, "timesteps_total": 439230, "episode_len_mean": 700.0, "episodes_total": 190, "time_total_s": 335.4709138870239, "episode_reward_mean": 960.7780051069146, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 53.76535701751709, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558518>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 7, "date": "2019-05-20_04-39-01", "timesteps_since_restore": 439230, "timesteps_this_iter": 70496, "custom_metrics": {"system_level_velocity_min": 6.705932369922427, "outflow_rate_max": 1023.0292474077999, "outflow_rate_min": 649.0589134671379, "outflow_rate_mean": 840.1422096957781, "cost1_min": 174.61759607839298, "cost2_min": -65.62387705670773, "cost1_max": 324.5339950412848, "cost1_mean": 271.8939201195459, "cost2_max": -21.803631020934702, "system_level_velocity_mean": 10.299058405291527, "cost2_mean": -40.8559750834414, "system_level_velocity_max": 12.19356015943642}, "episode_reward_min": 596.8636564159608, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 8, "episodes_this_iter": 26, "timestamp": 1558327193, "episode_reward_max": 1294.4064464827172, "info": {"load_time_ms": 14.075, "default": {"vf_loss": 13.109554290771484, "entropy": 1.385279893875122, "total_loss": 13.106962203979492, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.003735082922503352, "vf_explained_var": 0.8630139231681824, "cur_lr": 0.0005000000237487257, "kl": 0.007616150192916393}, "num_steps_trained": 505285, "grad_time_ms": 16376.189, "num_steps_sampled": 505285, "sample_time_ms": 31912.002, "update_time_ms": 75.963}, "time_since_restore": 387.9497232437134, "timesteps_total": 505285, "episode_len_mean": 700.0, "episodes_total": 216, "time_total_s": 387.9497232437134, "episode_reward_mean": 1049.170952288127, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 52.47880935668945, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558828>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 8, "date": "2019-05-20_04-39-53", "timesteps_since_restore": 505285, "timesteps_this_iter": 66055, "custom_metrics": {"system_level_velocity_min": 6.705932369922427, "outflow_rate_max": 1043.3029544473143, "outflow_rate_min": 710.6163945027653, "outflow_rate_mean": 890.2885898099023, "cost1_min": 174.61759607839298, "cost2_min": -68.40329593215486, "cost1_max": 357.95278819092147, "cost1_mean": 281.509117037722, "cost2_max": -27.061897619392965, "system_level_velocity_mean": 10.609466137267582, "cost2_mean": -45.56322788817462, "system_level_velocity_max": 13.461694557450082}, "episode_reward_min": 856.6590633281321, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 9, "episodes_this_iter": 29, "timestamp": 1558327246, "episode_reward_max": 1382.8628439745714, "info": {"load_time_ms": 13.199, "default": {"vf_loss": 16.95558738708496, "entropy": 1.371134877204895, "total_loss": 16.952672958374023, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.004088913556188345, "vf_explained_var": 0.8367019295692444, "cur_lr": 0.0005000000237487257, "kl": 0.007826918736100197}, "num_steps_trained": 571254, "grad_time_ms": 16538.414, "num_steps_sampled": 571254, "sample_time_ms": 32177.587, "update_time_ms": 68.397}, "time_since_restore": 440.22464871406555, "timesteps_total": 571254, "episode_len_mean": 700.0, "episodes_total": 245, "time_total_s": 440.22464871406555, "episode_reward_mean": 1098.0450692948946, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 52.27492547035217, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5605f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5607b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5608d0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 9, "date": "2019-05-20_04-40-46", "timesteps_since_restore": 571254, "timesteps_this_iter": 65969, "custom_metrics": {"system_level_velocity_min": 6.705932369922427, "outflow_rate_max": 1045.1339359521253, "outflow_rate_min": 710.6163945027653, "outflow_rate_mean": 926.9116631894025, "cost1_min": 174.61759607839298, "cost2_min": -68.40329593215486, "cost1_max": 358.0560801047674, "cost1_mean": 289.61580348959615, "cost2_max": -31.32968193000043, "system_level_velocity_mean": 10.890358853387582, "cost2_mean": -48.18469847980466, "system_level_velocity_max": 13.461694557450082}, "episode_reward_min": 867.8456980789832, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 10, "episodes_this_iter": 32, "timestamp": 1558327297, "episode_reward_max": 1382.8628439745714, "info": {"load_time_ms": 12.723, "default": {"vf_loss": 19.83994483947754, "entropy": 1.363156795501709, "total_loss": 19.83584213256836, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005606019403785467, "vf_explained_var": 0.8159784078598022, "cur_lr": 0.0005000000237487257, "kl": 0.010035406798124313}, "num_steps_trained": 635639, "grad_time_ms": 16645.505, "num_steps_sampled": 635639, "sample_time_ms": 32333.7, "update_time_ms": 62.557}, "time_since_restore": 491.70706057548523, "timesteps_total": 635639, "episode_len_mean": 700.0, "episodes_total": 277, "time_total_s": 491.70706057548523, "episode_reward_mean": 1126.3090943617121, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 51.48241186141968, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f28>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 10, "date": "2019-05-20_04-41-37", "timesteps_since_restore": 635639, "timesteps_this_iter": 64385, "custom_metrics": {"system_level_velocity_min": 8.399681432822318, "outflow_rate_max": 1085.562781719992, "outflow_rate_min": 776.2799360434833, "outflow_rate_mean": 956.6549024221712, "cost1_min": 216.88937395692938, "cost2_min": -68.40329593215486, "cost1_max": 381.49376959663414, "cost1_mean": 301.94784408275285, "cost2_max": -34.19782813885552, "system_level_velocity_mean": 11.341116945664139, "cost2_mean": -48.50033501772906, "system_level_velocity_max": 14.32683818214892}, "episode_reward_min": 888.2116075029066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 11, "episodes_this_iter": 33, "timestamp": 1558327345, "episode_reward_max": 1382.8628439745714, "info": {"load_time_ms": 8.175, "default": {"vf_loss": 22.479825973510742, "entropy": 1.3517638444900513, "total_loss": 22.475669860839844, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005628205370157957, "vf_explained_var": 0.7921575307846069, "cur_lr": 0.0005000000237487257, "kl": 0.009821985848248005}, "num_steps_trained": 695576, "grad_time_ms": 16833.877, "num_steps_sampled": 695576, "sample_time_ms": 32021.991, "update_time_ms": 8.522}, "time_since_restore": 539.6972575187683, "timesteps_total": 695576, "episode_len_mean": 700.0, "episodes_total": 310, "time_total_s": 539.6972575187683, "episode_reward_mean": 1140.3789204628117, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.99019694328308, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c9e8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 11, "date": "2019-05-20_04-42-25", "timesteps_since_restore": 695576, "timesteps_this_iter": 59937, "custom_metrics": {"system_level_velocity_min": 9.060145705283404, "outflow_rate_max": 1085.562781719992, "outflow_rate_min": 800.7454187736002, "outflow_rate_mean": 973.0061443379087, "cost1_min": 236.88065266646493, "cost2_min": -73.32795702087984, "cost1_max": 381.49376959663414, "cost1_mean": 313.7790625504565, "cost2_max": -29.328460341237268, "system_level_velocity_mean": 11.785613537610768, "cost2_mean": -47.4954840896222, "system_level_velocity_max": 14.32683818214892}, "episode_reward_min": 888.2116075029066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 12, "episodes_this_iter": 30, "timestamp": 1558327396, "episode_reward_max": 1378.5000526496574, "info": {"load_time_ms": 8.148, "default": {"vf_loss": 21.58150863647461, "entropy": 1.3506803512573242, "total_loss": 21.576387405395508, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.006757305469363928, "vf_explained_var": 0.8133929371833801, "cur_lr": 0.0005000000237487257, "kl": 0.010921062901616096}, "num_steps_trained": 758920, "grad_time_ms": 16965.929, "num_steps_sampled": 758920, "sample_time_ms": 32214.156, "update_time_ms": 8.501}, "time_since_restore": 589.963873386383, "timesteps_total": 758920, "episode_len_mean": 700.0, "episodes_total": 340, "time_total_s": 589.963873386383, "episode_reward_mean": 1159.8620087342701, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 50.266615867614746, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6160>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 12, "date": "2019-05-20_04-43-16", "timesteps_since_restore": 758920, "timesteps_this_iter": 63344, "custom_metrics": {"system_level_velocity_min": 9.326368939901094, "outflow_rate_max": 1110.391453210591, "outflow_rate_min": 813.1708161324614, "outflow_rate_mean": 990.4570821344247, "cost1_min": 241.52596477425382, "cost2_min": -73.4159469352216, "cost1_max": 381.49376959663414, "cost1_mean": 321.1894084629805, "cost2_max": -29.328460341237268, "system_level_velocity_mean": 12.056163252563527, "cost2_mean": -48.928001913511835, "system_level_velocity_max": 14.32683818214892}, "episode_reward_min": 888.2116075029066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 13, "episodes_this_iter": 28, "timestamp": 1558327445, "episode_reward_max": 1378.5000526496574, "info": {"load_time_ms": 8.178, "default": {"vf_loss": 22.386743545532227, "entropy": 1.361376166343689, "total_loss": 22.38242530822754, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005648086313158274, "vf_explained_var": 0.8312690258026123, "cur_lr": 0.0005000000237487257, "kl": 0.00887051597237587}, "num_steps_trained": 825312, "grad_time_ms": 17058.935, "num_steps_sampled": 825312, "sample_time_ms": 32729.127, "update_time_ms": 8.501}, "time_since_restore": 639.3038311004639, "timesteps_total": 825312, "episode_len_mean": 700.0, "episodes_total": 368, "time_total_s": 639.3038311004639, "episode_reward_mean": 1164.7174236532028, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 49.33995771408081, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5605f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560cf8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 13, "date": "2019-05-20_04-44-05", "timesteps_since_restore": 825312, "timesteps_this_iter": 66392, "custom_metrics": {"system_level_velocity_min": 6.014236309253361, "outflow_rate_max": 1118.397048851388, "outflow_rate_min": 610.2729564324756, "outflow_rate_mean": 988.8388078653879, "cost1_min": 156.40665465290442, "cost2_min": -73.4159469352216, "cost1_max": 388.27358765873083, "cost1_mean": 319.9841968064604, "cost2_max": -29.328460341237268, "system_level_velocity_mean": 12.020255503144075, "cost2_mean": -49.9231269388672, "system_level_velocity_max": 14.649023127903467}, "episode_reward_min": 893.5822929161304, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 14, "episodes_this_iter": 28, "timestamp": 1558327493, "episode_reward_max": 1378.5000526496574, "info": {"load_time_ms": 8.307, "default": {"vf_loss": 21.982385635375977, "entropy": 1.364326000213623, "total_loss": 21.977617263793945, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.006230875384062529, "vf_explained_var": 0.8532387018203735, "cur_lr": 0.0005000000237487257, "kl": 0.009745270945131779}, "num_steps_trained": 888669, "grad_time_ms": 17403.739, "num_steps_sampled": 888669, "sample_time_ms": 32901.206, "update_time_ms": 8.577}, "time_since_restore": 687.2200262546539, "timesteps_total": 888669, "episode_len_mean": 693.4, "episodes_total": 396, "time_total_s": 687.2200262546539, "episode_reward_mean": 1160.869657312224, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.91619515419006, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c9e8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 14, "date": "2019-05-20_04-44-53", "timesteps_since_restore": 888669, "timesteps_this_iter": 63357, "custom_metrics": {"system_level_velocity_min": 6.014236309253361, "outflow_rate_max": 1118.397048851388, "outflow_rate_min": 522.7570459126879, "outflow_rate_mean": 994.2677092863951, "cost1_min": 25.758810815717375, "cost2_min": -73.4159469352216, "cost1_max": 392.3515212249773, "cost1_mean": 320.6929711916, "cost2_max": -11.796530618613254, "system_level_velocity_mean": 12.21775130221156, "cost2_mean": -50.03162340297626, "system_level_velocity_max": 17.465372410336954}, "episode_reward_min": 60.29618297860302, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 15, "episodes_this_iter": 27, "timestamp": 1558327538, "episode_reward_max": 1378.5000526496574, "info": {"load_time_ms": 8.269, "default": {"vf_loss": 25.546201705932617, "entropy": 1.358508586883545, "total_loss": 25.54106903076172, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.006902792491018772, "vf_explained_var": 0.8288674354553223, "cur_lr": 0.0005000000237487257, "kl": 0.011808682233095169}, "num_steps_trained": 950335, "grad_time_ms": 17509.257, "num_steps_sampled": 950335, "sample_time_ms": 32541.645, "update_time_ms": 8.37}, "time_since_restore": 732.1460993289948, "timesteps_total": 950335, "episode_len_mean": 693.4, "episodes_total": 423, "time_total_s": 732.1460993289948, "episode_reward_mean": 1158.7535744731265, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.92607307434082, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558ef0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 15, "date": "2019-05-20_04-45-38", "timesteps_since_restore": 950335, "timesteps_this_iter": 61666, "custom_metrics": {"system_level_velocity_min": 6.014236309253361, "outflow_rate_max": 1118.397048851388, "outflow_rate_min": 522.7570459126879, "outflow_rate_mean": 1002.1560029837685, "cost1_min": 25.758810815717375, "cost2_min": -69.72636401860777, "cost1_max": 392.3515212249773, "cost1_mean": 324.63090415113317, "cost2_max": -11.796530618613254, "system_level_velocity_mean": 12.385860891812268, "cost2_mean": -48.952578196874086, "system_level_velocity_max": 17.465372410336954}, "episode_reward_min": 60.29618297860302, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 16, "episodes_this_iter": 27, "timestamp": 1558327584, "episode_reward_max": 1367.67634486447, "info": {"load_time_ms": 8.238, "default": {"vf_loss": 27.160160064697266, "entropy": 1.35911226272583, "total_loss": 27.154823303222656, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.007004092913120985, "vf_explained_var": 0.8000252842903137, "cur_lr": 0.0005000000237487257, "kl": 0.01110842265188694}, "num_steps_trained": 1009849, "grad_time_ms": 17471.4, "num_steps_sampled": 1009849, "sample_time_ms": 32053.993, "update_time_ms": 8.389}, "time_since_restore": 778.2721831798553, "timesteps_total": 1009849, "episode_len_mean": 693.4, "episodes_total": 450, "time_total_s": 778.2721831798553, "episode_reward_mean": 1155.7957982280216, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.126083850860596, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558080>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 16, "date": "2019-05-20_04-46-24", "timesteps_since_restore": 1009849, "timesteps_this_iter": 59514, "custom_metrics": {"system_level_velocity_min": 6.014236309253361, "outflow_rate_max": 1118.397048851388, "outflow_rate_min": 522.7570459126879, "outflow_rate_mean": 1003.1382573739351, "cost1_min": 25.758810815717375, "cost2_min": -67.81998400833939, "cost1_max": 392.3515212249773, "cost1_mean": 328.83751332852125, "cost2_max": -11.796530618613254, "system_level_velocity_mean": 12.568507788458815, "cost2_mean": -47.06255962402416, "system_level_velocity_max": 17.465372410336954}, "episode_reward_min": 60.29618297860302, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 17, "episodes_this_iter": 26, "timestamp": 1558327636, "episode_reward_max": 1369.0223367689007, "info": {"load_time_ms": 8.225, "default": {"vf_loss": 24.757225036621094, "entropy": 1.365862250328064, "total_loss": 24.75241470336914, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.0065435925498604774, "vf_explained_var": 0.8161745071411133, "cur_lr": 0.0005000000237487257, "kl": 0.011555272154510021}, "num_steps_trained": 1074272, "grad_time_ms": 17310.202, "num_steps_sampled": 1074272, "sample_time_ms": 31993.366, "update_time_ms": 8.569}, "time_since_restore": 829.8189647197723, "timesteps_total": 1074272, "episode_len_mean": 700.0, "episodes_total": 476, "time_total_s": 829.8189647197723, "episode_reward_mean": 1182.482076330931, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 51.54678153991699, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560cf8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 17, "date": "2019-05-20_04-47-16", "timesteps_since_restore": 1074272, "timesteps_this_iter": 64423, "custom_metrics": {"system_level_velocity_min": 6.257195080254052, "outflow_rate_max": 1134.7264303322183, "outflow_rate_min": 623.9508118823783, "outflow_rate_mean": 1018.8264431994426, "cost1_min": 161.16961190673908, "cost2_min": -76.97734397887146, "cost1_max": 393.82388833936204, "cost1_mean": 336.40486684642326, "cost2_max": -26.43922386782875, "system_level_velocity_mean": 12.705202575039817, "cost2_mean": -47.80542363728455, "system_level_velocity_max": 14.909222404672265}, "episode_reward_min": 844.8896470517769, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 18, "episodes_this_iter": 28, "timestamp": 1558327687, "episode_reward_max": 1369.0223367689007, "info": {"load_time_ms": 8.307, "default": {"vf_loss": 24.141141891479492, "entropy": 1.3645890951156616, "total_loss": 24.134862899780273, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008344265632331371, "vf_explained_var": 0.8184699416160583, "cur_lr": 0.0005000000237487257, "kl": 0.01376429945230484}, "num_steps_trained": 1139781, "grad_time_ms": 17120.6, "num_steps_sampled": 1139781, "sample_time_ms": 32048.095, "update_time_ms": 8.12}, "time_since_restore": 880.9559733867645, "timesteps_total": 1139781, "episode_len_mean": 700.0, "episodes_total": 504, "time_total_s": 880.9559733867645, "episode_reward_mean": 1176.9203316749358, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 51.13700866699219, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5aeb00>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 18, "date": "2019-05-20_04-48-07", "timesteps_since_restore": 1139781, "timesteps_this_iter": 65509, "custom_metrics": {"system_level_velocity_min": 6.257195080254052, "outflow_rate_max": 1134.7264303322183, "outflow_rate_min": 623.9508118823783, "outflow_rate_mean": 1013.9484772177365, "cost1_min": 161.16961190673908, "cost2_min": -80.58575820704837, "cost1_max": 393.82388833936204, "cost1_mean": 329.52629018110105, "cost2_max": -30.489032387830008, "system_level_velocity_mean": 12.446978105144074, "cost2_mean": -51.3802700931698, "system_level_velocity_max": 14.909222404672265}, "episode_reward_min": 844.8896470517769, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 19, "episodes_this_iter": 30, "timestamp": 1558327739, "episode_reward_max": 1369.0223367689007, "info": {"load_time_ms": 8.493, "default": {"vf_loss": 27.865798950195312, "entropy": 1.3661019802093506, "total_loss": 27.86001205444336, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.007533544674515724, "vf_explained_var": 0.7859370112419128, "cur_lr": 0.0005000000237487257, "kl": 0.011645053513348103}, "num_steps_trained": 1203168, "grad_time_ms": 17171.677, "num_steps_sampled": 1203168, "sample_time_ms": 31984.692, "update_time_ms": 8.306}, "time_since_restore": 933.1197464466095, "timesteps_total": 1203168, "episode_len_mean": 700.0, "episodes_total": 534, "time_total_s": 933.1197464466095, "episode_reward_mean": 1190.8380566403307, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 52.16377305984497, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ceb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c6a0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 19, "date": "2019-05-20_04-48-59", "timesteps_since_restore": 1203168, "timesteps_this_iter": 63387, "custom_metrics": {"system_level_velocity_min": 6.257195080254052, "outflow_rate_max": 1147.8489489499866, "outflow_rate_min": 623.9508118823783, "outflow_rate_mean": 1022.9402052390594, "cost1_min": 163.6159267631545, "cost2_min": -80.58575820704837, "cost1_max": 399.61218362965263, "cost1_mean": 329.1259985080171, "cost2_max": -35.72070432454247, "system_level_velocity_mean": 12.426426135229184, "cost2_mean": -55.788199091731734, "system_level_velocity_max": 15.086393639281859}, "episode_reward_min": 844.8896470517769, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 20, "episodes_this_iter": 29, "timestamp": 1558327786, "episode_reward_max": 1369.0223367689007, "info": {"load_time_ms": 8.469, "default": {"vf_loss": 30.7945556640625, "entropy": 1.3588000535964966, "total_loss": 30.78814125061035, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.008540283888578415, "vf_explained_var": 0.7706113457679749, "cur_lr": 0.0005000000237487257, "kl": 0.0141620934009552}, "num_steps_trained": 1264516, "grad_time_ms": 17171.537, "num_steps_sampled": 1264516, "sample_time_ms": 31496.784, "update_time_ms": 8.253}, "time_since_restore": 979.7090840339661, "timesteps_total": 1264516, "episode_len_mean": 700.0, "episodes_total": 563, "time_total_s": 979.7090840339661, "episode_reward_mean": 1196.8746084710867, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.58933758735657, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ce10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c438>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 20, "date": "2019-05-20_04-49-46", "timesteps_since_restore": 1264516, "timesteps_this_iter": 61348, "custom_metrics": {"system_level_velocity_min": 7.597339262205121, "outflow_rate_max": 1147.8489489499866, "outflow_rate_min": 792.179791945691, "outflow_rate_mean": 1031.525359397216, "cost1_min": 200.47112087364386, "cost2_min": -80.58575820704837, "cost1_max": 403.7993933616707, "cost1_mean": 331.2977303495999, "cost2_max": -32.632412623344116, "system_level_velocity_mean": 12.503933601799087, "cost2_mean": -58.586176228948, "system_level_velocity_max": 15.3092248914565}, "episode_reward_min": 954.5483851853438, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 21, "episodes_this_iter": 31, "timestamp": 1558327835, "episode_reward_max": 1343.672327143233, "info": {"load_time_ms": 8.3, "default": {"vf_loss": 30.740697860717773, "entropy": 1.3542864322662354, "total_loss": 30.734516143798828, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008346565067768097, "vf_explained_var": 0.7825052738189697, "cur_lr": 0.0005000000237487257, "kl": 0.014418736100196838}, "num_steps_trained": 1326874, "grad_time_ms": 17165.876, "num_steps_sampled": 1326874, "sample_time_ms": 31643.364, "update_time_ms": 8.483}, "time_since_restore": 1029.100121974945, "timesteps_total": 1326874, "episode_len_mean": 700.0, "episodes_total": 594, "time_total_s": 1029.100121974945, "episode_reward_mean": 1207.4807816253535, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 49.391037940979004, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5587b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f60>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 21, "date": "2019-05-20_04-50-35", "timesteps_since_restore": 1326874, "timesteps_this_iter": 62358, "custom_metrics": {"system_level_velocity_min": 7.887760632541582, "outflow_rate_max": 1163.3975550477808, "outflow_rate_min": 815.7326301765333, "outflow_rate_mean": 1039.0813843751916, "cost1_min": 207.78241958052666, "cost2_min": -80.25572826678929, "cost1_max": 403.7993933616707, "cost1_mean": 337.74073050556194, "cost2_max": -32.632412623344116, "system_level_velocity_mean": 12.74599764111474, "cost2_mean": -57.6869350101078, "system_level_velocity_max": 15.3092248914565}, "episode_reward_min": 1012.9621434022786, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 22, "episodes_this_iter": 33, "timestamp": 1558327880, "episode_reward_max": 1343.672327143233, "info": {"load_time_ms": 8.572, "default": {"vf_loss": 35.30144119262695, "entropy": 1.3438037633895874, "total_loss": 35.294525146484375, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.00910776387900114, "vf_explained_var": 0.7577951550483704, "cur_lr": 0.0005000000237487257, "kl": 0.014650526456534863}, "num_steps_trained": 1385034, "grad_time_ms": 17187.8, "num_steps_sampled": 1385034, "sample_time_ms": 31100.36, "update_time_ms": 8.411}, "time_since_restore": 1074.1542122364044, "timesteps_total": 1385034, "episode_len_mean": 700.0, "episodes_total": 627, "time_total_s": 1074.1542122364044, "episode_reward_mean": 1204.1135087833522, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.05409026145935, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560278>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 22, "date": "2019-05-20_04-51-20", "timesteps_since_restore": 1385034, "timesteps_this_iter": 58160, "custom_metrics": {"system_level_velocity_min": 7.887760632541582, "outflow_rate_max": 1163.3975550477808, "outflow_rate_min": 815.7326301765333, "outflow_rate_mean": 1039.5550122215695, "cost1_min": 207.78241958052666, "cost2_min": -79.31284793573005, "cost1_max": 403.7993933616707, "cost1_mean": 342.28006313794765, "cost2_max": -30.44523772160516, "system_level_velocity_mean": 12.925816254500221, "cost2_mean": -54.06418857418573, "system_level_velocity_max": 15.3092248914565}, "episode_reward_min": 980.8913889362558, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 23, "episodes_this_iter": 27, "timestamp": 1558327926, "episode_reward_max": 1375.8565546973596, "info": {"load_time_ms": 8.632, "default": {"vf_loss": 32.29512405395508, "entropy": 1.336745262145996, "total_loss": 32.288597106933594, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.008489270694553852, "vf_explained_var": 0.7731979489326477, "cur_lr": 0.0005000000237487257, "kl": 0.01305050402879715}, "num_steps_trained": 1443981, "grad_time_ms": 17177.684, "num_steps_sampled": 1443981, "sample_time_ms": 30781.137, "update_time_ms": 8.389}, "time_since_restore": 1120.1941771507263, "timesteps_total": 1443981, "episode_len_mean": 700.0, "episodes_total": 654, "time_total_s": 1120.1941771507263, "episode_reward_mean": 1210.6452562573566, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.0399649143219, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ccf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c6a0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 23, "date": "2019-05-20_04-52-06", "timesteps_since_restore": 1443981, "timesteps_this_iter": 58947, "custom_metrics": {"system_level_velocity_min": 8.717697811768758, "outflow_rate_max": 1163.3975550477808, "outflow_rate_min": 853.896666148549, "outflow_rate_mean": 1045.8106943930986, "cost1_min": 229.3606314974254, "cost2_min": -79.31284793573005, "cost1_max": 405.4686970720204, "cost1_mean": 348.5274128323773, "cost2_max": -25.25058812950261, "system_level_velocity_mean": 13.152039861242876, "cost2_mean": -50.89070218394346, "system_level_velocity_max": 15.308500412359574}, "episode_reward_min": 980.8913889362558, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 24, "episodes_this_iter": 30, "timestamp": 1558327976, "episode_reward_max": 1389.0881161628906, "info": {"load_time_ms": 8.684, "default": {"vf_loss": 32.79637908935547, "entropy": 1.3550324440002441, "total_loss": 32.79019546508789, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008439190685749054, "vf_explained_var": 0.7814826369285583, "cur_lr": 0.0005000000237487257, "kl": 0.015039266087114811}, "num_steps_trained": 1506698, "grad_time_ms": 17050.151, "num_steps_sampled": 1506698, "sample_time_ms": 31088.464, "update_time_ms": 8.363}, "time_since_restore": 1169.9305231571198, "timesteps_total": 1506698, "episode_len_mean": 693.28, "episodes_total": 684, "time_total_s": 1169.9305231571198, "episode_reward_mean": 1195.102668657913, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 49.73634600639343, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558898>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 24, "date": "2019-05-20_04-52-56", "timesteps_since_restore": 1506698, "timesteps_this_iter": 62717, "custom_metrics": {"system_level_velocity_min": 8.717697811768758, "outflow_rate_max": 1157.197159147846, "outflow_rate_min": 493.7011947654558, "outflow_rate_mean": 1039.431164047177, "cost1_min": 18.500436146350943, "cost2_min": -79.1038337583255, "cost1_max": 405.4686970720204, "cost1_mean": 344.98335283783445, "cost2_max": -11.666671300956281, "system_level_velocity_mean": 13.18831727323334, "cost2_mean": -50.824327786111056, "system_level_velocity_max": 17.941655603727668}, "episode_reward_min": 42.29103071625896, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 25, "episodes_this_iter": 29, "timestamp": 1558328027, "episode_reward_max": 1389.0881161628906, "info": {"load_time_ms": 8.667, "default": {"vf_loss": 33.06370162963867, "entropy": 1.344398856163025, "total_loss": 33.05757522583008, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00832037441432476, "vf_explained_var": 0.7615270018577576, "cur_lr": 0.0005000000237487257, "kl": 0.014646828174591064}, "num_steps_trained": 1571167, "grad_time_ms": 17187.566, "num_steps_sampled": 1571167, "sample_time_ms": 31509.704, "update_time_ms": 8.391}, "time_since_restore": 1220.4111721515656, "timesteps_total": 1571167, "episode_len_mean": 686.57, "episodes_total": 713, "time_total_s": 1220.4111721515656, "episode_reward_mean": 1181.7627338140367, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 50.4806489944458, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5585c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560dd8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 25, "date": "2019-05-20_04-53-47", "timesteps_since_restore": 1571167, "timesteps_this_iter": 64469, "custom_metrics": {"system_level_velocity_min": 8.717697811768758, "outflow_rate_max": 1157.197159147846, "outflow_rate_min": 491.75005665836557, "outflow_rate_mean": 1027.2236080049734, "cost1_min": 18.500436146350943, "cost2_min": -79.1038337583255, "cost1_max": 408.0086240349451, "cost1_mean": 335.40195984704746, "cost2_max": -10.248315390267935, "system_level_velocity_mean": 13.019244947012398, "cost2_mean": -51.808658722402804, "system_level_velocity_max": 17.941655603727668}, "episode_reward_min": 42.29103071625896, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 26, "episodes_this_iter": 27, "timestamp": 1558328076, "episode_reward_max": 1389.0881161628906, "info": {"load_time_ms": 8.559, "default": {"vf_loss": 29.597129821777344, "entropy": 1.347579836845398, "total_loss": 29.589757919311523, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00981044489890337, "vf_explained_var": 0.7929248809814453, "cur_lr": 0.0005000000237487257, "kl": 0.016256580129265785}, "num_steps_trained": 1636592, "grad_time_ms": 17348.113, "num_steps_sampled": 1636592, "sample_time_ms": 31682.046, "update_time_ms": 8.354}, "time_since_restore": 1269.8863017559052, "timesteps_total": 1636592, "episode_len_mean": 686.57, "episodes_total": 740, "time_total_s": 1269.8863017559052, "episode_reward_mean": 1180.8455403970536, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 49.4751296043396, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a198>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 26, "date": "2019-05-20_04-54-36", "timesteps_since_restore": 1636592, "timesteps_this_iter": 65425, "custom_metrics": {"system_level_velocity_min": 8.717697811768758, "outflow_rate_max": 1156.8388300393317, "outflow_rate_min": 491.75005665836557, "outflow_rate_mean": 1021.8138372369804, "cost1_min": 18.500436146350943, "cost2_min": -79.1038337583255, "cost1_max": 416.98747258853905, "cost1_mean": 330.3581371646131, "cost2_max": -10.248315390267935, "system_level_velocity_mean": 12.84620675809698, "cost2_mean": -54.239660381417345, "system_level_velocity_max": 17.941655603727668}, "episode_reward_min": 42.29103071625896, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 27, "episodes_this_iter": 27, "timestamp": 1558328125, "episode_reward_max": 1372.3387751063615, "info": {"load_time_ms": 8.628, "default": {"vf_loss": 28.919374465942383, "entropy": 1.3351510763168335, "total_loss": 28.913108825683594, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00862355250865221, "vf_explained_var": 0.8029841780662537, "cur_lr": 0.0005000000237487257, "kl": 0.01572008989751339}, "num_steps_trained": 1700364, "grad_time_ms": 17431.702, "num_steps_sampled": 1700364, "sample_time_ms": 31287.407, "update_time_ms": 8.312}, "time_since_restore": 1318.3209018707275, "timesteps_total": 1700364, "episode_len_mean": 686.57, "episodes_total": 767, "time_total_s": 1318.3209018707275, "episode_reward_mean": 1174.8310923756878, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 48.43460011482239, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c588>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 27, "date": "2019-05-20_04-55-25", "timesteps_since_restore": 1700364, "timesteps_this_iter": 63772, "custom_metrics": {"system_level_velocity_min": 8.216846396631544, "outflow_rate_max": 1156.8388300393317, "outflow_rate_min": 491.75005665836557, "outflow_rate_mean": 1014.7206272965732, "cost1_min": 18.500436146350943, "cost2_min": -90.96425515483261, "cost1_max": 422.8384142407992, "cost1_mean": 326.4009108019999, "cost2_max": -10.248315390267935, "system_level_velocity_mean": 12.709107656066285, "cost2_mean": -55.626888007406315, "system_level_velocity_max": 17.941655603727668}, "episode_reward_min": 42.29103071625896, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 28, "episodes_this_iter": 29, "timestamp": 1558328170, "episode_reward_max": 1372.3387751063615, "info": {"load_time_ms": 8.493, "default": {"vf_loss": 32.85214614868164, "entropy": 1.3313844203948975, "total_loss": 32.84577178955078, "cur_kl_coeff": 0.15000000596046448, "policy_loss": -0.008504372090101242, "vf_explained_var": 0.793309211730957, "cur_lr": 0.0005000000237487257, "kl": 0.014184328727424145}, "num_steps_trained": 1762174, "grad_time_ms": 17209.171, "num_steps_sampled": 1762174, "sample_time_ms": 30909.278, "update_time_ms": 8.343}, "time_since_restore": 1363.4505581855774, "timesteps_total": 1762174, "episode_len_mean": 686.54, "episodes_total": 796, "time_total_s": 1363.4505581855774, "episode_reward_mean": 1183.2257577717035, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.12965631484985, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ad68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ae80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57aa20>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 28, "date": "2019-05-20_04-56-10", "timesteps_since_restore": 1762174, "timesteps_this_iter": 61810, "custom_metrics": {"system_level_velocity_min": 8.216846396631544, "outflow_rate_max": 1209.509713706663, "outflow_rate_min": 482.93475289541203, "outflow_rate_mean": 1022.0057131401015, "cost1_min": 16.67986936566847, "cost2_min": -90.96425515483261, "cost1_max": 435.3297259441463, "cost1_mean": 329.16740663185664, "cost2_max": -10.248315390267935, "system_level_velocity_mean": 12.817963757190842, "cost2_mean": -55.694347645875844, "system_level_velocity_max": 17.881816303169657}, "episode_reward_min": 45.69494393259066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 29, "episodes_this_iter": 29, "timestamp": 1558328216, "episode_reward_max": 1351.1103085949426, "info": {"load_time_ms": 8.524, "default": {"vf_loss": 37.3177490234375, "entropy": 1.3247406482696533, "total_loss": 37.30907440185547, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.011349847540259361, "vf_explained_var": 0.7756567001342773, "cur_lr": 0.0005000000237487257, "kl": 0.017821401357650757}, "num_steps_trained": 1821533, "grad_time_ms": 16912.568, "num_steps_sampled": 1821533, "sample_time_ms": 30585.079, "update_time_ms": 8.164}, "time_since_restore": 1409.3806657791138, "timesteps_total": 1821533, "episode_len_mean": 693.25, "episodes_total": 825, "time_total_s": 1409.3806657791138, "episode_reward_mean": 1201.4689816190132, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.93010759353638, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cb00>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 29, "date": "2019-05-20_04-56-56", "timesteps_since_restore": 1821533, "timesteps_this_iter": 59359, "custom_metrics": {"system_level_velocity_min": 8.216846396631544, "outflow_rate_max": 1209.509713706663, "outflow_rate_min": 482.93475289541203, "outflow_rate_mean": 1042.324130584785, "cost1_min": 16.67986936566847, "cost2_min": -90.96425515483261, "cost1_max": 435.3297259441463, "cost1_mean": 343.2706478387696, "cost2_max": -11.382185929379618, "system_level_velocity_mean": 13.17915034300365, "cost2_mean": -53.6454912746734, "system_level_velocity_max": 17.881816303169657}, "episode_reward_min": 45.69494393259066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 30, "episodes_this_iter": 33, "timestamp": 1558328262, "episode_reward_max": 1376.4931923435563, "info": {"load_time_ms": 8.359, "default": {"vf_loss": 44.75286865234375, "entropy": 1.3201392889022827, "total_loss": 44.745113372802734, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010314350947737694, "vf_explained_var": 0.7087528109550476, "cur_lr": 0.0005000000237487257, "kl": 0.01706036925315857}, "num_steps_trained": 1880822, "grad_time_ms": 16815.124, "num_steps_sampled": 1880822, "sample_time_ms": 30605.467, "update_time_ms": 8.108}, "time_since_restore": 1455.2014796733856, "timesteps_total": 1880822, "episode_len_mean": 686.6, "episodes_total": 858, "time_total_s": 1455.2014796733856, "episode_reward_mean": 1196.4379446773542, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.82081389427185, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5b9710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a8d0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 30, "date": "2019-05-20_04-57-42", "timesteps_since_restore": 1880822, "timesteps_this_iter": 59289, "custom_metrics": {"system_level_velocity_min": 9.699226039814592, "outflow_rate_max": 1209.509713706663, "outflow_rate_min": 482.93475289541203, "outflow_rate_mean": 1050.8392850547718, "cost1_min": 16.67986936566847, "cost2_min": -79.65769578992271, "cost1_max": 435.3297259441463, "cost1_mean": 349.1448316441123, "cost2_max": -10.984309991868745, "system_level_velocity_mean": 13.558591719132526, "cost2_mean": -51.69592392675337, "system_level_velocity_max": 17.881816303169657}, "episode_reward_min": 45.69494393259066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 31, "episodes_this_iter": 32, "timestamp": 1558328310, "episode_reward_max": 1376.4931923435563, "info": {"load_time_ms": 8.416, "default": {"vf_loss": 43.26399230957031, "entropy": 1.3237054347991943, "total_loss": 43.25651550292969, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010019779205322266, "vf_explained_var": 0.720569372177124, "cur_lr": 0.0005000000237487257, "kl": 0.0169460941106081}, "num_steps_trained": 1940303, "grad_time_ms": 16818.326, "num_steps_sampled": 1940303, "sample_time_ms": 30440.793, "update_time_ms": 8.105}, "time_since_restore": 1502.9885075092316, "timesteps_total": 1940303, "episode_len_mean": 686.6, "episodes_total": 890, "time_total_s": 1502.9885075092316, "episode_reward_mean": 1196.299914937773, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.78702783584595, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57af60>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 31, "date": "2019-05-20_04-58-30", "timesteps_since_restore": 1940303, "timesteps_this_iter": 59481, "custom_metrics": {"system_level_velocity_min": 9.699226039814592, "outflow_rate_max": 1209.509713706663, "outflow_rate_min": 482.93475289541203, "outflow_rate_mean": 1058.9846444392042, "cost1_min": 16.67986936566847, "cost2_min": -79.65769578992271, "cost1_max": 435.3297259441463, "cost1_mean": 357.2405756531474, "cost2_max": -10.984309991868745, "system_level_velocity_mean": 13.856705411283935, "cost2_mean": -49.49152081289567, "system_level_velocity_max": 17.881816303169657}, "episode_reward_min": 45.69494393259066, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 32, "episodes_this_iter": 30, "timestamp": 1558328355, "episode_reward_max": 1376.4931923435563, "info": {"load_time_ms": 8.304, "default": {"vf_loss": 41.08943176269531, "entropy": 1.319439172744751, "total_loss": 41.081912994384766, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.009949630126357079, "vf_explained_var": 0.7512204647064209, "cur_lr": 0.0005000000237487257, "kl": 0.016161886975169182}, "num_steps_trained": 1998841, "grad_time_ms": 16862.658, "num_steps_sampled": 1998841, "sample_time_ms": 30472.57, "update_time_ms": 8.308}, "time_since_restore": 1548.8007056713104, "timesteps_total": 1998841, "episode_len_mean": 693.35, "episodes_total": 920, "time_total_s": 1548.8007056713104, "episode_reward_mean": 1209.2656686767814, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.81219816207886, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ccc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca90>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 32, "date": "2019-05-20_04-59-15", "timesteps_since_restore": 1998841, "timesteps_this_iter": 58538, "custom_metrics": {"system_level_velocity_min": 9.699226039814592, "outflow_rate_max": 1186.9706304161327, "outflow_rate_min": 498.6170786658237, "outflow_rate_mean": 1065.1774694662665, "cost1_min": 23.1392472811682, "cost2_min": -81.81781983091452, "cost1_max": 434.6303579435705, "cost1_mean": 362.1871145679169, "cost2_max": -10.984309991868745, "system_level_velocity_mean": 13.875354972405864, "cost2_mean": -51.0158575057534, "system_level_velocity_max": 17.661419720445217}, "episode_reward_min": 55.717975368602055, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 33, "episodes_this_iter": 30, "timestamp": 1558328400, "episode_reward_max": 1348.9295082021802, "info": {"load_time_ms": 8.316, "default": {"vf_loss": 41.310577392578125, "entropy": 1.3213844299316406, "total_loss": 41.303646087646484, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00942851323634386, "vf_explained_var": 0.7487325072288513, "cur_lr": 0.0005000000237487257, "kl": 0.01665506884455681}, "num_steps_trained": 2058021, "grad_time_ms": 16956.785, "num_steps_sampled": 2058021, "sample_time_ms": 30254.443, "update_time_ms": 8.488}, "time_since_restore": 1593.6098036766052, "timesteps_total": 2058021, "episode_len_mean": 686.63, "episodes_total": 950, "time_total_s": 1593.6098036766052, "episode_reward_mean": 1186.0558734420547, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.8090980052948, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ba90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b4e0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 33, "date": "2019-05-20_05-00-00", "timesteps_since_restore": 2058021, "timesteps_this_iter": 59180, "custom_metrics": {"system_level_velocity_min": 9.416944569439641, "outflow_rate_max": 1186.9706304161327, "outflow_rate_min": 487.9519811681622, "outflow_rate_mean": 1056.0098048581108, "cost1_min": 18.587177903322097, "cost2_min": -84.36944727252481, "cost1_max": 434.6303579435705, "cost1_mean": 355.26396767182115, "cost2_max": -10.984309991868745, "system_level_velocity_mean": 13.79550045450098, "cost2_mean": -52.347179870810066, "system_level_velocity_max": 17.796504295014596}, "episode_reward_min": 50.43967823822004, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 34, "episodes_this_iter": 30, "timestamp": 1558328446, "episode_reward_max": 1348.9295082021802, "info": {"load_time_ms": 8.356, "default": {"vf_loss": 42.21323013305664, "entropy": 1.3184797763824463, "total_loss": 42.205142974853516, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010916303843259811, "vf_explained_var": 0.7268935441970825, "cur_lr": 0.0005000000237487257, "kl": 0.018850767984986305}, "num_steps_trained": 2116073, "grad_time_ms": 16859.971, "num_steps_sampled": 2116073, "sample_time_ms": 29979.523, "update_time_ms": 8.514}, "time_since_restore": 1639.6236658096313, "timesteps_total": 2116073, "episode_len_mean": 687.75, "episodes_total": 980, "time_total_s": 1639.6236658096313, "episode_reward_mean": 1178.980177282613, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.01386213302612, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ccc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cb70>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 34, "date": "2019-05-20_05-00-46", "timesteps_since_restore": 2116073, "timesteps_this_iter": 58052, "custom_metrics": {"system_level_velocity_min": 9.416944569439641, "outflow_rate_max": 1186.9706304161327, "outflow_rate_min": 487.9519811681622, "outflow_rate_mean": 1055.6546251430564, "cost1_min": 18.587177903322097, "cost2_min": -95.24055658442632, "cost1_max": 434.6303579435705, "cost1_mean": 355.42851173118447, "cost2_max": -12.903278898987374, "system_level_velocity_mean": 13.770828902226945, "cost2_mean": -53.463670581683544, "system_level_velocity_max": 17.796504295014596}, "episode_reward_min": 50.43967823822004, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 35, "episodes_this_iter": 31, "timestamp": 1558328490, "episode_reward_max": 1329.472365210322, "info": {"load_time_ms": 8.425, "default": {"vf_loss": 47.889217376708984, "entropy": 1.3190560340881348, "total_loss": 47.88201141357422, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.009929432533681393, "vf_explained_var": 0.67756187915802, "cur_lr": 0.0005000000237487257, "kl": 0.018153972923755646}, "num_steps_trained": 2172372, "grad_time_ms": 16527.437, "num_steps_sampled": 2172372, "sample_time_ms": 29627.815, "update_time_ms": 8.56}, "time_since_restore": 1683.2558872699738, "timesteps_total": 2172372, "episode_len_mean": 681.11, "episodes_total": 1011, "time_total_s": 1683.2558872699738, "episode_reward_mean": 1155.1133064970063, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.63222146034241, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c748>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 35, "date": "2019-05-20_05-01-30", "timesteps_since_restore": 2172372, "timesteps_this_iter": 56299, "custom_metrics": {"system_level_velocity_min": 9.416944569439641, "outflow_rate_max": 1185.5960256242095, "outflow_rate_min": 487.9519811681622, "outflow_rate_mean": 1042.1223778224964, "cost1_min": 18.587177903322097, "cost2_min": -95.24055658442632, "cost1_max": 429.7860740448253, "cost1_mean": 353.86969912681525, "cost2_max": -12.903278898987374, "system_level_velocity_mean": 13.891410174298693, "cost2_mean": -50.53007076373578, "system_level_velocity_max": 17.796504295014596}, "episode_reward_min": 50.43967823822004, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 36, "episodes_this_iter": 29, "timestamp": 1558328532, "episode_reward_max": 1305.9689963930653, "info": {"load_time_ms": 8.34, "default": {"vf_loss": 43.104122161865234, "entropy": 1.3281546831130981, "total_loss": 43.09508514404297, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.012152551673352718, "vf_explained_var": 0.706974983215332, "cur_lr": 0.0005000000237487257, "kl": 0.020768331363797188}, "num_steps_trained": 2226755, "grad_time_ms": 16078.351, "num_steps_sampled": 2226755, "sample_time_ms": 29325.176, "update_time_ms": 8.582}, "time_since_restore": 1725.204929113388, "timesteps_total": 2226755, "episode_len_mean": 681.11, "episodes_total": 1040, "time_total_s": 1725.204929113388, "episode_reward_mean": 1142.1088842991314, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.94904184341431, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b7b8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 36, "date": "2019-05-20_05-02-12", "timesteps_since_restore": 2226755, "timesteps_this_iter": 54383, "custom_metrics": {"system_level_velocity_min": 9.416944569439641, "outflow_rate_max": 1185.5960256242095, "outflow_rate_min": 487.9519811681622, "outflow_rate_mean": 1036.2218289566704, "cost1_min": 18.587177903322097, "cost2_min": -95.24055658442632, "cost1_max": 422.40456964926454, "cost1_mean": 356.8453989475679, "cost2_max": -12.903278898987374, "system_level_velocity_mean": 14.012943313993969, "cost2_mean": -47.29528995804129, "system_level_velocity_max": 17.796504295014596}, "episode_reward_min": 50.43967823822004, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 37, "episodes_this_iter": 30, "timestamp": 1558328576, "episode_reward_max": 1305.9689963930653, "info": {"load_time_ms": 8.027, "default": {"vf_loss": 51.09893798828125, "entropy": 1.3331241607666016, "total_loss": 51.092620849609375, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009884879924356937, "vf_explained_var": 0.6090624928474426, "cur_lr": 0.0005000000237487257, "kl": 0.0158663559705019}, "num_steps_trained": 2279857, "grad_time_ms": 15593.827, "num_steps_sampled": 2279857, "sample_time_ms": 29386.986, "update_time_ms": 8.634}, "time_since_restore": 1769.3829758167267, "timesteps_total": 2279857, "episode_len_mean": 687.83, "episodes_total": 1070, "time_total_s": 1769.3829758167267, "episode_reward_mean": 1139.4551718204302, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.17804670333862, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57af60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a320>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 37, "date": "2019-05-20_05-02-56", "timesteps_since_restore": 2279857, "timesteps_this_iter": 53102, "custom_metrics": {"system_level_velocity_min": 10.510350457175505, "outflow_rate_max": 1174.4309159299391, "outflow_rate_min": 517.7453351862127, "outflow_rate_mean": 1038.6242817196753, "cost1_min": 23.485430288964263, "cost2_min": -95.24055658442632, "cost1_max": 422.40456964926454, "cost1_mean": 368.20838081033287, "cost2_max": -13.113329078477332, "system_level_velocity_mean": 14.328836123577714, "cost2_mean": -42.62847058775748, "system_level_velocity_max": 17.727812186162105}, "episode_reward_min": 62.81931972528254, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 38, "episodes_this_iter": 35, "timestamp": 1558328623, "episode_reward_max": 1249.2941279861807, "info": {"load_time_ms": 7.852, "default": {"vf_loss": 51.241119384765625, "entropy": 1.332038402557373, "total_loss": 51.23335266113281, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011534430086612701, "vf_explained_var": 0.607424795627594, "cur_lr": 0.0005000000237487257, "kl": 0.016740091145038605}, "num_steps_trained": 2333804, "grad_time_ms": 15463.251, "num_steps_sampled": 2333804, "sample_time_ms": 29669.097, "update_time_ms": 8.664}, "time_since_restore": 1816.0080559253693, "timesteps_total": 2333804, "episode_len_mean": 676.74, "episodes_total": 1105, "time_total_s": 1816.0080559253693, "episode_reward_mean": 1105.3709800921588, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.62508010864258, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b588>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 38, "date": "2019-05-20_05-03-43", "timesteps_since_restore": 2333804, "timesteps_this_iter": 53947, "custom_metrics": {"system_level_velocity_min": 10.510350457175505, "outflow_rate_max": 1174.4309159299391, "outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 1032.9661055493543, "cost1_min": 11.803707774785835, "cost2_min": -77.43147863191076, "cost1_max": 428.2668952136261, "cost1_mean": 366.7893525131406, "cost2_max": -9.567456371176027, "system_level_velocity_mean": 14.581869362236327, "cost2_mean": -39.83455553673271, "system_level_velocity_max": 19.30960048517451}, "episode_reward_min": 29.26073726451969, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 39, "episodes_this_iter": 30, "timestamp": 1558328664, "episode_reward_max": 1233.9670175822287, "info": {"load_time_ms": 7.851, "default": {"vf_loss": 41.21833419799805, "entropy": 1.3472341299057007, "total_loss": 41.20928192138672, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.013089976273477077, "vf_explained_var": 0.6636614203453064, "cur_lr": 0.0005000000237487257, "kl": 0.017968671396374702}, "num_steps_trained": 2386674, "grad_time_ms": 15341.404, "num_steps_sampled": 2386674, "sample_time_ms": 29306.508, "update_time_ms": 8.586}, "time_since_restore": 1857.0806312561035, "timesteps_total": 2386674, "episode_len_mean": 674.75, "episodes_total": 1135, "time_total_s": 1857.0806312561035, "episode_reward_mean": 1091.495870447966, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.07257533073425, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b9b0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 39, "date": "2019-05-20_05-04-24", "timesteps_since_restore": 2386674, "timesteps_this_iter": 52870, "custom_metrics": {"system_level_velocity_min": 10.510350457175505, "outflow_rate_max": 1164.0321243424073, "outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 1034.1248901539057, "cost1_min": 11.803707774785835, "cost2_min": -80.52597508788648, "cost1_max": 434.19668435127227, "cost1_mean": 369.7294998210151, "cost2_max": -9.567456371176027, "system_level_velocity_mean": 14.762164428150957, "cost2_mean": -37.072032377680074, "system_level_velocity_max": 19.30960048517451}, "episode_reward_min": 29.26073726451969, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 40, "episodes_this_iter": 33, "timestamp": 1558328706, "episode_reward_max": 1233.9670175822287, "info": {"load_time_ms": 7.971, "default": {"vf_loss": 51.60480499267578, "entropy": 1.3452293872833252, "total_loss": 51.5981559753418, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010366519913077354, "vf_explained_var": 0.6043950319290161, "cur_lr": 0.0005000000237487257, "kl": 0.016516057774424553}, "num_steps_trained": 2440612, "grad_time_ms": 14987.898, "num_steps_sampled": 2440612, "sample_time_ms": 29288.246, "update_time_ms": 8.387}, "time_since_restore": 1899.1654789447784, "timesteps_total": 2440612, "episode_len_mean": 674.75, "episodes_total": 1168, "time_total_s": 1899.1654789447784, "episode_reward_mean": 1090.14982447105, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.08484768867493, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca58>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 40, "date": "2019-05-20_05-05-06", "timesteps_since_restore": 2440612, "timesteps_this_iter": 53938, "custom_metrics": {"system_level_velocity_min": 9.945172001389073, "outflow_rate_max": 1156.3945176140585, "outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 1027.1737553987907, "cost1_min": 11.803707774785835, "cost2_min": -80.52597508788648, "cost1_max": 434.19668435127227, "cost1_mean": 369.63854304300287, "cost2_max": -9.567456371176027, "system_level_velocity_mean": 14.752244306142204, "cost2_mean": -34.88044544256086, "system_level_velocity_max": 19.30960048517451}, "episode_reward_min": 29.26073726451969, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 41, "episodes_this_iter": 32, "timestamp": 1558328749, "episode_reward_max": 1249.843850487242, "info": {"load_time_ms": 8.003, "default": {"vf_loss": 53.954193115234375, "entropy": 1.3426846265792847, "total_loss": 53.94751739501953, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010217336937785149, "vf_explained_var": 0.5965132117271423, "cur_lr": 0.0005000000237487257, "kl": 0.015759779140353203}, "num_steps_trained": 2494639, "grad_time_ms": 14603.983, "num_steps_sampled": 2494639, "sample_time_ms": 29127.623, "update_time_ms": 8.137}, "time_since_restore": 1941.489892244339, "timesteps_total": 2494639, "episode_len_mean": 685.78, "episodes_total": 1200, "time_total_s": 1941.489892244339, "episode_reward_mean": 1111.9669662862032, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.32441329956055, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586668>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 41, "date": "2019-05-20_05-05-49", "timesteps_since_restore": 2494639, "timesteps_this_iter": 54027, "custom_metrics": {"system_level_velocity_min": 9.945172001389073, "outflow_rate_max": 1146.6715705961758, "outflow_rate_min": 489.92596116141834, "outflow_rate_mean": 1032.7829052410918, "cost1_min": 18.797039281360995, "cost2_min": -80.89402761774905, "cost1_max": 434.19668435127227, "cost1_mean": 372.9113541750922, "cost2_max": -11.989933101256277, "system_level_velocity_mean": 14.591331896888816, "cost2_mean": -35.08464517307019, "system_level_velocity_max": 19.30960048517451}, "episode_reward_min": 50.31592671658137, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 42, "episodes_this_iter": 29, "timestamp": 1558328791, "episode_reward_max": 1282.7280525552865, "info": {"load_time_ms": 8.053, "default": {"vf_loss": 46.30727005004883, "entropy": 1.331819772720337, "total_loss": 46.30055236816406, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.010465163737535477, "vf_explained_var": 0.6763139963150024, "cur_lr": 0.0005000000237487257, "kl": 0.016672831028699875}, "num_steps_trained": 2551640, "grad_time_ms": 14366.699, "num_steps_sampled": 2551640, "sample_time_ms": 29037.581, "update_time_ms": 7.933}, "time_since_restore": 1984.0322499275208, "timesteps_total": 2551640, "episode_len_mean": 694.49, "episodes_total": 1229, "time_total_s": 1984.0322499275208, "episode_reward_mean": 1145.7483504805562, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.54235768318176, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc50>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 42, "date": "2019-05-20_05-06-31", "timesteps_since_restore": 2551640, "timesteps_this_iter": 57001, "custom_metrics": {"system_level_velocity_min": 9.945172001389073, "outflow_rate_max": 1146.6715705961758, "outflow_rate_min": 727.1245082320186, "outflow_rate_mean": 1039.3907661401097, "cost1_min": 94.05655590760053, "cost2_min": -80.89402761774905, "cost1_max": 423.55778470036023, "cost1_mean": 373.5970126901635, "cost2_max": -16.473842313845687, "system_level_velocity_mean": 14.35440651074447, "cost2_mean": -37.968291954999856, "system_level_velocity_max": 16.83116455973982}, "episode_reward_min": 266.55836552507316, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 43, "episodes_this_iter": 31, "timestamp": 1558328836, "episode_reward_max": 1306.7293361032748, "info": {"load_time_ms": 8.001, "default": {"vf_loss": 46.61281967163086, "entropy": 1.327847957611084, "total_loss": 46.60416793823242, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012635371647775173, "vf_explained_var": 0.6998531818389893, "cur_lr": 0.0005000000237487257, "kl": 0.017748095095157623}, "num_steps_trained": 2610561, "grad_time_ms": 14242.183, "num_steps_sampled": 2610561, "sample_time_ms": 29140.441, "update_time_ms": 7.675}, "time_since_restore": 2028.6195080280304, "timesteps_total": 2610561, "episode_len_mean": 687.68, "episodes_total": 1260, "time_total_s": 2028.6195080280304, "episode_reward_mean": 1147.280336853081, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.587258100509644, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ac18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57aac8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 43, "date": "2019-05-20_05-07-16", "timesteps_since_restore": 2610561, "timesteps_this_iter": 58921, "custom_metrics": {"system_level_velocity_min": 9.90606458332829, "outflow_rate_max": 1170.1452717295458, "outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 1037.1130130186589, "cost1_min": 12.353177603048685, "cost2_min": -87.82814089878116, "cost1_max": 433.49047263709036, "cost1_mean": 365.0678207513778, "cost2_max": -11.016832373968347, "system_level_velocity_mean": 14.194514810063335, "cost2_mean": -41.5628564860914, "system_level_velocity_max": 16.83116455973982}, "episode_reward_min": 28.989913695103795, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 44, "episodes_this_iter": 30, "timestamp": 1558328880, "episode_reward_max": 1306.7293361032748, "info": {"load_time_ms": 7.821, "default": {"vf_loss": 45.05059051513672, "entropy": 1.325478434562683, "total_loss": 45.043373107910156, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.0110350726172328, "vf_explained_var": 0.7012562155723572, "cur_lr": 0.0005000000237487257, "kl": 0.016970070078969002}, "num_steps_trained": 2667490, "grad_time_ms": 14310.039, "num_steps_sampled": 2667490, "sample_time_ms": 28891.209, "update_time_ms": 7.884}, "time_since_restore": 2072.8077166080475, "timesteps_total": 2667490, "episode_len_mean": 687.68, "episodes_total": 1290, "time_total_s": 2072.8077166080475, "episode_reward_mean": 1160.969667604143, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.18820858001709, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b400>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 44, "date": "2019-05-20_05-08-00", "timesteps_since_restore": 2667490, "timesteps_this_iter": 56929, "custom_metrics": {"system_level_velocity_min": 9.90606458332829, "outflow_rate_max": 1170.1452717295458, "outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 1037.7763818614426, "cost1_min": 12.353177603048685, "cost2_min": -87.82814089878116, "cost1_max": 433.49047263709036, "cost1_mean": 360.02413165321593, "cost2_max": -11.016832373968347, "system_level_velocity_mean": 13.990021609280536, "cost2_mean": -44.9256200829067, "system_level_velocity_max": 16.83116455973982}, "episode_reward_min": 28.989913695103795, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 45, "episodes_this_iter": 32, "timestamp": 1558328926, "episode_reward_max": 1314.5587007579663, "info": {"load_time_ms": 7.747, "default": {"vf_loss": 42.629886627197266, "entropy": 1.328371286392212, "total_loss": 42.62133026123047, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012696751393377781, "vf_explained_var": 0.7188340425491333, "cur_lr": 0.0005000000237487257, "kl": 0.018391480669379234}, "num_steps_trained": 2726456, "grad_time_ms": 14446.547, "num_steps_sampled": 2726456, "sample_time_ms": 28963.265, "update_time_ms": 7.729}, "time_since_restore": 2118.535994529724, "timesteps_total": 2726456, "episode_len_mean": 686.47, "episodes_total": 1322, "time_total_s": 2118.535994529724, "episode_reward_mean": 1170.4754154200598, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.728277921676636, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c470>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 45, "date": "2019-05-20_05-08-46", "timesteps_since_restore": 2726456, "timesteps_this_iter": 58966, "custom_metrics": {"system_level_velocity_min": 9.90606458332829, "outflow_rate_max": 1180.549075228363, "outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 1046.830478277332, "cost1_min": 12.353177603048685, "cost2_min": -91.97152040081477, "cost1_max": 439.51735756961835, "cost1_mean": 362.38871063466644, "cost2_max": -11.016832373968347, "system_level_velocity_mean": 14.103756650423374, "cost2_mean": -46.72958235990843, "system_level_velocity_max": 18.097107900463723}, "episode_reward_min": 28.989913695103795, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 46, "episodes_this_iter": 29, "timestamp": 1558328972, "episode_reward_max": 1320.2202524871454, "info": {"load_time_ms": 7.653, "default": {"vf_loss": 45.27294158935547, "entropy": 1.3437222242355347, "total_loss": 45.26531219482422, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011803798377513885, "vf_explained_var": 0.7430666089057922, "cur_lr": 0.0005000000237487257, "kl": 0.01855161413550377}, "num_steps_trained": 2785405, "grad_time_ms": 14695.581, "num_steps_sampled": 2785405, "sample_time_ms": 29148.295, "update_time_ms": 7.787}, "time_since_restore": 2164.7992463111877, "timesteps_total": 2785405, "episode_len_mean": 693.28, "episodes_total": 1351, "time_total_s": 2164.7992463111877, "episode_reward_mean": 1193.5913863699489, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.26325178146362, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ac18>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 46, "date": "2019-05-20_05-09-32", "timesteps_since_restore": 2785405, "timesteps_this_iter": 58949, "custom_metrics": {"system_level_velocity_min": 10.109827988565245, "outflow_rate_max": 1180.549075228363, "outflow_rate_min": 489.92596116141834, "outflow_rate_mean": 1056.1320922500545, "cost1_min": 18.742564061288686, "cost2_min": -91.97152040081477, "cost1_max": 439.51735756961835, "cost1_mean": 365.65274112089645, "cost2_max": -12.40039551825841, "system_level_velocity_mean": 14.037074037138536, "cost2_mean": -48.16974971817233, "system_level_velocity_max": 18.097107900463723}, "episode_reward_min": 50.135548115230385, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 47, "episodes_this_iter": 29, "timestamp": 1558329018, "episode_reward_max": 1320.2202524871454, "info": {"load_time_ms": 7.776, "default": {"vf_loss": 47.3443489074707, "entropy": 1.339110255241394, "total_loss": 47.33740997314453, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011206487193703651, "vf_explained_var": 0.7326040863990784, "cur_lr": 0.0005000000237487257, "kl": 0.01894487999379635}, "num_steps_trained": 2844821, "grad_time_ms": 14809.22, "num_steps_sampled": 2844821, "sample_time_ms": 29222.961, "update_time_ms": 7.77}, "time_since_restore": 2210.88676738739, "timesteps_total": 2844821, "episode_len_mean": 686.75, "episodes_total": 1380, "time_total_s": 2210.88676738739, "episode_reward_mean": 1187.7604400986793, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.08752107620239, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586668>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 47, "date": "2019-05-20_05-10-18", "timesteps_since_restore": 2844821, "timesteps_this_iter": 59416, "custom_metrics": {"system_level_velocity_min": 9.737486113595798, "outflow_rate_max": 1180.549075228363, "outflow_rate_min": 489.92596116141834, "outflow_rate_mean": 1054.1274041391775, "cost1_min": 18.742564061288686, "cost2_min": -91.97152040081477, "cost1_max": 439.87714253013417, "cost1_mean": 364.87283324183886, "cost2_max": -8.873197932730038, "system_level_velocity_mean": 14.164864635511725, "cost2_mean": -46.93471665417221, "system_level_velocity_max": 18.097107900463723}, "episode_reward_min": 50.135548115230385, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 48, "episodes_this_iter": 30, "timestamp": 1558329063, "episode_reward_max": 1320.2202524871454, "info": {"load_time_ms": 7.805, "default": {"vf_loss": 46.51066207885742, "entropy": 1.3488433361053467, "total_loss": 46.50392532348633, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010591642931103706, "vf_explained_var": 0.7291886210441589, "cur_lr": 0.0005000000237487257, "kl": 0.017121881246566772}, "num_steps_trained": 2900868, "grad_time_ms": 14736.02, "num_steps_sampled": 2900868, "sample_time_ms": 29092.154, "update_time_ms": 8.048}, "time_since_restore": 2255.480493068695, "timesteps_total": 2900868, "episode_len_mean": 693.47, "episodes_total": 1410, "time_total_s": 2255.480493068695, "episode_reward_mean": 1193.1681123796714, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.59372568130493, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5aeb00>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 48, "date": "2019-05-20_05-11-03", "timesteps_since_restore": 2900868, "timesteps_this_iter": 56047, "custom_metrics": {"system_level_velocity_min": 9.737486113595798, "outflow_rate_max": 1180.549075228363, "outflow_rate_min": 519.5689485342305, "outflow_rate_mean": 1053.148239372894, "cost1_min": 30.434880397475588, "cost2_min": -92.4534932932929, "cost1_max": 439.87714253013417, "cost1_mean": 364.59227982942656, "cost2_max": -8.873197932730038, "system_level_velocity_mean": 13.977588409291666, "cost2_mean": -47.45480242263332, "system_level_velocity_max": 17.92873992062208}, "episode_reward_min": 73.55016172264402, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 49, "episodes_this_iter": 29, "timestamp": 1558329108, "episode_reward_max": 1294.3748035472865, "info": {"load_time_ms": 7.707, "default": {"vf_loss": 47.674808502197266, "entropy": 1.355029821395874, "total_loss": 47.66797637939453, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010736679658293724, "vf_explained_var": 0.7177672386169434, "cur_lr": 0.0005000000237487257, "kl": 0.017368927597999573}, "num_steps_trained": 2957630, "grad_time_ms": 14804.297, "num_steps_sampled": 2957630, "sample_time_ms": 29405.584, "update_time_ms": 8.21}, "time_since_restore": 2300.3890392780304, "timesteps_total": 2957630, "episode_len_mean": 693.47, "episodes_total": 1439, "time_total_s": 2300.3890392780304, "episode_reward_mean": 1184.4073886005754, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.90854620933533, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae710>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 49, "date": "2019-05-20_05-11-48", "timesteps_since_restore": 2957630, "timesteps_this_iter": 56762, "custom_metrics": {"system_level_velocity_min": 9.737486113595798, "outflow_rate_max": 1169.8857778796457, "outflow_rate_min": 519.5689485342305, "outflow_rate_mean": 1051.4996441827504, "cost1_min": 30.434880397475588, "cost2_min": -95.61767957786587, "cost1_max": 441.3877719571315, "cost1_mean": 366.69010043502715, "cost2_max": -8.873197932730038, "system_level_velocity_mean": 14.066575747754516, "cost2_mean": -46.480805530729455, "system_level_velocity_max": 17.92873992062208}, "episode_reward_min": 73.55016172264402, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 50, "episodes_this_iter": 33, "timestamp": 1558329153, "episode_reward_max": 1294.3748035472865, "info": {"load_time_ms": 7.676, "default": {"vf_loss": 55.13462829589844, "entropy": 1.3545622825622559, "total_loss": 55.12773513793945, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010825174860656261, "vf_explained_var": 0.6667302846908569, "cur_lr": 0.0005000000237487257, "kl": 0.017468076199293137}, "num_steps_trained": 3013673, "grad_time_ms": 15015.287, "num_steps_sampled": 3013673, "sample_time_ms": 29541.413, "update_time_ms": 8.705}, "time_since_restore": 2345.9856820106506, "timesteps_total": 3013673, "episode_len_mean": 700.0, "episodes_total": 1472, "time_total_s": 2345.9856820106506, "episode_reward_mean": 1188.9050950271726, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.59664273262024, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57be80>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 50, "date": "2019-05-20_05-12-33", "timesteps_since_restore": 3013673, "timesteps_this_iter": 56043, "custom_metrics": {"system_level_velocity_min": 10.17627326156694, "outflow_rate_max": 1169.8857778796457, "outflow_rate_min": 916.4128453847064, "outflow_rate_mean": 1049.395310415498, "cost1_min": 264.0956404739083, "cost2_min": -95.61767957786587, "cost1_max": 441.3877719571315, "cost1_mean": 369.82324895842925, "cost2_max": -17.69283645695637, "system_level_velocity_mean": 14.023719798848587, "cost2_mean": -44.76295638836947, "system_level_velocity_max": 16.829142401975748}, "episode_reward_min": 999.0870961504284, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 51, "episodes_this_iter": 31, "timestamp": 1558329198, "episode_reward_max": 1296.1058888286257, "info": {"load_time_ms": 7.611, "default": {"vf_loss": 53.50666046142578, "entropy": 1.3536698818206787, "total_loss": 53.49872970581055, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011931711807847023, "vf_explained_var": 0.687026858329773, "cur_lr": 0.0005000000237487257, "kl": 0.017788546159863472}, "num_steps_trained": 3068956, "grad_time_ms": 15206.584, "num_steps_sampled": 3068956, "sample_time_ms": 29514.292, "update_time_ms": 9.083}, "time_since_restore": 2389.9923362731934, "timesteps_total": 3068956, "episode_len_mean": 700.0, "episodes_total": 1503, "time_total_s": 2389.9923362731934, "episode_reward_mean": 1190.3630992612057, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.006654262542725, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d2828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d2a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d2ef0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 51, "date": "2019-05-20_05-13-18", "timesteps_since_restore": 3068956, "timesteps_this_iter": 55283, "custom_metrics": {"system_level_velocity_min": 10.17627326156694, "outflow_rate_max": 1187.3976609775486, "outflow_rate_min": 933.837142218336, "outflow_rate_mean": 1059.4185820092468, "cost1_min": 264.0956404739083, "cost2_min": -95.61767957786587, "cost1_max": 447.99298690583095, "cost1_mean": 376.9869706668797, "cost2_max": -17.69283645695637, "system_level_velocity_mean": 14.29651225259932, "cost2_mean": -43.96898024141244, "system_level_velocity_max": 17.239850821818965}, "episode_reward_min": 966.5651057824626, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 52, "episodes_this_iter": 32, "timestamp": 1558329241, "episode_reward_max": 1317.8299444044596, "info": {"load_time_ms": 7.665, "default": {"vf_loss": 53.26680374145508, "entropy": 1.3544132709503174, "total_loss": 53.25872039794922, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012083698064088821, "vf_explained_var": 0.6687269806861877, "cur_lr": 0.0005000000237487257, "kl": 0.017778323963284492}, "num_steps_trained": 3122889, "grad_time_ms": 15090.746, "num_steps_sampled": 3122889, "sample_time_ms": 29695.85, "update_time_ms": 9.426}, "time_since_restore": 2433.184018611908, "timesteps_total": 3122889, "episode_len_mean": 686.63, "episodes_total": 1535, "time_total_s": 2433.184018611908, "episode_reward_mean": 1175.062275138488, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.1916823387146, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5866d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e48>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 52, "date": "2019-05-20_05-14-01", "timesteps_since_restore": 3122889, "timesteps_this_iter": 53933, "custom_metrics": {"system_level_velocity_min": 10.17627326156694, "outflow_rate_max": 1187.3976609775486, "outflow_rate_min": 478.85323924047754, "outflow_rate_mean": 1056.484722032429, "cost1_min": 16.525392506073572, "cost2_min": -78.76626571674751, "cost1_max": 447.99298690583095, "cost1_mean": 376.4431889299181, "cost2_max": -12.019674211040735, "system_level_velocity_mean": 14.59938224560838, "cost2_mean": -41.70948773791358, "system_level_velocity_max": 18.207680406272274}, "episode_reward_min": 46.57333929113633, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 53, "episodes_this_iter": 31, "timestamp": 1558329282, "episode_reward_max": 1317.8299444044596, "info": {"load_time_ms": 7.556, "default": {"vf_loss": 48.26874923706055, "entropy": 1.363467812538147, "total_loss": 48.26156997680664, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011283422820270061, "vf_explained_var": 0.7313597798347473, "cur_lr": 0.0005000000237487257, "kl": 0.01823742873966694}, "num_steps_trained": 3177164, "grad_time_ms": 14852.134, "num_steps_sampled": 3177164, "sample_time_ms": 29630.977, "update_time_ms": 9.444}, "time_since_restore": 2474.731411218643, "timesteps_total": 3177164, "episode_len_mean": 673.25, "episodes_total": 1566, "time_total_s": 2474.731411218643, "episode_reward_mean": 1152.3933681230292, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.54739260673523, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e48>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 53, "date": "2019-05-20_05-14-42", "timesteps_since_restore": 3177164, "timesteps_this_iter": 54275, "custom_metrics": {"system_level_velocity_min": 10.248134088530785, "outflow_rate_max": 1210.945839897845, "outflow_rate_min": 478.85323924047754, "outflow_rate_mean": 1054.4024391670591, "cost1_min": 16.525392506073572, "cost2_min": -91.66803374319308, "cost1_max": 450.3546653333297, "cost1_mean": 373.55238310127135, "cost2_max": -9.47162312929027, "system_level_velocity_mean": 14.840110927704357, "cost2_mean": -42.12818586995959, "system_level_velocity_max": 18.512091065852946}, "episode_reward_min": 46.57333929113633, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 54, "episodes_this_iter": 30, "timestamp": 1558329328, "episode_reward_max": 1317.8299444044596, "info": {"load_time_ms": 7.559, "default": {"vf_loss": 51.15885543823242, "entropy": 1.3753130435943604, "total_loss": 51.15156173706055, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011182047426700592, "vf_explained_var": 0.7459796071052551, "cur_lr": 0.0005000000237487257, "kl": 0.017268730327486992}, "num_steps_trained": 3234162, "grad_time_ms": 14667.41, "num_steps_sampled": 3234162, "sample_time_ms": 29982.043, "update_time_ms": 9.197}, "time_since_restore": 2520.570153236389, "timesteps_total": 3234162, "episode_len_mean": 673.25, "episodes_total": 1596, "time_total_s": 2520.570153236389, "episode_reward_mean": 1154.16907337135, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.83874201774597, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ceb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc50>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 54, "date": "2019-05-20_05-15-28", "timesteps_since_restore": 3234162, "timesteps_this_iter": 56998, "custom_metrics": {"system_level_velocity_min": 10.105416015300735, "outflow_rate_max": 1210.945839897845, "outflow_rate_min": 478.85323924047754, "outflow_rate_mean": 1054.396576768892, "cost1_min": 16.525392506073572, "cost2_min": -91.66803374319308, "cost1_max": 450.3546653333297, "cost1_mean": 375.03697302187334, "cost2_max": -9.47162312929027, "system_level_velocity_mean": 14.90110911534153, "cost2_mean": -41.200505194796115, "system_level_velocity_max": 18.512091065852946}, "episode_reward_min": 46.57333929113633, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 55, "episodes_this_iter": 30, "timestamp": 1558329376, "episode_reward_max": 1321.7346838165909, "info": {"load_time_ms": 7.73, "default": {"vf_loss": 45.54847717285156, "entropy": 1.3890389204025269, "total_loss": 45.54110336303711, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010916788130998611, "vf_explained_var": 0.7743646502494812, "cur_lr": 0.0005000000237487257, "kl": 0.0157589390873909}, "num_steps_trained": 3293461, "grad_time_ms": 14549.334, "num_steps_sampled": 3293461, "sample_time_ms": 30258.246, "update_time_ms": 9.165}, "time_since_restore": 2567.884301185608, "timesteps_total": 3293461, "episode_len_mean": 686.62, "episodes_total": 1626, "time_total_s": 2567.884301185608, "episode_reward_mean": 1179.6359578188094, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.31414794921875, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5868d0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 55, "date": "2019-05-20_05-16-16", "timesteps_since_restore": 3293461, "timesteps_this_iter": 59299, "custom_metrics": {"system_level_velocity_min": 10.010722776359653, "outflow_rate_max": 1210.945839897845, "outflow_rate_min": 486.09666807518306, "outflow_rate_mean": 1056.2275985676404, "cost1_min": 17.921718342897616, "cost2_min": -91.66803374319308, "cost1_max": 450.5357197961288, "cost1_mean": 373.56939433937146, "cost2_max": -9.47162312929027, "system_level_velocity_mean": 14.517432792521136, "cost2_mean": -45.23048399458866, "system_level_velocity_max": 18.512091065852946}, "episode_reward_min": 49.91092098616325, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 56, "episodes_this_iter": 28, "timestamp": 1558329419, "episode_reward_max": 1321.7346838165909, "info": {"load_time_ms": 7.926, "default": {"vf_loss": 51.91428756713867, "entropy": 1.3847417831420898, "total_loss": 51.90625762939453, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012204205617308617, "vf_explained_var": 0.7131296396255493, "cur_lr": 0.0005000000237487257, "kl": 0.01855776086449623}, "num_steps_trained": 3349203, "grad_time_ms": 14381.328, "num_steps_sampled": 3349203, "sample_time_ms": 30162.409, "update_time_ms": 9.123}, "time_since_restore": 2611.5023231506348, "timesteps_total": 3349203, "episode_len_mean": 700.0, "episodes_total": 1654, "time_total_s": 2611.5023231506348, "episode_reward_mean": 1214.2890449575948, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.618021965026855, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586588>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 56, "date": "2019-05-20_05-16-59", "timesteps_since_restore": 3349203, "timesteps_this_iter": 55742, "custom_metrics": {"system_level_velocity_min": 10.010722776359653, "outflow_rate_max": 1210.945839897845, "outflow_rate_min": 900.8173509377445, "outflow_rate_mean": 1073.6640513601656, "cost1_min": 264.6293994767746, "cost2_min": -88.14659136102266, "cost1_max": 451.45677549981326, "cost1_mean": 383.8089108305488, "cost2_max": -18.007193152189984, "system_level_velocity_mean": 14.562837023075643, "cost2_mean": -44.62747572877466, "system_level_velocity_max": 17.323470727525336}, "episode_reward_min": 1009.8147436116313, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 57, "episodes_this_iter": 31, "timestamp": 1558329463, "episode_reward_max": 1321.7346838165909, "info": {"load_time_ms": 7.933, "default": {"vf_loss": 49.6951904296875, "entropy": 1.394362449645996, "total_loss": 49.68650436401367, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012937624007463455, "vf_explained_var": 0.7399985194206238, "cur_lr": 0.0005000000237487257, "kl": 0.018890181556344032}, "num_steps_trained": 3406937, "grad_time_ms": 14287.652, "num_steps_sampled": 3406937, "sample_time_ms": 30020.825, "update_time_ms": 8.962}, "time_since_restore": 2655.2244579792023, "timesteps_total": 3406937, "episode_len_mean": 700.0, "episodes_total": 1685, "time_total_s": 2655.2244579792023, "episode_reward_mean": 1212.53991256009, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.722134828567505, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b7f0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 57, "date": "2019-05-20_05-17-43", "timesteps_since_restore": 3406937, "timesteps_this_iter": 57734, "custom_metrics": {"system_level_velocity_min": 10.010722776359653, "outflow_rate_max": 1184.8142264575097, "outflow_rate_min": 914.780536336387, "outflow_rate_mean": 1073.418618476205, "cost1_min": 264.6293994767746, "cost2_min": -89.51844206250155, "cost1_max": 451.45677549981326, "cost1_mean": 381.035543849244, "cost2_max": -18.007193152189984, "system_level_velocity_mean": 14.467599808759582, "cost2_mean": -47.35108114490948, "system_level_velocity_max": 17.181254877324598}, "episode_reward_min": 1009.8147436116313, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 58, "episodes_this_iter": 32, "timestamp": 1558329506, "episode_reward_max": 1340.7463003110533, "info": {"load_time_ms": 8.094, "default": {"vf_loss": 56.86023712158203, "entropy": 1.4020696878433228, "total_loss": 56.852386474609375, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012141255661845207, "vf_explained_var": 0.7053805589675903, "cur_lr": 0.0005000000237487257, "kl": 0.019052596762776375}, "num_steps_trained": 3464120, "grad_time_ms": 14141.669, "num_steps_sampled": 3464120, "sample_time_ms": 29964.655, "update_time_ms": 8.77}, "time_since_restore": 2697.80601978302, "timesteps_total": 3464120, "episode_len_mean": 693.16, "episodes_total": 1717, "time_total_s": 2697.80601978302, "episode_reward_mean": 1203.951977781801, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.58156180381775, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c5f8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 58, "date": "2019-05-20_05-18-26", "timesteps_since_restore": 3464120, "timesteps_this_iter": 57183, "custom_metrics": {"system_level_velocity_min": 10.010722776359653, "outflow_rate_max": 1181.816494799388, "outflow_rate_min": 440.17247907724766, "outflow_rate_mean": 1062.9177937679376, "cost1_min": 10.302546978462678, "cost2_min": -90.25409695314544, "cost1_max": 451.45677549981326, "cost1_mean": 377.7515763858083, "cost2_max": -6.955988273052439, "system_level_velocity_mean": 14.514181092122108, "cost2_mean": -45.13445919039795, "system_level_velocity_max": 17.181254877324598}, "episode_reward_min": 21.909445812547602, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 59, "episodes_this_iter": 30, "timestamp": 1558329548, "episode_reward_max": 1340.7463003110533, "info": {"load_time_ms": 8.167, "default": {"vf_loss": 54.489044189453125, "entropy": 1.3956528902053833, "total_loss": 54.48196792602539, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010892757214605808, "vf_explained_var": 0.6725910902023315, "cur_lr": 0.0005000000237487257, "kl": 0.016938334330916405}, "num_steps_trained": 3519615, "grad_time_ms": 13921.153, "num_steps_sampled": 3519615, "sample_time_ms": 29902.777, "update_time_ms": 8.652}, "time_since_restore": 2739.8676578998566, "timesteps_total": 3519615, "episode_len_mean": 690.38, "episodes_total": 1747, "time_total_s": 2739.8676578998566, "episode_reward_mean": 1189.0283202856538, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.06163811683655, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5608d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560a20>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 59, "date": "2019-05-20_05-19-08", "timesteps_since_restore": 3519615, "timesteps_this_iter": 55495, "custom_metrics": {"system_level_velocity_min": 10.026292629210706, "outflow_rate_max": 1181.816494799388, "outflow_rate_min": 440.17247907724766, "outflow_rate_mean": 1056.8851648882492, "cost1_min": 10.302546978462678, "cost2_min": -90.25409695314544, "cost1_max": 445.77582372710725, "cost1_mean": 374.3742280995524, "cost2_max": -6.955988273052439, "system_level_velocity_mean": 14.448119023398835, "cost2_mean": -45.62873342923178, "system_level_velocity_max": 17.049710499616985}, "episode_reward_min": 21.909445812547602, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 60, "episodes_this_iter": 29, "timestamp": 1558329594, "episode_reward_max": 1340.7463003110533, "info": {"load_time_ms": 8.272, "default": {"vf_loss": 45.47039031982422, "entropy": 1.3925310373306274, "total_loss": 45.4632568359375, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011141791939735413, "vf_explained_var": 0.75701904296875, "cur_lr": 0.0005000000237487257, "kl": 0.01782332733273506}, "num_steps_trained": 3578600, "grad_time_ms": 13846.514, "num_steps_sampled": 3578600, "sample_time_ms": 30011.772, "update_time_ms": 8.209}, "time_since_restore": 2785.794290304184, "timesteps_total": 3578600, "episode_len_mean": 690.38, "episodes_total": 1776, "time_total_s": 2785.794290304184, "episode_reward_mean": 1183.4398677679967, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.92663240432739, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5607b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560dd8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 60, "date": "2019-05-20_05-19-54", "timesteps_since_restore": 3578600, "timesteps_this_iter": 58985, "custom_metrics": {"system_level_velocity_min": 10.026292629210706, "outflow_rate_max": 1162.822331448757, "outflow_rate_min": 440.17247907724766, "outflow_rate_mean": 1048.694636530411, "cost1_min": 10.302546978462678, "cost2_min": -106.3255033242475, "cost1_max": 446.43304908350393, "cost1_mean": 371.004039316468, "cost2_max": -6.955988273052439, "system_level_velocity_mean": 14.3218314511867, "cost2_mean": -45.77740883077342, "system_level_velocity_max": 17.10620481944379}, "episode_reward_min": 21.909445812547602, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 61, "episodes_this_iter": 34, "timestamp": 1558329640, "episode_reward_max": 1339.6547713374869, "info": {"load_time_ms": 8.337, "default": {"vf_loss": 56.028724670410156, "entropy": 1.4048646688461304, "total_loss": 56.02283477783203, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.009449933655560017, "vf_explained_var": 0.727356493473053, "cur_lr": 0.0005000000237487257, "kl": 0.015804274007678032}, "num_steps_trained": 3638534, "grad_time_ms": 13848.065, "num_steps_sampled": 3638534, "sample_time_ms": 30252.047, "update_time_ms": 8.192}, "time_since_restore": 2832.1875059604645, "timesteps_total": 3638534, "episode_len_mean": 686.04, "episodes_total": 1810, "time_total_s": 2832.1875059604645, "episode_reward_mean": 1173.3745479560464, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.39321565628052, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583dd8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 61, "date": "2019-05-20_05-20-40", "timesteps_since_restore": 3638534, "timesteps_this_iter": 59934, "custom_metrics": {"system_level_velocity_min": 10.026292629210706, "outflow_rate_max": 1177.236591926503, "outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 1041.5952920145737, "cost1_min": 15.808291456197782, "cost2_min": -106.3255033242475, "cost1_max": 450.4475953363482, "cost1_mean": 365.42153508179666, "cost2_max": -10.31334935653079, "system_level_velocity_mean": 14.228836126127433, "cost2_mean": -47.54086697502345, "system_level_velocity_max": 17.493828621070296}, "episode_reward_min": 44.394436457526616, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 62, "episodes_this_iter": 29, "timestamp": 1558329685, "episode_reward_max": 1339.6547713374869, "info": {"load_time_ms": 8.411, "default": {"vf_loss": 48.16069793701172, "entropy": 1.4183553457260132, "total_loss": 48.153621673583984, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.010938302613794804, "vf_explained_var": 0.7482802271842957, "cur_lr": 0.0005000000237487257, "kl": 0.017186474055051804}, "num_steps_trained": 3697799, "grad_time_ms": 13979.748, "num_steps_sampled": 3697799, "sample_time_ms": 30315.127, "update_time_ms": 8.0}, "time_since_restore": 2877.342215538025, "timesteps_total": 3697799, "episode_len_mean": 688.82, "episodes_total": 1839, "time_total_s": 2877.342215538025, "episode_reward_mean": 1173.2277147094649, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.154709577560425, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5587f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5580b8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 62, "date": "2019-05-20_05-21-25", "timesteps_since_restore": 3697799, "timesteps_this_iter": 59265, "custom_metrics": {"system_level_velocity_min": 9.797718244308898, "outflow_rate_max": 1182.1221745630166, "outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 1035.6040933523882, "cost1_min": 15.808291456197782, "cost2_min": -106.3255033242475, "cost1_max": 450.4475953363482, "cost1_mean": 359.7076644864504, "cost2_max": -10.31334935653079, "system_level_velocity_mean": 13.947267577283274, "cost2_mean": -50.211652857316096, "system_level_velocity_max": 17.493828621070296}, "episode_reward_min": 44.394436457526616, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 63, "episodes_this_iter": 30, "timestamp": 1558329730, "episode_reward_max": 1365.2678562099345, "info": {"load_time_ms": 8.354, "default": {"vf_loss": 49.997169494628906, "entropy": 1.4171876907348633, "total_loss": 49.99092483520508, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010210384614765644, "vf_explained_var": 0.7362848520278931, "cur_lr": 0.0005000000237487257, "kl": 0.017654966562986374}, "num_steps_trained": 3757923, "grad_time_ms": 14096.231, "num_steps_sampled": 3757923, "sample_time_ms": 30502.838, "update_time_ms": 8.57}, "time_since_restore": 2921.9469254016876, "timesteps_total": 3757923, "episode_len_mean": 688.82, "episodes_total": 1869, "time_total_s": 2921.9469254016876, "episode_reward_mean": 1186.1646946000787, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.60470986366272, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c828>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 63, "date": "2019-05-20_05-22-10", "timesteps_since_restore": 3757923, "timesteps_this_iter": 60124, "custom_metrics": {"system_level_velocity_min": 9.797718244308898, "outflow_rate_max": 1182.1221745630166, "outflow_rate_min": 477.8911634321994, "outflow_rate_mean": 1042.5485969086385, "cost1_min": 15.808291456197782, "cost2_min": -96.72181424984046, "cost1_max": 450.4475953363482, "cost1_mean": 361.89715731147675, "cost2_max": -10.31334935653079, "system_level_velocity_mean": 14.008501542373008, "cost2_mean": -51.1916201559275, "system_level_velocity_max": 17.493828621070296}, "episode_reward_min": 44.394436457526616, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 64, "episodes_this_iter": 29, "timestamp": 1558329776, "episode_reward_max": 1365.2678562099345, "info": {"load_time_ms": 8.146, "default": {"vf_loss": 44.10123825073242, "entropy": 1.4345881938934326, "total_loss": 44.09397506713867, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010967383161187172, "vf_explained_var": 0.7740908265113831, "cur_lr": 0.0005000000237487257, "kl": 0.01646856777369976}, "num_steps_trained": 3818068, "grad_time_ms": 14134.318, "num_steps_sampled": 3818068, "sample_time_ms": 30499.391, "update_time_ms": 8.551}, "time_since_restore": 2968.1230347156525, "timesteps_total": 3818068, "episode_len_mean": 695.58, "episodes_total": 1898, "time_total_s": 2968.1230347156525, "episode_reward_mean": 1196.5727790918281, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.176109313964844, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a588>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 64, "date": "2019-05-20_05-22-56", "timesteps_since_restore": 3818068, "timesteps_this_iter": 60145, "custom_metrics": {"system_level_velocity_min": 9.69600476130216, "outflow_rate_max": 1195.8793147878514, "outflow_rate_min": 847.3741543094097, "outflow_rate_mean": 1054.501113324984, "cost1_min": 163.22037240861212, "cost2_min": -96.72181424984046, "cost1_max": 450.4475953363482, "cost1_mean": 364.26904915896165, "cost2_max": -18.367974673879, "system_level_velocity_mean": 13.930886995447638, "cost2_mean": -53.81051603229327, "system_level_velocity_max": 17.493828621070296}, "episode_reward_min": 436.757009288687, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 65, "episodes_this_iter": 28, "timestamp": 1558329823, "episode_reward_max": 1365.2678562099345, "info": {"load_time_ms": 7.915, "default": {"vf_loss": 45.781532287597656, "entropy": 1.436496615409851, "total_loss": 45.77272033691406, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012485460378229618, "vf_explained_var": 0.7646527290344238, "cur_lr": 0.0005000000237487257, "kl": 0.016318658366799355}, "num_steps_trained": 3878239, "grad_time_ms": 14230.433, "num_steps_sampled": 3878239, "sample_time_ms": 30354.845, "update_time_ms": 8.53}, "time_since_restore": 3014.9394986629486, "timesteps_total": 3878239, "episode_len_mean": 700.0, "episodes_total": 1926, "time_total_s": 3014.9394986629486, "episode_reward_mean": 1202.7990734603716, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.81646394729614, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5863c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b668>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 65, "date": "2019-05-20_05-23-43", "timesteps_since_restore": 3878239, "timesteps_this_iter": 60171, "custom_metrics": {"system_level_velocity_min": 9.69600476130216, "outflow_rate_max": 1195.8793147878514, "outflow_rate_min": 889.5566028426222, "outflow_rate_mean": 1056.4012831807781, "cost1_min": 249.3190139104773, "cost2_min": -101.01429301676285, "cost1_max": 447.9843110467924, "cost1_mean": 364.2109990530369, "cost2_max": -18.367974673879, "system_level_velocity_mean": 13.84211757503286, "cost2_mean": -54.89695142905742, "system_level_velocity_max": 17.059664594657193}, "episode_reward_min": 1000.7706813007965, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 66, "episodes_this_iter": 28, "timestamp": 1558329871, "episode_reward_max": 1365.2678562099345, "info": {"load_time_ms": 7.981, "default": {"vf_loss": 44.62590408325195, "entropy": 1.430429220199585, "total_loss": 44.618858337402344, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011174268089234829, "vf_explained_var": 0.7606906890869141, "cur_lr": 0.0005000000237487257, "kl": 0.018355512991547585}, "num_steps_trained": 3938816, "grad_time_ms": 14418.296, "num_steps_sampled": 3938816, "sample_time_ms": 30544.495, "update_time_ms": 8.636}, "time_since_restore": 3062.3480298519135, "timesteps_total": 3938816, "episode_len_mean": 693.39, "episodes_total": 1954, "time_total_s": 3062.3480298519135, "episode_reward_mean": 1187.8014368962274, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 47.408531188964844, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5836d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5837f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583ac8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 66, "date": "2019-05-20_05-24-31", "timesteps_since_restore": 3938816, "timesteps_this_iter": 60577, "custom_metrics": {"system_level_velocity_min": 9.69600476130216, "outflow_rate_max": 1195.8793147878514, "outflow_rate_min": 513.344548631384, "outflow_rate_mean": 1047.6070634651248, "cost1_min": 26.310409226869755, "cost2_min": -101.01429301676285, "cost1_max": 447.9843110467924, "cost1_mean": 356.6695043237079, "cost2_max": -14.624094579471258, "system_level_velocity_mean": 13.750678378362046, "cost2_mean": -55.20484648349847, "system_level_velocity_max": 18.25595239536532}, "episode_reward_min": 61.82247631491418, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 67, "episodes_this_iter": 31, "timestamp": 1558329916, "episode_reward_max": 1344.9196058126465, "info": {"load_time_ms": 8.041, "default": {"vf_loss": 49.88080596923828, "entropy": 1.4380693435668945, "total_loss": 49.87235641479492, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012698718346655369, "vf_explained_var": 0.745147168636322, "cur_lr": 0.0005000000237487257, "kl": 0.01889725774526596}, "num_steps_trained": 3998271, "grad_time_ms": 14426.95, "num_steps_sampled": 3998271, "sample_time_ms": 30709.777, "update_time_ms": 8.573}, "time_since_restore": 3107.8157212734222, "timesteps_total": 3998271, "episode_len_mean": 693.39, "episodes_total": 1985, "time_total_s": 3107.8157212734222, "episode_reward_mean": 1178.8167060644191, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.46769142150879, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5584e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558048>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 67, "date": "2019-05-20_05-25-16", "timesteps_since_restore": 3998271, "timesteps_this_iter": 59455, "custom_metrics": {"system_level_velocity_min": 9.75484789630537, "outflow_rate_max": 1195.8793147878514, "outflow_rate_min": 513.344548631384, "outflow_rate_mean": 1037.0489706363014, "cost1_min": 26.310409226869755, "cost2_min": -101.01429301676285, "cost1_max": 454.10779966242194, "cost1_mean": 352.69221508408117, "cost2_max": -14.624094579471258, "system_level_velocity_mean": 13.627004921857276, "cost2_mean": -53.64317823069581, "system_level_velocity_max": 18.25595239536532}, "episode_reward_min": 61.82247631491418, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 68, "episodes_this_iter": 32, "timestamp": 1558329963, "episode_reward_max": 1331.8543664592287, "info": {"load_time_ms": 7.956, "default": {"vf_loss": 46.86131286621094, "entropy": 1.4434480667114258, "total_loss": 46.853084564208984, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.012415693141520023, "vf_explained_var": 0.7600902915000916, "cur_lr": 0.0005000000237487257, "kl": 0.018635936081409454}, "num_steps_trained": 4057128, "grad_time_ms": 14573.438, "num_steps_sampled": 4057128, "sample_time_ms": 30998.522, "update_time_ms": 8.708}, "time_since_restore": 3154.7378532886505, "timesteps_total": 4057128, "episode_len_mean": 686.59, "episodes_total": 2017, "time_total_s": 3154.7378532886505, "episode_reward_mean": 1175.617220872867, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.92213201522827, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5866d8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 68, "date": "2019-05-20_05-26-03", "timesteps_since_restore": 4057128, "timesteps_this_iter": 58857, "custom_metrics": {"system_level_velocity_min": 9.75484789630537, "outflow_rate_max": 1183.8370153469273, "outflow_rate_min": 462.5306177284606, "outflow_rate_mean": 1035.0262806472701, "cost1_min": 13.040540998820715, "cost2_min": -99.86527213236766, "cost1_max": 454.10779966242194, "cost1_mean": 356.43662590094823, "cost2_max": -8.75169333416378, "system_level_velocity_mean": 13.907776520707566, "cost2_mean": -50.09091209374802, "system_level_velocity_max": 18.25595239536532}, "episode_reward_min": 35.26537879894691, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 69, "episodes_this_iter": 30, "timestamp": 1558330009, "episode_reward_max": 1315.3660134758263, "info": {"load_time_ms": 7.977, "default": {"vf_loss": 49.58673095703125, "entropy": 1.4406973123550415, "total_loss": 49.57795715332031, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012811604887247086, "vf_explained_var": 0.7507066130638123, "cur_lr": 0.0005000000237487257, "kl": 0.017938999459147453}, "num_steps_trained": 4113648, "grad_time_ms": 14791.977, "num_steps_sampled": 4113648, "sample_time_ms": 31163.268, "update_time_ms": 9.014}, "time_since_restore": 3200.6434388160706, "timesteps_total": 4113648, "episode_len_mean": 692.61, "episodes_total": 2047, "time_total_s": 3200.6434388160706, "episode_reward_mean": 1177.21166709706, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.905585527420044, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5580b8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 69, "date": "2019-05-20_05-26-49", "timesteps_since_restore": 4113648, "timesteps_this_iter": 56520, "custom_metrics": {"system_level_velocity_min": 9.0827040486317, "outflow_rate_max": 1177.2169313963195, "outflow_rate_min": 462.5306177284606, "outflow_rate_mean": 1038.1383077707408, "cost1_min": 13.040540998820715, "cost2_min": -95.54955073116483, "cost1_max": 454.10779966242194, "cost1_mean": 364.4359199659794, "cost2_max": -8.75169333416378, "system_level_velocity_mean": 14.044327317427241, "cost2_mean": -47.2318375572423, "system_level_velocity_max": 17.16316097512683}, "episode_reward_min": 35.26537879894691, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 70, "episodes_this_iter": 31, "timestamp": 1558330054, "episode_reward_max": 1315.3660134758263, "info": {"load_time_ms": 7.914, "default": {"vf_loss": 56.729251861572266, "entropy": 1.4517991542816162, "total_loss": 56.72086715698242, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012579170987010002, "vf_explained_var": 0.6998406648635864, "cur_lr": 0.0005000000237487257, "kl": 0.018648145720362663}, "num_steps_trained": 4170358, "grad_time_ms": 14899.699, "num_steps_sampled": 4170358, "sample_time_ms": 30965.57, "update_time_ms": 9.1}, "time_since_restore": 3245.644519805908, "timesteps_total": 4170358, "episode_len_mean": 692.61, "episodes_total": 2078, "time_total_s": 3245.644519805908, "episode_reward_mean": 1176.8137369500807, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 45.00108098983765, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5837f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583198>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 70, "date": "2019-05-20_05-27-34", "timesteps_since_restore": 4170358, "timesteps_this_iter": 56710, "custom_metrics": {"system_level_velocity_min": 9.0827040486317, "outflow_rate_max": 1153.1438257771717, "outflow_rate_min": 462.5306177284606, "outflow_rate_mean": 1041.9631140140855, "cost1_min": 13.040540998820715, "cost2_min": -95.54955073116483, "cost1_max": 444.78715032544005, "cost1_mean": 372.2738396369434, "cost2_max": -8.75169333416378, "system_level_velocity_mean": 14.336926137027897, "cost2_mean": -45.141792692705764, "system_level_velocity_max": 17.019468993480956}, "episode_reward_min": 35.26537879894691, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 71, "episodes_this_iter": 30, "timestamp": 1558330099, "episode_reward_max": 1308.7427196836331, "info": {"load_time_ms": 7.952, "default": {"vf_loss": 48.23734664916992, "entropy": 1.4467718601226807, "total_loss": 48.2287483215332, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012570442631840706, "vf_explained_var": 0.7482652068138123, "cur_lr": 0.0005000000237487257, "kl": 0.017631638795137405}, "num_steps_trained": 4228800, "grad_time_ms": 14814.483, "num_steps_sampled": 4228800, "sample_time_ms": 30886.863, "update_time_ms": 8.793}, "time_since_restore": 3290.3998987674713, "timesteps_total": 4228800, "episode_len_mean": 699.41, "episodes_total": 2108, "time_total_s": 3290.3998987674713, "episode_reward_mean": 1176.6492157466635, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.75537896156311, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5866d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586588>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 71, "date": "2019-05-20_05-28-19", "timesteps_since_restore": 4228800, "timesteps_this_iter": 58442, "custom_metrics": {"system_level_velocity_min": 9.0827040486317, "outflow_rate_max": 1153.1438257771717, "outflow_rate_min": 865.3031540965492, "outflow_rate_mean": 1041.4467641540657, "cost1_min": 232.04959166423657, "cost2_min": -95.54955073116483, "cost1_max": 444.78715032544005, "cost1_mean": 371.2778909976637, "cost2_max": -17.932350416343656, "system_level_velocity_mean": 14.151529588880697, "cost2_mean": -47.64239769833332, "system_level_velocity_max": 17.019468993480956}, "episode_reward_min": 976.3590154114987, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 72, "episodes_this_iter": 31, "timestamp": 1558330143, "episode_reward_max": 1275.3506308970618, "info": {"load_time_ms": 7.712, "default": {"vf_loss": 52.7824821472168, "entropy": 1.459299087524414, "total_loss": 52.77518081665039, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.011706146411597729, "vf_explained_var": 0.7161489725112915, "cur_lr": 0.0005000000237487257, "kl": 0.019566696137189865}, "num_steps_trained": 4285219, "grad_time_ms": 14682.038, "num_steps_sampled": 4285219, "sample_time_ms": 30915.407, "update_time_ms": 8.803}, "time_since_restore": 3334.4913046360016, "timesteps_total": 4285219, "episode_len_mean": 690.89, "episodes_total": 2139, "time_total_s": 3334.4913046360016, "episode_reward_mean": 1153.5612494061345, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.09140586853027, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560748>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 72, "date": "2019-05-20_05-29-03", "timesteps_since_restore": 4285219, "timesteps_this_iter": 56419, "custom_metrics": {"system_level_velocity_min": 9.0827040486317, "outflow_rate_max": 1146.575612611842, "outflow_rate_min": 499.05987396576205, "outflow_rate_mean": 1031.6093464310177, "cost1_min": 23.123989512162154, "cost2_min": -96.28626697079811, "cost1_max": 438.8232785155533, "cost1_mean": 362.8722317320415, "cost2_max": -11.911503512523318, "system_level_velocity_mean": 14.074468410770123, "cost2_mean": -48.72573535078537, "system_level_velocity_max": 18.738614546175235}, "episode_reward_min": 64.00626928591657, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 73, "episodes_this_iter": 31, "timestamp": 1558330188, "episode_reward_max": 1277.1268756993315, "info": {"load_time_ms": 7.727, "default": {"vf_loss": 52.217105865478516, "entropy": 1.4697152376174927, "total_loss": 52.208770751953125, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01278047077357769, "vf_explained_var": 0.7157996892929077, "cur_lr": 0.0005000000237487257, "kl": 0.01978340744972229}, "num_steps_trained": 4341323, "grad_time_ms": 14653.673, "num_steps_sampled": 4341323, "sample_time_ms": 30939.386, "update_time_ms": 8.277}, "time_since_restore": 3379.027142047882, "timesteps_total": 4341323, "episode_len_mean": 677.47, "episodes_total": 2170, "time_total_s": 3379.027142047882, "episode_reward_mean": 1131.2127708547946, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.53583741188049, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ae48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57acc0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 73, "date": "2019-05-20_05-29-48", "timesteps_since_restore": 4341323, "timesteps_this_iter": 56104, "custom_metrics": {"system_level_velocity_min": 9.546805616118691, "outflow_rate_max": 1138.697673319353, "outflow_rate_min": 472.5580275473099, "outflow_rate_mean": 1021.0464602373958, "cost1_min": 16.47631216412443, "cost2_min": -96.28626697079811, "cost1_max": 438.8232785155533, "cost1_mean": 358.26400246242906, "cost2_max": -11.911503512523318, "system_level_velocity_mean": 14.25729116009638, "cost2_mean": -46.973408258378115, "system_level_velocity_max": 18.738614546175235}, "episode_reward_min": 39.68974063806885, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 74, "episodes_this_iter": 32, "timestamp": 1558330232, "episode_reward_max": 1279.7234142427913, "info": {"load_time_ms": 7.946, "default": {"vf_loss": 54.65352249145508, "entropy": 1.4893072843551636, "total_loss": 54.64421081542969, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.013781316578388214, "vf_explained_var": 0.7155877351760864, "cur_lr": 0.0005000000237487257, "kl": 0.019850561395287514}, "num_steps_trained": 4397350, "grad_time_ms": 14668.401, "num_steps_sampled": 4397350, "sample_time_ms": 30731.592, "update_time_ms": 8.274}, "time_since_restore": 3423.272702932358, "timesteps_total": 4397350, "episode_len_mean": 676.06, "episodes_total": 2202, "time_total_s": 3423.272702932358, "episode_reward_mean": 1131.0118147532637, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.24556088447571, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558438>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 74, "date": "2019-05-20_05-30-32", "timesteps_since_restore": 4397350, "timesteps_this_iter": 56027, "custom_metrics": {"system_level_velocity_min": 9.546805616118691, "outflow_rate_max": 1170.4795718215055, "outflow_rate_min": 472.5580275473099, "outflow_rate_mean": 1028.5358151379241, "cost1_min": 16.47631216412443, "cost2_min": -96.28626697079811, "cost1_max": 452.3856474632436, "cost1_mean": 366.18703547809497, "cost2_max": -11.911503512523318, "system_level_velocity_mean": 14.57945107181796, "cost2_mean": -43.10268306290109, "system_level_velocity_max": 18.738614546175235}, "episode_reward_min": 39.68974063806885, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 75, "episodes_this_iter": 32, "timestamp": 1558330275, "episode_reward_max": 1290.885561197986, "info": {"load_time_ms": 8.038, "default": {"vf_loss": 60.86640167236328, "entropy": 1.4905869960784912, "total_loss": 60.85847473144531, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011983877047896385, "vf_explained_var": 0.6299576163291931, "cur_lr": 0.0005000000237487257, "kl": 0.018043432384729385}, "num_steps_trained": 4452498, "grad_time_ms": 14528.654, "num_steps_sampled": 4452498, "sample_time_ms": 30511.926, "update_time_ms": 8.4}, "time_since_restore": 3466.496299266815, "timesteps_total": 4452498, "episode_len_mean": 678.64, "episodes_total": 2234, "time_total_s": 3466.496299266815, "episode_reward_mean": 1144.1536189527853, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.2235963344574, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c5c0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 75, "date": "2019-05-20_05-31-15", "timesteps_since_restore": 4452498, "timesteps_this_iter": 55148, "custom_metrics": {"system_level_velocity_min": 10.712977395193038, "outflow_rate_max": 1170.4795718215055, "outflow_rate_min": 472.5580275473099, "outflow_rate_mean": 1037.337828571989, "cost1_min": 16.47631216412443, "cost2_min": -83.56179286073369, "cost1_max": 452.3856474632436, "cost1_mean": 377.3978389039752, "cost2_max": -12.09476524098015, "system_level_velocity_mean": 14.938859427218429, "cost2_mean": -38.331916818870106, "system_level_velocity_max": 18.867045118745942}, "episode_reward_min": 39.68974063806885, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 76, "episodes_this_iter": 31, "timestamp": 1558330319, "episode_reward_max": 1290.885561197986, "info": {"load_time_ms": 7.875, "default": {"vf_loss": 55.45492935180664, "entropy": 1.4950270652770996, "total_loss": 55.4451904296875, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.014120213687419891, "vf_explained_var": 0.6946750283241272, "cur_lr": 0.0005000000237487257, "kl": 0.019499287009239197}, "num_steps_trained": 4506502, "grad_time_ms": 14302.62, "num_steps_sampled": 4506502, "sample_time_ms": 30382.287, "update_time_ms": 8.377}, "time_since_restore": 3510.3305764198303, "timesteps_total": 4506502, "episode_len_mean": 678.68, "episodes_total": 2265, "time_total_s": 3510.3305764198303, "episode_reward_mean": 1144.91747005723, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 43.83427715301514, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5834e0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 76, "date": "2019-05-20_05-31-59", "timesteps_since_restore": 4506502, "timesteps_this_iter": 54004, "custom_metrics": {"system_level_velocity_min": 10.52755975096148, "outflow_rate_max": 1170.4795718215055, "outflow_rate_min": 472.5580275473099, "outflow_rate_mean": 1040.0756780715403, "cost1_min": 16.47631216412443, "cost2_min": -83.51400744608682, "cost1_max": 452.3856474632436, "cost1_mean": 378.59206026063407, "cost2_max": -9.661736301869173, "system_level_velocity_mean": 14.95548308380668, "cost2_mean": -37.79668381245925, "system_level_velocity_max": 18.867045118745942}, "episode_reward_min": 39.68974063806885, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 77, "episodes_this_iter": 28, "timestamp": 1558330361, "episode_reward_max": 1290.885561197986, "info": {"load_time_ms": 7.628, "default": {"vf_loss": 52.783531188964844, "entropy": 1.5120129585266113, "total_loss": 52.7756462097168, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.011911140754818916, "vf_explained_var": 0.7146652936935425, "cur_lr": 0.0005000000237487257, "kl": 0.017893118783831596}, "num_steps_trained": 4560449, "grad_time_ms": 14128.696, "num_steps_sampled": 4560449, "sample_time_ms": 30190.975, "update_time_ms": 8.357}, "time_since_restore": 3552.135026216507, "timesteps_total": 4560449, "episode_len_mean": 686.84, "episodes_total": 2293, "time_total_s": 3552.135026216507, "episode_reward_mean": 1156.9788319917216, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.804449796676636, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5605f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606d8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 77, "date": "2019-05-20_05-32-41", "timesteps_since_restore": 4560449, "timesteps_this_iter": 53947, "custom_metrics": {"system_level_velocity_min": 10.52755975096148, "outflow_rate_max": 1200.0986966163102, "outflow_rate_min": 488.9277652966029, "outflow_rate_mean": 1044.9132280174988, "cost1_min": 24.129415748042817, "cost2_min": -83.51400744608682, "cost1_max": 444.7741530846034, "cost1_mean": 385.09113054622054, "cost2_max": -9.661736301869173, "system_level_velocity_mean": 14.991471152593185, "cost2_mean": -36.67588816715261, "system_level_velocity_max": 18.867045118745942}, "episode_reward_min": 62.36728259594365, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 78, "episodes_this_iter": 32, "timestamp": 1558330402, "episode_reward_max": 1284.9192670695409, "info": {"load_time_ms": 7.599, "default": {"vf_loss": 55.58854293823242, "entropy": 1.493169903755188, "total_loss": 55.58039093017578, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.01212593074887991, "vf_explained_var": 0.6756054759025574, "cur_lr": 0.0005000000237487257, "kl": 0.017641756683588028}, "num_steps_trained": 4615007, "grad_time_ms": 13981.508, "num_steps_sampled": 4615007, "sample_time_ms": 29723.96, "update_time_ms": 8.05}, "time_since_restore": 3592.903612613678, "timesteps_total": 4615007, "episode_len_mean": 693.37, "episodes_total": 2325, "time_total_s": 3592.903612613678, "episode_reward_mean": 1158.4199865509672, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 40.76858639717102, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c860>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 78, "date": "2019-05-20_05-33-22", "timesteps_since_restore": 4615007, "timesteps_this_iter": 54558, "custom_metrics": {"system_level_velocity_min": 6.839886391188367, "outflow_rate_max": 1200.0986966163102, "outflow_rate_min": 488.9277652966029, "outflow_rate_mean": 1039.0204420480572, "cost1_min": 24.129415748042817, "cost2_min": -83.51400744608682, "cost1_max": 444.7741530846034, "cost1_mean": 383.0120845284457, "cost2_max": -9.661736301869173, "system_level_velocity_mean": 14.738955239322056, "cost2_mean": -38.25101940962405, "system_level_velocity_max": 18.41125667731264}, "episode_reward_min": 62.36728259594365, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 79, "episodes_this_iter": 28, "timestamp": 1558330443, "episode_reward_max": 1263.1388001962503, "info": {"load_time_ms": 7.413, "default": {"vf_loss": 48.39118957519531, "entropy": 1.4998990297317505, "total_loss": 48.38161849975586, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.013739867135882378, "vf_explained_var": 0.7066877484321594, "cur_lr": 0.0005000000237487257, "kl": 0.018521487712860107}, "num_steps_trained": 4669069, "grad_time_ms": 13825.857, "num_steps_sampled": 4669069, "sample_time_ms": 29397.423, "update_time_ms": 7.632}, "time_since_restore": 3633.9709537029266, "timesteps_total": 4669069, "episode_len_mean": 693.37, "episodes_total": 2353, "time_total_s": 3633.9709537029266, "episode_reward_mean": 1140.282504809136, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.06734108924866, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ba90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bbe0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 79, "date": "2019-05-20_05-34-03", "timesteps_since_restore": 4669069, "timesteps_this_iter": 54062, "custom_metrics": {"system_level_velocity_min": 6.839886391188367, "outflow_rate_max": 1200.0986966163102, "outflow_rate_min": 488.9277652966029, "outflow_rate_mean": 1028.4566667698798, "cost1_min": 24.129415748042817, "cost2_min": -83.51400744608682, "cost1_max": 444.7741530846034, "cost1_mean": 374.75752815954576, "cost2_max": -9.661736301869173, "system_level_velocity_mean": 14.438869897088768, "cost2_mean": -40.48160473539895, "system_level_velocity_max": 18.41125667731264}, "episode_reward_min": 62.36728259594365, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 80, "episodes_this_iter": 33, "timestamp": 1558330484, "episode_reward_max": 1263.1388001962503, "info": {"load_time_ms": 7.353, "default": {"vf_loss": 58.14632034301758, "entropy": 1.5032941102981567, "total_loss": 58.13771057128906, "cur_kl_coeff": 0.22499996423721313, "policy_loss": -0.013188390992581844, "vf_explained_var": 0.584733784198761, "cur_lr": 0.0005000000237487257, "kl": 0.02034331113100052}, "num_steps_trained": 4722020, "grad_time_ms": 13561.87, "num_steps_sampled": 4722020, "sample_time_ms": 29238.828, "update_time_ms": 7.472}, "time_since_restore": 3674.737396001816, "timesteps_total": 4722020, "episode_len_mean": 693.34, "episodes_total": 2386, "time_total_s": 3674.737396001816, "episode_reward_mean": 1130.728739644532, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 40.76644229888916, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583828>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 80, "date": "2019-05-20_05-34-44", "timesteps_since_restore": 4722020, "timesteps_this_iter": 52951, "custom_metrics": {"system_level_velocity_min": 6.839886391188367, "outflow_rate_max": 1154.7942104492276, "outflow_rate_min": 454.96523976538253, "outflow_rate_mean": 1024.031285343673, "cost1_min": 21.46187334145974, "cost2_min": -74.46843192718015, "cost1_max": 446.6912153163074, "cost1_mean": 376.55258852679077, "cost2_max": -9.324647674199204, "system_level_velocity_mean": 14.527430863444573, "cost2_mean": -39.67209893894255, "system_level_velocity_max": 17.533695253729658}, "episode_reward_min": 61.62715527984502, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 81, "episodes_this_iter": 34, "timestamp": 1558330524, "episode_reward_max": 1243.0566581422886, "info": {"load_time_ms": 7.064, "default": {"vf_loss": 59.99641418457031, "entropy": 1.519361138343811, "total_loss": 59.988555908203125, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.012762143276631832, "vf_explained_var": 0.48680803179740906, "cur_lr": 0.0005000000237487257, "kl": 0.014533184468746185}, "num_steps_trained": 4773367, "grad_time_ms": 13516.174, "num_steps_sampled": 4773367, "sample_time_ms": 28835.905, "update_time_ms": 7.423}, "time_since_restore": 3714.991174697876, "timesteps_total": 4773367, "episode_len_mean": 693.34, "episodes_total": 2420, "time_total_s": 3714.991174697876, "episode_reward_mean": 1133.7670596213313, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 40.25377869606018, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558c18>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 81, "date": "2019-05-20_05-35-24", "timesteps_since_restore": 4773367, "timesteps_this_iter": 51347, "custom_metrics": {"system_level_velocity_min": 10.223314376313063, "outflow_rate_max": 1154.7942104492276, "outflow_rate_min": 454.96523976538253, "outflow_rate_mean": 1034.5399470406444, "cost1_min": 21.46187334145974, "cost2_min": -74.46843192718015, "cost1_max": 446.6912153163074, "cost1_mean": 385.43672600706685, "cost2_max": -9.324647674199204, "system_level_velocity_mean": 14.875026917002458, "cost2_mean": -38.05828306677718, "system_level_velocity_max": 17.533695253729658}, "episode_reward_min": 61.62715527984502, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 82, "episodes_this_iter": 30, "timestamp": 1558330566, "episode_reward_max": 1272.3807031878093, "info": {"load_time_ms": 6.994, "default": {"vf_loss": 56.534698486328125, "entropy": 1.5223193168640137, "total_loss": 56.52769470214844, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.011885006912052631, "vf_explained_var": 0.5900580883026123, "cur_lr": 0.0005000000237487257, "kl": 0.014439307153224945}, "num_steps_trained": 4826079, "grad_time_ms": 13620.965, "num_steps_sampled": 4826079, "sample_time_ms": 28536.464, "update_time_ms": 7.522}, "time_since_restore": 3757.1645555496216, "timesteps_total": 4826079, "episode_len_mean": 693.34, "episodes_total": 2450, "time_total_s": 3757.1645555496216, "episode_reward_mean": 1148.0988008829343, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.173380851745605, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a58>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 82, "date": "2019-05-20_05-36-06", "timesteps_since_restore": 4826079, "timesteps_this_iter": 52712, "custom_metrics": {"system_level_velocity_min": 10.223314376313063, "outflow_rate_max": 1154.7942104492276, "outflow_rate_min": 454.96523976538253, "outflow_rate_mean": 1043.7343245057598, "cost1_min": 21.46187334145974, "cost2_min": -74.46843192718015, "cost1_max": 450.1604587071929, "cost1_mean": 394.73984586105166, "cost2_max": -9.324647674199204, "system_level_velocity_mean": 15.231825249270955, "cost2_mean": -35.49585162640266, "system_level_velocity_max": 17.533695253729658}, "episode_reward_min": 61.62715527984502, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 83, "episodes_this_iter": 31, "timestamp": 1558330613, "episode_reward_max": 1272.3807031878093, "info": {"load_time_ms": 6.991, "default": {"vf_loss": 52.25067901611328, "entropy": 1.5087610483169556, "total_loss": 52.243595123291016, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.0118461474776268, "vf_explained_var": 0.6890954375267029, "cur_lr": 0.0005000000237487257, "kl": 0.014135639183223248}, "num_steps_trained": 4882258, "grad_time_ms": 13980.788, "num_steps_sampled": 4882258, "sample_time_ms": 28415.73, "update_time_ms": 7.636}, "time_since_restore": 3804.108297586441, "timesteps_total": 4882258, "episode_len_mean": 693.43, "episodes_total": 2481, "time_total_s": 3804.108297586441, "episode_reward_mean": 1150.3073501920908, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 46.94374203681946, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5839e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c50>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 83, "date": "2019-05-20_05-36-53", "timesteps_since_restore": 4882258, "timesteps_this_iter": 56179, "custom_metrics": {"system_level_velocity_min": 10.002508104161388, "outflow_rate_max": 1131.791705867654, "outflow_rate_min": 525.6482277765418, "outflow_rate_mean": 1047.999577276143, "cost1_min": 28.677610756530985, "cost2_min": -81.41239352733396, "cost1_max": 450.1604587071929, "cost1_mean": 394.67012518145617, "cost2_max": -11.56874163886943, "system_level_velocity_mean": 15.243506293066908, "cost2_mean": -35.76930640598528, "system_level_velocity_max": 18.89607097345339}, "episode_reward_min": 73.73146155505803, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 84, "episodes_this_iter": 30, "timestamp": 1558330654, "episode_reward_max": 1272.3807031878093, "info": {"load_time_ms": 7.009, "default": {"vf_loss": 51.64108657836914, "entropy": 1.516371726989746, "total_loss": 51.63238525390625, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01358072366565466, "vf_explained_var": 0.6313296556472778, "cur_lr": 0.0005000000237487257, "kl": 0.014448865316808224}, "num_steps_trained": 4935194, "grad_time_ms": 14003.525, "num_steps_sampled": 4935194, "sample_time_ms": 28024.046, "update_time_ms": 7.885}, "time_since_restore": 3844.681431531906, "timesteps_total": 4935194, "episode_len_mean": 693.43, "episodes_total": 2511, "time_total_s": 3844.681431531906, "episode_reward_mean": 1157.8610633218104, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 40.57313394546509, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c470>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 84, "date": "2019-05-20_05-37-34", "timesteps_since_restore": 4935194, "timesteps_this_iter": 52936, "custom_metrics": {"system_level_velocity_min": 10.002508104161388, "outflow_rate_max": 1132.5534767705649, "outflow_rate_min": 525.6482277765418, "outflow_rate_mean": 1045.1088566070312, "cost1_min": 28.677610756530985, "cost2_min": -81.41239352733396, "cost1_max": 450.1604587071929, "cost1_mean": 394.1102191506398, "cost2_max": -11.56874163886943, "system_level_velocity_mean": 15.229077587384976, "cost2_mean": -35.672055891545966, "system_level_velocity_max": 18.89607097345339}, "episode_reward_min": 73.73146155505803, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 85, "episodes_this_iter": 32, "timestamp": 1558330695, "episode_reward_max": 1272.3807031878093, "info": {"load_time_ms": 6.974, "default": {"vf_loss": 53.38928985595703, "entropy": 1.5137660503387451, "total_loss": 53.38227081298828, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.011870574206113815, "vf_explained_var": 0.6797627806663513, "cur_lr": 0.0005000000237487257, "kl": 0.014372576959431171}, "num_steps_trained": 4989591, "grad_time_ms": 13832.976, "num_steps_sampled": 4989591, "sample_time_ms": 28041.438, "update_time_ms": 8.001}, "time_since_restore": 3886.357965707779, "timesteps_total": 4989591, "episode_len_mean": 693.43, "episodes_total": 2543, "time_total_s": 3886.357965707779, "episode_reward_mean": 1148.640310751045, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.6765341758728, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5830b8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 85, "date": "2019-05-20_05-38-15", "timesteps_since_restore": 4989591, "timesteps_this_iter": 54397, "custom_metrics": {"system_level_velocity_min": 10.002508104161388, "outflow_rate_max": 1154.711837567864, "outflow_rate_min": 525.6482277765418, "outflow_rate_mean": 1043.1818691679475, "cost1_min": 28.677610756530985, "cost2_min": -81.41239352733396, "cost1_max": 451.40491674326324, "cost1_mean": 391.6383107935882, "cost2_max": -11.56874163886943, "system_level_velocity_mean": 15.146518203834184, "cost2_mean": -36.65723824088113, "system_level_velocity_max": 18.89607097345339}, "episode_reward_min": 73.73146155505803, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 86, "episodes_this_iter": 30, "timestamp": 1558330738, "episode_reward_max": 1246.6491834756553, "info": {"load_time_ms": 6.953, "default": {"vf_loss": 53.853904724121094, "entropy": 1.51594078540802, "total_loss": 53.84730529785156, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01127668283879757, "vf_explained_var": 0.6026037335395813, "cur_lr": 0.0005000000237487257, "kl": 0.013845575973391533}, "num_steps_trained": 5040941, "grad_time_ms": 13611.254, "num_steps_sampled": 5040941, "sample_time_ms": 28092.233, "update_time_ms": 7.864}, "time_since_restore": 3928.472644805908, "timesteps_total": 5040941, "episode_len_mean": 700.0, "episodes_total": 2573, "time_total_s": 3928.472644805908, "episode_reward_mean": 1157.8186453990818, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.11467909812927, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ba90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c780>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 86, "date": "2019-05-20_05-38-58", "timesteps_since_restore": 5040941, "timesteps_this_iter": 51350, "custom_metrics": {"system_level_velocity_min": 10.769528877311137, "outflow_rate_max": 1156.2569259382356, "outflow_rate_min": 906.3402847887573, "outflow_rate_mean": 1044.9853962311895, "cost1_min": 280.39532213152665, "cost2_min": -81.41239352733396, "cost1_max": 451.40491674326324, "cost1_mean": 396.0273618683393, "cost2_max": -13.899838230167502, "system_level_velocity_mean": 15.157273454365454, "cost2_mean": -37.21430079303583, "system_level_velocity_max": 17.55765153854184}, "episode_reward_min": 1012.097360669711, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 87, "episodes_this_iter": 31, "timestamp": 1558330780, "episode_reward_max": 1242.9296707199671, "info": {"load_time_ms": 7.042, "default": {"vf_loss": 56.906471252441406, "entropy": 1.5055279731750488, "total_loss": 56.901241302490234, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01023403462022543, "vf_explained_var": 0.6584894061088562, "cur_lr": 0.0005000000237487257, "kl": 0.014813642017543316}, "num_steps_trained": 5094968, "grad_time_ms": 13638.968, "num_steps_sampled": 5094968, "sample_time_ms": 28100.677, "update_time_ms": 7.842}, "time_since_restore": 3970.627143383026, "timesteps_total": 5094968, "episode_len_mean": 700.0, "episodes_total": 2604, "time_total_s": 3970.627143383026, "episode_reward_mean": 1145.9995048107846, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.15449857711792, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e400>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 87, "date": "2019-05-20_05-39-40", "timesteps_since_restore": 5094968, "timesteps_this_iter": 54027, "custom_metrics": {"system_level_velocity_min": 11.120443795255492, "outflow_rate_max": 1156.2569259382356, "outflow_rate_min": 922.377592822799, "outflow_rate_mean": 1046.5058800210065, "cost1_min": 288.8400390942975, "cost2_min": -100.89235159606858, "cost1_max": 451.40491674326324, "cost1_mean": 395.81276080406604, "cost2_max": -14.376684383074565, "system_level_velocity_mean": 15.175181138091268, "cost2_mean": -38.66339297354589, "system_level_velocity_max": 17.55765153854184}, "episode_reward_min": 1012.097360669711, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 88, "episodes_this_iter": 31, "timestamp": 1558330819, "episode_reward_max": 1242.9296707199671, "info": {"load_time_ms": 7.056, "default": {"vf_loss": 56.90761947631836, "entropy": 1.5147510766983032, "total_loss": 56.89900588989258, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.014002290554344654, "vf_explained_var": 0.6414451003074646, "cur_lr": 0.0005000000237487257, "kl": 0.015963103622198105}, "num_steps_trained": 5147709, "grad_time_ms": 13675.549, "num_steps_sampled": 5147709, "sample_time_ms": 27894.549, "update_time_ms": 7.972}, "time_since_restore": 4009.7027826309204, "timesteps_total": 5147709, "episode_len_mean": 700.0, "episodes_total": 2635, "time_total_s": 4009.7027826309204, "episode_reward_mean": 1135.8713305761455, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 39.07563924789429, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5838d0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 88, "date": "2019-05-20_05-40-19", "timesteps_since_restore": 5147709, "timesteps_this_iter": 52741, "custom_metrics": {"system_level_velocity_min": 10.415997912733543, "outflow_rate_max": 1156.2569259382356, "outflow_rate_min": 899.0385391467519, "outflow_rate_mean": 1039.4700586656108, "cost1_min": 270.0737245968371, "cost2_min": -100.89235159606858, "cost1_max": 449.6866306066339, "cost1_mean": 391.37764230512965, "cost2_max": -15.733431440287251, "system_level_velocity_mean": 15.04609515625636, "cost2_mean": -40.28195651271963, "system_level_velocity_max": 17.547130760138106}, "episode_reward_min": 981.257129791936, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 89, "episodes_this_iter": 32, "timestamp": 1558330860, "episode_reward_max": 1227.2885304337435, "info": {"load_time_ms": 7.302, "default": {"vf_loss": 50.051780700683594, "entropy": 1.5194133520126343, "total_loss": 50.0428466796875, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014124364592134953, "vf_explained_var": 0.7071338891983032, "cur_lr": 0.0005000000237487257, "kl": 0.015377688221633434}, "num_steps_trained": 5200927, "grad_time_ms": 13771.389, "num_steps_sampled": 5200927, "sample_time_ms": 27810.025, "update_time_ms": 8.115}, "time_since_restore": 4050.9027976989746, "timesteps_total": 5200927, "episode_len_mean": 700.0, "episodes_total": 2667, "time_total_s": 4050.9027976989746, "episode_reward_mean": 1130.022969655702, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.2000150680542, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590748>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 89, "date": "2019-05-20_05-41-00", "timesteps_since_restore": 5200927, "timesteps_this_iter": 53218, "custom_metrics": {"system_level_velocity_min": 10.415997912733543, "outflow_rate_max": 1138.9497651322874, "outflow_rate_min": 888.9367096557608, "outflow_rate_mean": 1038.71567667272, "cost1_min": 270.0737245968371, "cost2_min": -100.89235159606858, "cost1_max": 449.6866306066339, "cost1_mean": 391.22483185657745, "cost2_max": -15.733431440287251, "system_level_velocity_mean": 15.071182432549211, "cost2_mean": -41.71300331428372, "system_level_velocity_max": 17.547130760138106}, "episode_reward_min": 981.257129791936, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 90, "episodes_this_iter": 32, "timestamp": 1558330899, "episode_reward_max": 1227.2885304337435, "info": {"load_time_ms": 7.239, "default": {"vf_loss": 60.954681396484375, "entropy": 1.5377792119979858, "total_loss": 60.94773483276367, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.012247840873897076, "vf_explained_var": 0.5823726058006287, "cur_lr": 0.0005000000237487257, "kl": 0.015735870227217674}, "num_steps_trained": 5251201, "grad_time_ms": 13818.247, "num_steps_sampled": 5251201, "sample_time_ms": 27576.291, "update_time_ms": 8.249}, "time_since_restore": 4089.807427406311, "timesteps_total": 5251201, "episode_len_mean": 691.7, "episodes_total": 2699, "time_total_s": 4089.807427406311, "episode_reward_mean": 1117.1935418652713, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 38.904629707336426, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583908>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 90, "date": "2019-05-20_05-41-39", "timesteps_since_restore": 5251201, "timesteps_this_iter": 50274, "custom_metrics": {"system_level_velocity_min": 10.415997912733543, "outflow_rate_max": 1141.5051897715828, "outflow_rate_min": 484.23851738805604, "outflow_rate_mean": 1035.4183053734214, "cost1_min": 20.214228702853596, "cost2_min": -100.89235159606858, "cost1_max": 446.1965964485121, "cost1_mean": 389.8097140561907, "cost2_max": -14.31353318367123, "system_level_velocity_mean": 15.240972859059932, "cost2_mean": -40.174809156307994, "system_level_velocity_max": 18.02256503615775}, "episode_reward_min": 48.00854290167335, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 91, "episodes_this_iter": 34, "timestamp": 1558330942, "episode_reward_max": 1237.6870644859157, "info": {"load_time_ms": 7.338, "default": {"vf_loss": 67.02495574951172, "entropy": 1.53380286693573, "total_loss": 67.01998138427734, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.010480159893631935, "vf_explained_var": 0.4957270622253418, "cur_lr": 0.0005000000237487257, "kl": 0.0162949375808239}, "num_steps_trained": 5301626, "grad_time_ms": 13912.217, "num_steps_sampled": 5301626, "sample_time_ms": 27741.776, "update_time_ms": 8.398}, "time_since_restore": 4132.68850851059, "timesteps_total": 5301626, "episode_len_mean": 685.11, "episodes_total": 2733, "time_total_s": 4132.68850851059, "episode_reward_mean": 1111.7511988212775, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.881081104278564, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0eac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0ea20>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 91, "date": "2019-05-20_05-42-22", "timesteps_since_restore": 5301626, "timesteps_this_iter": 50425, "custom_metrics": {"system_level_velocity_min": 10.581988791266296, "outflow_rate_max": 1155.0193256978694, "outflow_rate_min": 481.23106320046185, "outflow_rate_mean": 1036.8406603103156, "cost1_min": 20.214228702853596, "cost2_min": -90.20596098477778, "cost1_max": 445.31883948310707, "cost1_mean": 394.04676388921393, "cost2_max": -14.31353318367123, "system_level_velocity_mean": 15.576400344990299, "cost2_mean": -37.08802221593436, "system_level_velocity_max": 18.193195552358407}, "episode_reward_min": 48.00854290167335, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 92, "episodes_this_iter": 30, "timestamp": 1558330984, "episode_reward_max": 1237.6870644859157, "info": {"load_time_ms": 7.497, "default": {"vf_loss": 52.08883285522461, "entropy": 1.5354059934616089, "total_loss": 52.08100128173828, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.012826713733375072, "vf_explained_var": 0.6842144727706909, "cur_lr": 0.0005000000237487257, "kl": 0.014802047982811928}, "num_steps_trained": 5354524, "grad_time_ms": 13963.832, "num_steps_sampled": 5354524, "sample_time_ms": 27662.791, "update_time_ms": 8.442}, "time_since_restore": 4174.585868597031, "timesteps_total": 5354524, "episode_len_mean": 685.11, "episodes_total": 2763, "time_total_s": 4174.585868597031, "episode_reward_mean": 1114.5192333607367, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.89736008644104, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5904a8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 92, "date": "2019-05-20_05-43-04", "timesteps_since_restore": 5354524, "timesteps_this_iter": 52898, "custom_metrics": {"system_level_velocity_min": 10.85989093586767, "outflow_rate_max": 1155.0193256978694, "outflow_rate_min": 481.23106320046185, "outflow_rate_mean": 1041.4860804898087, "cost1_min": 20.214228702853596, "cost2_min": -79.98144292459855, "cost1_max": 446.520835793582, "cost1_mean": 395.0262356776319, "cost2_max": -14.31353318367123, "system_level_velocity_mean": 15.623626760862646, "cost2_mean": -36.53108471214795, "system_level_velocity_max": 18.193195552358407}, "episode_reward_min": 48.00854290167335, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 93, "episodes_this_iter": 31, "timestamp": 1558331025, "episode_reward_max": 1250.697676704885, "info": {"load_time_ms": 7.572, "default": {"vf_loss": 57.4972038269043, "entropy": 1.5332268476486206, "total_loss": 57.489383697509766, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.012889605946838856, "vf_explained_var": 0.6614376306533813, "cur_lr": 0.0005000000237487257, "kl": 0.015023695304989815}, "num_steps_trained": 5407745, "grad_time_ms": 13585.156, "num_steps_sampled": 5407745, "sample_time_ms": 27427.523, "update_time_ms": 8.308}, "time_since_restore": 4215.382867097855, "timesteps_total": 5407745, "episode_len_mean": 690.94, "episodes_total": 2794, "time_total_s": 4215.382867097855, "episode_reward_mean": 1130.157209109718, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 40.796998500823975, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583160>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 93, "date": "2019-05-20_05-43-45", "timesteps_since_restore": 5407745, "timesteps_this_iter": 53221, "custom_metrics": {"system_level_velocity_min": 10.85989093586767, "outflow_rate_max": 1158.12601644652, "outflow_rate_min": 481.23106320046185, "outflow_rate_mean": 1046.0554161033049, "cost1_min": 26.996716151063804, "cost2_min": -81.30297763084921, "cost1_max": 450.6199171224115, "cost1_mean": 393.99068978860697, "cost2_max": -14.672793999165323, "system_level_velocity_mean": 15.421210819902042, "cost2_mean": -39.648767992422876, "system_level_velocity_max": 18.193195552358407}, "episode_reward_min": 65.49337650472212, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 94, "episodes_this_iter": 34, "timestamp": 1558331067, "episode_reward_max": 1267.884561043565, "info": {"load_time_ms": 7.456, "default": {"vf_loss": 61.72053909301758, "entropy": 1.5536384582519531, "total_loss": 61.713321685791016, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.012452980503439903, "vf_explained_var": 0.6371937394142151, "cur_lr": 0.0005000000237487257, "kl": 0.015514169819653034}, "num_steps_trained": 5459535, "grad_time_ms": 13528.266, "num_steps_sampled": 5459535, "sample_time_ms": 27638.574, "update_time_ms": 8.345}, "time_since_restore": 4257.48139834404, "timesteps_total": 5459535, "episode_len_mean": 678.16, "episodes_total": 2828, "time_total_s": 4257.48139834404, "episode_reward_mean": 1117.5104683016493, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.0985312461853, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c50>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 94, "date": "2019-05-20_05-44-27", "timesteps_since_restore": 5459535, "timesteps_this_iter": 51790, "custom_metrics": {"system_level_velocity_min": 10.437706373139818, "outflow_rate_max": 1158.12601644652, "outflow_rate_min": 726.5439721221953, "outflow_rate_mean": 1046.6714852981597, "cost1_min": 84.91903009159965, "cost2_min": -81.30297763084921, "cost1_max": 454.3359083708455, "cost1_mean": 388.99558152237637, "cost2_max": -17.01255296699299, "system_level_velocity_mean": 15.546789922436693, "cost2_mean": -39.20754595203615, "system_level_velocity_max": 18.296703185662558}, "episode_reward_min": 213.13687344961093, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 95, "episodes_this_iter": 32, "timestamp": 1558331108, "episode_reward_max": 1267.884561043565, "info": {"load_time_ms": 7.512, "default": {"vf_loss": 63.51885223388672, "entropy": 1.5410374402999878, "total_loss": 63.512245178222656, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01176715549081564, "vf_explained_var": 0.6225488185882568, "cur_lr": 0.0005000000237487257, "kl": 0.015293695963919163}, "num_steps_trained": 5512694, "grad_time_ms": 13756.748, "num_steps_sampled": 5512694, "sample_time_ms": 27374.214, "update_time_ms": 8.206}, "time_since_restore": 4298.8087339401245, "timesteps_total": 5512694, "episode_len_mean": 672.65, "episodes_total": 2860, "time_total_s": 4298.8087339401245, "episode_reward_mean": 1113.0386761983195, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.327335596084595, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560f98>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 95, "date": "2019-05-20_05-45-08", "timesteps_since_restore": 5512694, "timesteps_this_iter": 53159, "custom_metrics": {"system_level_velocity_min": 10.437706373139818, "outflow_rate_max": 1158.12601644652, "outflow_rate_min": 726.5439721221953, "outflow_rate_mean": 1041.698968408683, "cost1_min": 84.91903009159965, "cost2_min": -81.30297763084921, "cost1_max": 454.3359083708455, "cost1_mean": 383.83884008311026, "cost2_max": -16.210617061890947, "system_level_velocity_mean": 15.485681017002895, "cost2_mean": -40.075712635495826, "system_level_velocity_max": 18.296703185662558}, "episode_reward_min": 213.13687344961093, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 96, "episodes_this_iter": 29, "timestamp": 1558331148, "episode_reward_max": 1267.884561043565, "info": {"load_time_ms": 7.299, "default": {"vf_loss": 51.92909622192383, "entropy": 1.565761685371399, "total_loss": 51.92113494873047, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.013197043910622597, "vf_explained_var": 0.6468349695205688, "cur_lr": 0.0005000000237487257, "kl": 0.015503285452723503}, "num_steps_trained": 5565822, "grad_time_ms": 13948.487, "num_steps_sampled": 5565822, "sample_time_ms": 26924.856, "update_time_ms": 8.415}, "time_since_restore": 4338.351872444153, "timesteps_total": 5565822, "episode_len_mean": 675.12, "episodes_total": 2889, "time_total_s": 4338.351872444153, "episode_reward_mean": 1109.1472850772734, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 39.54313850402832, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583908>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 96, "date": "2019-05-20_05-45-48", "timesteps_since_restore": 5565822, "timesteps_this_iter": 53128, "custom_metrics": {"system_level_velocity_min": 10.437706373139818, "outflow_rate_max": 1153.592814471409, "outflow_rate_min": 726.5439721221953, "outflow_rate_mean": 1040.4664375772088, "cost1_min": 84.91903009159965, "cost2_min": -79.6165624739369, "cost1_max": 454.3359083708455, "cost1_mean": 381.9166890111161, "cost2_max": -16.210617061890947, "system_level_velocity_mean": 15.354069948615352, "cost2_mean": -40.62749662377414, "system_level_velocity_max": 18.296703185662558}, "episode_reward_min": 213.13687344961093, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 97, "episodes_this_iter": 32, "timestamp": 1558331191, "episode_reward_max": 1267.884561043565, "info": {"load_time_ms": 7.283, "default": {"vf_loss": 53.65762710571289, "entropy": 1.5440309047698975, "total_loss": 53.64924621582031, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.013582514598965645, "vf_explained_var": 0.6826831102371216, "cur_lr": 0.0005000000237487257, "kl": 0.015393313020467758}, "num_steps_trained": 5620339, "grad_time_ms": 14005.471, "num_steps_sampled": 5620339, "sample_time_ms": 26946.995, "update_time_ms": 8.763}, "time_since_restore": 4381.300515413284, "timesteps_total": 5620339, "episode_len_mean": 689.71, "episodes_total": 2921, "time_total_s": 4381.300515413284, "episode_reward_mean": 1134.1829684952352, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 42.94864296913147, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5904a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ef0>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 97, "date": "2019-05-20_05-46-31", "timesteps_since_restore": 5620339, "timesteps_this_iter": 54517, "custom_metrics": {"system_level_velocity_min": 10.887852261794105, "outflow_rate_max": 1141.7713633461522, "outflow_rate_min": 736.9000340024213, "outflow_rate_mean": 1044.997374914369, "cost1_min": 98.03586770001553, "cost2_min": -79.6165624739369, "cost1_max": 450.1737163398283, "cost1_mean": 387.9444566474639, "cost2_max": -16.210617061890947, "system_level_velocity_mean": 15.226157781237427, "cost2_mean": -40.95482038149032, "system_level_velocity_max": 18.05314281129097}, "episode_reward_min": 249.94043566126845, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 98, "episodes_this_iter": 30, "timestamp": 1558331235, "episode_reward_max": 1241.9670355803148, "info": {"load_time_ms": 7.428, "default": {"vf_loss": 50.112213134765625, "entropy": 1.544318675994873, "total_loss": 50.10444259643555, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.012748997658491135, "vf_explained_var": 0.7230061292648315, "cur_lr": 0.0005000000237487257, "kl": 0.014748984947800636}, "num_steps_trained": 5674928, "grad_time_ms": 14055.286, "num_steps_sampled": 5674928, "sample_time_ms": 27422.568, "update_time_ms": 8.669}, "time_since_restore": 4425.652793645859, "timesteps_total": 5674928, "episode_len_mean": 699.7, "episodes_total": 2951, "time_total_s": 4425.652793645859, "episode_reward_mean": 1152.247708448642, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 44.35227823257446, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57be80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc88>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 98, "date": "2019-05-20_05-47-15", "timesteps_since_restore": 5674928, "timesteps_this_iter": 54589, "custom_metrics": {"system_level_velocity_min": 10.887852261794105, "outflow_rate_max": 1161.8727641870921, "outflow_rate_min": 910.7446975110406, "outflow_rate_mean": 1051.835436566956, "cost1_min": 278.51622983527056, "cost2_min": -80.98801849544819, "cost1_max": 450.1737163398283, "cost1_mean": 390.74473462602094, "cost2_max": -20.083804319144246, "system_level_velocity_mean": 15.054786245398402, "cost2_mean": -42.229521099337816, "system_level_velocity_max": 17.376994314868433}, "episode_reward_min": 1016.5428799047661, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 99, "episodes_this_iter": 29, "timestamp": 1558331277, "episode_reward_max": 1265.911183206054, "info": {"load_time_ms": 7.253, "default": {"vf_loss": 50.23325729370117, "entropy": 1.556750774383545, "total_loss": 50.22605514526367, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.012295003980398178, "vf_explained_var": 0.723883867263794, "cur_lr": 0.0005000000237487257, "kl": 0.015087340958416462}, "num_steps_trained": 5729272, "grad_time_ms": 13914.158, "num_steps_sampled": 5729272, "sample_time_ms": 27609.286, "update_time_ms": 8.615}, "time_since_restore": 4467.296563863754, "timesteps_total": 5729272, "episode_len_mean": 692.99, "episodes_total": 2980, "time_total_s": 4467.296563863754, "episode_reward_mean": 1142.2968436076542, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": false, "time_this_iter_s": 41.64377021789551, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5834e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583320>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 99, "date": "2019-05-20_05-47-57", "timesteps_since_restore": 5729272, "timesteps_this_iter": 54344, "custom_metrics": {"system_level_velocity_min": 10.887852261794105, "outflow_rate_max": 1163.1687575975939, "outflow_rate_min": 474.3327382057268, "outflow_rate_mean": 1045.3618954830004, "cost1_min": 18.99220098448852, "cost2_min": -80.98801849544819, "cost1_max": 446.2401422853941, "cost1_mean": 382.04951568613865, "cost2_max": -11.455999138175324, "system_level_velocity_mean": 14.882343936524363, "cost2_mean": -43.580453806660806, "system_level_velocity_max": 17.572866575846273}, "episode_reward_min": 45.48823412441272, "pid": 38332}
{"policy_reward_mean": {}, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "training_iteration": 100, "episodes_this_iter": 32, "timestamp": 1558331317, "episode_reward_max": 1265.911183206054, "info": {"load_time_ms": 7.312, "default": {"vf_loss": 52.65879440307617, "entropy": 1.5500073432922363, "total_loss": 52.65135192871094, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01280033215880394, "vf_explained_var": 0.6852619647979736, "cur_lr": 0.0005000000237487257, "kl": 0.01587211899459362}, "num_steps_trained": 5782229, "grad_time_ms": 13945.307, "num_steps_sampled": 5782229, "sample_time_ms": 27717.305, "update_time_ms": 8.781}, "time_since_restore": 4507.599587440491, "timesteps_total": 5782229, "episode_len_mean": 692.99, "episodes_total": 3012, "time_total_s": 4507.599587440491, "episode_reward_mean": 1148.0042010592817, "hostname": "flow-main", "experiment_id": "b6cb65543d2c44d2bf00a6a12153cbfe", "done": true, "time_this_iter_s": 40.30302357673645, "config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "gamma": 0.99, "use_gae": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "input": "sampler", "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b5f8>", "on_sample_end": null}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "simple_optimizer": false, "lambda": 0.97, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "channel_major": false, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true, "custom_options": {}, "grayscale": false, "lstm_cell_size": 256, "use_lstm": false, "custom_model": null, "lstm_use_prev_action_reward": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "clip_param": 0.3, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "iterations_since_restore": 100, "date": "2019-05-20_05-48-37", "timesteps_since_restore": 5782229, "timesteps_this_iter": 52957, "custom_metrics": {"system_level_velocity_min": 11.07630422892908, "outflow_rate_max": 1163.1687575975939, "outflow_rate_min": 474.3327382057268, "outflow_rate_mean": 1052.4654285993106, "cost1_min": 18.99220098448852, "cost2_min": -80.98801849544819, "cost1_max": 447.90130516303816, "cost1_mean": 382.8211342732777, "cost2_max": -11.455999138175324, "system_level_velocity_mean": 14.883292336358227, "cost2_mean": -44.28444932954414, "system_level_velocity_max": 17.572866575846273}, "episode_reward_min": 45.48823412441272, "pid": 38332}

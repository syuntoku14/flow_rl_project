{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a60b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a60f0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-39-24", "episodes_this_iter": 28, "timestamp": 1558327164, "episode_reward_max": 717.5420338714025, "num_metric_batches_dropped": 0, "time_since_restore": 48.16107749938965, "timesteps_total": 66690, "episode_len_mean": 676.3571428571429, "episodes_total": 28, "time_total_s": 48.16107749938965, "info": {"load_time_ms": 65.054, "default": {"vf_loss": 1.669408917427063, "total_loss": 1.6691396236419678, "entropy": 1.415703535079956, "policy_loss": -0.0007552675087936223, "cur_kl_coeff": 0.20000001788139343, "vf_explained_var": 0.8459355235099792, "cur_lr": 0.0005000000237487257, "kl": 0.0024300951045006514}, "num_steps_trained": 66690, "grad_time_ms": 16712.229, "num_steps_sampled": 66690, "sample_time_ms": 30669.436, "update_time_ms": 571.465}, "episode_reward_mean": 480.4177744900448, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.16107749938965, "iterations_since_restore": 1, "training_iteration": 1, "timesteps_since_restore": 66690, "timesteps_this_iter": 66690, "custom_metrics": {"system_level_velocity_min": 2.742894677806265, "outflow_rate_max": 823.6774343291083, "system_level_velocity_max": 18.116110124919278, "cost1_mean": 181.4069599347322, "outflow_rate_mean": 589.7953189641606, "cost1_min": 24.96259408143257, "cost2_min": -79.13005070107693, "cost1_max": 247.3569968081369, "outflow_rate_min": 251.08571564670095, "cost2_max": -22.516893736444555, "cost2_mean": -57.210295361911605, "system_level_velocity_mean": 7.627721731865928}, "episode_reward_min": 62.88134980067623, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5580f0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-40-14", "episodes_this_iter": 27, "timestamp": 1558327214, "episode_reward_max": 717.5420338714025, "num_metric_batches_dropped": 0, "time_since_restore": 98.29813432693481, "timesteps_total": 135729, "episode_len_mean": 687.9636363636364, "episodes_total": 55, "time_total_s": 98.29813432693481, "info": {"load_time_ms": 37.93, "default": {"vf_loss": 1.6051679849624634, "total_loss": 1.6033220291137695, "entropy": 1.397674560546875, "policy_loss": -0.002723574172705412, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9135147333145142, "cur_lr": 0.0005000000237487257, "kl": 0.008775976486504078}, "num_steps_trained": 135729, "grad_time_ms": 17271.675, "num_steps_sampled": 135729, "sample_time_ms": 31414.409, "update_time_ms": 288.956}, "episode_reward_mean": 482.1903827572879, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 50.137056827545166, "iterations_since_restore": 2, "training_iteration": 2, "timesteps_since_restore": 135729, "timesteps_this_iter": 69039, "custom_metrics": {"system_level_velocity_min": 2.5961281298992422, "outflow_rate_max": 823.6774343291083, "system_level_velocity_max": 18.116110124919278, "cost1_mean": 182.18499872507454, "outflow_rate_mean": 572.1634909353136, "cost1_min": 24.96259408143257, "cost2_min": -79.13005070107693, "cost1_max": 247.3569968081369, "outflow_rate_min": 224.72285802296133, "cost2_max": -22.516893736444555, "cost2_mean": -57.193888902113365, "system_level_velocity_mean": 7.362852679793986}, "episode_reward_min": 62.88134980067623, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f60>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-41-00", "episodes_this_iter": 27, "timestamp": 1558327260, "episode_reward_max": 718.91190722401, "num_metric_batches_dropped": 0, "time_since_restore": 143.50785613059998, "timesteps_total": 198508, "episode_len_mean": 691.9268292682926, "episodes_total": 82, "time_total_s": 143.50785613059998, "info": {"load_time_ms": 28.269, "default": {"vf_loss": 3.3256711959838867, "total_loss": 3.3209190368652344, "entropy": 1.3881746530532837, "policy_loss": -0.005877234041690826, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.9007534384727478, "cur_lr": 0.0005000000237487257, "kl": 0.011251518502831459}, "num_steps_trained": 198508, "grad_time_ms": 17212.076, "num_steps_sampled": 198508, "sample_time_ms": 30273.187, "update_time_ms": 195.132}, "episode_reward_mean": 519.7281130470502, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.20972180366516, "iterations_since_restore": 3, "training_iteration": 3, "timesteps_since_restore": 198508, "timesteps_this_iter": 62779, "custom_metrics": {"system_level_velocity_min": 2.5961281298992422, "outflow_rate_max": 823.6774343291083, "system_level_velocity_max": 18.116110124919278, "cost1_mean": 190.3267976693275, "outflow_rate_mean": 592.457975938246, "cost1_min": 24.96259408143257, "cost2_min": -79.13005070107693, "cost1_max": 253.09044240762753, "outflow_rate_min": 224.72285802296133, "cost2_max": -22.516893736444555, "cost2_mean": -58.85155881142301, "system_level_velocity_mean": 7.551668495849472}, "episode_reward_min": 62.88134980067623, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e80>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-41-49", "episodes_this_iter": 27, "timestamp": 1558327309, "episode_reward_max": 1025.7109815198187, "num_metric_batches_dropped": 0, "time_since_restore": 193.13036704063416, "timesteps_total": 264543, "episode_len_mean": 700.0, "episodes_total": 109, "time_total_s": 193.13036704063416, "info": {"load_time_ms": 23.369, "default": {"vf_loss": 6.120395183563232, "total_loss": 6.115226745605469, "entropy": 1.3847155570983887, "policy_loss": -0.006230637896806002, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.8854692578315735, "cur_lr": 0.0005000000237487257, "kl": 0.010623167268931866}, "num_steps_trained": 264543, "grad_time_ms": 17371.968, "num_steps_sampled": 264543, "sample_time_ms": 30614.173, "update_time_ms": 148.613}, "episode_reward_mean": 593.0624381550551, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 49.62251091003418, "iterations_since_restore": 4, "training_iteration": 4, "timesteps_since_restore": 264543, "timesteps_this_iter": 66035, "custom_metrics": {"system_level_velocity_min": 2.5961281298992422, "outflow_rate_max": 863.3071145248255, "system_level_velocity_max": 10.298958783573704, "cost1_mean": 201.64408249647997, "outflow_rate_mean": 622.8940038711249, "cost1_min": 66.54132244251288, "cost2_min": -113.40046603402851, "cost1_max": 273.32917272582677, "outflow_rate_min": 224.72285802296133, "cost2_max": -36.00190064865258, "cost2_mean": -65.88211665106213, "system_level_velocity_mean": 7.734908416674117}, "episode_reward_min": 326.51828811334644, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5b9710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560390>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-42-40", "episodes_this_iter": 27, "timestamp": 1558327360, "episode_reward_max": 1218.5136571155847, "num_metric_batches_dropped": 0, "time_since_restore": 243.48183798789978, "timesteps_total": 333177, "episode_len_mean": 700.0, "episodes_total": 136, "time_total_s": 243.48183798789978, "info": {"load_time_ms": 20.788, "default": {"vf_loss": 9.064947128295898, "total_loss": 9.061229705810547, "entropy": 1.3748936653137207, "policy_loss": -0.004577513784170151, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.8765316605567932, "cur_lr": 0.0005000000237487257, "kl": 0.008614755235612392}, "num_steps_trained": 333177, "grad_time_ms": 17626.883, "num_steps_sampled": 333177, "sample_time_ms": 30803.707, "update_time_ms": 120.441}, "episode_reward_mean": 724.5435010327867, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 50.351470947265625, "iterations_since_restore": 5, "training_iteration": 5, "timesteps_since_restore": 333177, "timesteps_this_iter": 68634, "custom_metrics": {"system_level_velocity_min": 2.5961281298992422, "outflow_rate_max": 1010.5617756631225, "system_level_velocity_max": 12.300695355081823, "cost1_mean": 225.2991289108085, "outflow_rate_mean": 699.2597302788467, "cost1_min": 66.54132244251288, "cost2_min": -142.11038959265068, "cost1_max": 329.8716073900297, "outflow_rate_min": 224.72285802296133, "cost2_max": -36.00190064865258, "cost2_mean": -77.1659978594104, "system_level_velocity_mean": 8.565048235742898}, "episode_reward_min": 326.51828811334644, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c940>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-43-35", "episodes_this_iter": 26, "timestamp": 1558327415, "episode_reward_max": 1280.1933155041615, "num_metric_batches_dropped": 0, "time_since_restore": 298.35015082359314, "timesteps_total": 407748, "episode_len_mean": 700.0, "episodes_total": 162, "time_total_s": 298.35015082359314, "info": {"load_time_ms": 18.934, "default": {"vf_loss": 9.633118629455566, "total_loss": 9.630139350891113, "entropy": 1.3846349716186523, "policy_loss": -0.0039038534741848707, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.8930205702781677, "cur_lr": 0.0005000000237487257, "kl": 0.009254571050405502}, "num_steps_trained": 407748, "grad_time_ms": 17962.133, "num_steps_sampled": 407748, "sample_time_ms": 31516.983, "update_time_ms": 102.031}, "episode_reward_mean": 864.1108608843817, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 54.86831283569336, "iterations_since_restore": 6, "training_iteration": 6, "timesteps_since_restore": 407748, "timesteps_this_iter": 74571, "custom_metrics": {"system_level_velocity_min": 3.5247953244298396, "outflow_rate_max": 1089.9995775244067, "system_level_velocity_max": 12.52936147784299, "cost1_mean": 251.47978241405244, "outflow_rate_mean": 794.9516680950364, "cost1_min": 90.49318536969865, "cost2_min": -146.36545420251838, "cost1_max": 336.5479381043285, "outflow_rate_min": 300.17859254214056, "cost2_max": -46.51077612278059, "cost2_mean": -93.35529234118032, "system_level_velocity_mean": 9.49269852461818}, "episode_reward_min": 449.08470821116043, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5602b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e10>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-44-30", "episodes_this_iter": 26, "timestamp": 1558327470, "episode_reward_max": 1280.1933155041615, "num_metric_batches_dropped": 0, "time_since_restore": 353.62346267700195, "timesteps_total": 480704, "episode_len_mean": 700.0, "episodes_total": 188, "time_total_s": 353.62346267700195, "info": {"load_time_ms": 17.516, "default": {"vf_loss": 9.992155075073242, "total_loss": 9.988277435302734, "entropy": 1.3891546726226807, "policy_loss": -0.004955715965479612, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.872195303440094, "cur_lr": 0.0005000000237487257, "kl": 0.010786396451294422}, "num_steps_trained": 480704, "grad_time_ms": 18345.904, "num_steps_sampled": 480704, "sample_time_ms": 31940.098, "update_time_ms": 88.568}, "episode_reward_mean": 972.2914093946728, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 55.27331185340881, "iterations_since_restore": 7, "training_iteration": 7, "timesteps_since_restore": 480704, "timesteps_this_iter": 72956, "custom_metrics": {"system_level_velocity_min": 3.5247953244298396, "outflow_rate_max": 1098.9484922460188, "system_level_velocity_max": 12.937926945439544, "cost1_mean": 267.14709404312225, "outflow_rate_mean": 866.5623507994549, "cost1_min": 90.49318536969865, "cost2_min": -153.48708314469982, "cost1_max": 349.72161442129493, "outflow_rate_min": 300.17859254214056, "cost2_max": -63.34098504334868, "cost2_mean": -109.75038151119134, "system_level_velocity_mean": 10.046857995297845}, "episode_reward_min": 451.7766775309271, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5587f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558da0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-45-23", "episodes_this_iter": 28, "timestamp": 1558327523, "episode_reward_max": 1343.601497167171, "num_metric_batches_dropped": 0, "time_since_restore": 406.3268530368805, "timesteps_total": 547908, "episode_len_mean": 700.0, "episodes_total": 216, "time_total_s": 406.3268530368805, "info": {"load_time_ms": 16.365, "default": {"vf_loss": 12.70431900024414, "total_loss": 12.700373649597168, "entropy": 1.3771075010299683, "policy_loss": -0.004916773177683353, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.8426825404167175, "cur_lr": 0.0005000000237487257, "kl": 0.009717004373669624}, "num_steps_trained": 547908, "grad_time_ms": 18327.969, "num_steps_sampled": 547908, "sample_time_ms": 32240.773, "update_time_ms": 78.709}, "episode_reward_mean": 1061.780725897855, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 52.70339035987854, "iterations_since_restore": 8, "training_iteration": 8, "timesteps_since_restore": 547908, "timesteps_this_iter": 67204, "custom_metrics": {"system_level_velocity_min": 7.6039389881915485, "outflow_rate_max": 1112.401123166548, "system_level_velocity_max": 13.75311754225599, "cost1_mean": 286.44599256053414, "outflow_rate_mean": 938.295920651661, "cost1_min": 200.35898108964778, "cost2_min": -169.93665808688763, "cost1_max": 371.0266844833194, "outflow_rate_min": 655.8349663292103, "cost2_max": -69.85444420592569, "cost2_mean": -121.76258841726543, "system_level_velocity_mean": 10.749491754876932}, "episode_reward_min": 810.3290255348344, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5608d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-46-14", "episodes_this_iter": 29, "timestamp": 1558327574, "episode_reward_max": 1374.403689388551, "num_metric_batches_dropped": 0, "time_since_restore": 457.7254731655121, "timesteps_total": 611091, "episode_len_mean": 700.0, "episodes_total": 245, "time_total_s": 457.7254731655121, "info": {"load_time_ms": 15.605, "default": {"vf_loss": 13.468502044677734, "total_loss": 13.463582992553711, "entropy": 1.3722562789916992, "policy_loss": -0.006026224698871374, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.827289879322052, "cur_lr": 0.0005000000237487257, "kl": 0.011068545281887054}, "num_steps_trained": 611091, "grad_time_ms": 18279.872, "num_steps_sampled": 611091, "sample_time_ms": 32367.089, "update_time_ms": 70.787}, "episode_reward_mean": 1103.563959197512, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 51.39862012863159, "iterations_since_restore": 9, "training_iteration": 9, "timesteps_since_restore": 611091, "timesteps_this_iter": 63183, "custom_metrics": {"system_level_velocity_min": 7.6039389881915485, "outflow_rate_max": 1147.235427461645, "system_level_velocity_max": 13.75311754225599, "cost1_mean": 299.40953340425585, "outflow_rate_mean": 980.8741931548753, "cost1_min": 200.35898108964778, "cost2_min": -169.93665808688763, "cost1_max": 371.0266844833194, "outflow_rate_min": 693.3831848845684, "cost2_max": -78.08924052569081, "cost2_mean": -129.96858158708724, "system_level_velocity_mean": 11.222629209393574}, "episode_reward_min": 830.765605667852, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cb70>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-47-02", "episodes_this_iter": 30, "timestamp": 1558327622, "episode_reward_max": 1374.403689388551, "num_metric_batches_dropped": 0, "time_since_restore": 505.95907330513, "timesteps_total": 673814, "episode_len_mean": 700.0, "episodes_total": 275, "time_total_s": 505.95907330513, "info": {"load_time_ms": 14.962, "default": {"vf_loss": 15.710562705993652, "total_loss": 15.70582389831543, "entropy": 1.3735182285308838, "policy_loss": -0.0057562594301998615, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7728704810142517, "cur_lr": 0.0005000000237487257, "kl": 0.010168659500777721}, "num_steps_trained": 673814, "grad_time_ms": 18004.155, "num_steps_sampled": 673814, "sample_time_ms": 32388.939, "update_time_ms": 64.529}, "episode_reward_mean": 1121.9969088229334, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.23360013961792, "iterations_since_restore": 10, "training_iteration": 10, "timesteps_since_restore": 673814, "timesteps_this_iter": 62723, "custom_metrics": {"system_level_velocity_min": 7.6039389881915485, "outflow_rate_max": 1147.235427461645, "system_level_velocity_max": 13.75311754225599, "cost1_mean": 308.479300216345, "outflow_rate_mean": 1001.2508437442012, "cost1_min": 200.35898108964778, "cost2_min": -180.2214312449613, "cost1_max": 371.0266844833194, "outflow_rate_min": 815.002243332949, "cost2_max": -78.08924052569081, "cost2_mean": -135.21976455233315, "system_level_velocity_mean": 11.546517456154017}, "episode_reward_min": 906.663269968291, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae0f0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-47-51", "episodes_this_iter": 34, "timestamp": 1558327671, "episode_reward_max": 1374.403689388551, "num_metric_batches_dropped": 0, "time_since_restore": 554.7916297912598, "timesteps_total": 736781, "episode_len_mean": 700.0, "episodes_total": 309, "time_total_s": 554.7916297912598, "info": {"load_time_ms": 9.262, "default": {"vf_loss": 23.272851943969727, "total_loss": 23.267375946044922, "entropy": 1.3597185611724854, "policy_loss": -0.006743566133081913, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.7199988961219788, "cur_lr": 0.0005000000237487257, "kl": 0.012669713236391544}, "num_steps_trained": 736781, "grad_time_ms": 17819.887, "num_steps_sampled": 736781, "sample_time_ms": 32706.394, "update_time_ms": 8.243}, "episode_reward_mean": 1137.724152689282, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.83255648612976, "iterations_since_restore": 11, "training_iteration": 11, "timesteps_since_restore": 736781, "timesteps_this_iter": 62967, "custom_metrics": {"system_level_velocity_min": 8.154102325166127, "outflow_rate_max": 1147.235427461645, "system_level_velocity_max": 14.14849171208108, "cost1_mean": 316.60103960831896, "outflow_rate_mean": 1015.0848412276225, "cost1_min": 214.11189479776613, "cost2_min": -180.2214312449613, "cost1_max": 382.3215567884696, "outflow_rate_min": 815.002243332949, "cost2_max": -78.08924052569081, "cost2_mean": -136.95271269905814, "system_level_velocity_mean": 11.83933983832966}, "episode_reward_min": 908.0185409166822, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560a20>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-48-40", "episodes_this_iter": 31, "timestamp": 1558327720, "episode_reward_max": 1370.9827618399033, "num_metric_batches_dropped": 0, "time_since_restore": 603.7104866504669, "timesteps_total": 801907, "episode_len_mean": 693.31, "episodes_total": 340, "time_total_s": 603.7104866504669, "info": {"load_time_ms": 8.991, "default": {"vf_loss": 23.049989700317383, "total_loss": 23.044679641723633, "entropy": 1.3603761196136475, "policy_loss": -0.006692132446914911, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7329440116882324, "cur_lr": 0.0005000000237487257, "kl": 0.013803047128021717}, "num_steps_trained": 801907, "grad_time_ms": 17512.789, "num_steps_sampled": 801907, "sample_time_ms": 32892.652, "update_time_ms": 8.286}, "episode_reward_mean": 1139.3058465965512, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.91885685920715, "iterations_since_restore": 12, "training_iteration": 12, "timesteps_since_restore": 801907, "timesteps_this_iter": 65126, "custom_metrics": {"system_level_velocity_min": 8.154102325166127, "outflow_rate_max": 1142.90351982717, "system_level_velocity_max": 17.81611605991857, "cost1_mean": 317.7843576058769, "outflow_rate_mean": 1016.8850607534042, "cost1_min": 20.64518391920528, "cost2_min": -180.2214312449613, "cost1_max": 382.3215567884696, "outflow_rate_min": 491.0443871713045, "cost2_max": -19.88230848246951, "cost2_mean": -136.76401250157664, "system_level_velocity_mean": 12.045633102297227}, "episode_reward_min": 54.90816216324446, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5aeb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae630>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-49-28", "episodes_this_iter": 29, "timestamp": 1558327768, "episode_reward_max": 1369.8081621589106, "num_metric_batches_dropped": 0, "time_since_restore": 651.2594323158264, "timesteps_total": 864449, "episode_len_mean": 693.31, "episodes_total": 369, "time_total_s": 651.2594323158264, "info": {"load_time_ms": 8.971, "default": {"vf_loss": 25.898462295532227, "total_loss": 25.89290428161621, "entropy": 1.3529565334320068, "policy_loss": -0.00688603799790144, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7338748574256897, "cur_lr": 0.0005000000237487257, "kl": 0.013291789218783379}, "num_steps_trained": 864449, "grad_time_ms": 17261.207, "num_steps_sampled": 864449, "sample_time_ms": 33376.539, "update_time_ms": 8.301}, "episode_reward_mean": 1159.8906479167845, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.5489456653595, "iterations_since_restore": 13, "training_iteration": 13, "timesteps_since_restore": 864449, "timesteps_this_iter": 62542, "custom_metrics": {"system_level_velocity_min": 8.472271222637469, "outflow_rate_max": 1167.9073112669207, "system_level_velocity_max": 17.81611605991857, "cost1_mean": 324.9115446799856, "outflow_rate_mean": 1024.5895454163065, "cost1_min": 20.64518391920528, "cost2_min": -175.9999154960638, "cost1_max": 393.68626788758695, "outflow_rate_min": 491.0443871713045, "cost2_max": -19.88230848246951, "cost2_mean": -132.85730946114768, "system_level_velocity_mean": 12.314156697789086}, "episode_reward_min": 54.90816216324446, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d2630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5604a8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-50-16", "episodes_this_iter": 27, "timestamp": 1558327816, "episode_reward_max": 1369.8081621589106, "num_metric_batches_dropped": 0, "time_since_restore": 699.4273371696472, "timesteps_total": 926811, "episode_len_mean": 693.31, "episodes_total": 396, "time_total_s": 699.4273371696472, "info": {"load_time_ms": 8.936, "default": {"vf_loss": 25.70490074157715, "total_loss": 25.700593948364258, "entropy": 1.3499449491500854, "policy_loss": -0.005656947381794453, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7528595328330994, "cur_lr": 0.0005000000237487257, "kl": 0.013499170541763306}, "num_steps_trained": 926811, "grad_time_ms": 17038.526, "num_steps_sampled": 926811, "sample_time_ms": 33449.971, "update_time_ms": 8.236}, "episode_reward_mean": 1164.5939225988282, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.1679048538208, "iterations_since_restore": 14, "training_iteration": 14, "timesteps_since_restore": 926811, "timesteps_this_iter": 62362, "custom_metrics": {"system_level_velocity_min": 7.875703355837818, "outflow_rate_max": 1167.9073112669207, "system_level_velocity_max": 17.81611605991857, "cost1_mean": 328.3943154087031, "outflow_rate_mean": 1027.7709939499252, "cost1_min": 20.64518391920528, "cost2_min": -164.78836444053266, "cost1_max": 393.68626788758695, "outflow_rate_min": 491.0443871713045, "cost2_max": -19.88230848246951, "cost2_mean": -129.76379368104293, "system_level_velocity_mean": 12.454833953676596}, "episode_reward_min": 54.90816216324446, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c6a0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-51-05", "episodes_this_iter": 27, "timestamp": 1558327865, "episode_reward_max": 1369.8081621589106, "num_metric_batches_dropped": 0, "time_since_restore": 748.4111044406891, "timesteps_total": 990008, "episode_len_mean": 693.31, "episodes_total": 423, "time_total_s": 748.4111044406891, "info": {"load_time_ms": 8.781, "default": {"vf_loss": 24.290695190429688, "total_loss": 24.284317016601562, "entropy": 1.3361008167266846, "policy_loss": -0.007751378696411848, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7755233645439148, "cur_lr": 0.0005000000237487257, "kl": 0.013712354935705662}, "num_steps_trained": 990008, "grad_time_ms": 16791.704, "num_steps_sampled": 990008, "sample_time_ms": 33560.186, "update_time_ms": 8.259}, "episode_reward_mean": 1173.7992938038874, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.98376727104187, "iterations_since_restore": 15, "training_iteration": 15, "timesteps_since_restore": 990008, "timesteps_this_iter": 63197, "custom_metrics": {"system_level_velocity_min": 7.875703355837818, "outflow_rate_max": 1167.9073112669207, "system_level_velocity_max": 17.81611605991857, "cost1_mean": 331.847025110029, "outflow_rate_mean": 1031.1163268227763, "cost1_min": 20.64518391920528, "cost2_min": -164.78836444053266, "cost1_max": 393.68626788758695, "outflow_rate_min": 491.0443871713045, "cost2_max": -19.88230848246951, "cost2_mean": -127.15248016710956, "system_level_velocity_mean": 12.596173915915749}, "episode_reward_min": 54.90816216324446, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca90>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-51-55", "episodes_this_iter": 28, "timestamp": 1558327915, "episode_reward_max": 1357.3611272715298, "num_metric_batches_dropped": 0, "time_since_restore": 797.8823118209839, "timesteps_total": 1053944, "episode_len_mean": 700.0, "episodes_total": 451, "time_total_s": 797.8823118209839, "info": {"load_time_ms": 8.749, "default": {"vf_loss": 25.613924026489258, "total_loss": 25.608373641967773, "entropy": 1.350173830986023, "policy_loss": -0.007061854004859924, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.7645993828773499, "cur_lr": 0.0005000000237487257, "kl": 0.015143521130084991}, "num_steps_trained": 1053944, "grad_time_ms": 16505.84, "num_steps_sampled": 1053944, "sample_time_ms": 33308.83, "update_time_ms": 8.082}, "episode_reward_mean": 1188.5120740742666, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 49.4712073802948, "iterations_since_restore": 16, "training_iteration": 16, "timesteps_since_restore": 1053944, "timesteps_this_iter": 63936, "custom_metrics": {"system_level_velocity_min": 7.875703355837818, "outflow_rate_max": 1167.9073112669207, "system_level_velocity_max": 15.182762000524228, "cost1_mean": 337.66153935084157, "outflow_rate_mean": 1041.5107961688032, "cost1_min": 205.46403540698668, "cost2_min": -160.57053748203828, "cost1_max": 406.2020131856788, "outflow_rate_min": 794.5632378794459, "cost2_max": -91.13443354651568, "cost2_mean": -127.22448509583637, "system_level_velocity_mean": 12.647262395514256}, "episode_reward_min": 954.6577227910716, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a358>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-52-42", "episodes_this_iter": 27, "timestamp": 1558327962, "episode_reward_max": 1357.3611272715298, "num_metric_batches_dropped": 0, "time_since_restore": 845.2583348751068, "timesteps_total": 1115681, "episode_len_mean": 700.0, "episodes_total": 478, "time_total_s": 845.2583348751068, "info": {"load_time_ms": 8.696, "default": {"vf_loss": 24.775693893432617, "total_loss": 24.770660400390625, "entropy": 1.348411202430725, "policy_loss": -0.006422759499400854, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7828966379165649, "cur_lr": 0.0005000000237487257, "kl": 0.013872732408344746}, "num_steps_trained": 1115681, "grad_time_ms": 15988.537, "num_steps_sampled": 1115681, "sample_time_ms": 33039.015, "update_time_ms": 8.136}, "episode_reward_mean": 1186.6237788461494, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.376023054122925, "iterations_since_restore": 17, "training_iteration": 17, "timesteps_since_restore": 1115681, "timesteps_this_iter": 61737, "custom_metrics": {"system_level_velocity_min": 7.875703355837818, "outflow_rate_max": 1159.4890673068437, "system_level_velocity_max": 15.182762000524228, "cost1_mean": 338.01562857195967, "outflow_rate_mean": 1043.6583210302629, "cost1_min": 205.46403540698668, "cost2_min": -177.521228877414, "cost1_max": 406.2020131856788, "outflow_rate_min": 794.5632378794459, "cost2_max": -91.13443354651568, "cost2_mean": -129.52925986639823, "system_level_velocity_mean": 12.663346209281253}, "episode_reward_min": 953.6840714589831, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c828>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-53-30", "episodes_this_iter": 27, "timestamp": 1558328010, "episode_reward_max": 1382.7461995468782, "num_metric_batches_dropped": 0, "time_since_restore": 892.9414179325104, "timesteps_total": 1179796, "episode_len_mean": 700.0, "episodes_total": 505, "time_total_s": 892.9414179325104, "info": {"load_time_ms": 8.704, "default": {"vf_loss": 27.582439422607422, "total_loss": 27.577463150024414, "entropy": 1.3502546548843384, "policy_loss": -0.006487993057817221, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7592435479164124, "cur_lr": 0.0005000000237487257, "kl": 0.015119909308850765}, "num_steps_trained": 1179796, "grad_time_ms": 15720.789, "num_steps_sampled": 1179796, "sample_time_ms": 32808.361, "update_time_ms": 7.842}, "episode_reward_mean": 1188.0673440707947, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.683083057403564, "iterations_since_restore": 18, "training_iteration": 18, "timesteps_since_restore": 1179796, "timesteps_this_iter": 64115, "custom_metrics": {"system_level_velocity_min": 8.759355937269325, "outflow_rate_max": 1180.2786238664607, "system_level_velocity_max": 15.360411969445039, "cost1_mean": 338.7265015088232, "outflow_rate_mean": 1047.3142691836952, "cost1_min": 227.87239427571183, "cost2_min": -177.521228877414, "cost1_max": 412.048440997454, "outflow_rate_min": 839.3797128189351, "cost2_max": -91.13443354651568, "cost2_mean": -132.37650688058858, "system_level_velocity_mean": 12.693495309393477}, "episode_reward_min": 953.6840714589831, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ca90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ce48>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-54-15", "episodes_this_iter": 31, "timestamp": 1558328055, "episode_reward_max": 1382.7461995468782, "num_metric_batches_dropped": 0, "time_since_restore": 938.4800102710724, "timesteps_total": 1242558, "episode_len_mean": 700.0, "episodes_total": 536, "time_total_s": 938.4800102710724, "info": {"load_time_ms": 8.588, "default": {"vf_loss": 32.901161193847656, "total_loss": 32.89559555053711, "entropy": 1.3385169506072998, "policy_loss": -0.006997257005423307, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7537837624549866, "cur_lr": 0.0005000000237487257, "kl": 0.014299501664936543}, "num_steps_trained": 1242558, "grad_time_ms": 15275.325, "num_steps_sampled": 1242558, "sample_time_ms": 32666.957, "update_time_ms": 7.85}, "episode_reward_mean": 1194.9734117714083, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.53859233856201, "iterations_since_restore": 19, "training_iteration": 19, "timesteps_since_restore": 1242558, "timesteps_this_iter": 62762, "custom_metrics": {"system_level_velocity_min": 9.52087524747773, "outflow_rate_max": 1180.2786238664607, "system_level_velocity_max": 15.69281125508881, "cost1_mean": 343.82204346355405, "outflow_rate_mean": 1058.0119449296594, "cost1_min": 250.9117072204926, "cost2_min": -177.521228877414, "cost1_max": 418.08332209233106, "outflow_rate_min": 865.4186233725605, "cost2_max": -97.87175700149663, "cost2_mean": -131.82142570008813, "system_level_velocity_mean": 12.878935908265879}, "episode_reward_min": 953.6840714589831, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ab70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a710>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-55-03", "episodes_this_iter": 28, "timestamp": 1558328103, "episode_reward_max": 1382.7461995468782, "num_metric_batches_dropped": 0, "time_since_restore": 986.464485168457, "timesteps_total": 1306782, "episode_len_mean": 700.0, "episodes_total": 564, "time_total_s": 986.464485168457, "info": {"load_time_ms": 8.631, "default": {"vf_loss": 24.98771858215332, "total_loss": 24.981700897216797, "entropy": 1.3327139616012573, "policy_loss": -0.007580369710922241, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.7896575331687927, "cur_lr": 0.0005000000237487257, "kl": 0.015617623925209045}, "num_steps_trained": 1306782, "grad_time_ms": 15287.212, "num_steps_sampled": 1306782, "sample_time_ms": 32629.472, "update_time_ms": 7.829}, "episode_reward_mean": 1187.9362519917618, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.984474897384644, "iterations_since_restore": 20, "training_iteration": 20, "timesteps_since_restore": 1306782, "timesteps_this_iter": 64224, "custom_metrics": {"system_level_velocity_min": 8.742817672661081, "outflow_rate_max": 1180.2786238664607, "system_level_velocity_max": 15.69281125508881, "cost1_mean": 340.22140897634677, "outflow_rate_mean": 1051.6822138678572, "cost1_min": 229.46495263061027, "cost2_min": -169.19287969125563, "cost1_max": 418.08332209233106, "outflow_rate_min": 862.351652318157, "cost2_max": -97.87175700149663, "cost2_mean": -131.6953154352007, "system_level_velocity_mean": 12.760136644087366}, "episode_reward_min": 953.6840714589831, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f28>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-55-54", "episodes_this_iter": 31, "timestamp": 1558328154, "episode_reward_max": 1380.3781405492853, "num_metric_batches_dropped": 0, "time_since_restore": 1036.9431352615356, "timesteps_total": 1369665, "episode_len_mean": 700.0, "episodes_total": 595, "time_total_s": 1036.9431352615356, "info": {"load_time_ms": 8.615, "default": {"vf_loss": 31.710660934448242, "total_loss": 31.703500747680664, "entropy": 1.3166568279266357, "policy_loss": -0.008691512979567051, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.7681884765625, "cur_lr": 0.0005000000237487257, "kl": 0.015312316827476025}, "num_steps_trained": 1369665, "grad_time_ms": 15424.636, "num_steps_sampled": 1369665, "sample_time_ms": 32654.794, "update_time_ms": 7.719}, "episode_reward_mean": 1192.7937260163794, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 50.47865009307861, "iterations_since_restore": 21, "training_iteration": 21, "timesteps_since_restore": 1369665, "timesteps_this_iter": 62883, "custom_metrics": {"system_level_velocity_min": 8.742817672661081, "outflow_rate_max": 1189.0324150253134, "system_level_velocity_max": 15.69281125508881, "cost1_mean": 339.07604842877583, "outflow_rate_mean": 1048.2842116891422, "cost1_min": 229.46495263061027, "cost2_min": -167.0529722565622, "cost1_max": 418.08332209233106, "outflow_rate_min": 862.351652318157, "cost2_max": -92.45919598329496, "cost2_mean": -130.72729921591394, "system_level_velocity_mean": 12.72911501973418}, "episode_reward_min": 997.2182175442235, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5b9710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a2b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-56-41", "episodes_this_iter": 31, "timestamp": 1558328201, "episode_reward_max": 1355.7900751556108, "num_metric_batches_dropped": 0, "time_since_restore": 1084.0288932323456, "timesteps_total": 1432518, "episode_len_mean": 700.0, "episodes_total": 626, "time_total_s": 1084.0288932323456, "info": {"load_time_ms": 8.507, "default": {"vf_loss": 34.47758865356445, "total_loss": 34.470787048339844, "entropy": 1.3304030895233154, "policy_loss": -0.008377774618566036, "cur_kl_coeff": 0.10000000894069672, "vf_explained_var": 0.762955904006958, "cur_lr": 0.0005000000237487257, "kl": 0.015708990395069122}, "num_steps_trained": 1432518, "grad_time_ms": 15547.49, "num_steps_sampled": 1432518, "sample_time_ms": 32349.358, "update_time_ms": 7.746}, "episode_reward_mean": 1187.4437559017385, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.08575797080994, "iterations_since_restore": 22, "training_iteration": 22, "timesteps_since_restore": 1432518, "timesteps_this_iter": 62853, "custom_metrics": {"system_level_velocity_min": 8.742817672661081, "outflow_rate_max": 1189.0324150253134, "system_level_velocity_max": 15.358583720964635, "cost1_mean": 336.2479789627703, "outflow_rate_mean": 1040.307080549897, "cost1_min": 229.46495263061027, "cost2_min": -167.0529722565622, "cost1_max": 413.35962086517094, "outflow_rate_min": 862.351652318157, "cost2_max": -90.2636970008273, "cost2_mean": -132.55087670875787, "system_level_velocity_mean": 12.633925750486997}, "episode_reward_min": 978.3469719135667, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ae10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560630>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-57-28", "episodes_this_iter": 30, "timestamp": 1558328248, "episode_reward_max": 1351.4517787615148, "num_metric_batches_dropped": 0, "time_since_restore": 1130.7569909095764, "timesteps_total": 1493882, "episode_len_mean": 700.0, "episodes_total": 656, "time_total_s": 1130.7569909095764, "info": {"load_time_ms": 8.341, "default": {"vf_loss": 33.93003463745117, "total_loss": 33.92391586303711, "entropy": 1.3397423028945923, "policy_loss": -0.0076735857874155045, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7851858139038086, "cur_lr": 0.0005000000237487257, "kl": 0.015595072880387306}, "num_steps_trained": 1493882, "grad_time_ms": 15560.11, "num_steps_sampled": 1493882, "sample_time_ms": 32257.482, "update_time_ms": 7.845}, "episode_reward_mean": 1198.8017152590721, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.728097677230835, "iterations_since_restore": 23, "training_iteration": 23, "timesteps_since_restore": 1493882, "timesteps_this_iter": 61364, "custom_metrics": {"system_level_velocity_min": 8.742817672661081, "outflow_rate_max": 1189.0324150253134, "system_level_velocity_max": 15.358583720964635, "cost1_mean": 338.3744067884298, "outflow_rate_mean": 1041.349481591925, "cost1_min": 229.46495263061027, "cost2_min": -167.0529722565622, "cost1_max": 413.35962086517094, "outflow_rate_min": 882.28486360418, "cost2_max": -88.67335590697971, "cost2_mean": -131.57505495927754, "system_level_velocity_mean": 12.723304012148018}, "episode_reward_min": 978.3469719135667, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558c50>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-58-13", "episodes_this_iter": 29, "timestamp": 1558328293, "episode_reward_max": 1350.5234456132425, "num_metric_batches_dropped": 0, "time_since_restore": 1176.3376874923706, "timesteps_total": 1554179, "episode_len_mean": 700.0, "episodes_total": 685, "time_total_s": 1176.3376874923706, "info": {"load_time_ms": 8.237, "default": {"vf_loss": 35.231971740722656, "total_loss": 35.225460052490234, "entropy": 1.3436071872711182, "policy_loss": -0.008058762177824974, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7798264026641846, "cur_lr": 0.0005000000237487257, "kl": 0.015513678081333637}, "num_steps_trained": 1554179, "grad_time_ms": 15405.731, "num_steps_sampled": 1554179, "sample_time_ms": 32159.482, "update_time_ms": 7.759}, "episode_reward_mean": 1202.6239660715023, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.58069658279419, "iterations_since_restore": 24, "training_iteration": 24, "timesteps_since_restore": 1554179, "timesteps_this_iter": 60297, "custom_metrics": {"system_level_velocity_min": 9.832192305921861, "outflow_rate_max": 1150.7836289005388, "system_level_velocity_max": 15.292913928671041, "cost1_mean": 345.4592397699826, "outflow_rate_mean": 1050.974597921186, "cost1_min": 259.45470060066754, "cost2_min": -170.90303831998148, "cost1_max": 402.47330428683733, "outflow_rate_min": 852.7866641774054, "cost2_max": -87.05597927811833, "cost2_mean": -128.25577683756757, "system_level_velocity_mean": 12.99427283750407}, "episode_reward_min": 959.7399004935353, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5608d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-59-00", "episodes_this_iter": 27, "timestamp": 1558328340, "episode_reward_max": 1340.149930609513, "num_metric_batches_dropped": 0, "time_since_restore": 1222.5147256851196, "timesteps_total": 1614557, "episode_len_mean": 700.0, "episodes_total": 712, "time_total_s": 1222.5147256851196, "info": {"load_time_ms": 7.92, "default": {"vf_loss": 34.41291427612305, "total_loss": 34.406639099121094, "entropy": 1.3368096351623535, "policy_loss": -0.008066640235483646, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7677185535430908, "cur_lr": 0.0005000000237487257, "kl": 0.017915543168783188}, "num_steps_trained": 1614557, "grad_time_ms": 15236.486, "num_steps_sampled": 1614557, "sample_time_ms": 32050.46, "update_time_ms": 7.672}, "episode_reward_mean": 1201.3884934745035, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.17703819274902, "iterations_since_restore": 25, "training_iteration": 25, "timesteps_since_restore": 1614557, "timesteps_this_iter": 60378, "custom_metrics": {"system_level_velocity_min": 9.832192305921861, "outflow_rate_max": 1147.2689744075522, "system_level_velocity_max": 15.503608390423118, "cost1_mean": 347.64404813234086, "outflow_rate_mean": 1052.812020269503, "cost1_min": 259.45470060066754, "cost2_min": -170.90303831998148, "cost1_max": 411.29657015245596, "outflow_rate_min": 852.7866641774054, "cost2_max": -63.716528199020225, "cost2_mean": -127.84282922125026, "system_level_velocity_mean": 13.08873591589545}, "episode_reward_min": 959.7399004935353, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b828>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_04-59-47", "episodes_this_iter": 27, "timestamp": 1558328387, "episode_reward_max": 1340.149930609513, "num_metric_batches_dropped": 0, "time_since_restore": 1269.9523887634277, "timesteps_total": 1674214, "episode_len_mean": 700.0, "episodes_total": 739, "time_total_s": 1269.9523887634277, "info": {"load_time_ms": 7.682, "default": {"vf_loss": 33.22203826904297, "total_loss": 33.21581268310547, "entropy": 1.3189500570297241, "policy_loss": -0.008021365851163864, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7838387489318848, "cur_lr": 0.0005000000237487257, "kl": 0.017957499250769615}, "num_steps_trained": 1674214, "grad_time_ms": 15140.449, "num_steps_sampled": 1674214, "sample_time_ms": 31943.369, "update_time_ms": 7.683}, "episode_reward_mean": 1202.2061483696205, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.437663078308105, "iterations_since_restore": 26, "training_iteration": 26, "timesteps_since_restore": 1674214, "timesteps_this_iter": 59657, "custom_metrics": {"system_level_velocity_min": 9.832192305921861, "outflow_rate_max": 1163.5710727984049, "system_level_velocity_max": 15.503608390423118, "cost1_mean": 353.59942058279813, "outflow_rate_mean": 1064.4050365118767, "cost1_min": 259.45470060066754, "cost2_min": -170.90303831998148, "cost1_max": 411.7380143273606, "outflow_rate_min": 852.7866641774054, "cost2_max": -63.716528199020225, "cost2_mean": -128.33409915276377, "system_level_velocity_mean": 13.312899503701965}, "episode_reward_min": 959.7399004935353, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a63c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c9e8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-00-37", "episodes_this_iter": 27, "timestamp": 1558328437, "episode_reward_max": 1332.8936688643182, "num_metric_batches_dropped": 0, "time_since_restore": 1319.6660022735596, "timesteps_total": 1736694, "episode_len_mean": 700.0, "episodes_total": 766, "time_total_s": 1319.6660022735596, "info": {"load_time_ms": 7.834, "default": {"vf_loss": 33.12007522583008, "total_loss": 33.11359786987305, "entropy": 1.3260488510131836, "policy_loss": -0.008378032594919205, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7591615915298462, "cur_lr": 0.0005000000237487257, "kl": 0.018988940864801407}, "num_steps_trained": 1736694, "grad_time_ms": 15349.465, "num_steps_sampled": 1736694, "sample_time_ms": 31966.755, "update_time_ms": 7.76}, "episode_reward_mean": 1203.8223447579217, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 49.713613510131836, "iterations_since_restore": 27, "training_iteration": 27, "timesteps_since_restore": 1736694, "timesteps_this_iter": 62480, "custom_metrics": {"system_level_velocity_min": 10.550638153806997, "outflow_rate_max": 1163.5710727984049, "system_level_velocity_max": 15.503608390423118, "cost1_mean": 356.50536143679733, "outflow_rate_mean": 1067.322611081903, "cost1_min": 276.4542893970579, "cost2_min": -185.01455449040716, "cost1_max": 411.7380143273606, "outflow_rate_min": 937.0395865832553, "cost2_max": -63.716528199020225, "cost2_mean": -127.24785259822328, "system_level_velocity_mean": 13.44107662652611}, "episode_reward_min": 1018.8641592316269, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b2b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-01-23", "episodes_this_iter": 29, "timestamp": 1558328483, "episode_reward_max": 1319.6621088095624, "num_metric_batches_dropped": 0, "time_since_restore": 1365.8894641399384, "timesteps_total": 1797104, "episode_len_mean": 700.0, "episodes_total": 795, "time_total_s": 1365.8894641399384, "info": {"load_time_ms": 7.711, "default": {"vf_loss": 35.09796142578125, "total_loss": 35.090763092041016, "entropy": 1.3114320039749146, "policy_loss": -0.009063534438610077, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7863375544548035, "cur_lr": 0.0005000000237487257, "kl": 0.01867864653468132}, "num_steps_trained": 1797104, "grad_time_ms": 15232.219, "num_steps_sampled": 1797104, "sample_time_ms": 31938.823, "update_time_ms": 7.785}, "episode_reward_mean": 1186.4660394392479, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.223461866378784, "iterations_since_restore": 28, "training_iteration": 28, "timesteps_since_restore": 1797104, "timesteps_this_iter": 60410, "custom_metrics": {"system_level_velocity_min": 9.729206696995156, "outflow_rate_max": 1170.834469077676, "system_level_velocity_max": 15.989792772819378, "cost1_mean": 348.8635852059551, "outflow_rate_mean": 1056.0927618244505, "cost1_min": 255.0507618715668, "cost2_min": -187.86981705377949, "cost1_max": 424.54760639265277, "outflow_rate_min": 918.2737791549067, "cost2_max": -63.716528199020225, "cost2_mean": -131.79129237320174, "system_level_velocity_mean": 13.175464526193474}, "episode_reward_min": 1012.1318255552205, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bf60>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-02-09", "episodes_this_iter": 30, "timestamp": 1558328529, "episode_reward_max": 1337.0769620495885, "num_metric_batches_dropped": 0, "time_since_restore": 1411.8983039855957, "timesteps_total": 1857111, "episode_len_mean": 700.0, "episodes_total": 825, "time_total_s": 1411.8983039855957, "info": {"load_time_ms": 7.628, "default": {"vf_loss": 38.46538162231445, "total_loss": 38.45772933959961, "entropy": 1.299988865852356, "policy_loss": -0.009600967168807983, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7659080028533936, "cur_lr": 0.0005000000237487257, "kl": 0.01945611461997032}, "num_steps_trained": 1857111, "grad_time_ms": 15315.497, "num_steps_sampled": 1857111, "sample_time_ms": 31904.974, "update_time_ms": 7.775}, "episode_reward_mean": 1183.5377246290693, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.00883984565735, "iterations_since_restore": 29, "training_iteration": 29, "timesteps_since_restore": 1857111, "timesteps_this_iter": 60007, "custom_metrics": {"system_level_velocity_min": 9.51180949726122, "outflow_rate_max": 1171.5249208845485, "system_level_velocity_max": 15.989792772819378, "cost1_mean": 349.7795478151882, "outflow_rate_mean": 1058.4824167969136, "cost1_min": 245.1278433014123, "cost2_min": -187.86981705377949, "cost1_max": 424.54760639265277, "outflow_rate_min": 857.1934222668513, "cost2_max": -87.21482649923637, "cost2_mean": -131.4201981088747, "system_level_velocity_mean": 13.2163652050915}, "episode_reward_min": 1012.1318255552205, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ab38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ab00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-02-57", "episodes_this_iter": 28, "timestamp": 1558328577, "episode_reward_max": 1337.0769620495885, "num_metric_batches_dropped": 0, "time_since_restore": 1459.9659004211426, "timesteps_total": 1917731, "episode_len_mean": 700.0, "episodes_total": 853, "time_total_s": 1459.9659004211426, "info": {"load_time_ms": 7.403, "default": {"vf_loss": 34.805049896240234, "total_loss": 34.79736328125, "entropy": 1.32155179977417, "policy_loss": -0.00959127675741911, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7798815369606018, "cur_lr": 0.0005000000237487257, "kl": 0.01902601309120655}, "num_steps_trained": 1917731, "grad_time_ms": 15345.469, "num_steps_sampled": 1917731, "sample_time_ms": 31884.09, "update_time_ms": 7.818}, "episode_reward_mean": 1184.0320567745448, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.067596435546875, "iterations_since_restore": 30, "training_iteration": 30, "timesteps_since_restore": 1917731, "timesteps_this_iter": 60620, "custom_metrics": {"system_level_velocity_min": 9.51180949726122, "outflow_rate_max": 1171.5249208845485, "system_level_velocity_max": 16.04870197853295, "cost1_mean": 349.6111662829153, "outflow_rate_mean": 1057.3156461282988, "cost1_min": 244.56353011097872, "cost2_min": -187.86981705377949, "cost1_max": 425.97292822377347, "outflow_rate_min": 857.1934222668513, "cost2_max": -87.21482649923637, "cost2_mean": -130.74777061378748, "system_level_velocity_mean": 13.223518043801512}, "episode_reward_min": 973.200315226188, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c5c0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-03-46", "episodes_this_iter": 30, "timestamp": 1558328626, "episode_reward_max": 1337.0769620495885, "num_metric_batches_dropped": 0, "time_since_restore": 1508.8026015758514, "timesteps_total": 1980070, "episode_len_mean": 700.0, "episodes_total": 883, "time_total_s": 1508.8026015758514, "info": {"load_time_ms": 7.468, "default": {"vf_loss": 35.130165100097656, "total_loss": 35.122886657714844, "entropy": 1.3386924266815186, "policy_loss": -0.0090940548107028, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.7951143383979797, "cur_lr": 0.0005000000237487257, "kl": 0.01812729239463806}, "num_steps_trained": 1980070, "grad_time_ms": 15455.083, "num_steps_sampled": 1980070, "sample_time_ms": 31611.239, "update_time_ms": 8.04}, "episode_reward_mean": 1191.8376064561428, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.83670115470886, "iterations_since_restore": 31, "training_iteration": 31, "timesteps_since_restore": 1980070, "timesteps_this_iter": 62339, "custom_metrics": {"system_level_velocity_min": 9.51180949726122, "outflow_rate_max": 1171.5249208845485, "system_level_velocity_max": 16.04870197853295, "cost1_mean": 350.89654983440363, "outflow_rate_mean": 1056.953972945268, "cost1_min": 244.56353011097872, "cost2_min": -187.86981705377949, "cost1_max": 425.97292822377347, "outflow_rate_min": 857.1934222668513, "cost2_max": -87.82729017513614, "cost2_mean": -128.80322956618255, "system_level_velocity_mean": 13.273755375718288}, "episode_reward_min": 973.200315226188, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b160>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-04-34", "episodes_this_iter": 31, "timestamp": 1558328674, "episode_reward_max": 1347.2388094070502, "num_metric_batches_dropped": 0, "time_since_restore": 1556.9965932369232, "timesteps_total": 2042444, "episode_len_mean": 700.0, "episodes_total": 914, "time_total_s": 1556.9965932369232, "info": {"load_time_ms": 7.306, "default": {"vf_loss": 37.76506805419922, "total_loss": 37.75884246826172, "entropy": 1.334687352180481, "policy_loss": -0.008087273687124252, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.778386116027832, "cur_lr": 0.0005000000237487257, "kl": 0.018633754923939705}, "num_steps_trained": 2042444, "grad_time_ms": 15545.726, "num_steps_sampled": 2042444, "sample_time_ms": 31631.336, "update_time_ms": 8.041}, "episode_reward_mean": 1192.3821432103673, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.19399166107178, "iterations_since_restore": 32, "training_iteration": 32, "timesteps_since_restore": 2042444, "timesteps_this_iter": 62374, "custom_metrics": {"system_level_velocity_min": 9.515031694106447, "outflow_rate_max": 1189.9457123168563, "system_level_velocity_max": 16.45244877900106, "cost1_mean": 351.39466274987717, "outflow_rate_mean": 1059.7740866202387, "cost1_min": 244.56353011097872, "cost2_min": -180.10039139561368, "cost1_max": 435.7388896561571, "outflow_rate_min": 894.2364812057288, "cost2_max": -91.24727004016995, "cost2_mean": -129.42067768636656, "system_level_velocity_mean": 13.291428220728545}, "episode_reward_min": 973.200315226188, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b518>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-05-23", "episodes_this_iter": 30, "timestamp": 1558328723, "episode_reward_max": 1347.2388094070502, "num_metric_batches_dropped": 0, "time_since_restore": 1605.1235525608063, "timesteps_total": 2104538, "episode_len_mean": 700.0, "episodes_total": 944, "time_total_s": 1605.1235525608063, "info": {"load_time_ms": 7.397, "default": {"vf_loss": 37.61722946166992, "total_loss": 37.60942459106445, "entropy": 1.340648889541626, "policy_loss": -0.009737685322761536, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7802755236625671, "cur_lr": 0.0005000000237487257, "kl": 0.019325897097587585}, "num_steps_trained": 2104538, "grad_time_ms": 15734.98, "num_steps_sampled": 2104538, "sample_time_ms": 31579.926, "update_time_ms": 8.189}, "episode_reward_mean": 1189.5310492857127, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.12695932388306, "iterations_since_restore": 33, "training_iteration": 33, "timesteps_since_restore": 2104538, "timesteps_this_iter": 62094, "custom_metrics": {"system_level_velocity_min": 9.417349612338104, "outflow_rate_max": 1189.9457123168563, "system_level_velocity_max": 16.45244877900106, "cost1_mean": 345.1356300653416, "outflow_rate_mean": 1051.7090671285573, "cost1_min": 246.56945834519163, "cost2_min": -180.10039139561368, "cost1_max": 435.7388896561571, "outflow_rate_min": 877.3830850445821, "cost2_max": -91.24727004016995, "cost2_mean": -132.97002016318416, "system_level_velocity_mean": 13.051181083384769}, "episode_reward_min": 996.9653054688802, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57aa20>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-06-13", "episodes_this_iter": 28, "timestamp": 1558328773, "episode_reward_max": 1347.2388094070502, "num_metric_batches_dropped": 0, "time_since_restore": 1655.373529434204, "timesteps_total": 2168379, "episode_len_mean": 700.0, "episodes_total": 972, "time_total_s": 1655.373529434204, "info": {"load_time_ms": 7.694, "default": {"vf_loss": 33.91819763183594, "total_loss": 33.912071228027344, "entropy": 1.3568488359451294, "policy_loss": -0.007981009781360626, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7775236368179321, "cur_lr": 0.0005000000237487257, "kl": 0.01856258325278759}, "num_steps_trained": 2168379, "grad_time_ms": 16053.369, "num_steps_sampled": 2168379, "sample_time_ms": 31725.403, "update_time_ms": 8.201}, "episode_reward_mean": 1183.4437672922802, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 50.24997687339783, "iterations_since_restore": 34, "training_iteration": 34, "timesteps_since_restore": 2168379, "timesteps_this_iter": 63841, "custom_metrics": {"system_level_velocity_min": 9.417349612338104, "outflow_rate_max": 1189.9457123168563, "system_level_velocity_max": 16.45244877900106, "cost1_mean": 342.6511146116156, "outflow_rate_mean": 1047.4500280366121, "cost1_min": 246.56945834519163, "cost2_min": -179.2502917146433, "cost1_max": 435.7388896561571, "outflow_rate_min": 877.3830850445821, "cost2_max": -92.16922013855195, "cost2_mean": -134.5706441337484, "system_level_velocity_mean": 12.964180351774381}, "episode_reward_min": 991.9248492447904, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c0b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-07-00", "episodes_this_iter": 29, "timestamp": 1558328820, "episode_reward_max": 1321.5930791919882, "num_metric_batches_dropped": 0, "time_since_restore": 1702.6121668815613, "timesteps_total": 2231210, "episode_len_mean": 700.0, "episodes_total": 1001, "time_total_s": 1702.6121668815613, "info": {"load_time_ms": 7.943, "default": {"vf_loss": 37.23191452026367, "total_loss": 37.22447967529297, "entropy": 1.34818434715271, "policy_loss": -0.009478122927248478, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7790142297744751, "cur_lr": 0.0005000000237487257, "kl": 0.02043711580336094}, "num_steps_trained": 2231210, "grad_time_ms": 16155.131, "num_steps_sampled": 2231210, "sample_time_ms": 31729.393, "update_time_ms": 8.453}, "episode_reward_mean": 1175.4692310782941, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.23863744735718, "iterations_since_restore": 35, "training_iteration": 35, "timesteps_since_restore": 2231210, "timesteps_this_iter": 62831, "custom_metrics": {"system_level_velocity_min": 8.714435622593896, "outflow_rate_max": 1189.9457123168563, "system_level_velocity_max": 16.45244877900106, "cost1_mean": 335.94972773296826, "outflow_rate_mean": 1036.3384676284609, "cost1_min": 228.12068668086937, "cost2_min": -179.2502917146433, "cost1_max": 435.7388896561571, "outflow_rate_min": 854.7271469995894, "cost2_max": -92.16922013855195, "cost2_mean": -136.0361935571287, "system_level_velocity_mean": 12.716833278545534}, "episode_reward_min": 934.8898025932932, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586080>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-07-48", "episodes_this_iter": 29, "timestamp": 1558328868, "episode_reward_max": 1338.8350155481767, "num_metric_batches_dropped": 0, "time_since_restore": 1750.7986211776733, "timesteps_total": 2293021, "episode_len_mean": 700.0, "episodes_total": 1030, "time_total_s": 1750.7986211776733, "info": {"load_time_ms": 8.009, "default": {"vf_loss": 34.87766647338867, "total_loss": 34.870941162109375, "entropy": 1.3431400060653687, "policy_loss": -0.00927346758544445, "cur_kl_coeff": 0.15000000596046448, "vf_explained_var": 0.7971546053886414, "cur_lr": 0.0005000000237487257, "kl": 0.01697731390595436}, "num_steps_trained": 2293021, "grad_time_ms": 16008.09, "num_steps_sampled": 2293021, "sample_time_ms": 31950.817, "update_time_ms": 8.286}, "episode_reward_mean": 1171.9116100706663, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.18645429611206, "iterations_since_restore": 36, "training_iteration": 36, "timesteps_since_restore": 2293021, "timesteps_this_iter": 61811, "custom_metrics": {"system_level_velocity_min": 8.714435622593896, "outflow_rate_max": 1168.61327441522, "system_level_velocity_max": 16.28793002589733, "cost1_mean": 336.98346405035295, "outflow_rate_mean": 1036.56853150191, "cost1_min": 228.12068668086937, "cost2_min": -179.2502917146433, "cost1_max": 430.41848231750015, "outflow_rate_min": 854.7271469995894, "cost2_max": -93.53895194421966, "cost2_mean": -135.21036342088524, "system_level_velocity_mean": 12.75304230528026}, "episode_reward_min": 934.8898025932932, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a63c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bac8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-08-36", "episodes_this_iter": 28, "timestamp": 1558328916, "episode_reward_max": 1338.8350155481767, "num_metric_batches_dropped": 0, "time_since_restore": 1798.6156830787659, "timesteps_total": 2357012, "episode_len_mean": 700.0, "episodes_total": 1058, "time_total_s": 1798.6156830787659, "info": {"load_time_ms": 7.828, "default": {"vf_loss": 32.516395568847656, "total_loss": 32.509620666503906, "entropy": 1.3504459857940674, "policy_loss": -0.009449698962271214, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.8076534867286682, "cur_lr": 0.0005000000237487257, "kl": 0.017823776230216026}, "num_steps_trained": 2357012, "grad_time_ms": 15755.343, "num_steps_sampled": 2357012, "sample_time_ms": 32014.713, "update_time_ms": 8.117}, "episode_reward_mean": 1170.0079726358495, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.81706190109253, "iterations_since_restore": 37, "training_iteration": 37, "timesteps_since_restore": 2357012, "timesteps_this_iter": 63991, "custom_metrics": {"system_level_velocity_min": 8.714435622593896, "outflow_rate_max": 1147.956860891948, "system_level_velocity_max": 15.51054356341363, "cost1_mean": 336.0372103639123, "outflow_rate_mean": 1036.0021278754805, "cost1_min": 228.12068668086937, "cost2_min": -175.61835613705915, "cost1_max": 409.72423933966394, "outflow_rate_min": 854.7271469995894, "cost2_max": -91.09796698222775, "cost2_mean": -135.10553984437735, "system_level_velocity_mean": 12.716150383556736}, "episode_reward_min": 934.8898025932932, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586080>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-09-26", "episodes_this_iter": 29, "timestamp": 1558328966, "episode_reward_max": 1338.8350155481767, "num_metric_batches_dropped": 0, "time_since_restore": 1847.7772369384766, "timesteps_total": 2419096, "episode_len_mean": 700.0, "episodes_total": 1087, "time_total_s": 1847.7772369384766, "info": {"load_time_ms": 8.136, "default": {"vf_loss": 39.157569885253906, "total_loss": 39.15044403076172, "entropy": 1.3528059720993042, "policy_loss": -0.00991134438663721, "cur_kl_coeff": 0.15000000596046448, "vf_explained_var": 0.7602553963661194, "cur_lr": 0.0005000000237487257, "kl": 0.018537018448114395}, "num_steps_trained": 2419096, "grad_time_ms": 15966.392, "num_steps_sampled": 2419096, "sample_time_ms": 32095.324, "update_time_ms": 8.141}, "episode_reward_mean": 1177.7823809482884, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 49.16155385971069, "iterations_since_restore": 38, "training_iteration": 38, "timesteps_since_restore": 2419096, "timesteps_this_iter": 62084, "custom_metrics": {"system_level_velocity_min": 8.714435622593896, "outflow_rate_max": 1154.772414829641, "system_level_velocity_max": 15.569948996019386, "cost1_mean": 339.05049169808467, "outflow_rate_mean": 1040.2598563314502, "cost1_min": 228.12068668086937, "cost2_min": -175.61835613705915, "cost1_max": 414.99454643641786, "outflow_rate_min": 854.7271469995894, "cost2_max": -91.09796698222775, "cost2_mean": -135.70049535491313, "system_level_velocity_mean": 12.818443205703836}, "episode_reward_min": 934.8898025932932, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b7b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-10-12", "episodes_this_iter": 27, "timestamp": 1558329012, "episode_reward_max": 1325.9053501374965, "num_metric_batches_dropped": 0, "time_since_restore": 1894.1390917301178, "timesteps_total": 2479354, "episode_len_mean": 700.0, "episodes_total": 1114, "time_total_s": 1894.1390917301178, "info": {"load_time_ms": 8.263, "default": {"vf_loss": 38.2491455078125, "total_loss": 38.241722106933594, "entropy": 1.3508905172348022, "policy_loss": -0.010253162123262882, "cur_kl_coeff": 0.15000000596046448, "vf_explained_var": 0.7631344795227051, "cur_lr": 0.0005000000237487257, "kl": 0.018892338499426842}, "num_steps_trained": 2479354, "grad_time_ms": 16062.879, "num_steps_sampled": 2479354, "sample_time_ms": 32032.934, "update_time_ms": 8.15}, "episode_reward_mean": 1186.518909720017, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.361854791641235, "iterations_since_restore": 39, "training_iteration": 39, "timesteps_since_restore": 2479354, "timesteps_this_iter": 60258, "custom_metrics": {"system_level_velocity_min": 9.753409059464254, "outflow_rate_max": 1175.4998283985196, "system_level_velocity_max": 15.970834406377131, "cost1_mean": 344.5154470309952, "outflow_rate_mean": 1050.5756849073543, "cost1_min": 258.2344223188524, "cost2_min": -179.12830455189328, "cost1_max": 422.11540846553214, "outflow_rate_min": 912.8748049621165, "cost2_max": -91.09796698222775, "cost2_mean": -136.35380917550287, "system_level_velocity_mean": 13.002741642732191}, "episode_reward_min": 998.6153213979018, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5587b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-10-58", "episodes_this_iter": 30, "timestamp": 1558329058, "episode_reward_max": 1342.3957600748365, "num_metric_batches_dropped": 0, "time_since_restore": 1939.97882437706, "timesteps_total": 2538204, "episode_len_mean": 693.43, "episodes_total": 1144, "time_total_s": 1939.97882437706, "info": {"load_time_ms": 8.242, "default": {"vf_loss": 42.091102600097656, "total_loss": 42.08382797241211, "entropy": 1.3479114770889282, "policy_loss": -0.00999748520553112, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7417879104614258, "cur_lr": 0.0005000000237487257, "kl": 0.018143504858016968}, "num_steps_trained": 2538204, "grad_time_ms": 15824.348, "num_steps_sampled": 2538204, "sample_time_ms": 32048.502, "update_time_ms": 8.054}, "episode_reward_mean": 1173.1485561680063, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.83973264694214, "iterations_since_restore": 40, "training_iteration": 40, "timesteps_since_restore": 2538204, "timesteps_this_iter": 58850, "custom_metrics": {"system_level_velocity_min": 9.961884872511906, "outflow_rate_max": 1175.4998283985196, "system_level_velocity_max": 17.619491831339232, "cost1_mean": 343.12262347238334, "outflow_rate_mean": 1046.6440207165226, "cost1_min": 27.641781520446308, "cost2_min": -179.12830455189328, "cost1_max": 422.11540846553214, "outflow_rate_min": 453.5210579865785, "cost2_max": -28.0359149005348, "cost2_mean": -134.09207066538747, "system_level_velocity_mean": 13.104382461227324}, "episode_reward_min": 64.23753862475554, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ae80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a8d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-11-42", "episodes_this_iter": 29, "timestamp": 1558329102, "episode_reward_max": 1342.3957600748365, "num_metric_batches_dropped": 0, "time_since_restore": 1984.1807634830475, "timesteps_total": 2596900, "episode_len_mean": 693.43, "episodes_total": 1173, "time_total_s": 1984.1807634830475, "info": {"load_time_ms": 8.169, "default": {"vf_loss": 48.21907043457031, "total_loss": 48.21187210083008, "entropy": 1.3442074060440063, "policy_loss": -0.010128059424459934, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.668036162853241, "cur_lr": 0.0005000000237487257, "kl": 0.019546983763575554}, "num_steps_trained": 2596900, "grad_time_ms": 15497.845, "num_steps_sampled": 2596900, "sample_time_ms": 31913.144, "update_time_ms": 7.79}, "episode_reward_mean": 1171.8634170033215, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.20193910598755, "iterations_since_restore": 41, "training_iteration": 41, "timesteps_since_restore": 2596900, "timesteps_this_iter": 58696, "custom_metrics": {"system_level_velocity_min": 9.961884872511906, "outflow_rate_max": 1175.4998283985196, "system_level_velocity_max": 17.619491831339232, "cost1_mean": 349.1497901618819, "outflow_rate_mean": 1049.0903725324122, "cost1_min": 27.641781520446308, "cost2_min": -179.12830455189328, "cost1_max": 422.37739894886374, "outflow_rate_min": 453.5210579865785, "cost2_max": -28.0359149005348, "cost2_mean": -128.6948932276238, "system_level_velocity_mean": 13.332796212805452}, "episode_reward_min": 64.23753862475554, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5867b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5866d8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-12-30", "episodes_this_iter": 31, "timestamp": 1558329150, "episode_reward_max": 1346.9126833350613, "num_metric_batches_dropped": 0, "time_since_restore": 2032.269609928131, "timesteps_total": 2657352, "episode_len_mean": 693.43, "episodes_total": 1204, "time_total_s": 2032.269609928131, "info": {"load_time_ms": 8.363, "default": {"vf_loss": 43.132164001464844, "total_loss": 43.12407302856445, "entropy": 1.3717175722122192, "policy_loss": -0.010841134935617447, "cur_kl_coeff": 0.15000000596046448, "vf_explained_var": 0.7201842069625854, "cur_lr": 0.0005000000237487257, "kl": 0.01835373230278492}, "num_steps_trained": 2657352, "grad_time_ms": 15374.781, "num_steps_sampled": 2657352, "sample_time_ms": 32024.595, "update_time_ms": 7.877}, "episode_reward_mean": 1166.2441085720918, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.08884644508362, "iterations_since_restore": 42, "training_iteration": 42, "timesteps_since_restore": 2657352, "timesteps_this_iter": 60452, "custom_metrics": {"system_level_velocity_min": 9.976139860487518, "outflow_rate_max": 1161.8915720347177, "system_level_velocity_max": 17.619491831339232, "cost1_mean": 351.18375850894097, "outflow_rate_mean": 1047.152171796453, "cost1_min": 27.641781520446308, "cost2_min": -172.79469951119023, "cost1_max": 422.37739894886374, "outflow_rate_min": 453.5210579865785, "cost2_max": -28.0359149005348, "cost2_mean": -125.14083376874174, "system_level_velocity_mean": 13.411706842900857}, "episode_reward_min": 64.23753862475554, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc88>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-13-18", "episodes_this_iter": 30, "timestamp": 1558329198, "episode_reward_max": 1346.9126833350613, "num_metric_batches_dropped": 0, "time_since_restore": 2080.2333483695984, "timesteps_total": 2716413, "episode_len_mean": 700.0, "episodes_total": 1234, "time_total_s": 2080.2333483695984, "info": {"load_time_ms": 8.318, "default": {"vf_loss": 41.94641876220703, "total_loss": 41.93843078613281, "entropy": 1.3713973760604858, "policy_loss": -0.010920565575361252, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.744031548500061, "cur_lr": 0.0005000000237487257, "kl": 0.01955377869307995}, "num_steps_trained": 2716413, "grad_time_ms": 15337.613, "num_steps_sampled": 2716413, "sample_time_ms": 32045.996, "update_time_ms": 7.675}, "episode_reward_mean": 1174.0275398966194, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.963738441467285, "iterations_since_restore": 43, "training_iteration": 43, "timesteps_since_restore": 2716413, "timesteps_this_iter": 59061, "custom_metrics": {"system_level_velocity_min": 10.222966165126133, "outflow_rate_max": 1161.8915720347177, "system_level_velocity_max": 15.966216471349794, "cost1_mean": 351.87386856248287, "outflow_rate_mean": 1046.1925134176527, "cost1_min": 266.60442901438074, "cost2_min": -167.19829884259198, "cost1_max": 422.37739894886374, "outflow_rate_min": 910.2948230673023, "cost2_max": -82.75821154524284, "cost2_mean": -124.52588688702522, "system_level_velocity_mean": 13.269442357623186}, "episode_reward_min": 977.0585581284034, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b240>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-14-05", "episodes_this_iter": 29, "timestamp": 1558329245, "episode_reward_max": 1346.9126833350613, "num_metric_batches_dropped": 0, "time_since_restore": 2126.7383065223694, "timesteps_total": 2775843, "episode_len_mean": 700.0, "episodes_total": 1263, "time_total_s": 2126.7383065223694, "info": {"load_time_ms": 8.076, "default": {"vf_loss": 37.111690521240234, "total_loss": 37.10313415527344, "entropy": 1.381528377532959, "policy_loss": -0.011177875101566315, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7807561755180359, "cur_lr": 0.0005000000237487257, "kl": 0.01748483069241047}, "num_steps_trained": 2775843, "grad_time_ms": 15115.013, "num_steps_sampled": 2775843, "sample_time_ms": 31893.754, "update_time_ms": 7.717}, "episode_reward_mean": 1178.0236381977752, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.504958152770996, "iterations_since_restore": 44, "training_iteration": 44, "timesteps_since_restore": 2775843, "timesteps_this_iter": 59430, "custom_metrics": {"system_level_velocity_min": 9.777503496231546, "outflow_rate_max": 1170.4858968697677, "system_level_velocity_max": 15.966216471349794, "cost1_mean": 351.8963935866387, "outflow_rate_mean": 1046.730962828283, "cost1_min": 254.67544254202767, "cost2_min": -165.77096550897747, "cost1_max": 422.37739894886374, "outflow_rate_min": 877.8850343039543, "cost2_max": -82.75821154524284, "cost2_mean": -122.83253831885708, "system_level_velocity_mean": 13.25831089028647}, "episode_reward_min": 938.6395282569882, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5867b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-14-50", "episodes_this_iter": 30, "timestamp": 1558329290, "episode_reward_max": 1343.2147510193242, "num_metric_batches_dropped": 0, "time_since_restore": 2172.322316646576, "timesteps_total": 2834627, "episode_len_mean": 693.44, "episodes_total": 1293, "time_total_s": 2172.322316646576, "info": {"load_time_ms": 7.977, "default": {"vf_loss": 44.76675796508789, "total_loss": 44.75847244262695, "entropy": 1.3814481496810913, "policy_loss": -0.011695158667862415, "cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.7125856876373291, "cur_lr": 0.0005000000237487257, "kl": 0.02273080311715603}, "num_steps_trained": 2834627, "grad_time_ms": 15082.183, "num_steps_sampled": 2834627, "sample_time_ms": 31761.205, "update_time_ms": 7.73}, "episode_reward_mean": 1168.8670590294737, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.58401012420654, "iterations_since_restore": 45, "training_iteration": 45, "timesteps_since_restore": 2834627, "timesteps_this_iter": 58784, "custom_metrics": {"system_level_velocity_min": 9.777503496231546, "outflow_rate_max": 1170.4858968697677, "system_level_velocity_max": 18.20640395912791, "cost1_mean": 348.2139002427617, "outflow_rate_mean": 1041.3599130415744, "cost1_min": 28.482879773618237, "cost2_min": -165.77096550897747, "cost1_max": 421.26701238498663, "outflow_rate_min": 526.6464874708697, "cost2_max": -19.69544417452877, "cost2_mean": -121.1097431816245, "system_level_velocity_mean": 13.27558463526585}, "episode_reward_min": 74.15517399301724, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bc88>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-15-37", "episodes_this_iter": 29, "timestamp": 1558329337, "episode_reward_max": 1343.2147510193242, "num_metric_batches_dropped": 0, "time_since_restore": 2219.0635466575623, "timesteps_total": 2893273, "episode_len_mean": 693.44, "episodes_total": 1322, "time_total_s": 2219.0635466575623, "info": {"load_time_ms": 8.076, "default": {"vf_loss": 42.35685348510742, "total_loss": 42.348880767822266, "entropy": 1.3921319246292114, "policy_loss": -0.011666749604046345, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.7486693263053894, "cur_lr": 0.0005000000237487257, "kl": 0.01641482301056385}, "num_steps_trained": 2893273, "grad_time_ms": 15264.323, "num_steps_sampled": 2893273, "sample_time_ms": 31431.351, "update_time_ms": 8.047}, "episode_reward_mean": 1181.033762532802, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.74123001098633, "iterations_since_restore": 46, "training_iteration": 46, "timesteps_since_restore": 2893273, "timesteps_this_iter": 58646, "custom_metrics": {"system_level_velocity_min": 9.777503496231546, "outflow_rate_max": 1170.4858968697677, "system_level_velocity_max": 18.20640395912791, "cost1_mean": 352.24766135127044, "outflow_rate_mean": 1046.990510312216, "cost1_min": 28.482879773618237, "cost2_min": -159.26782633477106, "cost1_max": 421.26701238498663, "outflow_rate_min": 526.6464874708697, "cost2_max": -19.69544417452877, "cost2_mean": -119.14489375122943, "system_level_velocity_mean": 13.406744168737752}, "episode_reward_min": 74.15517399301724, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ceb8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-16-24", "episodes_this_iter": 27, "timestamp": 1558329384, "episode_reward_max": 1343.2147510193242, "num_metric_batches_dropped": 0, "time_since_restore": 2265.6365807056427, "timesteps_total": 2952068, "episode_len_mean": 693.44, "episodes_total": 1349, "time_total_s": 2265.6365807056427, "info": {"load_time_ms": 8.064, "default": {"vf_loss": 39.556060791015625, "total_loss": 39.55009078979492, "entropy": 1.3938449621200562, "policy_loss": -0.009842128492891788, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.765018880367279, "cur_lr": 0.0005000000237487257, "kl": 0.017180847004055977}, "num_steps_trained": 2952068, "grad_time_ms": 15400.891, "num_steps_sampled": 2952068, "sample_time_ms": 31170.582, "update_time_ms": 8.27}, "episode_reward_mean": 1185.8170985472468, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.573034048080444, "iterations_since_restore": 47, "training_iteration": 47, "timesteps_since_restore": 2952068, "timesteps_this_iter": 58795, "custom_metrics": {"system_level_velocity_min": 9.777503496231546, "outflow_rate_max": 1164.380951193323, "system_level_velocity_max": 18.20640395912791, "cost1_mean": 352.37378729465104, "outflow_rate_mean": 1047.7188810427333, "cost1_min": 28.482879773618237, "cost2_min": -159.26782633477106, "cost1_max": 419.53170737084224, "outflow_rate_min": 526.6464874708697, "cost2_max": -19.69544417452877, "cost2_mean": -118.18821295449965, "system_level_velocity_mean": 13.389925268060422}, "episode_reward_min": 74.15517399301724, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cdd8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-17-09", "episodes_this_iter": 31, "timestamp": 1558329429, "episode_reward_max": 1343.2147510193242, "num_metric_batches_dropped": 0, "time_since_restore": 2310.8530128002167, "timesteps_total": 3009282, "episode_len_mean": 693.44, "episodes_total": 1380, "time_total_s": 2310.8530128002167, "info": {"load_time_ms": 7.863, "default": {"vf_loss": 50.28538131713867, "total_loss": 50.27891540527344, "entropy": 1.3924554586410522, "policy_loss": -0.01013878919184208, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6829339861869812, "cur_lr": 0.0005000000237487257, "kl": 0.016319505870342255}, "num_steps_trained": 3009282, "grad_time_ms": 15267.16, "num_steps_sampled": 3009282, "sample_time_ms": 30911.441, "update_time_ms": 8.533}, "episode_reward_mean": 1191.8074678959704, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.216432094573975, "iterations_since_restore": 48, "training_iteration": 48, "timesteps_since_restore": 3009282, "timesteps_this_iter": 57214, "custom_metrics": {"system_level_velocity_min": 9.904645630502538, "outflow_rate_max": 1164.380951193323, "system_level_velocity_max": 18.20640395912791, "cost1_mean": 357.1856454391452, "outflow_rate_mean": 1053.8856946877854, "cost1_min": 28.482879773618237, "cost2_min": -159.26782633477106, "cost1_max": 419.53170737084224, "outflow_rate_min": 526.6464874708697, "cost2_max": -19.69544417452877, "cost2_mean": -114.85993714263071, "system_level_velocity_mean": 13.555163474551085}, "episode_reward_min": 74.15517399301724, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5585c0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-17-54", "episodes_this_iter": 27, "timestamp": 1558329474, "episode_reward_max": 1337.4399487699056, "num_metric_batches_dropped": 0, "time_since_restore": 2355.824465751648, "timesteps_total": 3065679, "episode_len_mean": 700.0, "episodes_total": 1407, "time_total_s": 2355.824465751648, "info": {"load_time_ms": 7.695, "default": {"vf_loss": 42.749080657958984, "total_loss": 42.741153717041016, "entropy": 1.3830394744873047, "policy_loss": -0.011604026891291142, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.727512001991272, "cur_lr": 0.0005000000237487257, "kl": 0.016330210492014885}, "num_steps_trained": 3065679, "grad_time_ms": 15287.663, "num_steps_sampled": 3065679, "sample_time_ms": 30752.642, "update_time_ms": 8.526}, "episode_reward_mean": 1191.9828061116718, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.971452951431274, "iterations_since_restore": 49, "training_iteration": 49, "timesteps_since_restore": 3065679, "timesteps_this_iter": 56397, "custom_metrics": {"system_level_velocity_min": 9.815755133191137, "outflow_rate_max": 1152.8958529728368, "system_level_velocity_max": 15.680502394592764, "cost1_mean": 359.15331855392463, "outflow_rate_mean": 1056.050353085255, "cost1_min": 263.53269598687655, "cost2_min": -154.1313908954463, "cost1_max": 414.7891727447583, "outflow_rate_min": 885.6704799646113, "cost2_max": -80.41326833599089, "cost2_mean": -114.31668618211928, "system_level_velocity_mean": 13.455805595082525}, "episode_reward_min": 950.0255090736435, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cdd8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-18-39", "episodes_this_iter": 29, "timestamp": 1558329519, "episode_reward_max": 1331.0560496136918, "num_metric_batches_dropped": 0, "time_since_restore": 2400.627935886383, "timesteps_total": 3121584, "episode_len_mean": 700.0, "episodes_total": 1436, "time_total_s": 2400.627935886383, "info": {"load_time_ms": 7.741, "default": {"vf_loss": 46.69478225708008, "total_loss": 46.68830490112305, "entropy": 1.374685287475586, "policy_loss": -0.010083789005875587, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.689083456993103, "cur_lr": 0.0005000000237487257, "kl": 0.016026990488171577}, "num_steps_trained": 3121584, "grad_time_ms": 15483.593, "num_steps_sampled": 3121584, "sample_time_ms": 30453.628, "update_time_ms": 8.545}, "episode_reward_mean": 1176.827542220778, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.80347013473511, "iterations_since_restore": 50, "training_iteration": 50, "timesteps_since_restore": 3121584, "timesteps_this_iter": 55905, "custom_metrics": {"system_level_velocity_min": 9.815755133191137, "outflow_rate_max": 1152.8958529728368, "system_level_velocity_max": 15.680502394592764, "cost1_mean": 359.2403639136375, "outflow_rate_mean": 1052.4927739064435, "cost1_min": 263.53269598687655, "cost2_min": -154.1313908954463, "cost1_max": 414.7891727447583, "outflow_rate_min": 885.6704799646113, "cost2_max": -80.41326833599089, "cost2_mean": -111.88874165685151, "system_level_velocity_mean": 13.47750695332023}, "episode_reward_min": 950.0255090736435, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558320>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-19-23", "episodes_this_iter": 29, "timestamp": 1558329563, "episode_reward_max": 1319.7502502619943, "num_metric_batches_dropped": 0, "time_since_restore": 2444.5641436576843, "timesteps_total": 3177729, "episode_len_mean": 700.0, "episodes_total": 1465, "time_total_s": 2444.5641436576843, "info": {"load_time_ms": 7.737, "default": {"vf_loss": 50.54750442504883, "total_loss": 50.54048156738281, "entropy": 1.3518434762954712, "policy_loss": -0.010950630530714989, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6326379179954529, "cur_lr": 0.0005000000237487257, "kl": 0.017449598759412766}, "num_steps_trained": 3177729, "grad_time_ms": 15685.573, "num_steps_sampled": 3177729, "sample_time_ms": 30224.345, "update_time_ms": 8.766}, "episode_reward_mean": 1168.9891587464963, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.93620777130127, "iterations_since_restore": 51, "training_iteration": 51, "timesteps_since_restore": 3177729, "timesteps_this_iter": 56145, "custom_metrics": {"system_level_velocity_min": 9.815755133191137, "outflow_rate_max": 1151.0362037966959, "system_level_velocity_max": 15.921061166386343, "cost1_mean": 360.47140018094206, "outflow_rate_mean": 1051.1124532504903, "cost1_min": 263.53269598687655, "cost2_min": -148.10833726971495, "cost1_max": 422.1986241442635, "outflow_rate_min": 885.6704799646113, "cost2_max": -79.06139623897796, "cost2_mean": -109.00052412678457, "system_level_velocity_mean": 13.551070677736488}, "episode_reward_min": 928.827363221424, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c828>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-20-06", "episodes_this_iter": 32, "timestamp": 1558329606, "episode_reward_max": 1319.7502502619943, "num_metric_batches_dropped": 0, "time_since_restore": 2487.0816819667816, "timesteps_total": 3233767, "episode_len_mean": 693.45, "episodes_total": 1497, "time_total_s": 2487.0816819667816, "info": {"load_time_ms": 7.816, "default": {"vf_loss": 56.837093353271484, "total_loss": 56.82955551147461, "entropy": 1.3566886186599731, "policy_loss": -0.01129757147282362, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.5937331914901733, "cur_lr": 0.0005000000237487257, "kl": 0.016692087054252625}, "num_steps_trained": 3233767, "grad_time_ms": 15694.204, "num_steps_sampled": 3233767, "sample_time_ms": 29661.404, "update_time_ms": 8.813}, "episode_reward_mean": 1155.8917043974968, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 42.51753830909729, "iterations_since_restore": 52, "training_iteration": 52, "timesteps_since_restore": 3233767, "timesteps_this_iter": 56038, "custom_metrics": {"system_level_velocity_min": 10.581144470361078, "outflow_rate_max": 1143.310990570008, "system_level_velocity_max": 17.766430693077762, "cost1_mean": 360.6142231818809, "outflow_rate_mean": 1048.8558264650867, "cost1_min": 28.93908066579863, "cost2_min": -142.1660063269382, "cost1_max": 422.1986241442635, "outflow_rate_min": 507.7436805404866, "cost2_max": -21.177545081474957, "cost2_mean": -104.74049304402769, "system_level_velocity_mean": 13.739671046483094}, "episode_reward_min": 70.05249803231668, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5585c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558470>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-20-49", "episodes_this_iter": 31, "timestamp": 1558329649, "episode_reward_max": 1302.2765954340666, "num_metric_batches_dropped": 0, "time_since_restore": 2530.7003304958344, "timesteps_total": 3290241, "episode_len_mean": 693.45, "episodes_total": 1528, "time_total_s": 2530.7003304958344, "info": {"load_time_ms": 7.817, "default": {"vf_loss": 52.58390808105469, "total_loss": 52.577354431152344, "entropy": 1.3766554594039917, "policy_loss": -0.010126253589987755, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6217730045318604, "cur_lr": 0.0005000000237487257, "kl": 0.015863755717873573}, "num_steps_trained": 3290241, "grad_time_ms": 15498.041, "num_steps_sampled": 3290241, "sample_time_ms": 29422.075, "update_time_ms": 8.957}, "episode_reward_mean": 1150.4550554721818, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.618648529052734, "iterations_since_restore": 53, "training_iteration": 53, "timesteps_since_restore": 3290241, "timesteps_this_iter": 56474, "custom_metrics": {"system_level_velocity_min": 10.581144470361078, "outflow_rate_max": 1143.310990570008, "system_level_velocity_max": 17.766430693077762, "cost1_mean": 362.0800718540931, "outflow_rate_mean": 1051.060550690801, "cost1_min": 28.93908066579863, "cost2_min": -136.54489324652565, "cost1_max": 422.1986241442635, "outflow_rate_min": 507.7436805404866, "cost2_max": -21.177545081474957, "cost2_mean": -104.1605745456108, "system_level_velocity_mean": 13.8113783557836}, "episode_reward_min": 70.05249803231668, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583e10>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-21-34", "episodes_this_iter": 29, "timestamp": 1558329694, "episode_reward_max": 1311.7932345341574, "num_metric_batches_dropped": 0, "time_since_restore": 2574.967319250107, "timesteps_total": 3347866, "episode_len_mean": 693.45, "episodes_total": 1557, "time_total_s": 2574.967319250107, "info": {"load_time_ms": 7.981, "default": {"vf_loss": 48.6676025390625, "total_loss": 48.66093444824219, "entropy": 1.3885406255722046, "policy_loss": -0.010434426367282867, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.6486949324607849, "cur_lr": 0.0005000000237487257, "kl": 0.01672707125544548}, "num_steps_trained": 3347866, "grad_time_ms": 15423.971, "num_steps_sampled": 3347866, "sample_time_ms": 29274.514, "update_time_ms": 9.034}, "episode_reward_mean": 1144.328161701207, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.26698875427246, "iterations_since_restore": 54, "training_iteration": 54, "timesteps_since_restore": 3347866, "timesteps_this_iter": 57625, "custom_metrics": {"system_level_velocity_min": 10.257187376434294, "outflow_rate_max": 1153.3019981279251, "system_level_velocity_max": 17.766430693077762, "cost1_mean": 359.4729420074793, "outflow_rate_mean": 1046.8969993807543, "cost1_min": 28.93908066579863, "cost2_min": -149.17513855837913, "cost1_max": 422.1986241442635, "outflow_rate_min": 507.7436805404866, "cost2_max": -21.177545081474957, "cost2_mean": -105.30302566764709, "system_level_velocity_mean": 13.717367018306277}, "episode_reward_min": 70.05249803231668, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bcc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560630>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-22-17", "episodes_this_iter": 31, "timestamp": 1558329737, "episode_reward_max": 1338.4983737339066, "num_metric_batches_dropped": 0, "time_since_restore": 2618.463492155075, "timesteps_total": 3404678, "episode_len_mean": 700.0, "episodes_total": 1588, "time_total_s": 2618.463492155075, "info": {"load_time_ms": 7.995, "default": {"vf_loss": 48.85976028442383, "total_loss": 48.852272033691406, "entropy": 1.3753948211669922, "policy_loss": -0.01159057766199112, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.652157187461853, "cur_lr": 0.0005000000237487257, "kl": 0.01823904551565647}, "num_steps_trained": 3404678, "grad_time_ms": 15383.85, "num_steps_sampled": 3404678, "sample_time_ms": 29105.961, "update_time_ms": 8.833}, "episode_reward_mean": 1165.6905018648815, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.49617290496826, "iterations_since_restore": 55, "training_iteration": 55, "timesteps_since_restore": 3404678, "timesteps_this_iter": 56812, "custom_metrics": {"system_level_velocity_min": 10.257187376434294, "outflow_rate_max": 1153.3019981279251, "system_level_velocity_max": 15.518456957055085, "cost1_mean": 363.9460991413489, "outflow_rate_mean": 1053.6086005300517, "cost1_min": 274.87795161665474, "cost2_min": -149.17513855837913, "cost1_max": 412.5384331499047, "outflow_rate_min": 914.6005044804966, "cost2_max": -64.68884853552535, "cost2_mean": -105.30216920762786, "system_level_velocity_mean": 13.712461139249454}, "episode_reward_min": 982.8713212610613, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5602b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-22-59", "episodes_this_iter": 27, "timestamp": 1558329779, "episode_reward_max": 1338.4983737339066, "num_metric_batches_dropped": 0, "time_since_restore": 2660.6135761737823, "timesteps_total": 3458988, "episode_len_mean": 700.0, "episodes_total": 1615, "time_total_s": 2660.6135761737823, "info": {"load_time_ms": 7.859, "default": {"vf_loss": 47.165443420410156, "total_loss": 47.15804672241211, "entropy": 1.371910572052002, "policy_loss": -0.011159278452396393, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6287057995796204, "cur_lr": 0.0005000000237487257, "kl": 0.01669890806078911}, "num_steps_trained": 3458988, "grad_time_ms": 15147.134, "num_steps_sampled": 3458988, "sample_time_ms": 28885.156, "update_time_ms": 8.848}, "episode_reward_mean": 1178.5998774233512, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 42.150084018707275, "iterations_since_restore": 56, "training_iteration": 56, "timesteps_since_restore": 3458988, "timesteps_this_iter": 54310, "custom_metrics": {"system_level_velocity_min": 10.257187376434294, "outflow_rate_max": 1155.1573455513699, "system_level_velocity_max": 15.529781982621722, "cost1_mean": 366.69761615848313, "outflow_rate_mean": 1054.5145324075238, "cost1_min": 274.87795161665474, "cost2_min": -149.17513855837913, "cost1_max": 414.31582671177136, "outflow_rate_min": 914.6005044804966, "cost2_max": -64.68884853552535, "cost2_mean": -103.50694055670512, "system_level_velocity_mean": 13.820499122170565}, "episode_reward_min": 982.8713212610613, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586e48>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-23-45", "episodes_this_iter": 31, "timestamp": 1558329825, "episode_reward_max": 1338.4983737339066, "num_metric_batches_dropped": 0, "time_since_restore": 2706.3768031597137, "timesteps_total": 3516594, "episode_len_mean": 700.0, "episodes_total": 1646, "time_total_s": 2706.3768031597137, "info": {"load_time_ms": 7.802, "default": {"vf_loss": 52.53632354736328, "total_loss": 52.52977752685547, "entropy": 1.404336929321289, "policy_loss": -0.009995715692639351, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.6617393493652344, "cur_lr": 0.0005000000237487257, "kl": 0.015338575467467308}, "num_steps_trained": 3516594, "grad_time_ms": 15066.539, "num_steps_sampled": 3516594, "sample_time_ms": 28883.293, "update_time_ms": 8.852}, "episode_reward_mean": 1187.1497333391424, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.7632269859314, "iterations_since_restore": 57, "training_iteration": 57, "timesteps_since_restore": 3516594, "timesteps_this_iter": 57606, "custom_metrics": {"system_level_velocity_min": 10.257187376434294, "outflow_rate_max": 1155.1573455513699, "system_level_velocity_max": 15.710906140732686, "cost1_mean": 369.6865221490129, "outflow_rate_mean": 1060.0319393159357, "cost1_min": 274.87795161665474, "cost2_min": -143.79948887477235, "cost1_max": 416.6392623384319, "outflow_rate_min": 914.6005044804966, "cost2_max": -64.68884853552535, "cost2_mean": -102.98328757652709, "system_level_velocity_mean": 13.933450099871225}, "episode_reward_min": 1013.0006046051312, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a668>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-24-32", "episodes_this_iter": 31, "timestamp": 1558329872, "episode_reward_max": 1310.1275958226825, "num_metric_batches_dropped": 0, "time_since_restore": 2752.9210562705994, "timesteps_total": 3574577, "episode_len_mean": 700.0, "episodes_total": 1677, "time_total_s": 2752.9210562705994, "info": {"load_time_ms": 7.801, "default": {"vf_loss": 51.95556640625, "total_loss": 51.94850158691406, "entropy": 1.399654746055603, "policy_loss": -0.010586430318653584, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6720154285430908, "cur_lr": 0.0005000000237487257, "kl": 0.01563095673918724}, "num_steps_trained": 3574577, "grad_time_ms": 15150.146, "num_steps_sampled": 3574577, "sample_time_ms": 28931.618, "update_time_ms": 9.203}, "episode_reward_mean": 1188.741717954956, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.54425311088562, "iterations_since_restore": 58, "training_iteration": 58, "timesteps_since_restore": 3574577, "timesteps_this_iter": 57983, "custom_metrics": {"system_level_velocity_min": 10.408755697998949, "outflow_rate_max": 1172.7201187903077, "system_level_velocity_max": 15.955124560049553, "cost1_mean": 369.8171835894351, "outflow_rate_mean": 1061.3733334581405, "cost1_min": 278.06417067675306, "cost2_min": -154.16730846885474, "cost1_max": 422.80088915501943, "outflow_rate_min": 932.7094652749024, "cost2_max": -64.68884853552535, "cost2_mean": -104.52545710733024, "system_level_velocity_mean": 13.936632429634876}, "episode_reward_min": 1013.0006046051312, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5609b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560240>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-25-16", "episodes_this_iter": 30, "timestamp": 1558329916, "episode_reward_max": 1310.1275958226825, "num_metric_batches_dropped": 0, "time_since_restore": 2797.286425590515, "timesteps_total": 3632706, "episode_len_mean": 693.23, "episodes_total": 1707, "time_total_s": 2797.286425590515, "info": {"load_time_ms": 7.956, "default": {"vf_loss": 49.18878173828125, "total_loss": 49.181129455566406, "entropy": 1.4301695823669434, "policy_loss": -0.011240549385547638, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6871024370193481, "cur_lr": 0.0005000000237487257, "kl": 0.015939000993967056}, "num_steps_trained": 3632706, "grad_time_ms": 14993.514, "num_steps_sampled": 3632706, "sample_time_ms": 29026.335, "update_time_ms": 9.311}, "episode_reward_mean": 1170.3313707106022, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.36536931991577, "iterations_since_restore": 59, "training_iteration": 59, "timesteps_since_restore": 3632706, "timesteps_this_iter": 58129, "custom_metrics": {"system_level_velocity_min": 10.408755697998949, "outflow_rate_max": 1172.7201187903077, "system_level_velocity_max": 17.349925370328172, "cost1_mean": 361.3635887913563, "outflow_rate_mean": 1049.8372118418636, "cost1_min": 15.091717118242661, "cost2_min": -154.16730846885474, "cost1_max": 422.80088915501943, "outflow_rate_min": 476.4898462992569, "cost2_max": -15.615379697835927, "cost2_mean": -107.0184981149264, "system_level_velocity_mean": 13.785449410218895}, "episode_reward_min": 34.771536465560935, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56ceb8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-26-02", "episodes_this_iter": 30, "timestamp": 1558329962, "episode_reward_max": 1298.8216099275105, "num_metric_batches_dropped": 0, "time_since_restore": 2843.2615461349487, "timesteps_total": 3691648, "episode_len_mean": 693.23, "episodes_total": 1737, "time_total_s": 2843.2615461349487, "info": {"load_time_ms": 8.067, "default": {"vf_loss": 45.278594970703125, "total_loss": 45.271087646484375, "entropy": 1.431452751159668, "policy_loss": -0.011217807419598103, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.7016971707344055, "cur_lr": 0.0005000000237487257, "kl": 0.01649029739201069}, "num_steps_trained": 3691648, "grad_time_ms": 14828.818, "num_steps_sampled": 3691648, "sample_time_ms": 29307.405, "update_time_ms": 9.275}, "episode_reward_mean": 1154.8643285481944, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.975120544433594, "iterations_since_restore": 60, "training_iteration": 60, "timesteps_since_restore": 3691648, "timesteps_this_iter": 58942, "custom_metrics": {"system_level_velocity_min": 10.280815651661385, "outflow_rate_max": 1172.7201187903077, "system_level_velocity_max": 17.349925370328172, "cost1_mean": 353.92615079639654, "outflow_rate_mean": 1038.6887380114324, "cost1_min": 15.091717118242661, "cost2_min": -154.16730846885474, "cost1_max": 422.80088915501943, "outflow_rate_min": 476.4898462992569, "cost2_max": -15.615379697835927, "cost2_mean": -110.85814422825656, "system_level_velocity_mean": 13.502479618317548}, "episode_reward_min": 34.771536465560935, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5606a0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-26-49", "episodes_this_iter": 29, "timestamp": 1558330009, "episode_reward_max": 1298.8216099275105, "num_metric_batches_dropped": 0, "time_since_restore": 2890.3519144058228, "timesteps_total": 3750776, "episode_len_mean": 693.23, "episodes_total": 1766, "time_total_s": 2890.3519144058228, "info": {"load_time_ms": 7.95, "default": {"vf_loss": 47.36600112915039, "total_loss": 47.35894012451172, "entropy": 1.4222491979599, "policy_loss": -0.010811134241521358, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6749863624572754, "cur_lr": 0.0005000000237487257, "kl": 0.016649246215820312}, "num_steps_trained": 3750776, "grad_time_ms": 14765.474, "num_steps_sampled": 3750776, "sample_time_ms": 29685.984, "update_time_ms": 9.214}, "episode_reward_mean": 1153.8898072212107, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.09036827087402, "iterations_since_restore": 61, "training_iteration": 61, "timesteps_since_restore": 3750776, "timesteps_this_iter": 59128, "custom_metrics": {"system_level_velocity_min": 10.280815651661385, "outflow_rate_max": 1172.7201187903077, "system_level_velocity_max": 17.349925370328172, "cost1_mean": 351.0633534277551, "outflow_rate_mean": 1034.6343839556353, "cost1_min": 15.091717118242661, "cost2_min": -150.723801594863, "cost1_max": 422.80088915501943, "outflow_rate_min": 476.4898462992569, "cost2_max": -15.615379697835927, "cost2_mean": -110.85523354085444, "system_level_velocity_mean": 13.401333171113839}, "episode_reward_min": 34.771536465560935, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cf60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b5f8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-27-36", "episodes_this_iter": 30, "timestamp": 1558330056, "episode_reward_max": 1322.0397407935166, "num_metric_batches_dropped": 0, "time_since_restore": 2937.5326993465424, "timesteps_total": 3808337, "episode_len_mean": 700.0, "episodes_total": 1796, "time_total_s": 2937.5326993465424, "info": {"load_time_ms": 7.95, "default": {"vf_loss": 45.354942321777344, "total_loss": 45.34775924682617, "entropy": 1.444048523902893, "policy_loss": -0.010918001644313335, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.7078699469566345, "cur_lr": 0.0005000000237487257, "kl": 0.016616981476545334}, "num_steps_trained": 3808337, "grad_time_ms": 14791.164, "num_steps_sampled": 3808337, "sample_time_ms": 30122.532, "update_time_ms": 9.407}, "episode_reward_mean": 1150.7755945807783, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.180784940719604, "iterations_since_restore": 62, "training_iteration": 62, "timesteps_since_restore": 3808337, "timesteps_this_iter": 57561, "custom_metrics": {"system_level_velocity_min": 10.280815651661385, "outflow_rate_max": 1141.5249664665782, "system_level_velocity_max": 15.743451456369392, "cost1_mean": 349.6860530407916, "outflow_rate_mean": 1033.567424166938, "cost1_min": 274.2918531742138, "cost2_min": -150.723801594863, "cost1_max": 420.0198984732543, "outflow_rate_min": 878.3908067926064, "cost2_max": -71.94146109170482, "cost2_mean": -113.6198754179546, "system_level_velocity_mean": 13.174979931540044}, "episode_reward_min": 992.2385942183761, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5835c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5830b8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-28-20", "episodes_this_iter": 32, "timestamp": 1558330100, "episode_reward_max": 1322.0397407935166, "num_metric_batches_dropped": 0, "time_since_restore": 2980.8525488376617, "timesteps_total": 3865125, "episode_len_mean": 694.37, "episodes_total": 1828, "time_total_s": 2980.8525488376617, "info": {"load_time_ms": 8.105, "default": {"vf_loss": 51.8582649230957, "total_loss": 51.849117279052734, "entropy": 1.425228476524353, "policy_loss": -0.013138252310454845, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6763315796852112, "cur_lr": 0.0005000000237487257, "kl": 0.017718125134706497}, "num_steps_trained": 3865125, "grad_time_ms": 14764.591, "num_steps_sampled": 3865125, "sample_time_ms": 30120.861, "update_time_ms": 9.253}, "episode_reward_mean": 1148.104245401756, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.319849491119385, "iterations_since_restore": 63, "training_iteration": 63, "timesteps_since_restore": 3865125, "timesteps_this_iter": 56788, "custom_metrics": {"system_level_velocity_min": 10.322762053140027, "outflow_rate_max": 1141.5249664665782, "system_level_velocity_max": 16.527801600433577, "cost1_mean": 353.9536683360656, "outflow_rate_mean": 1041.1065047779869, "cost1_min": 85.14703344803752, "cost2_min": -150.723801594863, "cost1_max": 420.0198984732543, "outflow_rate_min": 698.2733929178335, "cost2_max": -37.63462101567378, "cost2_mean": -108.9187821683257, "system_level_velocity_mean": 13.472836605626604}, "episode_reward_min": 250.89363498094147, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c908>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-29-05", "episodes_this_iter": 29, "timestamp": 1558330145, "episode_reward_max": 1322.0397407935166, "num_metric_batches_dropped": 0, "time_since_restore": 3025.6832637786865, "timesteps_total": 3922883, "episode_len_mean": 694.37, "episodes_total": 1857, "time_total_s": 3025.6832637786865, "info": {"load_time_ms": 8.031, "default": {"vf_loss": 52.478431701660156, "total_loss": 52.470924377441406, "entropy": 1.4323023557662964, "policy_loss": -0.01128065399825573, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6660264730453491, "cur_lr": 0.0005000000237487257, "kl": 0.016787666827440262}, "num_steps_trained": 3922883, "grad_time_ms": 14690.701, "num_steps_sampled": 3922883, "sample_time_ms": 30251.063, "update_time_ms": 9.11}, "episode_reward_mean": 1152.4412838471562, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.83071494102478, "iterations_since_restore": 64, "training_iteration": 64, "timesteps_since_restore": 3922883, "timesteps_this_iter": 57758, "custom_metrics": {"system_level_velocity_min": 9.733823749076814, "outflow_rate_max": 1141.5249664665782, "system_level_velocity_max": 16.527801600433577, "cost1_mean": 355.70643266520966, "outflow_rate_mean": 1040.4201912456265, "cost1_min": 85.14703344803752, "cost2_min": -138.6928014033639, "cost1_max": 412.624179696381, "outflow_rate_min": 698.2733929178335, "cost2_max": -37.63462101567378, "cost2_mean": -104.18057340254589, "system_level_velocity_mean": 13.545684602030553}, "episode_reward_min": 250.89363498094147, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5838d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583208>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-29-50", "episodes_this_iter": 30, "timestamp": 1558330190, "episode_reward_max": 1305.9446635626853, "num_metric_batches_dropped": 0, "time_since_restore": 3071.267271757126, "timesteps_total": 3979416, "episode_len_mean": 694.37, "episodes_total": 1887, "time_total_s": 3071.267271757126, "info": {"load_time_ms": 7.992, "default": {"vf_loss": 45.65673828125, "total_loss": 45.648990631103516, "entropy": 1.4247918128967285, "policy_loss": -0.011462057940661907, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.6893414258956909, "cur_lr": 0.0005000000237487257, "kl": 0.016519103199243546}, "num_steps_trained": 3979416, "grad_time_ms": 14658.678, "num_steps_sampled": 3979416, "sample_time_ms": 30492.018, "update_time_ms": 9.126}, "episode_reward_mean": 1146.500442584847, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.58400797843933, "iterations_since_restore": 65, "training_iteration": 65, "timesteps_since_restore": 3979416, "timesteps_this_iter": 56533, "custom_metrics": {"system_level_velocity_min": 9.733823749076814, "outflow_rate_max": 1144.4139620311396, "system_level_velocity_max": 16.527801600433577, "cost1_mean": 358.18605634806875, "outflow_rate_mean": 1042.6403062821296, "cost1_min": 85.14703344803752, "cost2_min": -137.329005873388, "cost1_max": 412.82372584606406, "outflow_rate_min": 698.2733929178335, "cost2_max": -37.63462101567378, "cost2_mean": -101.22896446976529, "system_level_velocity_mean": 13.64776327936804}, "episode_reward_min": 250.89363498094147, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ad30>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-30-37", "episodes_this_iter": 29, "timestamp": 1558330237, "episode_reward_max": 1305.9446635626853, "num_metric_batches_dropped": 0, "time_since_restore": 3117.5201909542084, "timesteps_total": 4036078, "episode_len_mean": 693.19, "episodes_total": 1916, "time_total_s": 3117.5201909542084, "info": {"load_time_ms": 7.975, "default": {"vf_loss": 46.03855895996094, "total_loss": 46.03113555908203, "entropy": 1.4346617460250854, "policy_loss": -0.011436640284955502, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.7032971978187561, "cur_lr": 0.0005000000237487257, "kl": 0.017850002273917198}, "num_steps_trained": 4036078, "grad_time_ms": 14797.551, "num_steps_sampled": 4036078, "sample_time_ms": 30762.784, "update_time_ms": 9.133}, "episode_reward_mean": 1150.239778030927, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.25291919708252, "iterations_since_restore": 66, "training_iteration": 66, "timesteps_since_restore": 4036078, "timesteps_this_iter": 56662, "custom_metrics": {"system_level_velocity_min": 9.595407092032273, "outflow_rate_max": 1144.4139620311396, "system_level_velocity_max": 16.687414586080706, "cost1_mean": 362.70490197869907, "outflow_rate_mean": 1043.8758179833649, "cost1_min": 12.380252177982813, "cost2_min": -137.329005873388, "cost1_max": 416.74960108560526, "outflow_rate_min": 459.24275550364274, "cost2_max": -13.868913182344253, "cost2_mean": -96.35937433337709, "system_level_velocity_mean": 13.857695451765979}, "episode_reward_min": 35.308486566960525, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5609b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-31-22", "episodes_this_iter": 29, "timestamp": 1558330282, "episode_reward_max": 1305.9446635626853, "num_metric_batches_dropped": 0, "time_since_restore": 3163.036205291748, "timesteps_total": 4092704, "episode_len_mean": 693.19, "episodes_total": 1945, "time_total_s": 3163.036205291748, "info": {"load_time_ms": 7.84, "default": {"vf_loss": 46.99689865112305, "total_loss": 46.99011993408203, "entropy": 1.4461466073989868, "policy_loss": -0.010493180714547634, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.7117004990577698, "cur_lr": 0.0005000000237487257, "kl": 0.016497399657964706}, "num_steps_trained": 4092704, "grad_time_ms": 14817.408, "num_steps_sampled": 4092704, "sample_time_ms": 30719.57, "update_time_ms": 9.173}, "episode_reward_mean": 1145.5215870778334, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.51601433753967, "iterations_since_restore": 67, "training_iteration": 67, "timesteps_since_restore": 4092704, "timesteps_this_iter": 56626, "custom_metrics": {"system_level_velocity_min": 9.469228500804363, "outflow_rate_max": 1144.4139620311396, "system_level_velocity_max": 16.687414586080706, "cost1_mean": 361.2493360375782, "outflow_rate_mean": 1039.2554367417804, "cost1_min": 12.380252177982813, "cost2_min": -137.329005873388, "cost1_max": 416.74960108560526, "outflow_rate_min": 459.24275550364274, "cost2_max": -13.868913182344253, "cost2_mean": -96.24410635476188, "system_level_velocity_mean": 13.802368246331163}, "episode_reward_min": 35.308486566960525, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ad68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a6d8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-32-09", "episodes_this_iter": 29, "timestamp": 1558330329, "episode_reward_max": 1281.3135506231076, "num_metric_batches_dropped": 0, "time_since_restore": 3209.69957947731, "timesteps_total": 4150675, "episode_len_mean": 693.19, "episodes_total": 1974, "time_total_s": 3209.69957947731, "info": {"load_time_ms": 7.869, "default": {"vf_loss": 49.04184341430664, "total_loss": 49.03373718261719, "entropy": 1.4843944311141968, "policy_loss": -0.012260938994586468, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.7035897970199585, "cur_lr": 0.0005000000237487257, "kl": 0.018476346507668495}, "num_steps_trained": 4150675, "grad_time_ms": 14755.965, "num_steps_sampled": 4150675, "sample_time_ms": 30792.921, "update_time_ms": 8.618}, "episode_reward_mean": 1135.4421261728444, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.663374185562134, "iterations_since_restore": 68, "training_iteration": 68, "timesteps_since_restore": 4150675, "timesteps_this_iter": 57971, "custom_metrics": {"system_level_velocity_min": 9.469228500804363, "outflow_rate_max": 1137.3048666407024, "system_level_velocity_max": 16.687414586080706, "cost1_mean": 358.06817828705215, "outflow_rate_mean": 1033.6139459586523, "cost1_min": 12.380252177982813, "cost2_min": -137.329005873388, "cost1_max": 416.74960108560526, "outflow_rate_min": 459.24275550364274, "cost2_max": -13.868913182344253, "cost2_mean": -97.6918453285713, "system_level_velocity_mean": 13.687857459697529}, "episode_reward_min": 35.308486566960525, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57beb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57ba90>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-32-56", "episodes_this_iter": 29, "timestamp": 1558330376, "episode_reward_max": 1299.3478762861223, "num_metric_batches_dropped": 0, "time_since_restore": 3256.511025905609, "timesteps_total": 4209570, "episode_len_mean": 693.19, "episodes_total": 2003, "time_total_s": 3256.511025905609, "info": {"load_time_ms": 7.786, "default": {"vf_loss": 44.018653869628906, "total_loss": 44.01182556152344, "entropy": 1.4864850044250488, "policy_loss": -0.010194861330091953, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.7158769965171814, "cur_lr": 0.0005000000237487257, "kl": 0.014987459406256676}, "num_steps_trained": 4209570, "grad_time_ms": 15003.289, "num_steps_sampled": 4209570, "sample_time_ms": 30791.63, "update_time_ms": 8.466}, "episode_reward_mean": 1133.2306604879561, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.81144642829895, "iterations_since_restore": 69, "training_iteration": 69, "timesteps_since_restore": 4209570, "timesteps_this_iter": 58895, "custom_metrics": {"system_level_velocity_min": 9.469228500804363, "outflow_rate_max": 1149.4226722632777, "system_level_velocity_max": 16.687414586080706, "cost1_mean": 350.11209732899437, "outflow_rate_mean": 1023.050957368743, "cost1_min": 12.380252177982813, "cost2_min": -132.18213542733707, "cost1_max": 416.74960108560526, "outflow_rate_min": 459.24275550364274, "cost2_max": -13.868913182344253, "cost2_mean": -102.12911238844579, "system_level_velocity_mean": 13.378340674449792}, "episode_reward_min": 35.308486566960525, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5838d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583b38>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-33-43", "episodes_this_iter": 29, "timestamp": 1558330423, "episode_reward_max": 1299.3478762861223, "num_metric_batches_dropped": 0, "time_since_restore": 3304.0934886932373, "timesteps_total": 4268754, "episode_len_mean": 700.0, "episodes_total": 2032, "time_total_s": 3304.0934886932373, "info": {"load_time_ms": 7.816, "default": {"vf_loss": 42.526512145996094, "total_loss": 42.51764678955078, "entropy": 1.4906913042068481, "policy_loss": -0.012758697383105755, "cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.734328031539917, "cur_lr": 0.0005000000237487257, "kl": 0.017313236370682716}, "num_steps_trained": 4268754, "grad_time_ms": 15235.994, "num_steps_sampled": 4268754, "sample_time_ms": 30717.218, "update_time_ms": 8.758}, "episode_reward_mean": 1131.6506878708371, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.582462787628174, "iterations_since_restore": 70, "training_iteration": 70, "timesteps_since_restore": 4268754, "timesteps_this_iter": 59184, "custom_metrics": {"system_level_velocity_min": 9.469228500804363, "outflow_rate_max": 1149.4226722632777, "system_level_velocity_max": 15.563281905340874, "cost1_mean": 346.4752818806767, "outflow_rate_mean": 1021.8948469804282, "cost1_min": 249.58350081489687, "cost2_min": -139.2078973838449, "cost1_max": 413.04525903159373, "outflow_rate_min": 844.5664446328196, "cost2_max": -60.8555539741251, "cost2_mean": -106.30150903238167, "system_level_velocity_mean": 13.083044818169752}, "episode_reward_min": 926.5083510209819, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d2978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a63c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560940>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-34-28", "episodes_this_iter": 33, "timestamp": 1558330468, "episode_reward_max": 1324.8699533736885, "num_metric_batches_dropped": 0, "time_since_restore": 3348.2568724155426, "timesteps_total": 4326481, "episode_len_mean": 693.36, "episodes_total": 2065, "time_total_s": 3348.2568724155426, "info": {"load_time_ms": 8.062, "default": {"vf_loss": 47.038150787353516, "total_loss": 47.02954864501953, "entropy": 1.4727766513824463, "policy_loss": -0.012535834684967995, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.7172292470932007, "cur_lr": 0.0005000000237487257, "kl": 0.01747930236160755}, "num_steps_trained": 4326481, "grad_time_ms": 15156.083, "num_steps_sampled": 4326481, "sample_time_ms": 30504.223, "update_time_ms": 8.863}, "episode_reward_mean": 1128.8541313547978, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.1633837223053, "iterations_since_restore": 71, "training_iteration": 71, "timesteps_since_restore": 4326481, "timesteps_this_iter": 57727, "custom_metrics": {"system_level_velocity_min": 9.726831563344668, "outflow_rate_max": 1158.2436310982562, "system_level_velocity_max": 17.297848481194286, "cost1_mean": 346.89234255868485, "outflow_rate_mean": 1024.3943540244254, "cost1_min": 23.420752396760175, "cost2_min": -140.68239524064535, "cost1_max": 423.17006407033625, "outflow_rate_min": 460.7986147915604, "cost2_max": -20.92621737288962, "cost2_mean": -106.55144019860232, "system_level_velocity_mean": 13.257891601653814}, "episode_reward_min": 59.729066744316185, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57add8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a8d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-35-12", "episodes_this_iter": 28, "timestamp": 1558330512, "episode_reward_max": 1324.8699533736885, "num_metric_batches_dropped": 0, "time_since_restore": 3392.946715116501, "timesteps_total": 4386028, "episode_len_mean": 693.36, "episodes_total": 2093, "time_total_s": 3392.946715116501, "info": {"load_time_ms": 8.04, "default": {"vf_loss": 41.27656173706055, "total_loss": 41.269248962402344, "entropy": 1.5048797130584717, "policy_loss": -0.01105459313839674, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.7365987300872803, "cur_lr": 0.0005000000237487257, "kl": 0.016644887626171112}, "num_steps_trained": 4386028, "grad_time_ms": 15010.228, "num_steps_sampled": 4386028, "sample_time_ms": 30404.287, "update_time_ms": 8.48}, "episode_reward_mean": 1132.205050586187, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.68984270095825, "iterations_since_restore": 72, "training_iteration": 72, "timesteps_since_restore": 4386028, "timesteps_this_iter": 59547, "custom_metrics": {"system_level_velocity_min": 10.199854919215777, "outflow_rate_max": 1158.2436310982562, "system_level_velocity_max": 17.297848481194286, "cost1_mean": 348.45710707789505, "outflow_rate_mean": 1029.9370178977529, "cost1_min": 23.420752396760175, "cost2_min": -147.20524101215858, "cost1_max": 423.17006407033625, "outflow_rate_min": 460.7986147915604, "cost2_max": -20.92621737288962, "cost2_mean": -108.46716830583065, "system_level_velocity_mean": 13.319624300920006}, "episode_reward_min": 59.729066744316185, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e560710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5604a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5609b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-35-58", "episodes_this_iter": 31, "timestamp": 1558330558, "episode_reward_max": 1360.8367644894354, "num_metric_batches_dropped": 0, "time_since_restore": 3438.3900275230408, "timesteps_total": 4445623, "episode_len_mean": 693.36, "episodes_total": 2124, "time_total_s": 3438.3900275230408, "info": {"load_time_ms": 7.641, "default": {"vf_loss": 43.50825500488281, "total_loss": 43.5004997253418, "entropy": 1.5169988870620728, "policy_loss": -0.011571119539439678, "cur_kl_coeff": 0.22499996423721313, "vf_explained_var": 0.7548314929008484, "cur_lr": 0.0005000000237487257, "kl": 0.01695607230067253}, "num_steps_trained": 4445623, "grad_time_ms": 15061.811, "num_steps_sampled": 4445623, "sample_time_ms": 30565.479, "update_time_ms": 8.451}, "episode_reward_mean": 1146.4823064943466, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.44331240653992, "iterations_since_restore": 73, "training_iteration": 73, "timesteps_since_restore": 4445623, "timesteps_this_iter": 59595, "custom_metrics": {"system_level_velocity_min": 10.608808316219584, "outflow_rate_max": 1163.7837748417621, "system_level_velocity_max": 17.297848481194286, "cost1_mean": 351.8748856474116, "outflow_rate_mean": 1037.6994275782026, "cost1_min": 23.420752396760175, "cost2_min": -147.20524101215858, "cost1_max": 426.10170335568455, "outflow_rate_min": 460.7986147915604, "cost2_max": -20.92621737288962, "cost2_mean": -109.13378611999808, "system_level_velocity_mean": 13.450457008154304}, "episode_reward_min": 59.729066744316185, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56cfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e56c588>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-36-46", "episodes_this_iter": 27, "timestamp": 1558330606, "episode_reward_max": 1360.8367644894354, "num_metric_batches_dropped": 0, "time_since_restore": 3486.8543417453766, "timesteps_total": 4505734, "episode_len_mean": 693.36, "episodes_total": 2151, "time_total_s": 3486.8543417453766, "info": {"load_time_ms": 7.598, "default": {"vf_loss": 42.15766525268555, "total_loss": 42.15119552612305, "entropy": 1.5189944505691528, "policy_loss": -0.011044706217944622, "cur_kl_coeff": 0.22499999403953552, "vf_explained_var": 0.737170398235321, "cur_lr": 0.0005000000237487257, "kl": 0.020321881398558617}, "num_steps_trained": 4505734, "grad_time_ms": 15393.474, "num_steps_sampled": 4505734, "sample_time_ms": 30595.53, "update_time_ms": 8.397}, "episode_reward_mean": 1148.9366218485945, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.464314222335815, "iterations_since_restore": 74, "training_iteration": 74, "timesteps_since_restore": 4505734, "timesteps_this_iter": 60111, "custom_metrics": {"system_level_velocity_min": 10.596924059676441, "outflow_rate_max": 1163.7837748417621, "system_level_velocity_max": 17.297848481194286, "cost1_mean": 347.5516194705658, "outflow_rate_mean": 1032.624206423433, "cost1_min": 23.420752396760175, "cost2_min": -147.20524101215858, "cost1_max": 426.10170335568455, "outflow_rate_min": 460.7986147915604, "cost2_max": -20.92621737288962, "cost2_mean": -111.37476588663768, "system_level_velocity_mean": 13.287846128193058}, "episode_reward_min": 59.729066744316185, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e558438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5866a0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-37-33", "episodes_this_iter": 28, "timestamp": 1558330653, "episode_reward_max": 1360.8367644894354, "num_metric_batches_dropped": 0, "time_since_restore": 3533.1444091796875, "timesteps_total": 4563989, "episode_len_mean": 700.0, "episodes_total": 2179, "time_total_s": 3533.1444091796875, "info": {"load_time_ms": 7.613, "default": {"vf_loss": 41.250789642333984, "total_loss": 41.24369812011719, "entropy": 1.5188597440719604, "policy_loss": -0.011550563387572765, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.743920624256134, "cur_lr": 0.0005000000237487257, "kl": 0.013211363926529884}, "num_steps_trained": 4563989, "grad_time_ms": 15561.89, "num_steps_sampled": 4563989, "sample_time_ms": 30497.438, "update_time_ms": 8.58}, "episode_reward_mean": 1159.4422329370507, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.29006743431091, "iterations_since_restore": 75, "training_iteration": 75, "timesteps_since_restore": 4563989, "timesteps_this_iter": 58255, "custom_metrics": {"system_level_velocity_min": 10.59574261474037, "outflow_rate_max": 1163.7837748417621, "system_level_velocity_max": 15.949962518966277, "cost1_mean": 349.86343928641554, "outflow_rate_mean": 1037.1623504371332, "cost1_min": 275.89412494515443, "cost2_min": -143.0654925908296, "cost1_max": 426.10170335568455, "outflow_rate_min": 897.8125998021668, "cost2_max": -69.30092907216428, "cost2_mean": -111.8048846748319, "system_level_velocity_mean": 13.205761377679018}, "episode_reward_min": 946.273796890897, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5868d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-38-17", "episodes_this_iter": 28, "timestamp": 1558330697, "episode_reward_max": 1341.9071176873576, "num_metric_batches_dropped": 0, "time_since_restore": 3576.9622921943665, "timesteps_total": 4621498, "episode_len_mean": 700.0, "episodes_total": 2207, "time_total_s": 3576.9622921943665, "info": {"load_time_ms": 7.711, "default": {"vf_loss": 45.80949020385742, "total_loss": 45.802940368652344, "entropy": 1.5044924020767212, "policy_loss": -0.010944041423499584, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.691698431968689, "cur_lr": 0.0005000000237487257, "kl": 0.013023869134485722}, "num_steps_trained": 4621498, "grad_time_ms": 15434.132, "num_steps_sampled": 4621498, "sample_time_ms": 30384.819, "update_time_ms": 8.32}, "episode_reward_mean": 1161.995106754129, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.817883014678955, "iterations_since_restore": 76, "training_iteration": 76, "timesteps_since_restore": 4621498, "timesteps_this_iter": 57509, "custom_metrics": {"system_level_velocity_min": 10.59574261474037, "outflow_rate_max": 1156.9281816481925, "system_level_velocity_max": 15.89738031248006, "cost1_mean": 352.519683481411, "outflow_rate_mean": 1038.649363579357, "cost1_min": 275.89412494515443, "cost2_min": -141.92513711941928, "cost1_max": 421.5887750029593, "outflow_rate_min": 897.8125998021668, "cost2_max": -68.50381962006237, "cost2_mean": -110.68010826976688, "system_level_velocity_mean": 13.305553850677892}, "episode_reward_min": 946.273796890897, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57aac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57a080>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-39-02", "episodes_this_iter": 30, "timestamp": 1558330742, "episode_reward_max": 1341.9071176873576, "num_metric_batches_dropped": 0, "time_since_restore": 3622.369959115982, "timesteps_total": 4677949, "episode_len_mean": 700.0, "episodes_total": 2237, "time_total_s": 3622.369959115982, "info": {"load_time_ms": 8.082, "default": {"vf_loss": 48.29503631591797, "total_loss": 48.28883361816406, "entropy": 1.5076013803482056, "policy_loss": -0.010584509931504726, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7028958201408386, "cur_lr": 0.0005000000237487257, "kl": 0.012971045449376106}, "num_steps_trained": 4677949, "grad_time_ms": 15236.059, "num_steps_sampled": 4677949, "sample_time_ms": 30571.593, "update_time_ms": 8.399}, "episode_reward_mean": 1160.4063188443736, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.4076669216156, "iterations_since_restore": 77, "training_iteration": 77, "timesteps_since_restore": 4677949, "timesteps_this_iter": 56451, "custom_metrics": {"system_level_velocity_min": 10.59574261474037, "outflow_rate_max": 1174.7479735630684, "system_level_velocity_max": 15.867788393138444, "cost1_mean": 355.64524537221195, "outflow_rate_mean": 1046.2769227803876, "cost1_min": 275.89412494515443, "cost2_min": -147.47600106077041, "cost1_max": 421.3411888180017, "outflow_rate_min": 911.9470969748097, "cost2_max": -68.50381962006237, "cost2_mean": -113.10750907514338, "system_level_velocity_mean": 13.414090356859333}, "episode_reward_min": 963.8279482221726, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57bbe0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-39-49", "episodes_this_iter": 29, "timestamp": 1558330789, "episode_reward_max": 1327.5276874312672, "num_metric_batches_dropped": 0, "time_since_restore": 3669.7476468086243, "timesteps_total": 4736935, "episode_len_mean": 700.0, "episodes_total": 2266, "time_total_s": 3669.7476468086243, "info": {"load_time_ms": 7.948, "default": {"vf_loss": 46.89451599121094, "total_loss": 46.88744354248047, "entropy": 1.5249375104904175, "policy_loss": -0.01165794301778078, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7168031334877014, "cur_lr": 0.0005000000237487257, "kl": 0.01360696367919445}, "num_steps_trained": 4736935, "grad_time_ms": 15233.193, "num_steps_sampled": 4736935, "sample_time_ms": 30647.068, "update_time_ms": 8.361}, "episode_reward_mean": 1169.493926835126, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 47.37768769264221, "iterations_since_restore": 78, "training_iteration": 78, "timesteps_since_restore": 4736935, "timesteps_this_iter": 58986, "custom_metrics": {"system_level_velocity_min": 10.266518253518853, "outflow_rate_max": 1174.7479735630684, "system_level_velocity_max": 15.867788393138444, "cost1_mean": 360.2268362457524, "outflow_rate_mean": 1054.707388724216, "cost1_min": 268.0243465760487, "cost2_min": -148.4451009485692, "cost1_max": 421.3411888180017, "outflow_rate_min": 926.8784403030868, "cost2_max": -68.50381962006237, "cost2_mean": -114.15770061395907, "system_level_velocity_mean": 13.585605347644796}, "episode_reward_min": 963.8279482221726, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0eac8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-40-35", "episodes_this_iter": 28, "timestamp": 1558330835, "episode_reward_max": 1335.714921352891, "num_metric_batches_dropped": 0, "time_since_restore": 3715.445881843567, "timesteps_total": 4797164, "episode_len_mean": 700.0, "episodes_total": 2294, "time_total_s": 3715.445881843567, "info": {"load_time_ms": 8.092, "default": {"vf_loss": 43.11787796020508, "total_loss": 43.112060546875, "entropy": 1.5366955995559692, "policy_loss": -0.0099591463804245, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.741142749786377, "cur_lr": 0.0005000000237487257, "kl": 0.01226405706256628}, "num_steps_trained": 4797164, "grad_time_ms": 15113.225, "num_steps_sampled": 4797164, "sample_time_ms": 30655.11, "update_time_ms": 8.366}, "episode_reward_mean": 1181.6304646225979, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.69823503494263, "iterations_since_restore": 79, "training_iteration": 79, "timesteps_since_restore": 4797164, "timesteps_this_iter": 60229, "custom_metrics": {"system_level_velocity_min": 9.38272650231845, "outflow_rate_max": 1204.317421441341, "system_level_velocity_max": 16.31728995103153, "cost1_mean": 360.6127206285002, "outflow_rate_mean": 1059.0760442708026, "cost1_min": 249.62772623484784, "cost2_min": -148.4451009485692, "cost1_max": 431.29595704493255, "outflow_rate_min": 893.8558550277271, "cost2_max": -73.81539600691232, "cost2_mean": -118.44715837478115, "system_level_velocity_mean": 13.59959825729107}, "episode_reward_min": 961.1158731582514, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583d30>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-41-21", "episodes_this_iter": 30, "timestamp": 1558330881, "episode_reward_max": 1335.714921352891, "num_metric_batches_dropped": 0, "time_since_restore": 3760.8554894924164, "timesteps_total": 4855614, "episode_len_mean": 700.0, "episodes_total": 2324, "time_total_s": 3760.8554894924164, "info": {"load_time_ms": 8.083, "default": {"vf_loss": 45.656070709228516, "total_loss": 45.649078369140625, "entropy": 1.5128012895584106, "policy_loss": -0.011525588110089302, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7439290881156921, "cur_lr": 0.0005000000237487257, "kl": 0.01343140471726656}, "num_steps_trained": 4855614, "grad_time_ms": 14935.755, "num_steps_sampled": 4855614, "sample_time_ms": 30617.263, "update_time_ms": 8.09}, "episode_reward_mean": 1188.4464057883706, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.40960764884949, "iterations_since_restore": 80, "training_iteration": 80, "timesteps_since_restore": 4855614, "timesteps_this_iter": 58450, "custom_metrics": {"system_level_velocity_min": 9.38272650231845, "outflow_rate_max": 1204.317421441341, "system_level_velocity_max": 16.372850786207366, "cost1_mean": 360.02614502749384, "outflow_rate_mean": 1063.0921830484165, "cost1_min": 249.62772623484784, "cost2_min": -169.92206014984941, "cost1_max": 431.32523119567463, "outflow_rate_min": 893.8558550277271, "cost2_max": -73.81539600691232, "cost2_mean": -121.95460597926365, "system_level_velocity_mean": 13.583741344975646}, "episode_reward_min": 961.1158731582514, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5862b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5904a8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-42-06", "episodes_this_iter": 29, "timestamp": 1558330926, "episode_reward_max": 1398.1873501962646, "num_metric_batches_dropped": 0, "time_since_restore": 3806.2452857494354, "timesteps_total": 4913701, "episode_len_mean": 700.0, "episodes_total": 2353, "time_total_s": 3806.2452857494354, "info": {"load_time_ms": 8.144, "default": {"vf_loss": 49.1844482421875, "total_loss": 49.17829895019531, "entropy": 1.5095899105072021, "policy_loss": -0.01087704673409462, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7313883304595947, "cur_lr": 0.0005000000237487257, "kl": 0.01401709858328104}, "num_steps_trained": 4913701, "grad_time_ms": 14850.736, "num_steps_sampled": 4913701, "sample_time_ms": 30823.673, "update_time_ms": 7.822}, "episode_reward_mean": 1196.179965845323, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.38979625701904, "iterations_since_restore": 81, "training_iteration": 81, "timesteps_since_restore": 4913701, "timesteps_this_iter": 58087, "custom_metrics": {"system_level_velocity_min": 9.38272650231845, "outflow_rate_max": 1204.317421441341, "system_level_velocity_max": 16.42835746377189, "cost1_mean": 361.48481447834973, "outflow_rate_mean": 1065.4720771454004, "cost1_min": 249.62772623484784, "cost2_min": -169.92206014984941, "cost1_max": 433.5459907722292, "outflow_rate_min": 893.8558550277271, "cost2_max": -73.81539600691232, "cost2_mean": -122.51327197133543, "system_level_velocity_mean": 13.658404370994438}, "episode_reward_min": 961.1158731582514, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586358>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-42-50", "episodes_this_iter": 31, "timestamp": 1558330970, "episode_reward_max": 1398.1873501962646, "num_metric_batches_dropped": 0, "time_since_restore": 3850.207479953766, "timesteps_total": 4972405, "episode_len_mean": 700.0, "episodes_total": 2384, "time_total_s": 3850.207479953766, "info": {"load_time_ms": 8.197, "default": {"vf_loss": 48.18801498413086, "total_loss": 48.180206298828125, "entropy": 1.5311670303344727, "policy_loss": -0.01252654753625393, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7267795205116272, "cur_lr": 0.0005000000237487257, "kl": 0.013975312933325768}, "num_steps_trained": 4972405, "grad_time_ms": 14713.403, "num_steps_sampled": 4972405, "sample_time_ms": 30887.061, "update_time_ms": 7.917}, "episode_reward_mean": 1185.165167312581, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.962194204330444, "iterations_since_restore": 82, "training_iteration": 82, "timesteps_since_restore": 4972405, "timesteps_this_iter": 58704, "custom_metrics": {"system_level_velocity_min": 10.231035438720493, "outflow_rate_max": 1211.602237972429, "system_level_velocity_max": 16.42835746377189, "cost1_mean": 360.6022197719291, "outflow_rate_mean": 1067.1145978821573, "cost1_min": 275.4522198187382, "cost2_min": -169.92206014984941, "cost1_max": 433.5459907722292, "outflow_rate_min": 913.9113301730903, "cost2_max": -82.30817670032593, "cost2_mean": -125.80760834504781, "system_level_velocity_mean": 13.640313153123014}, "episode_reward_min": 985.1904845085568, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5839e8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-43-35", "episodes_this_iter": 30, "timestamp": 1558331015, "episode_reward_max": 1398.1873501962646, "num_metric_batches_dropped": 0, "time_since_restore": 3895.327889442444, "timesteps_total": 5032318, "episode_len_mean": 696.17, "episodes_total": 2414, "time_total_s": 3895.327889442444, "info": {"load_time_ms": 8.619, "default": {"vf_loss": 44.315181732177734, "total_loss": 44.30881118774414, "entropy": 1.5237890481948853, "policy_loss": -0.010835814289748669, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7198585271835327, "cur_lr": 0.0005000000237487257, "kl": 0.013238745741546154}, "num_steps_trained": 5032318, "grad_time_ms": 14753.283, "num_steps_sampled": 5032318, "sample_time_ms": 30813.591, "update_time_ms": 7.899}, "episode_reward_mean": 1175.672166658382, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.12040948867798, "iterations_since_restore": 83, "training_iteration": 83, "timesteps_since_restore": 5032318, "timesteps_this_iter": 59913, "custom_metrics": {"system_level_velocity_min": 10.231035438720493, "outflow_rate_max": 1211.602237972429, "system_level_velocity_max": 16.42835746377189, "cost1_mean": 361.7176012979729, "outflow_rate_mean": 1071.138398577826, "cost1_min": 188.04702880584782, "cost2_min": -169.92206014984941, "cost1_max": 433.5459907722292, "outflow_rate_min": 833.9570371785779, "cost2_max": -78.07667620361075, "cost2_mean": -126.10504373124144, "system_level_velocity_mean": 13.768941447961268}, "episode_reward_min": 591.9984224695456, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e8d0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-44-19", "episodes_this_iter": 28, "timestamp": 1558331059, "episode_reward_max": 1389.8515605962848, "num_metric_batches_dropped": 0, "time_since_restore": 3939.1806955337524, "timesteps_total": 5090952, "episode_len_mean": 696.17, "episodes_total": 2442, "time_total_s": 3939.1806955337524, "info": {"load_time_ms": 8.59, "default": {"vf_loss": 44.0828742980957, "total_loss": 44.07617950439453, "entropy": 1.5362167358398438, "policy_loss": -0.011199555359780788, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7219071984291077, "cur_lr": 0.0005000000237487257, "kl": 0.013321168720722198}, "num_steps_trained": 5090952, "grad_time_ms": 14537.3, "num_steps_sampled": 5090952, "sample_time_ms": 30571.019, "update_time_ms": 7.898}, "episode_reward_mean": 1160.3407949994803, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.852806091308594, "iterations_since_restore": 84, "training_iteration": 84, "timesteps_since_restore": 5090952, "timesteps_this_iter": 58634, "custom_metrics": {"system_level_velocity_min": 10.231035438720493, "outflow_rate_max": 1211.602237972429, "system_level_velocity_max": 16.383486251147204, "cost1_mean": 359.26145506681826, "outflow_rate_mean": 1067.4763614125923, "cost1_min": 188.04702880584782, "cost2_min": -163.15879446882144, "cost1_max": 432.2308640582344, "outflow_rate_min": 833.9570371785779, "cost2_max": -78.07667620361075, "cost2_mean": -125.63176233994913, "system_level_velocity_mean": 13.676199818425346}, "episode_reward_min": 591.9984224695456, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5900b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590128>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-45-04", "episodes_this_iter": 30, "timestamp": 1558331104, "episode_reward_max": 1389.8515605962848, "num_metric_batches_dropped": 0, "time_since_restore": 3984.175617456436, "timesteps_total": 5149691, "episode_len_mean": 696.17, "episodes_total": 2472, "time_total_s": 3984.175617456436, "info": {"load_time_ms": 8.401, "default": {"vf_loss": 43.79679870605469, "total_loss": 43.78910446166992, "entropy": 1.5253362655639648, "policy_loss": -0.012295576743781567, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7424470782279968, "cur_lr": 0.0005000000237487257, "kl": 0.01363273337483406}, "num_steps_trained": 5149691, "grad_time_ms": 14527.425, "num_steps_sampled": 5149691, "sample_time_ms": 30452.236, "update_time_ms": 7.662}, "episode_reward_mean": 1152.3699286578353, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.994921922683716, "iterations_since_restore": 85, "training_iteration": 85, "timesteps_since_restore": 5149691, "timesteps_this_iter": 58739, "custom_metrics": {"system_level_velocity_min": 10.424489238267004, "outflow_rate_max": 1192.209025079623, "system_level_velocity_max": 16.383486251147204, "cost1_mean": 357.03678803424657, "outflow_rate_mean": 1062.6665982023437, "cost1_min": 188.04702880584782, "cost2_min": -154.6472853010028, "cost1_max": 432.2308640582344, "outflow_rate_min": 833.9570371785779, "cost2_max": -78.07667620361075, "cost2_mean": -124.89029443752815, "system_level_velocity_mean": 13.585151401875075}, "episode_reward_min": 591.9984224695456, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0ea20>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-45-50", "episodes_this_iter": 29, "timestamp": 1558331150, "episode_reward_max": 1356.295176796797, "num_metric_batches_dropped": 0, "time_since_restore": 4029.8971467018127, "timesteps_total": 5208062, "episode_len_mean": 683.18, "episodes_total": 2501, "time_total_s": 4029.8971467018127, "info": {"load_time_ms": 8.338, "default": {"vf_loss": 49.215232849121094, "total_loss": 49.20859146118164, "entropy": 1.5295759439468384, "policy_loss": -0.011013186536729336, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7064210772514343, "cur_lr": 0.0005000000237487257, "kl": 0.01293698139488697}, "num_steps_trained": 5208062, "grad_time_ms": 14711.909, "num_steps_sampled": 5208062, "sample_time_ms": 30455.942, "update_time_ms": 7.639}, "episode_reward_mean": 1136.8858637837589, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.72152924537659, "iterations_since_restore": 86, "training_iteration": 86, "timesteps_since_restore": 5208062, "timesteps_this_iter": 58371, "custom_metrics": {"system_level_velocity_min": 10.424489238267004, "outflow_rate_max": 1191.2232342124214, "system_level_velocity_max": 18.695554582199843, "cost1_mean": 351.6225263856291, "outflow_rate_mean": 1049.3165177357023, "cost1_min": 31.901989568104945, "cost2_min": -154.6472853010028, "cost1_max": 430.3131894365839, "outflow_rate_min": 538.1587386534574, "cost2_max": -25.684115945882326, "cost2_mean": -120.80702011367987, "system_level_velocity_mean": 13.730201843596765}, "episode_reward_min": 78.35521437706132, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583be0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-46-39", "episodes_this_iter": 29, "timestamp": 1558331199, "episode_reward_max": 1356.295176796797, "num_metric_batches_dropped": 0, "time_since_restore": 4078.399397611618, "timesteps_total": 5269038, "episode_len_mean": 687.01, "episodes_total": 2530, "time_total_s": 4078.399397611618, "info": {"load_time_ms": 8.195, "default": {"vf_loss": 40.72711181640625, "total_loss": 40.72054672241211, "entropy": 1.5555860996246338, "policy_loss": -0.010744547471404076, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7385091185569763, "cur_lr": 0.0005000000237487257, "kl": 0.012381569482386112}, "num_steps_trained": 5269038, "grad_time_ms": 14952.336, "num_steps_sampled": 5269038, "sample_time_ms": 30521.83, "update_time_ms": 7.594}, "episode_reward_mean": 1146.6369202498806, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 48.5022509098053, "iterations_since_restore": 87, "training_iteration": 87, "timesteps_since_restore": 5269038, "timesteps_this_iter": 60976, "custom_metrics": {"system_level_velocity_min": 9.770226339674274, "outflow_rate_max": 1182.7909110010673, "system_level_velocity_max": 18.695554582199843, "cost1_mean": 347.89910908296855, "outflow_rate_mean": 1042.7337377209285, "cost1_min": 31.901989568104945, "cost2_min": -172.58046847516204, "cost1_max": 430.3131894365839, "outflow_rate_min": 538.1587386534574, "cost2_max": -25.684115945882326, "cost2_mean": -124.07261022081175, "system_level_velocity_mean": 13.500206757661738}, "episode_reward_min": 78.35521437706132, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5ae1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590cf8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-47-25", "episodes_this_iter": 29, "timestamp": 1558331245, "episode_reward_max": 1372.8877601473853, "num_metric_batches_dropped": 0, "time_since_restore": 4124.952952623367, "timesteps_total": 5327269, "episode_len_mean": 680.35, "episodes_total": 2559, "time_total_s": 4124.952952623367, "info": {"load_time_ms": 8.175, "default": {"vf_loss": 51.28164291381836, "total_loss": 51.2756233215332, "entropy": 1.5369198322296143, "policy_loss": -0.010686458088457584, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7060704231262207, "cur_lr": 0.0005000000237487257, "kl": 0.013823469169437885}, "num_steps_trained": 5327269, "grad_time_ms": 14993.816, "num_steps_sampled": 5327269, "sample_time_ms": 30393.882, "update_time_ms": 7.94}, "episode_reward_mean": 1149.105044705545, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.55355501174927, "iterations_since_restore": 88, "training_iteration": 88, "timesteps_since_restore": 5327269, "timesteps_this_iter": 58231, "custom_metrics": {"system_level_velocity_min": 9.770226339674274, "outflow_rate_max": 1175.0733001492536, "system_level_velocity_max": 18.695554582199843, "cost1_mean": 346.8402892369122, "outflow_rate_mean": 1039.3944348192308, "cost1_min": 22.580873630822722, "cost2_min": -172.58046847516204, "cost1_max": 438.83035579499733, "outflow_rate_min": 499.67249035665265, "cost2_max": -19.195895550551896, "cost2_mean": -122.61523940278278, "system_level_velocity_mean": 13.62774242575392}, "episode_reward_min": 52.81908040305466, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8ee0e9b0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-48-12", "episodes_this_iter": 29, "timestamp": 1558331292, "episode_reward_max": 1427.670449279002, "num_metric_batches_dropped": 0, "time_since_restore": 4171.643654584885, "timesteps_total": 5386010, "episode_len_mean": 693.34, "episodes_total": 2588, "time_total_s": 4171.643654584885, "info": {"load_time_ms": 7.984, "default": {"vf_loss": 47.000980377197266, "total_loss": 46.99412536621094, "entropy": 1.544118046760559, "policy_loss": -0.011443819850683212, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7329810261726379, "cur_lr": 0.0005000000237487257, "kl": 0.013596123084425926}, "num_steps_trained": 5386010, "grad_time_ms": 15099.816, "num_steps_sampled": 5386010, "sample_time_ms": 30387.253, "update_time_ms": 8.067}, "episode_reward_mean": 1176.9029838509769, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 46.690701961517334, "iterations_since_restore": 89, "training_iteration": 89, "timesteps_since_restore": 5386010, "timesteps_this_iter": 58741, "custom_metrics": {"system_level_velocity_min": 9.356009988559768, "outflow_rate_max": 1196.245285279278, "system_level_velocity_max": 17.928421761037217, "cost1_mean": 355.3467731137537, "outflow_rate_mean": 1057.3426840322086, "cost1_min": 22.580873630822722, "cost2_min": -172.58046847516204, "cost1_max": 441.7897915793672, "outflow_rate_min": 499.67249035665265, "cost2_max": -19.195895550551896, "cost2_mean": -126.43341281008253, "system_level_velocity_mean": 13.589531119365041}, "episode_reward_min": 52.81908040305466, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6780>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-49-07", "episodes_this_iter": 29, "timestamp": 1558331347, "episode_reward_max": 1427.670449279002, "num_metric_batches_dropped": 0, "time_since_restore": 4226.557839632034, "timesteps_total": 5444264, "episode_len_mean": 693.34, "episodes_total": 2617, "time_total_s": 4226.557839632034, "info": {"load_time_ms": 7.877, "default": {"vf_loss": 48.133792877197266, "total_loss": 48.124969482421875, "entropy": 1.5381296873092651, "policy_loss": -0.013339285738766193, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7217527031898499, "cur_lr": 0.0005000000237487257, "kl": 0.013372397981584072}, "num_steps_trained": 5444264, "grad_time_ms": 16093.18, "num_steps_sampled": 5444264, "sample_time_ms": 30329.058, "update_time_ms": 8.041}, "episode_reward_mean": 1178.6759633809138, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 54.91418504714966, "iterations_since_restore": 90, "training_iteration": 90, "timesteps_since_restore": 5444264, "timesteps_this_iter": 58254, "custom_metrics": {"system_level_velocity_min": 9.356009988559768, "outflow_rate_max": 1196.245285279278, "system_level_velocity_max": 17.928421761037217, "cost1_mean": 359.41585238839843, "outflow_rate_mean": 1065.5376519628103, "cost1_min": 22.580873630822722, "cost2_min": -164.32952681858075, "cost1_max": 441.7897915793672, "outflow_rate_min": 499.67249035665265, "cost2_max": -19.195895550551896, "cost2_mean": -125.13923867711351, "system_level_velocity_mean": 13.747928748555314}, "episode_reward_min": 52.81908040305466, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5866d8>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-50-04", "episodes_this_iter": 29, "timestamp": 1558331404, "episode_reward_max": 1427.670449279002, "num_metric_batches_dropped": 0, "time_since_restore": 4283.753382205963, "timesteps_total": 5503580, "episode_len_mean": 700.0, "episodes_total": 2646, "time_total_s": 4283.753382205963, "info": {"load_time_ms": 7.937, "default": {"vf_loss": 47.955116271972656, "total_loss": 47.94920349121094, "entropy": 1.5501830577850342, "policy_loss": -0.010075472295284271, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.6914141774177551, "cur_lr": 0.0005000000237487257, "kl": 0.01234187837690115}, "num_steps_trained": 5503580, "grad_time_ms": 16141.783, "num_steps_sampled": 5503580, "sample_time_ms": 31459.372, "update_time_ms": 10.971}, "episode_reward_mean": 1192.7017191270036, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 57.19554257392883, "iterations_since_restore": 91, "training_iteration": 91, "timesteps_since_restore": 5503580, "timesteps_this_iter": 59316, "custom_metrics": {"system_level_velocity_min": 9.356009988559768, "outflow_rate_max": 1199.5835389431616, "system_level_velocity_max": 16.726240627581834, "cost1_mean": 364.63505624437965, "outflow_rate_mean": 1075.1719367921944, "cost1_min": 249.851597523388, "cost2_min": -156.02844849617605, "cost1_max": 441.7897915793672, "outflow_rate_min": 892.1559220071199, "cost2_max": -87.8330804460457, "cost2_mean": -127.47306296505161, "system_level_velocity_mean": 13.765201509411204}, "episode_reward_min": 947.4448028585181, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ec50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5c0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-50-48", "episodes_this_iter": 28, "timestamp": 1558331448, "episode_reward_max": 1382.5714363083473, "num_metric_batches_dropped": 0, "time_since_restore": 4327.602986574173, "timesteps_total": 5563180, "episode_len_mean": 700.0, "episodes_total": 2674, "time_total_s": 4327.602986574173, "info": {"load_time_ms": 7.917, "default": {"vf_loss": 45.365333557128906, "total_loss": 45.35923767089844, "entropy": 1.5603667497634888, "policy_loss": -0.010602883994579315, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7140440940856934, "cur_lr": 0.0005000000237487257, "kl": 0.013342543505132198}, "num_steps_trained": 5563180, "grad_time_ms": 16382.975, "num_steps_sampled": 5563180, "sample_time_ms": 31207.656, "update_time_ms": 10.909}, "episode_reward_mean": 1182.2818446320948, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.84960436820984, "iterations_since_restore": 92, "training_iteration": 92, "timesteps_since_restore": 5563180, "timesteps_this_iter": 59600, "custom_metrics": {"system_level_velocity_min": 10.029284804305469, "outflow_rate_max": 1204.239986227491, "system_level_velocity_max": 16.657913683496727, "cost1_mean": 359.3821191560635, "outflow_rate_mean": 1067.1504093992444, "cost1_min": 266.30068224956824, "cost2_min": -152.80374127785637, "cost1_max": 439.54963156232145, "outflow_rate_min": 892.1559220071199, "cost2_max": -89.75199699277786, "cost2_mean": -129.86430089650875, "system_level_velocity_mean": 13.563407620279454}, "episode_reward_min": 978.7897925186167, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e320>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-51-32", "episodes_this_iter": 30, "timestamp": 1558331492, "episode_reward_max": 1445.746524598261, "num_metric_batches_dropped": 0, "time_since_restore": 4371.908535003662, "timesteps_total": 5622326, "episode_len_mean": 700.0, "episodes_total": 2704, "time_total_s": 4371.908535003662, "info": {"load_time_ms": 7.83, "default": {"vf_loss": 51.61502456665039, "total_loss": 51.60784149169922, "entropy": 1.5581140518188477, "policy_loss": -0.011464490555226803, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.6620506048202515, "cur_lr": 0.0005000000237487257, "kl": 0.012690633535385132}, "num_steps_trained": 5622326, "grad_time_ms": 16449.965, "num_steps_sampled": 5622326, "sample_time_ms": 31060.362, "update_time_ms": 11.095}, "episode_reward_mean": 1181.8356146541823, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.305548429489136, "iterations_since_restore": 93, "training_iteration": 93, "timesteps_since_restore": 5622326, "timesteps_this_iter": 59146, "custom_metrics": {"system_level_velocity_min": 10.411345250453778, "outflow_rate_max": 1204.239986227491, "system_level_velocity_max": 16.788798764968107, "cost1_mean": 355.79683238632754, "outflow_rate_mean": 1059.118816556399, "cost1_min": 271.1444649170158, "cost2_min": -156.36176846674647, "cost1_max": 443.75826207448813, "outflow_rate_min": 892.1559220071199, "cost2_max": -89.75199699277786, "cost2_mean": -130.39456635959274, "system_level_velocity_mean": 13.428528763317548}, "episode_reward_min": 978.7897925186167, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5861d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e586668>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-52-22", "episodes_this_iter": 30, "timestamp": 1558331542, "episode_reward_max": 1445.746524598261, "num_metric_batches_dropped": 0, "time_since_restore": 4420.92955327034, "timesteps_total": 5681629, "episode_len_mean": 700.0, "episodes_total": 2734, "time_total_s": 4420.92955327034, "info": {"load_time_ms": 7.861, "default": {"vf_loss": 45.816162109375, "total_loss": 45.80964660644531, "entropy": 1.5675393342971802, "policy_loss": -0.01148444227874279, "cur_kl_coeff": 0.33750009536743164, "vf_explained_var": 0.7090045213699341, "cur_lr": 0.0005000000237487257, "kl": 0.014739549718797207}, "num_steps_trained": 5681629, "grad_time_ms": 16785.834, "num_steps_sampled": 5681629, "sample_time_ms": 31240.898, "update_time_ms": 11.392}, "episode_reward_mean": 1178.045465142639, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 49.021018266677856, "iterations_since_restore": 94, "training_iteration": 94, "timesteps_since_restore": 5681629, "timesteps_this_iter": 59303, "custom_metrics": {"system_level_velocity_min": 9.518104598429327, "outflow_rate_max": 1204.9867964172633, "system_level_velocity_max": 16.788798764968107, "cost1_mean": 356.63002085509123, "outflow_rate_mean": 1061.0663890487826, "cost1_min": 252.58795425609065, "cost2_min": -158.27090916406968, "cost1_max": 443.75826207448813, "outflow_rate_min": 866.1495081558438, "cost2_max": -105.2553766581054, "cost2_mean": -130.20057733646183, "system_level_velocity_mean": 13.454467216580381}, "episode_reward_min": 964.884343972321, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58e668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ef28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e58ecc0>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-53-07", "episodes_this_iter": 30, "timestamp": 1558331587, "episode_reward_max": 1445.746524598261, "num_metric_batches_dropped": 0, "time_since_restore": 4466.205410957336, "timesteps_total": 5741138, "episode_len_mean": 700.0, "episodes_total": 2764, "time_total_s": 4466.205410957336, "info": {"load_time_ms": 8.259, "default": {"vf_loss": 45.761573791503906, "total_loss": 45.75458908081055, "entropy": 1.5820136070251465, "policy_loss": -0.011692102998495102, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7065297961235046, "cur_lr": 0.0005000000237487257, "kl": 0.013939203694462776}, "num_steps_trained": 5741138, "grad_time_ms": 16694.947, "num_steps_sampled": 5741138, "sample_time_ms": 31358.245, "update_time_ms": 11.368}, "episode_reward_mean": 1180.2969273044073, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 45.27585768699646, "iterations_since_restore": 95, "training_iteration": 95, "timesteps_since_restore": 5741138, "timesteps_this_iter": 59509, "custom_metrics": {"system_level_velocity_min": 9.518104598429327, "outflow_rate_max": 1204.9867964172633, "system_level_velocity_max": 16.788798764968107, "cost1_mean": 358.6905902960955, "outflow_rate_mean": 1065.1890320273421, "cost1_min": 252.58795425609065, "cost2_min": -158.27090916406968, "cost1_max": 443.75826207448813, "outflow_rate_min": 866.1495081558438, "cost2_max": -105.2553766581054, "cost2_mean": -129.94267331663465, "system_level_velocity_mean": 13.537548504817927}, "episode_reward_min": 964.884343972321, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5d2e80>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-53-50", "episodes_this_iter": 29, "timestamp": 1558331630, "episode_reward_max": 1412.1444555773942, "num_metric_batches_dropped": 0, "time_since_restore": 4509.176795005798, "timesteps_total": 5798498, "episode_len_mean": 700.0, "episodes_total": 2793, "time_total_s": 4509.176795005798, "info": {"load_time_ms": 8.389, "default": {"vf_loss": 47.96950149536133, "total_loss": 47.961116790771484, "entropy": 1.5704247951507568, "policy_loss": -0.013566790148615837, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.6898178458213806, "cur_lr": 0.0005000000237487257, "kl": 0.01535467803478241}, "num_steps_trained": 5798498, "grad_time_ms": 16654.94, "num_steps_sampled": 5798498, "sample_time_ms": 31124.885, "update_time_ms": 11.518}, "episode_reward_mean": 1175.038499814954, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 42.971384048461914, "iterations_since_restore": 96, "training_iteration": 96, "timesteps_since_restore": 5798498, "timesteps_this_iter": 57360, "custom_metrics": {"system_level_velocity_min": 9.518104598429327, "outflow_rate_max": 1219.757143211496, "system_level_velocity_max": 16.788941773187045, "cost1_mean": 359.99758609767684, "outflow_rate_mean": 1068.0055804668652, "cost1_min": 252.58795425609065, "cost2_min": -158.27090916406968, "cost1_max": 443.75826207448813, "outflow_rate_min": 866.1495081558438, "cost2_max": -100.73840490820723, "cost2_mean": -129.3358546227288, "system_level_velocity_mean": 13.59796937368018}, "episode_reward_min": 964.884343972321, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583400>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-54-33", "episodes_this_iter": 27, "timestamp": 1558331673, "episode_reward_max": 1382.5033315859312, "num_metric_batches_dropped": 0, "time_since_restore": 4552.465286016464, "timesteps_total": 5855832, "episode_len_mean": 700.0, "episodes_total": 2820, "time_total_s": 4552.465286016464, "info": {"load_time_ms": 8.383, "default": {"vf_loss": 49.46889114379883, "total_loss": 49.46120834350586, "entropy": 1.58328115940094, "policy_loss": -0.012393563985824585, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.7004368305206299, "cur_lr": 0.0005000000237487257, "kl": 0.01397737953811884}, "num_steps_trained": 5855832, "grad_time_ms": 16574.979, "num_steps_sampled": 5855832, "sample_time_ms": 30687.342, "update_time_ms": 11.356}, "episode_reward_mean": 1173.0797868027914, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.288491010665894, "iterations_since_restore": 97, "training_iteration": 97, "timesteps_since_restore": 5855832, "timesteps_this_iter": 57334, "custom_metrics": {"system_level_velocity_min": 9.288885919009248, "outflow_rate_max": 1235.5669899947327, "system_level_velocity_max": 16.904637113873527, "cost1_mean": 362.3408536265682, "outflow_rate_mean": 1072.469434712217, "cost1_min": 244.99759065031063, "cost2_min": -155.35512121790617, "cost1_max": 447.1841310869101, "outflow_rate_min": 850.7481801715647, "cost2_max": -100.73840490820723, "cost2_mean": -129.28016098464767, "system_level_velocity_mean": 13.701225508320093}, "episode_reward_min": 947.6294535905855, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e5a6b00>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-55-17", "episodes_this_iter": 27, "timestamp": 1558331717, "episode_reward_max": 1378.7240781269618, "num_metric_batches_dropped": 0, "time_since_restore": 4596.159600496292, "timesteps_total": 5912936, "episode_len_mean": 700.0, "episodes_total": 2847, "time_total_s": 4596.159600496292, "info": {"load_time_ms": 8.451, "default": {"vf_loss": 48.50060272216797, "total_loss": 48.4937858581543, "entropy": 1.5796215534210205, "policy_loss": -0.011529313400387764, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.6700801253318787, "cur_lr": 0.0005000000237487257, "kl": 0.013972305692732334}, "num_steps_trained": 5912936, "grad_time_ms": 16444.529, "num_steps_sampled": 5912936, "sample_time_ms": 30534.736, "update_time_ms": 11.25}, "episode_reward_mean": 1171.6624798137432, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 43.69431447982788, "iterations_since_restore": 98, "training_iteration": 98, "timesteps_since_restore": 5912936, "timesteps_this_iter": 57104, "custom_metrics": {"system_level_velocity_min": 9.288885919009248, "outflow_rate_max": 1235.5669899947327, "system_level_velocity_max": 17.175695762921695, "cost1_mean": 362.0462099247605, "outflow_rate_mean": 1071.2534898641234, "cost1_min": 244.99759065031063, "cost2_min": -157.71367631537095, "cost1_max": 451.0510506659223, "outflow_rate_min": 850.7481801715647, "cost2_max": -100.73840490820723, "cost2_mean": -128.38845056855874, "system_level_velocity_mean": 13.700398630923212}, "episode_reward_min": 947.6294535905855, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e590710>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-56-02", "episodes_this_iter": 30, "timestamp": 1558331762, "episode_reward_max": 1421.1323868897434, "num_metric_batches_dropped": 0, "time_since_restore": 4640.942619085312, "timesteps_total": 5969332, "episode_len_mean": 700.0, "episodes_total": 2877, "time_total_s": 4640.942619085312, "info": {"load_time_ms": 8.527, "default": {"vf_loss": 49.59825134277344, "total_loss": 49.591392517089844, "entropy": 1.5879669189453125, "policy_loss": -0.01162965502589941, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.6622760891914368, "cur_lr": 0.0005000000237487257, "kl": 0.014142315834760666}, "num_steps_trained": 5969332, "grad_time_ms": 16164.374, "num_steps_sampled": 5969332, "sample_time_ms": 30624.09, "update_time_ms": 11.342}, "episode_reward_mean": 1168.7219866209116, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": false, "time_this_iter_s": 44.783018589019775, "iterations_since_restore": 99, "training_iteration": 99, "timesteps_since_restore": 5969332, "timesteps_this_iter": 56396, "custom_metrics": {"system_level_velocity_min": 9.288885919009248, "outflow_rate_max": 1235.5669899947327, "system_level_velocity_max": 17.175695762921695, "cost1_mean": 362.1604622795975, "outflow_rate_mean": 1069.6892644446466, "cost1_min": 244.99759065031063, "cost2_min": -157.71367631537095, "cost1_max": 451.0510506659223, "outflow_rate_min": 850.7481801715647, "cost2_max": -100.73840490820723, "cost2_mean": -127.93452789020395, "system_level_velocity_mean": 13.709433291736671}, "episode_reward_min": 947.6294535905855, "pid": 34524}
{"config": {"vf_share_layers": false, "compress_observations": false, "input_evaluation": null, "horizon": 1500, "num_workers": 20, "lambda": 0.97, "synchronize_filters": true, "vf_clip_param": 1000000.0, "optimizer": {}, "collect_metrics_timeout": 180, "tf_session_args": {"intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true}, "sample_batch_size": 750, "train_batch_size": 30000, "observation_filter": "MeanStdFilter", "clip_param": 0.3, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e583860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0a8e57b198>"}, "kl_coeff": 0.2, "num_envs_per_worker": 1, "monitor": false, "lr_schedule": null, "output_max_file_size": 67108864, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "batch_mode": "truncate_episodes", "log_level": "INFO", "input": "sampler", "simple_optimizer": false, "gamma": 0.99, "entropy_coeff": 0.0, "clip_actions": false, "num_cpus_per_worker": 1, "num_gpus": 0, "vf_loss_coeff": 1.0, "model": {"zero_mean": true, "conv_activation": "relu", "conv_filters": null, "fcnet_hiddens": [128, 64, 32], "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "dim": 84, "lstm_cell_size": 256, "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "grayscale": false, "lstm_use_prev_action_reward": false, "use_lstm": false, "custom_model": null, "channel_major": false}, "num_cpus_for_driver": 1, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr": 0.0005, "output": null, "num_gpus_per_worker": 0, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "use_gae": true, "sample_async": false, "custom_resources_per_worker": {}, "num_sgd_iter": 10, "clip_rewards": null}, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "date": "2019-05-20_05-56-46", "episodes_this_iter": 30, "timestamp": 1558331806, "episode_reward_max": 1421.1323868897434, "num_metric_batches_dropped": 0, "time_since_restore": 4684.963970661163, "timesteps_total": 6026081, "episode_len_mean": 697.16, "episodes_total": 2907, "time_total_s": 4684.963970661163, "info": {"load_time_ms": 8.612, "default": {"vf_loss": 55.653297424316406, "total_loss": 55.645599365234375, "entropy": 1.5853180885314941, "policy_loss": -0.012513542547821999, "cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.6151902675628662, "cur_lr": 0.0005000000237487257, "kl": 0.014270711690187454}, "num_steps_trained": 6026081, "grad_time_ms": 15017.035, "num_steps_sampled": 6026081, "sample_time_ms": 30699.774, "update_time_ms": 11.318}, "episode_reward_mean": 1160.949867337642, "hostname": "flow-main", "experiment_id": "4fabde6b297544d48f7aeb2f8d9a4b29", "done": true, "time_this_iter_s": 44.02135157585144, "iterations_since_restore": 100, "training_iteration": 100, "timesteps_since_restore": 6026081, "timesteps_this_iter": 56749, "custom_metrics": {"system_level_velocity_min": 9.288885919009248, "outflow_rate_max": 1235.5669899947327, "system_level_velocity_max": 17.175695762921695, "cost1_mean": 361.0373955513549, "outflow_rate_mean": 1067.8114664652217, "cost1_min": 244.99759065031063, "cost2_min": -157.71367631537095, "cost1_max": 451.0510506659223, "outflow_rate_min": 850.7481801715647, "cost2_max": -74.66156796556322, "cost2_mean": -126.24349749174455, "system_level_velocity_mean": 13.737450798243103}, "episode_reward_min": 809.8065818070734, "pid": 34524}
